(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=t(r);fetch(r.href,l)}})();function VS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var tg={exports:{}},Gc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t1;function dk(){if(t1)return Gc;t1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var d in r)d!=="key"&&(l[d]=r[d])}else l=r;return r=l.ref,{$$typeof:n,type:i,key:c,ref:r!==void 0?r:null,props:l}}return Gc.Fragment=e,Gc.jsx=t,Gc.jsxs=t,Gc}var n1;function fk(){return n1||(n1=1,tg.exports=dk()),tg.exports}var o=fk(),ng={exports:{}},Ye={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i1;function hk(){if(i1)return Ye;i1=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),p=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),x=Symbol.for("react.lazy"),b=Symbol.for("react.activity"),T=Symbol.iterator;function S(B){return B===null||typeof B!="object"?null:(B=T&&B[T]||B["@@iterator"],typeof B=="function"?B:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,k={};function F(B,ee,he){this.props=B,this.context=ee,this.refs=k,this.updater=he||E}F.prototype.isReactComponent={},F.prototype.setState=function(B,ee){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,ee,"setState")},F.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function $(){}$.prototype=F.prototype;function M(B,ee,he){this.props=B,this.context=ee,this.refs=k,this.updater=he||E}var J=M.prototype=new $;J.constructor=M,D(J,F.prototype),J.isPureReactComponent=!0;var H=Array.isArray;function z(){}var R={H:null,A:null,T:null,S:null},C=Object.prototype.hasOwnProperty;function A(B,ee,he){var Q=he.ref;return{$$typeof:n,type:B,key:ee,ref:Q!==void 0?Q:null,props:he}}function P(B,ee){return A(B.type,ee,B.props)}function L(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function O(B){var ee={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(he){return ee[he]})}var j=/\/+/g;function q(B,ee){return typeof B=="object"&&B!==null&&B.key!=null?O(""+B.key):ee.toString(36)}function le(B){switch(B.status){case"fulfilled":return B.value;case"rejected":throw B.reason;default:switch(typeof B.status=="string"?B.then(z,z):(B.status="pending",B.then(function(ee){B.status==="pending"&&(B.status="fulfilled",B.value=ee)},function(ee){B.status==="pending"&&(B.status="rejected",B.reason=ee)})),B.status){case"fulfilled":return B.value;case"rejected":throw B.reason}}throw B}function U(B,ee,he,Q,ae){var ye=typeof B;(ye==="undefined"||ye==="boolean")&&(B=null);var ue=!1;if(B===null)ue=!0;else switch(ye){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(B.$$typeof){case n:case e:ue=!0;break;case x:return ue=B._init,U(ue(B._payload),ee,he,Q,ae)}}if(ue)return ae=ae(B),ue=Q===""?"."+q(B,0):Q,H(ae)?(he="",ue!=null&&(he=ue.replace(j,"$&/")+"/"),U(ae,ee,he,"",function(Be){return Be})):ae!=null&&(L(ae)&&(ae=P(ae,he+(ae.key==null||B&&B.key===ae.key?"":(""+ae.key).replace(j,"$&/")+"/")+ue)),ee.push(ae)),1;ue=0;var Te=Q===""?".":Q+":";if(H(B))for(var Ae=0;Ae<B.length;Ae++)Q=B[Ae],ye=Te+q(Q,Ae),ue+=U(Q,ee,he,ye,ae);else if(Ae=S(B),typeof Ae=="function")for(B=Ae.call(B),Ae=0;!(Q=B.next()).done;)Q=Q.value,ye=Te+q(Q,Ae++),ue+=U(Q,ee,he,ye,ae);else if(ye==="object"){if(typeof B.then=="function")return U(le(B),ee,he,Q,ae);throw ee=String(B),Error("Objects are not valid as a React child (found: "+(ee==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}return ue}function Y(B,ee,he){if(B==null)return B;var Q=[],ae=0;return U(B,Q,"","",function(ye){return ee.call(he,ye,ae++)}),Q}function X(B){if(B._status===-1){var ee=B._result;ee=ee(),ee.then(function(he){(B._status===0||B._status===-1)&&(B._status=1,B._result=he)},function(he){(B._status===0||B._status===-1)&&(B._status=2,B._result=he)}),B._status===-1&&(B._status=0,B._result=ee)}if(B._status===1)return B._result.default;throw B._result}var ie=typeof reportError=="function"?reportError:function(B){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ee=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof B=="object"&&B!==null&&typeof B.message=="string"?String(B.message):String(B),error:B});if(!window.dispatchEvent(ee))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",B);return}console.error(B)},pe={map:Y,forEach:function(B,ee,he){Y(B,function(){ee.apply(this,arguments)},he)},count:function(B){var ee=0;return Y(B,function(){ee++}),ee},toArray:function(B){return Y(B,function(ee){return ee})||[]},only:function(B){if(!L(B))throw Error("React.Children.only expected to receive a single React element child.");return B}};return Ye.Activity=b,Ye.Children=pe,Ye.Component=F,Ye.Fragment=t,Ye.Profiler=r,Ye.PureComponent=M,Ye.StrictMode=i,Ye.Suspense=p,Ye.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=R,Ye.__COMPILER_RUNTIME={__proto__:null,c:function(B){return R.H.useMemoCache(B)}},Ye.cache=function(B){return function(){return B.apply(null,arguments)}},Ye.cacheSignal=function(){return null},Ye.cloneElement=function(B,ee,he){if(B==null)throw Error("The argument must be a React element, but you passed "+B+".");var Q=D({},B.props),ae=B.key;if(ee!=null)for(ye in ee.key!==void 0&&(ae=""+ee.key),ee)!C.call(ee,ye)||ye==="key"||ye==="__self"||ye==="__source"||ye==="ref"&&ee.ref===void 0||(Q[ye]=ee[ye]);var ye=arguments.length-2;if(ye===1)Q.children=he;else if(1<ye){for(var ue=Array(ye),Te=0;Te<ye;Te++)ue[Te]=arguments[Te+2];Q.children=ue}return A(B.type,ae,Q)},Ye.createContext=function(B){return B={$$typeof:c,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null},B.Provider=B,B.Consumer={$$typeof:l,_context:B},B},Ye.createElement=function(B,ee,he){var Q,ae={},ye=null;if(ee!=null)for(Q in ee.key!==void 0&&(ye=""+ee.key),ee)C.call(ee,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(ae[Q]=ee[Q]);var ue=arguments.length-2;if(ue===1)ae.children=he;else if(1<ue){for(var Te=Array(ue),Ae=0;Ae<ue;Ae++)Te[Ae]=arguments[Ae+2];ae.children=Te}if(B&&B.defaultProps)for(Q in ue=B.defaultProps,ue)ae[Q]===void 0&&(ae[Q]=ue[Q]);return A(B,ye,ae)},Ye.createRef=function(){return{current:null}},Ye.forwardRef=function(B){return{$$typeof:d,render:B}},Ye.isValidElement=L,Ye.lazy=function(B){return{$$typeof:x,_payload:{_status:-1,_result:B},_init:X}},Ye.memo=function(B,ee){return{$$typeof:h,type:B,compare:ee===void 0?null:ee}},Ye.startTransition=function(B){var ee=R.T,he={};R.T=he;try{var Q=B(),ae=R.S;ae!==null&&ae(he,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(z,ie)}catch(ye){ie(ye)}finally{ee!==null&&he.types!==null&&(ee.types=he.types),R.T=ee}},Ye.unstable_useCacheRefresh=function(){return R.H.useCacheRefresh()},Ye.use=function(B){return R.H.use(B)},Ye.useActionState=function(B,ee,he){return R.H.useActionState(B,ee,he)},Ye.useCallback=function(B,ee){return R.H.useCallback(B,ee)},Ye.useContext=function(B){return R.H.useContext(B)},Ye.useDebugValue=function(){},Ye.useDeferredValue=function(B,ee){return R.H.useDeferredValue(B,ee)},Ye.useEffect=function(B,ee){return R.H.useEffect(B,ee)},Ye.useEffectEvent=function(B){return R.H.useEffectEvent(B)},Ye.useId=function(){return R.H.useId()},Ye.useImperativeHandle=function(B,ee,he){return R.H.useImperativeHandle(B,ee,he)},Ye.useInsertionEffect=function(B,ee){return R.H.useInsertionEffect(B,ee)},Ye.useLayoutEffect=function(B,ee){return R.H.useLayoutEffect(B,ee)},Ye.useMemo=function(B,ee){return R.H.useMemo(B,ee)},Ye.useOptimistic=function(B,ee){return R.H.useOptimistic(B,ee)},Ye.useReducer=function(B,ee,he){return R.H.useReducer(B,ee,he)},Ye.useRef=function(B){return R.H.useRef(B)},Ye.useState=function(B){return R.H.useState(B)},Ye.useSyncExternalStore=function(B,ee,he){return R.H.useSyncExternalStore(B,ee,he)},Ye.useTransition=function(){return R.H.useTransition()},Ye.version="19.2.4",Ye}var s1;function v0(){return s1||(s1=1,ng.exports=hk()),ng.exports}var K=v0();const pk=VS(K);var ig={exports:{}},Bc={},sg={exports:{}},rg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r1;function mk(){return r1||(r1=1,(function(n){function e(U,Y){var X=U.length;U.push(Y);e:for(;0<X;){var ie=X-1>>>1,pe=U[ie];if(0<r(pe,Y))U[ie]=Y,U[X]=pe,X=ie;else break e}}function t(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var Y=U[0],X=U.pop();if(X!==Y){U[0]=X;e:for(var ie=0,pe=U.length,B=pe>>>1;ie<B;){var ee=2*(ie+1)-1,he=U[ee],Q=ee+1,ae=U[Q];if(0>r(he,X))Q<pe&&0>r(ae,he)?(U[ie]=ae,U[Q]=X,ie=Q):(U[ie]=he,U[ee]=X,ie=ee);else if(Q<pe&&0>r(ae,X))U[ie]=ae,U[Q]=X,ie=Q;else break e}}return Y}function r(U,Y){var X=U.sortIndex-Y.sortIndex;return X!==0?X:U.id-Y.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,d=c.now();n.unstable_now=function(){return c.now()-d}}var p=[],h=[],x=1,b=null,T=3,S=!1,E=!1,D=!1,k=!1,F=typeof setTimeout=="function"?setTimeout:null,$=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function J(U){for(var Y=t(h);Y!==null;){if(Y.callback===null)i(h);else if(Y.startTime<=U)i(h),Y.sortIndex=Y.expirationTime,e(p,Y);else break;Y=t(h)}}function H(U){if(D=!1,J(U),!E)if(t(p)!==null)E=!0,z||(z=!0,O());else{var Y=t(h);Y!==null&&le(H,Y.startTime-U)}}var z=!1,R=-1,C=5,A=-1;function P(){return k?!0:!(n.unstable_now()-A<C)}function L(){if(k=!1,z){var U=n.unstable_now();A=U;var Y=!0;try{e:{E=!1,D&&(D=!1,$(R),R=-1),S=!0;var X=T;try{t:{for(J(U),b=t(p);b!==null&&!(b.expirationTime>U&&P());){var ie=b.callback;if(typeof ie=="function"){b.callback=null,T=b.priorityLevel;var pe=ie(b.expirationTime<=U);if(U=n.unstable_now(),typeof pe=="function"){b.callback=pe,J(U),Y=!0;break t}b===t(p)&&i(p),J(U)}else i(p);b=t(p)}if(b!==null)Y=!0;else{var B=t(h);B!==null&&le(H,B.startTime-U),Y=!1}}break e}finally{b=null,T=X,S=!1}Y=void 0}}finally{Y?O():z=!1}}}var O;if(typeof M=="function")O=function(){M(L)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,q=j.port2;j.port1.onmessage=L,O=function(){q.postMessage(null)}}else O=function(){F(L,0)};function le(U,Y){R=F(function(){U(n.unstable_now())},Y)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(U){switch(T){case 1:case 2:case 3:var Y=3;break;default:Y=T}var X=T;T=Y;try{return U()}finally{T=X}},n.unstable_requestPaint=function(){k=!0},n.unstable_runWithPriority=function(U,Y){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var X=T;T=U;try{return Y()}finally{T=X}},n.unstable_scheduleCallback=function(U,Y,X){var ie=n.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?ie+X:ie):X=ie,U){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=X+pe,U={id:x++,callback:Y,priorityLevel:U,startTime:X,expirationTime:pe,sortIndex:-1},X>ie?(U.sortIndex=X,e(h,U),t(p)===null&&U===t(h)&&(D?($(R),R=-1):D=!0,le(H,X-ie))):(U.sortIndex=pe,e(p,U),E||S||(E=!0,z||(z=!0,O()))),U},n.unstable_shouldYield=P,n.unstable_wrapCallback=function(U){var Y=T;return function(){var X=T;T=Y;try{return U.apply(this,arguments)}finally{T=X}}}})(rg)),rg}var o1;function gk(){return o1||(o1=1,sg.exports=mk()),sg.exports}var og={exports:{}},In={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a1;function xk(){if(a1)return In;a1=1;var n=v0();function e(p){var h="https://react.dev/errors/"+p;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)h+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(p,h,x){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:b==null?null:""+b,children:p,containerInfo:h,implementation:x}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(p,h){if(p==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return In.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,In.createPortal=function(p,h){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return l(p,h,null,x)},In.flushSync=function(p){var h=c.T,x=i.p;try{if(c.T=null,i.p=2,p)return p()}finally{c.T=h,i.p=x,i.d.f()}},In.preconnect=function(p,h){typeof p=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,i.d.C(p,h))},In.prefetchDNS=function(p){typeof p=="string"&&i.d.D(p)},In.preinit=function(p,h){if(typeof p=="string"&&h&&typeof h.as=="string"){var x=h.as,b=d(x,h.crossOrigin),T=typeof h.integrity=="string"?h.integrity:void 0,S=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;x==="style"?i.d.S(p,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:b,integrity:T,fetchPriority:S}):x==="script"&&i.d.X(p,{crossOrigin:b,integrity:T,fetchPriority:S,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},In.preinitModule=function(p,h){if(typeof p=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var x=d(h.as,h.crossOrigin);i.d.M(p,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&i.d.M(p)},In.preload=function(p,h){if(typeof p=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var x=h.as,b=d(x,h.crossOrigin);i.d.L(p,x,{crossOrigin:b,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},In.preloadModule=function(p,h){if(typeof p=="string")if(h){var x=d(h.as,h.crossOrigin);i.d.m(p,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else i.d.m(p)},In.requestFormReset=function(p){i.d.r(p)},In.unstable_batchedUpdates=function(p,h){return p(h)},In.useFormState=function(p,h,x){return c.H.useFormState(p,h,x)},In.useFormStatus=function(){return c.H.useHostTransitionStatus()},In.version="19.2.4",In}var l1;function yk(){if(l1)return og.exports;l1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),og.exports=xk(),og.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c1;function vk(){if(c1)return Bc;c1=1;var n=gk(),e=v0(),t=yk();function i(s){var a="https://react.dev/errors/"+s;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function l(s){var a=s,u=s;if(s.alternate)for(;a.return;)a=a.return;else{s=a;do a=s,(a.flags&4098)!==0&&(u=a.return),s=a.return;while(s)}return a.tag===3?u:null}function c(s){if(s.tag===13){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function d(s){if(s.tag===31){var a=s.memoizedState;if(a===null&&(s=s.alternate,s!==null&&(a=s.memoizedState)),a!==null)return a.dehydrated}return null}function p(s){if(l(s)!==s)throw Error(i(188))}function h(s){var a=s.alternate;if(!a){if(a=l(s),a===null)throw Error(i(188));return a!==s?null:s}for(var u=s,f=a;;){var v=u.return;if(v===null)break;var _=v.alternate;if(_===null){if(f=v.return,f!==null){u=f;continue}break}if(v.child===_.child){for(_=v.child;_;){if(_===u)return p(v),s;if(_===f)return p(v),a;_=_.sibling}throw Error(i(188))}if(u.return!==f.return)u=v,f=_;else{for(var N=!1,V=v.child;V;){if(V===u){N=!0,u=v,f=_;break}if(V===f){N=!0,f=v,u=_;break}V=V.sibling}if(!N){for(V=_.child;V;){if(V===u){N=!0,u=_,f=v;break}if(V===f){N=!0,f=_,u=v;break}V=V.sibling}if(!N)throw Error(i(189))}}if(u.alternate!==f)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?s:a}function x(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s;for(s=s.child;s!==null;){if(a=x(s),a!==null)return a;s=s.sibling}return null}var b=Object.assign,T=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),$=Symbol.for("react.consumer"),M=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),C=Symbol.for("react.lazy"),A=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function O(s){return s===null||typeof s!="object"?null:(s=L&&s[L]||s["@@iterator"],typeof s=="function"?s:null)}var j=Symbol.for("react.client.reference");function q(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===j?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case D:return"Fragment";case F:return"Profiler";case k:return"StrictMode";case H:return"Suspense";case z:return"SuspenseList";case A:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case E:return"Portal";case M:return s.displayName||"Context";case $:return(s._context.displayName||"Context")+".Consumer";case J:var a=s.render;return s=s.displayName,s||(s=a.displayName||a.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case R:return a=s.displayName||null,a!==null?a:q(s.type)||"Memo";case C:a=s._payload,s=s._init;try{return q(s(a))}catch{}}return null}var le=Array.isArray,U=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X={pending:!1,data:null,method:null,action:null},ie=[],pe=-1;function B(s){return{current:s}}function ee(s){0>pe||(s.current=ie[pe],ie[pe]=null,pe--)}function he(s,a){pe++,ie[pe]=s.current,s.current=a}var Q=B(null),ae=B(null),ye=B(null),ue=B(null);function Te(s,a){switch(he(ye,a),he(ae,s),he(Q,null),a.nodeType){case 9:case 11:s=(s=a.documentElement)&&(s=s.namespaceURI)?wb(s):0;break;default:if(s=a.tagName,a=a.namespaceURI)a=wb(a),s=Eb(a,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ee(Q),he(Q,s)}function Ae(){ee(Q),ee(ae),ee(ye)}function Be(s){s.memoizedState!==null&&he(ue,s);var a=Q.current,u=Eb(a,s.type);a!==u&&(he(ae,s),he(Q,u))}function jt(s){ae.current===s&&(ee(Q),ee(ae)),ue.current===s&&(ee(ue),Vc._currentValue=X)}var Dt,An;function mt(s){if(Dt===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);Dt=a&&a[1]||"",An=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Dt+s+An}var we=!1;function Ee(s,a){if(!s||we)return"";we=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(a){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(fe){var ce=fe}Reflect.construct(s,[],xe)}else{try{xe.call()}catch(fe){ce=fe}s.call(xe.prototype)}}else{try{throw Error()}catch(fe){ce=fe}(xe=s())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(fe){if(fe&&ce&&typeof fe.stack=="string")return[fe.stack,ce.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var v=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");v&&v.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=f.DetermineComponentFrameRoot(),N=_[0],V=_[1];if(N&&V){var W=N.split(`
`),oe=V.split(`
`);for(v=f=0;f<W.length&&!W[f].includes("DetermineComponentFrameRoot");)f++;for(;v<oe.length&&!oe[v].includes("DetermineComponentFrameRoot");)v++;if(f===W.length||v===oe.length)for(f=W.length-1,v=oe.length-1;1<=f&&0<=v&&W[f]!==oe[v];)v--;for(;1<=f&&0<=v;f--,v--)if(W[f]!==oe[v]){if(f!==1||v!==1)do if(f--,v--,0>v||W[f]!==oe[v]){var me=`
`+W[f].replace(" at new "," at ");return s.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",s.displayName)),me}while(1<=f&&0<=v);break}}}finally{we=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?mt(u):""}function De(s,a){switch(s.tag){case 26:case 27:case 5:return mt(s.type);case 16:return mt("Lazy");case 13:return s.child!==a&&a!==null?mt("Suspense Fallback"):mt("Suspense");case 19:return mt("SuspenseList");case 0:case 15:return Ee(s.type,!1);case 11:return Ee(s.type.render,!1);case 1:return Ee(s.type,!0);case 31:return mt("Activity");default:return""}}function _e(s){try{var a="",u=null;do a+=De(s,u),u=s,s=s.return;while(s);return a}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var Pe=Object.prototype.hasOwnProperty,He=n.unstable_scheduleCallback,At=n.unstable_cancelCallback,xo=n.unstable_shouldYield,Ou=n.unstable_requestPaint,Ln=n.unstable_now,yo=n.unstable_getCurrentPriorityLevel,Fl=n.unstable_ImmediatePriority,Gl=n.unstable_UserBlockingPriority,gr=n.unstable_NormalPriority,sp=n.unstable_LowPriority,Uu=n.unstable_IdlePriority,Vu=n.log,zu=n.unstable_setDisableYieldValue,Pi=null,yn=null;function xi(s){if(typeof Vu=="function"&&zu(s),yn&&typeof yn.setStrictMode=="function")try{yn.setStrictMode(Pi,s)}catch{}}var Vt=Math.clz32?Math.clz32:Fu,Hu=Math.log,pa=Math.LN2;function Fu(s){return s>>>=0,s===0?32:31-(Hu(s)/pa|0)|0}var os=256,vo=262144,qt=4194304;function as(s){var a=s&42;if(a!==0)return a;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function ls(s,a,u){var f=s.pendingLanes;if(f===0)return 0;var v=0,_=s.suspendedLanes,N=s.pingedLanes;s=s.warmLanes;var V=f&134217727;return V!==0?(f=V&~_,f!==0?v=as(f):(N&=V,N!==0?v=as(N):u||(u=V&~s,u!==0&&(v=as(u))))):(V=f&~_,V!==0?v=as(V):N!==0?v=as(N):u||(u=f&~s,u!==0&&(v=as(u)))),v===0?0:a!==0&&a!==v&&(a&_)===0&&(_=v&-v,u=a&-a,_>=u||_===32&&(u&4194048)!==0)?a:v}function Li(s,a){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&a)===0}function rp(s,a){switch(s){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gu(){var s=qt;return qt<<=1,(qt&62914560)===0&&(qt=4194304),s}function cs(s){for(var a=[],u=0;31>u;u++)a.push(s);return a}function bo(s,a){s.pendingLanes|=a,a!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function op(s,a,u,f,v,_){var N=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var V=s.entanglements,W=s.expirationTimes,oe=s.hiddenUpdates;for(u=N&~u;0<u;){var me=31-Vt(u),xe=1<<me;V[me]=0,W[me]=-1;var ce=oe[me];if(ce!==null)for(oe[me]=null,me=0;me<ce.length;me++){var fe=ce[me];fe!==null&&(fe.lane&=-536870913)}u&=~xe}f!==0&&_o(s,f,0),_!==0&&v===0&&s.tag!==0&&(s.suspendedLanes|=_&~(N&~a))}function _o(s,a,u){s.pendingLanes|=a,s.suspendedLanes&=~a;var f=31-Vt(a);s.entangledLanes|=a,s.entanglements[f]=s.entanglements[f]|1073741824|u&261930}function Bl(s,a){var u=s.entangledLanes|=a;for(s=s.entanglements;u;){var f=31-Vt(u),v=1<<f;v&a|s[f]&a&&(s[f]|=a),u&=~v}}function ql(s,a){var u=a&-a;return u=(u&42)!==0?1:To(u),(u&(s.suspendedLanes|a))!==0?0:u}function To(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Us(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Bu(){var s=Y.p;return s!==0?s:(s=window.event,s===void 0?32:Jb(s.type))}function Oi(s,a){var u=Y.p;try{return Y.p=s,a()}finally{Y.p=u}}var Ui=Math.random().toString(36).slice(2),$t="__reactFiber$"+Ui,cn="__reactProps$"+Ui,us="__reactContainer$"+Ui,ma="__reactEvents$"+Ui,ap="__reactListeners$"+Ui,qu="__reactHandles$"+Ui,$u="__reactResources$"+Ui,ds="__reactMarker$"+Ui;function ga(s){delete s[$t],delete s[cn],delete s[ma],delete s[ap],delete s[qu]}function fs(s){var a=s[$t];if(a)return a;for(var u=s.parentNode;u;){if(a=u[us]||u[$t]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(s=jb(s);s!==null;){if(u=s[$t])return u;s=jb(s)}return a}s=u,u=s.parentNode}return null}function yi(s){if(s=s[$t]||s[us]){var a=s.tag;if(a===5||a===6||a===13||a===31||a===26||a===27||a===3)return s}return null}function ti(s){var a=s.tag;if(a===5||a===26||a===27||a===6)return s.stateNode;throw Error(i(33))}function hs(s){var a=s[$u];return a||(a=s[$u]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function Yt(s){s[ds]=!0}var $l=new Set,Yl={};function ps(s,a){ms(s,a),ms(s+"Capture",a)}function ms(s,a){for(Yl[s]=a,s=0;s<a.length;s++)$l.add(a[s])}var Jl=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Kl={},Xl={};function Yu(s){return Pe.call(Xl,s)?!0:Pe.call(Kl,s)?!1:Jl.test(s)?Xl[s]=!0:(Kl[s]=!0,!1)}function xa(s,a,u){if(Yu(a))if(u===null)s.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(a);return;case"boolean":var f=a.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(a);return}}s.setAttribute(a,""+u)}}function ni(s,a,u){if(u===null)s.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(a);return}s.setAttribute(a,""+u)}}function Jt(s,a,u,f){if(f===null)s.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(a,u,""+f)}}function un(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function xr(s){var a=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function Wl(s,a,u){var f=Object.getOwnPropertyDescriptor(s.constructor.prototype,a);if(!s.hasOwnProperty(a)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var v=f.get,_=f.set;return Object.defineProperty(s,a,{configurable:!0,get:function(){return v.call(this)},set:function(N){u=""+N,_.call(this,N)}}),Object.defineProperty(s,a,{enumerable:f.enumerable}),{getValue:function(){return u},setValue:function(N){u=""+N},stopTracking:function(){s._valueTracker=null,delete s[a]}}}}function yt(s){if(!s._valueTracker){var a=xr(s)?"checked":"value";s._valueTracker=Wl(s,a,""+s[a])}}function So(s){if(!s)return!1;var a=s._valueTracker;if(!a)return!0;var u=a.getValue(),f="";return s&&(f=xr(s)?s.checked?"true":"false":s.value),s=f,s!==u?(a.setValue(s),!0):!1}function gs(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var wo=/[\n"\\]/g;function Fn(s){return s.replace(wo,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function ya(s,a,u,f,v,_,N,V){s.name="",N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?s.type=N:s.removeAttribute("type"),a!=null?N==="number"?(a===0&&s.value===""||s.value!=a)&&(s.value=""+un(a)):s.value!==""+un(a)&&(s.value=""+un(a)):N!=="submit"&&N!=="reset"||s.removeAttribute("value"),a!=null?Ql(s,N,un(a)):u!=null?Ql(s,N,un(u)):f!=null&&s.removeAttribute("value"),v==null&&_!=null&&(s.defaultChecked=!!_),v!=null&&(s.checked=v&&typeof v!="function"&&typeof v!="symbol"),V!=null&&typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"?s.name=""+un(V):s.removeAttribute("name")}function Ju(s,a,u,f,v,_,N,V){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(s.type=_),a!=null||u!=null){if(!(_!=="submit"&&_!=="reset"||a!=null)){yt(s);return}u=u!=null?""+un(u):"",a=a!=null?""+un(a):u,V||a===s.value||(s.value=a),s.defaultValue=a}f=f??v,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=V?s.checked:!!f,s.defaultChecked=!!f,N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"&&(s.name=N),yt(s)}function Ql(s,a,u){a==="number"&&gs(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function yr(s,a,u,f){if(s=s.options,a){a={};for(var v=0;v<u.length;v++)a["$"+u[v]]=!0;for(u=0;u<s.length;u++)v=a.hasOwnProperty("$"+s[u].value),s[u].selected!==v&&(s[u].selected=v),v&&f&&(s[u].defaultSelected=!0)}else{for(u=""+un(u),a=null,v=0;v<s.length;v++){if(s[v].value===u){s[v].selected=!0,f&&(s[v].defaultSelected=!0);return}a!==null||s[v].disabled||(a=s[v])}a!==null&&(a.selected=!0)}}function Ku(s,a,u){if(a!=null&&(a=""+un(a),a!==s.value&&(s.value=a),u==null)){s.defaultValue!==a&&(s.defaultValue=a);return}s.defaultValue=u!=null?""+un(u):""}function vr(s,a,u,f){if(a==null){if(f!=null){if(u!=null)throw Error(i(92));if(le(f)){if(1<f.length)throw Error(i(93));f=f[0]}u=f}u==null&&(u=""),a=u}u=un(a),s.defaultValue=u,f=s.textContent,f===u&&f!==""&&f!==null&&(s.value=f),yt(s)}function Gn(s,a){if(a){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=a;return}}s.textContent=a}var Xu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zl(s,a,u){var f=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?f?s.setProperty(a,""):a==="float"?s.cssFloat="":s[a]="":f?s.setProperty(a,u):typeof u!="number"||u===0||Xu.has(a)?a==="float"?s.cssFloat=u:s[a]=(""+u).trim():s[a]=u+"px"}function ec(s,a,u){if(a!=null&&typeof a!="object")throw Error(i(62));if(s=s.style,u!=null){for(var f in u)!u.hasOwnProperty(f)||a!=null&&a.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var v in a)f=a[v],a.hasOwnProperty(v)&&u[v]!==f&&Zl(s,v,f)}else for(var _ in a)a.hasOwnProperty(_)&&Zl(s,_,a[_])}function va(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),br=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ba(s){return br.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Vi(){}var tc=null;function vi(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var _r=null,xs=null;function Eo(s){var a=yi(s);if(a&&(s=a.stateNode)){var u=s[cn]||null;e:switch(s=a.stateNode,a.type){case"input":if(ya(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+Fn(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var f=u[a];if(f!==s&&f.form===s.form){var v=f[cn]||null;if(!v)throw Error(i(90));ya(f,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name)}}for(a=0;a<u.length;a++)f=u[a],f.form===s.form&&So(f)}break e;case"textarea":Ku(s,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&yr(s,!!u.multiple,a,!1)}}}var _a=!1;function Tr(s,a,u){if(_a)return s(a,u);_a=!0;try{var f=s(a);return f}finally{if(_a=!1,(_r!==null||xs!==null)&&(Bd(),_r&&(a=_r,s=xs,xs=_r=null,Eo(a),s)))for(a=0;a<s.length;a++)Eo(s[a])}}function zi(s,a){var u=s.stateNode;if(u===null)return null;var f=u[cn]||null;if(f===null)return null;u=f[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(i(231,a,typeof u));return u}var bi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),No=!1;if(bi)try{var _t={};Object.defineProperty(_t,"passive",{get:function(){No=!0}}),window.addEventListener("test",_t,_t),window.removeEventListener("test",_t,_t)}catch{No=!1}var ys=null,nc=null,Co=null;function ic(){if(Co)return Co;var s,a=nc,u=a.length,f,v="value"in ys?ys.value:ys.textContent,_=v.length;for(s=0;s<u&&a[s]===v[s];s++);var N=u-s;for(f=1;f<=N&&a[u-f]===v[_-f];f++);return Co=v.slice(s,1<f?1-f:void 0)}function ko(s){var a=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&a===13&&(s=13)):s=a,s===10&&(s=13),32<=s||s===13?s:0}function Vs(){return!0}function Hi(){return!1}function vn(s){function a(u,f,v,_,N){this._reactName=u,this._targetInst=v,this.type=f,this.nativeEvent=_,this.target=N,this.currentTarget=null;for(var V in s)s.hasOwnProperty(V)&&(u=s[V],this[V]=u?u(_):_[V]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?Vs:Hi,this.isPropagationStopped=Hi,this}return b(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Vs)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Vs)},persist:function(){},isPersistent:Vs}),a}var zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vs=vn(zs),Sr=b({},zs,{view:0,detail:0}),sc=vn(Sr),wr,Ta,bs,Sa=b({},Sr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Er,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==bs&&(bs&&s.type==="mousemove"?(wr=s.screenX-bs.screenX,Ta=s.screenY-bs.screenY):Ta=wr=0,bs=s),wr)},movementY:function(s){return"movementY"in s?s.movementY:Ta}}),rc=vn(Sa),Ao=b({},Sa,{dataTransfer:0}),Qu=vn(Ao),Zu=b({},Sr,{relatedTarget:0}),Io=vn(Zu),oc=b({},zs,{animationName:0,elapsedTime:0,pseudoElement:0}),ed=vn(oc),wa=b({},zs,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),td=vn(wa),nd=b({},zs,{data:0}),_s=vn(nd),id={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sd={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rd={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function od(s){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(s):(s=rd[s])?!!a[s]:!1}function Er(){return od}var On=b({},Sr,{key:function(s){if(s.key){var a=id[s.key]||s.key;if(a!=="Unidentified")return a}return s.type==="keypress"?(s=ko(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?sd[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Er,charCode:function(s){return s.type==="keypress"?ko(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ko(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),ad=vn(On),ld=b({},Sa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Hs=vn(ld),y=b({},Sr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Er}),w=vn(y),I=b({},zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),G=vn(I),se=b({},Sa,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),de=vn(se),Ne=b({},zs,{newState:0,oldState:0}),Ke=vn(Ne),zt=[9,13,27,32],ht=bi&&"CompositionEvent"in window,It=null;bi&&"documentMode"in document&&(It=document.documentMode);var _i=bi&&"TextEvent"in window&&!It,Ts=bi&&(!ht||It&&8<It&&11>=It),Fi=" ",Gi=!1;function Ro(s,a){switch(s){case"keyup":return zt.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ea(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Na=!1;function P2(s,a){switch(s){case"compositionend":return Ea(a);case"keypress":return a.which!==32?null:(Gi=!0,Fi);case"textInput":return s=a.data,s===Fi&&Gi?null:s;default:return null}}function L2(s,a){if(Na)return s==="compositionend"||!ht&&Ro(s,a)?(s=ic(),Co=nc=ys=null,Na=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return Ts&&a.locale!=="ko"?null:a.data;default:return null}}var O2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Px(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a==="input"?!!O2[s.type]:a==="textarea"}function Lx(s,a,u,f){_r?xs?xs.push(f):xs=[f]:_r=f,a=Wd(a,"onChange"),0<a.length&&(u=new vs("onChange","change",null,u,f),s.push({event:u,listeners:a}))}var ac=null,lc=null;function U2(s){yb(s,0)}function cd(s){var a=ti(s);if(So(a))return s}function Ox(s,a){if(s==="change")return a}var Ux=!1;if(bi){var lp;if(bi){var cp="oninput"in document;if(!cp){var Vx=document.createElement("div");Vx.setAttribute("oninput","return;"),cp=typeof Vx.oninput=="function"}lp=cp}else lp=!1;Ux=lp&&(!document.documentMode||9<document.documentMode)}function zx(){ac&&(ac.detachEvent("onpropertychange",Hx),lc=ac=null)}function Hx(s){if(s.propertyName==="value"&&cd(lc)){var a=[];Lx(a,lc,s,vi(s)),Tr(U2,a)}}function V2(s,a,u){s==="focusin"?(zx(),ac=a,lc=u,ac.attachEvent("onpropertychange",Hx)):s==="focusout"&&zx()}function z2(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return cd(lc)}function H2(s,a){if(s==="click")return cd(a)}function F2(s,a){if(s==="input"||s==="change")return cd(a)}function G2(s,a){return s===a&&(s!==0||1/s===1/a)||s!==s&&a!==a}var ii=typeof Object.is=="function"?Object.is:G2;function cc(s,a){if(ii(s,a))return!0;if(typeof s!="object"||s===null||typeof a!="object"||a===null)return!1;var u=Object.keys(s),f=Object.keys(a);if(u.length!==f.length)return!1;for(f=0;f<u.length;f++){var v=u[f];if(!Pe.call(a,v)||!ii(s[v],a[v]))return!1}return!0}function Fx(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Gx(s,a){var u=Fx(s);s=0;for(var f;u;){if(u.nodeType===3){if(f=s+u.textContent.length,s<=a&&f>=a)return{node:u,offset:a-s};s=f}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Fx(u)}}function Bx(s,a){return s&&a?s===a?!0:s&&s.nodeType===3?!1:a&&a.nodeType===3?Bx(s,a.parentNode):"contains"in s?s.contains(a):s.compareDocumentPosition?!!(s.compareDocumentPosition(a)&16):!1:!1}function qx(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var a=gs(s.document);a instanceof s.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)s=a.contentWindow;else break;a=gs(s.document)}return a}function up(s){var a=s&&s.nodeName&&s.nodeName.toLowerCase();return a&&(a==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||a==="textarea"||s.contentEditable==="true")}var B2=bi&&"documentMode"in document&&11>=document.documentMode,Ca=null,dp=null,uc=null,fp=!1;function $x(s,a,u){var f=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;fp||Ca==null||Ca!==gs(f)||(f=Ca,"selectionStart"in f&&up(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),uc&&cc(uc,f)||(uc=f,f=Wd(dp,"onSelect"),0<f.length&&(a=new vs("onSelect","select",null,a,u),s.push({event:a,listeners:f}),a.target=Ca)))}function jo(s,a){var u={};return u[s.toLowerCase()]=a.toLowerCase(),u["Webkit"+s]="webkit"+a,u["Moz"+s]="moz"+a,u}var ka={animationend:jo("Animation","AnimationEnd"),animationiteration:jo("Animation","AnimationIteration"),animationstart:jo("Animation","AnimationStart"),transitionrun:jo("Transition","TransitionRun"),transitionstart:jo("Transition","TransitionStart"),transitioncancel:jo("Transition","TransitionCancel"),transitionend:jo("Transition","TransitionEnd")},hp={},Yx={};bi&&(Yx=document.createElement("div").style,"AnimationEvent"in window||(delete ka.animationend.animation,delete ka.animationiteration.animation,delete ka.animationstart.animation),"TransitionEvent"in window||delete ka.transitionend.transition);function Do(s){if(hp[s])return hp[s];if(!ka[s])return s;var a=ka[s],u;for(u in a)if(a.hasOwnProperty(u)&&u in Yx)return hp[s]=a[u];return s}var Jx=Do("animationend"),Kx=Do("animationiteration"),Xx=Do("animationstart"),q2=Do("transitionrun"),$2=Do("transitionstart"),Y2=Do("transitioncancel"),Wx=Do("transitionend"),Qx=new Map,pp="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pp.push("scrollEnd");function Bi(s,a){Qx.set(s,a),ps(a,[s])}var ud=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Ti=[],Aa=0,mp=0;function dd(){for(var s=Aa,a=mp=Aa=0;a<s;){var u=Ti[a];Ti[a++]=null;var f=Ti[a];Ti[a++]=null;var v=Ti[a];Ti[a++]=null;var _=Ti[a];if(Ti[a++]=null,f!==null&&v!==null){var N=f.pending;N===null?v.next=v:(v.next=N.next,N.next=v),f.pending=v}_!==0&&Zx(u,v,_)}}function fd(s,a,u,f){Ti[Aa++]=s,Ti[Aa++]=a,Ti[Aa++]=u,Ti[Aa++]=f,mp|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function gp(s,a,u,f){return fd(s,a,u,f),hd(s)}function Mo(s,a){return fd(s,null,null,a),hd(s)}function Zx(s,a,u){s.lanes|=u;var f=s.alternate;f!==null&&(f.lanes|=u);for(var v=!1,_=s.return;_!==null;)_.childLanes|=u,f=_.alternate,f!==null&&(f.childLanes|=u),_.tag===22&&(s=_.stateNode,s===null||s._visibility&1||(v=!0)),s=_,_=_.return;return s.tag===3?(_=s.stateNode,v&&a!==null&&(v=31-Vt(u),s=_.hiddenUpdates,f=s[v],f===null?s[v]=[a]:f.push(a),a.lane=u|536870912),_):null}function hd(s){if(50<jc)throw jc=0,Em=null,Error(i(185));for(var a=s.return;a!==null;)s=a,a=s.return;return s.tag===3?s.stateNode:null}var Ia={};function J2(s,a,u,f){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function si(s,a,u,f){return new J2(s,a,u,f)}function xp(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Fs(s,a){var u=s.alternate;return u===null?(u=si(s.tag,a,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=a,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,a=s.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function ey(s,a){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=a,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,a=u.dependencies,s.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),s}function pd(s,a,u,f,v,_){var N=0;if(f=s,typeof s=="function")xp(s)&&(N=1);else if(typeof s=="string")N=ZC(s,u,Q.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case A:return s=si(31,u,a,v),s.elementType=A,s.lanes=_,s;case D:return Po(u.children,v,_,a);case k:N=8,v|=24;break;case F:return s=si(12,u,a,v|2),s.elementType=F,s.lanes=_,s;case H:return s=si(13,u,a,v),s.elementType=H,s.lanes=_,s;case z:return s=si(19,u,a,v),s.elementType=z,s.lanes=_,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case M:N=10;break e;case $:N=9;break e;case J:N=11;break e;case R:N=14;break e;case C:N=16,f=null;break e}N=29,u=Error(i(130,s===null?"null":typeof s,"")),f=null}return a=si(N,u,a,v),a.elementType=s,a.type=f,a.lanes=_,a}function Po(s,a,u,f){return s=si(7,s,f,a),s.lanes=u,s}function yp(s,a,u){return s=si(6,s,null,a),s.lanes=u,s}function ty(s){var a=si(18,null,null,0);return a.stateNode=s,a}function vp(s,a,u){return a=si(4,s.children!==null?s.children:[],s.key,a),a.lanes=u,a.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},a}var ny=new WeakMap;function Si(s,a){if(typeof s=="object"&&s!==null){var u=ny.get(s);return u!==void 0?u:(a={value:s,source:a,stack:_e(a)},ny.set(s,a),a)}return{value:s,source:a,stack:_e(a)}}var Ra=[],ja=0,md=null,dc=0,wi=[],Ei=0,Nr=null,Ss=1,ws="";function Gs(s,a){Ra[ja++]=dc,Ra[ja++]=md,md=s,dc=a}function iy(s,a,u){wi[Ei++]=Ss,wi[Ei++]=ws,wi[Ei++]=Nr,Nr=s;var f=Ss;s=ws;var v=32-Vt(f)-1;f&=~(1<<v),u+=1;var _=32-Vt(a)+v;if(30<_){var N=v-v%5;_=(f&(1<<N)-1).toString(32),f>>=N,v-=N,Ss=1<<32-Vt(a)+v|u<<v|f,ws=_+s}else Ss=1<<_|u<<v|f,ws=s}function bp(s){s.return!==null&&(Gs(s,1),iy(s,1,0))}function _p(s){for(;s===md;)md=Ra[--ja],Ra[ja]=null,dc=Ra[--ja],Ra[ja]=null;for(;s===Nr;)Nr=wi[--Ei],wi[Ei]=null,ws=wi[--Ei],wi[Ei]=null,Ss=wi[--Ei],wi[Ei]=null}function sy(s,a){wi[Ei++]=Ss,wi[Ei++]=ws,wi[Ei++]=Nr,Ss=a.id,ws=a.overflow,Nr=s}var bn=null,Nt=null,ot=!1,Cr=null,Ni=!1,Tp=Error(i(519));function kr(s){var a=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw fc(Si(a,s)),Tp}function ry(s){var a=s.stateNode,u=s.type,f=s.memoizedProps;switch(a[$t]=s,a[cn]=f,u){case"dialog":Ze("cancel",a),Ze("close",a);break;case"iframe":case"object":case"embed":Ze("load",a);break;case"video":case"audio":for(u=0;u<Mc.length;u++)Ze(Mc[u],a);break;case"source":Ze("error",a);break;case"img":case"image":case"link":Ze("error",a),Ze("load",a);break;case"details":Ze("toggle",a);break;case"input":Ze("invalid",a),Ju(a,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ze("invalid",a);break;case"textarea":Ze("invalid",a),vr(a,f.value,f.defaultValue,f.children)}u=f.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||f.suppressHydrationWarning===!0||Tb(a.textContent,u)?(f.popover!=null&&(Ze("beforetoggle",a),Ze("toggle",a)),f.onScroll!=null&&Ze("scroll",a),f.onScrollEnd!=null&&Ze("scrollend",a),f.onClick!=null&&(a.onclick=Vi),a=!0):a=!1,a||kr(s,!0)}function oy(s){for(bn=s.return;bn;)switch(bn.tag){case 5:case 31:case 13:Ni=!1;return;case 27:case 3:Ni=!0;return;default:bn=bn.return}}function Da(s){if(s!==bn)return!1;if(!ot)return oy(s),ot=!0,!1;var a=s.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||zm(s.type,s.memoizedProps)),u=!u),u&&Nt&&kr(s),oy(s),a===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Nt=Rb(s)}else if(a===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Nt=Rb(s)}else a===27?(a=Nt,Fr(s.type)?(s=qm,qm=null,Nt=s):Nt=a):Nt=bn?ki(s.stateNode.nextSibling):null;return!0}function Lo(){Nt=bn=null,ot=!1}function Sp(){var s=Cr;return s!==null&&(Yn===null?Yn=s:Yn.push.apply(Yn,s),Cr=null),s}function fc(s){Cr===null?Cr=[s]:Cr.push(s)}var wp=B(null),Oo=null,Bs=null;function Ar(s,a,u){he(wp,a._currentValue),a._currentValue=u}function qs(s){s._currentValue=wp.current,ee(wp)}function Ep(s,a,u){for(;s!==null;){var f=s.alternate;if((s.childLanes&a)!==a?(s.childLanes|=a,f!==null&&(f.childLanes|=a)):f!==null&&(f.childLanes&a)!==a&&(f.childLanes|=a),s===u)break;s=s.return}}function Np(s,a,u,f){var v=s.child;for(v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){var N=v.child;_=_.firstContext;e:for(;_!==null;){var V=_;_=v;for(var W=0;W<a.length;W++)if(V.context===a[W]){_.lanes|=u,V=_.alternate,V!==null&&(V.lanes|=u),Ep(_.return,u,s),f||(N=null);break e}_=V.next}}else if(v.tag===18){if(N=v.return,N===null)throw Error(i(341));N.lanes|=u,_=N.alternate,_!==null&&(_.lanes|=u),Ep(N,u,s),N=null}else N=v.child;if(N!==null)N.return=v;else for(N=v;N!==null;){if(N===s){N=null;break}if(v=N.sibling,v!==null){v.return=N.return,N=v;break}N=N.return}v=N}}function Ma(s,a,u,f){s=null;for(var v=a,_=!1;v!==null;){if(!_){if((v.flags&524288)!==0)_=!0;else if((v.flags&262144)!==0)break}if(v.tag===10){var N=v.alternate;if(N===null)throw Error(i(387));if(N=N.memoizedProps,N!==null){var V=v.type;ii(v.pendingProps.value,N.value)||(s!==null?s.push(V):s=[V])}}else if(v===ue.current){if(N=v.alternate,N===null)throw Error(i(387));N.memoizedState.memoizedState!==v.memoizedState.memoizedState&&(s!==null?s.push(Vc):s=[Vc])}v=v.return}s!==null&&Np(a,s,u,f),a.flags|=262144}function gd(s){for(s=s.firstContext;s!==null;){if(!ii(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Uo(s){Oo=s,Bs=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function _n(s){return ay(Oo,s)}function xd(s,a){return Oo===null&&Uo(s),ay(s,a)}function ay(s,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},Bs===null){if(s===null)throw Error(i(308));Bs=a,s.dependencies={lanes:0,firstContext:a},s.flags|=524288}else Bs=Bs.next=a;return u}var K2=typeof AbortController<"u"?AbortController:function(){var s=[],a=this.signal={aborted:!1,addEventListener:function(u,f){s.push(f)}};this.abort=function(){a.aborted=!0,s.forEach(function(u){return u()})}},X2=n.unstable_scheduleCallback,W2=n.unstable_NormalPriority,Kt={$$typeof:M,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Cp(){return{controller:new K2,data:new Map,refCount:0}}function hc(s){s.refCount--,s.refCount===0&&X2(W2,function(){s.controller.abort()})}var pc=null,kp=0,Pa=0,La=null;function Q2(s,a){if(pc===null){var u=pc=[];kp=0,Pa=Rm(),La={status:"pending",value:void 0,then:function(f){u.push(f)}}}return kp++,a.then(ly,ly),a}function ly(){if(--kp===0&&pc!==null){La!==null&&(La.status="fulfilled");var s=pc;pc=null,Pa=0,La=null;for(var a=0;a<s.length;a++)(0,s[a])()}}function Z2(s,a){var u=[],f={status:"pending",value:null,reason:null,then:function(v){u.push(v)}};return s.then(function(){f.status="fulfilled",f.value=a;for(var v=0;v<u.length;v++)(0,u[v])(a)},function(v){for(f.status="rejected",f.reason=v,v=0;v<u.length;v++)(0,u[v])(void 0)}),f}var cy=U.S;U.S=function(s,a){$v=Ln(),typeof a=="object"&&a!==null&&typeof a.then=="function"&&Q2(s,a),cy!==null&&cy(s,a)};var Vo=B(null);function Ap(){var s=Vo.current;return s!==null?s:Et.pooledCache}function yd(s,a){a===null?he(Vo,Vo.current):he(Vo,a.pool)}function uy(){var s=Ap();return s===null?null:{parent:Kt._currentValue,pool:s}}var Oa=Error(i(460)),Ip=Error(i(474)),vd=Error(i(542)),bd={then:function(){}};function dy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function fy(s,a,u){switch(u=s[u],u===void 0?s.push(a):u!==a&&(a.then(Vi,Vi),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,py(s),s;default:if(typeof a.status=="string")a.then(Vi,Vi);else{if(s=Et,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=a,s.status="pending",s.then(function(f){if(a.status==="pending"){var v=a;v.status="fulfilled",v.value=f}},function(f){if(a.status==="pending"){var v=a;v.status="rejected",v.reason=f}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw s=a.reason,py(s),s}throw Ho=a,Oa}}function zo(s){try{var a=s._init;return a(s._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(Ho=u,Oa):u}}var Ho=null;function hy(){if(Ho===null)throw Error(i(459));var s=Ho;return Ho=null,s}function py(s){if(s===Oa||s===vd)throw Error(i(483))}var Ua=null,mc=0;function _d(s){var a=mc;return mc+=1,Ua===null&&(Ua=[]),fy(Ua,s,a)}function gc(s,a){a=a.props.ref,s.ref=a!==void 0?a:null}function Td(s,a){throw a.$$typeof===T?Error(i(525)):(s=Object.prototype.toString.call(a),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":s)))}function my(s){function a(ne,Z){if(s){var re=ne.deletions;re===null?(ne.deletions=[Z],ne.flags|=16):re.push(Z)}}function u(ne,Z){if(!s)return null;for(;Z!==null;)a(ne,Z),Z=Z.sibling;return null}function f(ne){for(var Z=new Map;ne!==null;)ne.key!==null?Z.set(ne.key,ne):Z.set(ne.index,ne),ne=ne.sibling;return Z}function v(ne,Z){return ne=Fs(ne,Z),ne.index=0,ne.sibling=null,ne}function _(ne,Z,re){return ne.index=re,s?(re=ne.alternate,re!==null?(re=re.index,re<Z?(ne.flags|=67108866,Z):re):(ne.flags|=67108866,Z)):(ne.flags|=1048576,Z)}function N(ne){return s&&ne.alternate===null&&(ne.flags|=67108866),ne}function V(ne,Z,re,ge){return Z===null||Z.tag!==6?(Z=yp(re,ne.mode,ge),Z.return=ne,Z):(Z=v(Z,re),Z.return=ne,Z)}function W(ne,Z,re,ge){var Le=re.type;return Le===D?me(ne,Z,re.props.children,ge,re.key):Z!==null&&(Z.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===C&&zo(Le)===Z.type)?(Z=v(Z,re.props),gc(Z,re),Z.return=ne,Z):(Z=pd(re.type,re.key,re.props,null,ne.mode,ge),gc(Z,re),Z.return=ne,Z)}function oe(ne,Z,re,ge){return Z===null||Z.tag!==4||Z.stateNode.containerInfo!==re.containerInfo||Z.stateNode.implementation!==re.implementation?(Z=vp(re,ne.mode,ge),Z.return=ne,Z):(Z=v(Z,re.children||[]),Z.return=ne,Z)}function me(ne,Z,re,ge,Le){return Z===null||Z.tag!==7?(Z=Po(re,ne.mode,ge,Le),Z.return=ne,Z):(Z=v(Z,re),Z.return=ne,Z)}function xe(ne,Z,re){if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Z=yp(""+Z,ne.mode,re),Z.return=ne,Z;if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case S:return re=pd(Z.type,Z.key,Z.props,null,ne.mode,re),gc(re,Z),re.return=ne,re;case E:return Z=vp(Z,ne.mode,re),Z.return=ne,Z;case C:return Z=zo(Z),xe(ne,Z,re)}if(le(Z)||O(Z))return Z=Po(Z,ne.mode,re,null),Z.return=ne,Z;if(typeof Z.then=="function")return xe(ne,_d(Z),re);if(Z.$$typeof===M)return xe(ne,xd(ne,Z),re);Td(ne,Z)}return null}function ce(ne,Z,re,ge){var Le=Z!==null?Z.key:null;if(typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint")return Le!==null?null:V(ne,Z,""+re,ge);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case S:return re.key===Le?W(ne,Z,re,ge):null;case E:return re.key===Le?oe(ne,Z,re,ge):null;case C:return re=zo(re),ce(ne,Z,re,ge)}if(le(re)||O(re))return Le!==null?null:me(ne,Z,re,ge,null);if(typeof re.then=="function")return ce(ne,Z,_d(re),ge);if(re.$$typeof===M)return ce(ne,Z,xd(ne,re),ge);Td(ne,re)}return null}function fe(ne,Z,re,ge,Le){if(typeof ge=="string"&&ge!==""||typeof ge=="number"||typeof ge=="bigint")return ne=ne.get(re)||null,V(Z,ne,""+ge,Le);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case S:return ne=ne.get(ge.key===null?re:ge.key)||null,W(Z,ne,ge,Le);case E:return ne=ne.get(ge.key===null?re:ge.key)||null,oe(Z,ne,ge,Le);case C:return ge=zo(ge),fe(ne,Z,re,ge,Le)}if(le(ge)||O(ge))return ne=ne.get(re)||null,me(Z,ne,ge,Le,null);if(typeof ge.then=="function")return fe(ne,Z,re,_d(ge),Le);if(ge.$$typeof===M)return fe(ne,Z,re,xd(Z,ge),Le);Td(Z,ge)}return null}function Re(ne,Z,re,ge){for(var Le=null,lt=null,je=Z,We=Z=0,nt=null;je!==null&&We<re.length;We++){je.index>We?(nt=je,je=null):nt=je.sibling;var ct=ce(ne,je,re[We],ge);if(ct===null){je===null&&(je=nt);break}s&&je&&ct.alternate===null&&a(ne,je),Z=_(ct,Z,We),lt===null?Le=ct:lt.sibling=ct,lt=ct,je=nt}if(We===re.length)return u(ne,je),ot&&Gs(ne,We),Le;if(je===null){for(;We<re.length;We++)je=xe(ne,re[We],ge),je!==null&&(Z=_(je,Z,We),lt===null?Le=je:lt.sibling=je,lt=je);return ot&&Gs(ne,We),Le}for(je=f(je);We<re.length;We++)nt=fe(je,ne,We,re[We],ge),nt!==null&&(s&&nt.alternate!==null&&je.delete(nt.key===null?We:nt.key),Z=_(nt,Z,We),lt===null?Le=nt:lt.sibling=nt,lt=nt);return s&&je.forEach(function(Yr){return a(ne,Yr)}),ot&&Gs(ne,We),Le}function Ue(ne,Z,re,ge){if(re==null)throw Error(i(151));for(var Le=null,lt=null,je=Z,We=Z=0,nt=null,ct=re.next();je!==null&&!ct.done;We++,ct=re.next()){je.index>We?(nt=je,je=null):nt=je.sibling;var Yr=ce(ne,je,ct.value,ge);if(Yr===null){je===null&&(je=nt);break}s&&je&&Yr.alternate===null&&a(ne,je),Z=_(Yr,Z,We),lt===null?Le=Yr:lt.sibling=Yr,lt=Yr,je=nt}if(ct.done)return u(ne,je),ot&&Gs(ne,We),Le;if(je===null){for(;!ct.done;We++,ct=re.next())ct=xe(ne,ct.value,ge),ct!==null&&(Z=_(ct,Z,We),lt===null?Le=ct:lt.sibling=ct,lt=ct);return ot&&Gs(ne,We),Le}for(je=f(je);!ct.done;We++,ct=re.next())ct=fe(je,ne,We,ct.value,ge),ct!==null&&(s&&ct.alternate!==null&&je.delete(ct.key===null?We:ct.key),Z=_(ct,Z,We),lt===null?Le=ct:lt.sibling=ct,lt=ct);return s&&je.forEach(function(uk){return a(ne,uk)}),ot&&Gs(ne,We),Le}function wt(ne,Z,re,ge){if(typeof re=="object"&&re!==null&&re.type===D&&re.key===null&&(re=re.props.children),typeof re=="object"&&re!==null){switch(re.$$typeof){case S:e:{for(var Le=re.key;Z!==null;){if(Z.key===Le){if(Le=re.type,Le===D){if(Z.tag===7){u(ne,Z.sibling),ge=v(Z,re.props.children),ge.return=ne,ne=ge;break e}}else if(Z.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===C&&zo(Le)===Z.type){u(ne,Z.sibling),ge=v(Z,re.props),gc(ge,re),ge.return=ne,ne=ge;break e}u(ne,Z);break}else a(ne,Z);Z=Z.sibling}re.type===D?(ge=Po(re.props.children,ne.mode,ge,re.key),ge.return=ne,ne=ge):(ge=pd(re.type,re.key,re.props,null,ne.mode,ge),gc(ge,re),ge.return=ne,ne=ge)}return N(ne);case E:e:{for(Le=re.key;Z!==null;){if(Z.key===Le)if(Z.tag===4&&Z.stateNode.containerInfo===re.containerInfo&&Z.stateNode.implementation===re.implementation){u(ne,Z.sibling),ge=v(Z,re.children||[]),ge.return=ne,ne=ge;break e}else{u(ne,Z);break}else a(ne,Z);Z=Z.sibling}ge=vp(re,ne.mode,ge),ge.return=ne,ne=ge}return N(ne);case C:return re=zo(re),wt(ne,Z,re,ge)}if(le(re))return Re(ne,Z,re,ge);if(O(re)){if(Le=O(re),typeof Le!="function")throw Error(i(150));return re=Le.call(re),Ue(ne,Z,re,ge)}if(typeof re.then=="function")return wt(ne,Z,_d(re),ge);if(re.$$typeof===M)return wt(ne,Z,xd(ne,re),ge);Td(ne,re)}return typeof re=="string"&&re!==""||typeof re=="number"||typeof re=="bigint"?(re=""+re,Z!==null&&Z.tag===6?(u(ne,Z.sibling),ge=v(Z,re),ge.return=ne,ne=ge):(u(ne,Z),ge=yp(re,ne.mode,ge),ge.return=ne,ne=ge),N(ne)):u(ne,Z)}return function(ne,Z,re,ge){try{mc=0;var Le=wt(ne,Z,re,ge);return Ua=null,Le}catch(je){if(je===Oa||je===vd)throw je;var lt=si(29,je,null,ne.mode);return lt.lanes=ge,lt.return=ne,lt}finally{}}}var Fo=my(!0),gy=my(!1),Ir=!1;function Rp(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jp(s,a){s=s.updateQueue,a.updateQueue===s&&(a.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Rr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function jr(s,a,u){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(pt&2)!==0){var v=f.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),f.pending=a,a=hd(s),Zx(s,null,u),a}return fd(s,f,a,u),hd(s)}function xc(s,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var f=a.lanes;f&=s.pendingLanes,u|=f,a.lanes=u,Bl(s,u)}}function Dp(s,a){var u=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,u===f)){var v=null,_=null;if(u=u.firstBaseUpdate,u!==null){do{var N={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};_===null?v=_=N:_=_.next=N,u=u.next}while(u!==null);_===null?v=_=a:_=_.next=a}else v=_=a;u={baseState:f.baseState,firstBaseUpdate:v,lastBaseUpdate:_,shared:f.shared,callbacks:f.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=a:s.next=a,u.lastBaseUpdate=a}var Mp=!1;function yc(){if(Mp){var s=La;if(s!==null)throw s}}function vc(s,a,u,f){Mp=!1;var v=s.updateQueue;Ir=!1;var _=v.firstBaseUpdate,N=v.lastBaseUpdate,V=v.shared.pending;if(V!==null){v.shared.pending=null;var W=V,oe=W.next;W.next=null,N===null?_=oe:N.next=oe,N=W;var me=s.alternate;me!==null&&(me=me.updateQueue,V=me.lastBaseUpdate,V!==N&&(V===null?me.firstBaseUpdate=oe:V.next=oe,me.lastBaseUpdate=W))}if(_!==null){var xe=v.baseState;N=0,me=oe=W=null,V=_;do{var ce=V.lane&-536870913,fe=ce!==V.lane;if(fe?(tt&ce)===ce:(f&ce)===ce){ce!==0&&ce===Pa&&(Mp=!0),me!==null&&(me=me.next={lane:0,tag:V.tag,payload:V.payload,callback:null,next:null});e:{var Re=s,Ue=V;ce=a;var wt=u;switch(Ue.tag){case 1:if(Re=Ue.payload,typeof Re=="function"){xe=Re.call(wt,xe,ce);break e}xe=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Ue.payload,ce=typeof Re=="function"?Re.call(wt,xe,ce):Re,ce==null)break e;xe=b({},xe,ce);break e;case 2:Ir=!0}}ce=V.callback,ce!==null&&(s.flags|=64,fe&&(s.flags|=8192),fe=v.callbacks,fe===null?v.callbacks=[ce]:fe.push(ce))}else fe={lane:ce,tag:V.tag,payload:V.payload,callback:V.callback,next:null},me===null?(oe=me=fe,W=xe):me=me.next=fe,N|=ce;if(V=V.next,V===null){if(V=v.shared.pending,V===null)break;fe=V,V=fe.next,fe.next=null,v.lastBaseUpdate=fe,v.shared.pending=null}}while(!0);me===null&&(W=xe),v.baseState=W,v.firstBaseUpdate=oe,v.lastBaseUpdate=me,_===null&&(v.shared.lanes=0),Or|=N,s.lanes=N,s.memoizedState=xe}}function xy(s,a){if(typeof s!="function")throw Error(i(191,s));s.call(a)}function yy(s,a){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)xy(u[s],a)}var Va=B(null),Sd=B(0);function vy(s,a){s=er,he(Sd,s),he(Va,a),er=s|a.baseLanes}function Pp(){he(Sd,er),he(Va,Va.current)}function Lp(){er=Sd.current,ee(Va),ee(Sd)}var ri=B(null),Ci=null;function Dr(s){var a=s.alternate;he(Ht,Ht.current&1),he(ri,s),Ci===null&&(a===null||Va.current!==null||a.memoizedState!==null)&&(Ci=s)}function Op(s){he(Ht,Ht.current),he(ri,s),Ci===null&&(Ci=s)}function by(s){s.tag===22?(he(Ht,Ht.current),he(ri,s),Ci===null&&(Ci=s)):Mr()}function Mr(){he(Ht,Ht.current),he(ri,ri.current)}function oi(s){ee(ri),Ci===s&&(Ci=null),ee(Ht)}var Ht=B(0);function wd(s){for(var a=s;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||Gm(u)||Bm(u)))return a}else if(a.tag===19&&(a.memoizedProps.revealOrder==="forwards"||a.memoizedProps.revealOrder==="backwards"||a.memoizedProps.revealOrder==="unstable_legacy-backwards"||a.memoizedProps.revealOrder==="together")){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var $s=0,Xe=null,Tt=null,Xt=null,Ed=!1,za=!1,Go=!1,Nd=0,bc=0,Ha=null,eC=0;function Ot(){throw Error(i(321))}function Up(s,a){if(a===null)return!1;for(var u=0;u<a.length&&u<s.length;u++)if(!ii(s[u],a[u]))return!1;return!0}function Vp(s,a,u,f,v,_){return $s=_,Xe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,U.H=s===null||s.memoizedState===null?iv:em,Go=!1,_=u(f,v),Go=!1,za&&(_=Ty(a,u,f,v)),_y(s),_}function _y(s){U.H=Sc;var a=Tt!==null&&Tt.next!==null;if($s=0,Xt=Tt=Xe=null,Ed=!1,bc=0,Ha=null,a)throw Error(i(300));s===null||Wt||(s=s.dependencies,s!==null&&gd(s)&&(Wt=!0))}function Ty(s,a,u,f){Xe=s;var v=0;do{if(za&&(Ha=null),bc=0,za=!1,25<=v)throw Error(i(301));if(v+=1,Xt=Tt=null,s.updateQueue!=null){var _=s.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}U.H=sv,_=a(u,f)}while(za);return _}function tC(){var s=U.H,a=s.useState()[0];return a=typeof a.then=="function"?_c(a):a,s=s.useState()[0],(Tt!==null?Tt.memoizedState:null)!==s&&(Xe.flags|=1024),a}function zp(){var s=Nd!==0;return Nd=0,s}function Hp(s,a,u){a.updateQueue=s.updateQueue,a.flags&=-2053,s.lanes&=~u}function Fp(s){if(Ed){for(s=s.memoizedState;s!==null;){var a=s.queue;a!==null&&(a.pending=null),s=s.next}Ed=!1}$s=0,Xt=Tt=Xe=null,za=!1,bc=Nd=0,Ha=null}function Un(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?Xe.memoizedState=Xt=s:Xt=Xt.next=s,Xt}function Ft(){if(Tt===null){var s=Xe.alternate;s=s!==null?s.memoizedState:null}else s=Tt.next;var a=Xt===null?Xe.memoizedState:Xt.next;if(a!==null)Xt=a,Tt=s;else{if(s===null)throw Xe.alternate===null?Error(i(467)):Error(i(310));Tt=s,s={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},Xt===null?Xe.memoizedState=Xt=s:Xt=Xt.next=s}return Xt}function Cd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _c(s){var a=bc;return bc+=1,Ha===null&&(Ha=[]),s=fy(Ha,s,a),a=Xe,(Xt===null?a.memoizedState:Xt.next)===null&&(a=a.alternate,U.H=a===null||a.memoizedState===null?iv:em),s}function kd(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return _c(s);if(s.$$typeof===M)return _n(s)}throw Error(i(438,String(s)))}function Gp(s){var a=null,u=Xe.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var f=Xe.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(a={data:f.data.map(function(v){return v.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=Cd(),Xe.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(s),f=0;f<s;f++)u[f]=P;return a.index++,u}function Ys(s,a){return typeof a=="function"?a(s):a}function Ad(s){var a=Ft();return Bp(a,Tt,s)}function Bp(s,a,u){var f=s.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=u;var v=s.baseQueue,_=f.pending;if(_!==null){if(v!==null){var N=v.next;v.next=_.next,_.next=N}a.baseQueue=v=_,f.pending=null}if(_=s.baseState,v===null)s.memoizedState=_;else{a=v.next;var V=N=null,W=null,oe=a,me=!1;do{var xe=oe.lane&-536870913;if(xe!==oe.lane?(tt&xe)===xe:($s&xe)===xe){var ce=oe.revertLane;if(ce===0)W!==null&&(W=W.next={lane:0,revertLane:0,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null}),xe===Pa&&(me=!0);else if(($s&ce)===ce){oe=oe.next,ce===Pa&&(me=!0);continue}else xe={lane:0,revertLane:oe.revertLane,gesture:null,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},W===null?(V=W=xe,N=_):W=W.next=xe,Xe.lanes|=ce,Or|=ce;xe=oe.action,Go&&u(_,xe),_=oe.hasEagerState?oe.eagerState:u(_,xe)}else ce={lane:xe,revertLane:oe.revertLane,gesture:oe.gesture,action:oe.action,hasEagerState:oe.hasEagerState,eagerState:oe.eagerState,next:null},W===null?(V=W=ce,N=_):W=W.next=ce,Xe.lanes|=xe,Or|=xe;oe=oe.next}while(oe!==null&&oe!==a);if(W===null?N=_:W.next=V,!ii(_,s.memoizedState)&&(Wt=!0,me&&(u=La,u!==null)))throw u;s.memoizedState=_,s.baseState=N,s.baseQueue=W,f.lastRenderedState=_}return v===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function qp(s){var a=Ft(),u=a.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=s;var f=u.dispatch,v=u.pending,_=a.memoizedState;if(v!==null){u.pending=null;var N=v=v.next;do _=s(_,N.action),N=N.next;while(N!==v);ii(_,a.memoizedState)||(Wt=!0),a.memoizedState=_,a.baseQueue===null&&(a.baseState=_),u.lastRenderedState=_}return[_,f]}function Sy(s,a,u){var f=Xe,v=Ft(),_=ot;if(_){if(u===void 0)throw Error(i(407));u=u()}else u=a();var N=!ii((Tt||v).memoizedState,u);if(N&&(v.memoizedState=u,Wt=!0),v=v.queue,Jp(Ny.bind(null,f,v,s),[s]),v.getSnapshot!==a||N||Xt!==null&&Xt.memoizedState.tag&1){if(f.flags|=2048,Fa(9,{destroy:void 0},Ey.bind(null,f,v,u,a),null),Et===null)throw Error(i(349));_||($s&127)!==0||wy(f,a,u)}return u}function wy(s,a,u){s.flags|=16384,s={getSnapshot:a,value:u},a=Xe.updateQueue,a===null?(a=Cd(),Xe.updateQueue=a,a.stores=[s]):(u=a.stores,u===null?a.stores=[s]:u.push(s))}function Ey(s,a,u,f){a.value=u,a.getSnapshot=f,Cy(a)&&ky(s)}function Ny(s,a,u){return u(function(){Cy(a)&&ky(s)})}function Cy(s){var a=s.getSnapshot;s=s.value;try{var u=a();return!ii(s,u)}catch{return!0}}function ky(s){var a=Mo(s,2);a!==null&&Jn(a,s,2)}function $p(s){var a=Un();if(typeof s=="function"){var u=s;if(s=u(),Go){xi(!0);try{u()}finally{xi(!1)}}}return a.memoizedState=a.baseState=s,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:s},a}function Ay(s,a,u,f){return s.baseState=u,Bp(s,Tt,typeof f=="function"?f:Ys)}function nC(s,a,u,f,v){if(jd(s))throw Error(i(485));if(s=a.action,s!==null){var _={payload:v,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(N){_.listeners.push(N)}};U.T!==null?u(!0):_.isTransition=!1,f(_),u=a.pending,u===null?(_.next=a.pending=_,Iy(a,_)):(_.next=u.next,a.pending=u.next=_)}}function Iy(s,a){var u=a.action,f=a.payload,v=s.state;if(a.isTransition){var _=U.T,N={};U.T=N;try{var V=u(v,f),W=U.S;W!==null&&W(N,V),Ry(s,a,V)}catch(oe){Yp(s,a,oe)}finally{_!==null&&N.types!==null&&(_.types=N.types),U.T=_}}else try{_=u(v,f),Ry(s,a,_)}catch(oe){Yp(s,a,oe)}}function Ry(s,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(f){jy(s,a,f)},function(f){return Yp(s,a,f)}):jy(s,a,u)}function jy(s,a,u){a.status="fulfilled",a.value=u,Dy(a),s.state=u,a=s.pending,a!==null&&(u=a.next,u===a?s.pending=null:(u=u.next,a.next=u,Iy(s,u)))}function Yp(s,a,u){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do a.status="rejected",a.reason=u,Dy(a),a=a.next;while(a!==f)}s.action=null}function Dy(s){s=s.listeners;for(var a=0;a<s.length;a++)(0,s[a])()}function My(s,a){return a}function Py(s,a){if(ot){var u=Et.formState;if(u!==null){e:{var f=Xe;if(ot){if(Nt){t:{for(var v=Nt,_=Ni;v.nodeType!==8;){if(!_){v=null;break t}if(v=ki(v.nextSibling),v===null){v=null;break t}}_=v.data,v=_==="F!"||_==="F"?v:null}if(v){Nt=ki(v.nextSibling),f=v.data==="F!";break e}}kr(f)}f=!1}f&&(a=u[0])}}return u=Un(),u.memoizedState=u.baseState=a,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:My,lastRenderedState:a},u.queue=f,u=ev.bind(null,Xe,f),f.dispatch=u,f=$p(!1),_=Zp.bind(null,Xe,!1,f.queue),f=Un(),v={state:a,dispatch:null,action:s,pending:null},f.queue=v,u=nC.bind(null,Xe,v,_,u),v.dispatch=u,f.memoizedState=s,[a,u,!1]}function Ly(s){var a=Ft();return Oy(a,Tt,s)}function Oy(s,a,u){if(a=Bp(s,a,My)[0],s=Ad(Ys)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var f=_c(a)}catch(N){throw N===Oa?vd:N}else f=a;a=Ft();var v=a.queue,_=v.dispatch;return u!==a.memoizedState&&(Xe.flags|=2048,Fa(9,{destroy:void 0},iC.bind(null,v,u),null)),[f,_,s]}function iC(s,a){s.action=a}function Uy(s){var a=Ft(),u=Tt;if(u!==null)return Oy(a,u,s);Ft(),a=a.memoizedState,u=Ft();var f=u.queue.dispatch;return u.memoizedState=s,[a,f,!1]}function Fa(s,a,u,f){return s={tag:s,create:u,deps:f,inst:a,next:null},a=Xe.updateQueue,a===null&&(a=Cd(),Xe.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=s.next=s:(f=u.next,u.next=s,s.next=f,a.lastEffect=s),s}function Vy(){return Ft().memoizedState}function Id(s,a,u,f){var v=Un();Xe.flags|=s,v.memoizedState=Fa(1|a,{destroy:void 0},u,f===void 0?null:f)}function Rd(s,a,u,f){var v=Ft();f=f===void 0?null:f;var _=v.memoizedState.inst;Tt!==null&&f!==null&&Up(f,Tt.memoizedState.deps)?v.memoizedState=Fa(a,_,u,f):(Xe.flags|=s,v.memoizedState=Fa(1|a,_,u,f))}function zy(s,a){Id(8390656,8,s,a)}function Jp(s,a){Rd(2048,8,s,a)}function sC(s){Xe.flags|=4;var a=Xe.updateQueue;if(a===null)a=Cd(),Xe.updateQueue=a,a.events=[s];else{var u=a.events;u===null?a.events=[s]:u.push(s)}}function Hy(s){var a=Ft().memoizedState;return sC({ref:a,nextImpl:s}),function(){if((pt&2)!==0)throw Error(i(440));return a.impl.apply(void 0,arguments)}}function Fy(s,a){return Rd(4,2,s,a)}function Gy(s,a){return Rd(4,4,s,a)}function By(s,a){if(typeof a=="function"){s=s();var u=a(s);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return s=s(),a.current=s,function(){a.current=null}}function qy(s,a,u){u=u!=null?u.concat([s]):null,Rd(4,4,By.bind(null,a,s),u)}function Kp(){}function $y(s,a){var u=Ft();a=a===void 0?null:a;var f=u.memoizedState;return a!==null&&Up(a,f[1])?f[0]:(u.memoizedState=[s,a],s)}function Yy(s,a){var u=Ft();a=a===void 0?null:a;var f=u.memoizedState;if(a!==null&&Up(a,f[1]))return f[0];if(f=s(),Go){xi(!0);try{s()}finally{xi(!1)}}return u.memoizedState=[f,a],f}function Xp(s,a,u){return u===void 0||($s&1073741824)!==0&&(tt&261930)===0?s.memoizedState=a:(s.memoizedState=u,s=Jv(),Xe.lanes|=s,Or|=s,u)}function Jy(s,a,u,f){return ii(u,a)?u:Va.current!==null?(s=Xp(s,u,f),ii(s,a)||(Wt=!0),s):($s&42)===0||($s&1073741824)!==0&&(tt&261930)===0?(Wt=!0,s.memoizedState=u):(s=Jv(),Xe.lanes|=s,Or|=s,a)}function Ky(s,a,u,f,v){var _=Y.p;Y.p=_!==0&&8>_?_:8;var N=U.T,V={};U.T=V,Zp(s,!1,a,u);try{var W=v(),oe=U.S;if(oe!==null&&oe(V,W),W!==null&&typeof W=="object"&&typeof W.then=="function"){var me=Z2(W,f);Tc(s,a,me,ci(s))}else Tc(s,a,f,ci(s))}catch(xe){Tc(s,a,{then:function(){},status:"rejected",reason:xe},ci())}finally{Y.p=_,N!==null&&V.types!==null&&(N.types=V.types),U.T=N}}function rC(){}function Wp(s,a,u,f){if(s.tag!==5)throw Error(i(476));var v=Xy(s).queue;Ky(s,v,a,X,u===null?rC:function(){return Wy(s),u(f)})}function Xy(s){var a=s.memoizedState;if(a!==null)return a;a={memoizedState:X,baseState:X,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:X},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:u},next:null},s.memoizedState=a,s=s.alternate,s!==null&&(s.memoizedState=a),a}function Wy(s){var a=Xy(s);a.next===null&&(a=s.alternate.memoizedState),Tc(s,a.next.queue,{},ci())}function Qp(){return _n(Vc)}function Qy(){return Ft().memoizedState}function Zy(){return Ft().memoizedState}function oC(s){for(var a=s.return;a!==null;){switch(a.tag){case 24:case 3:var u=ci();s=Rr(u);var f=jr(a,s,u);f!==null&&(Jn(f,a,u),xc(f,a,u)),a={cache:Cp()},s.payload=a;return}a=a.return}}function aC(s,a,u){var f=ci();u={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},jd(s)?tv(a,u):(u=gp(s,a,u,f),u!==null&&(Jn(u,s,f),nv(u,a,f)))}function ev(s,a,u){var f=ci();Tc(s,a,u,f)}function Tc(s,a,u,f){var v={lane:f,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(jd(s))tv(a,v);else{var _=s.alternate;if(s.lanes===0&&(_===null||_.lanes===0)&&(_=a.lastRenderedReducer,_!==null))try{var N=a.lastRenderedState,V=_(N,u);if(v.hasEagerState=!0,v.eagerState=V,ii(V,N))return fd(s,a,v,0),Et===null&&dd(),!1}catch{}finally{}if(u=gp(s,a,v,f),u!==null)return Jn(u,s,f),nv(u,a,f),!0}return!1}function Zp(s,a,u,f){if(f={lane:2,revertLane:Rm(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},jd(s)){if(a)throw Error(i(479))}else a=gp(s,u,f,2),a!==null&&Jn(a,s,2)}function jd(s){var a=s.alternate;return s===Xe||a!==null&&a===Xe}function tv(s,a){za=Ed=!0;var u=s.pending;u===null?a.next=a:(a.next=u.next,u.next=a),s.pending=a}function nv(s,a,u){if((u&4194048)!==0){var f=a.lanes;f&=s.pendingLanes,u|=f,a.lanes=u,Bl(s,u)}}var Sc={readContext:_n,use:kd,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useLayoutEffect:Ot,useInsertionEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useSyncExternalStore:Ot,useId:Ot,useHostTransitionStatus:Ot,useFormState:Ot,useActionState:Ot,useOptimistic:Ot,useMemoCache:Ot,useCacheRefresh:Ot};Sc.useEffectEvent=Ot;var iv={readContext:_n,use:kd,useCallback:function(s,a){return Un().memoizedState=[s,a===void 0?null:a],s},useContext:_n,useEffect:zy,useImperativeHandle:function(s,a,u){u=u!=null?u.concat([s]):null,Id(4194308,4,By.bind(null,a,s),u)},useLayoutEffect:function(s,a){return Id(4194308,4,s,a)},useInsertionEffect:function(s,a){Id(4,2,s,a)},useMemo:function(s,a){var u=Un();a=a===void 0?null:a;var f=s();if(Go){xi(!0);try{s()}finally{xi(!1)}}return u.memoizedState=[f,a],f},useReducer:function(s,a,u){var f=Un();if(u!==void 0){var v=u(a);if(Go){xi(!0);try{u(a)}finally{xi(!1)}}}else v=a;return f.memoizedState=f.baseState=v,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:v},f.queue=s,s=s.dispatch=aC.bind(null,Xe,s),[f.memoizedState,s]},useRef:function(s){var a=Un();return s={current:s},a.memoizedState=s},useState:function(s){s=$p(s);var a=s.queue,u=ev.bind(null,Xe,a);return a.dispatch=u,[s.memoizedState,u]},useDebugValue:Kp,useDeferredValue:function(s,a){var u=Un();return Xp(u,s,a)},useTransition:function(){var s=$p(!1);return s=Ky.bind(null,Xe,s.queue,!0,!1),Un().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,a,u){var f=Xe,v=Un();if(ot){if(u===void 0)throw Error(i(407));u=u()}else{if(u=a(),Et===null)throw Error(i(349));(tt&127)!==0||wy(f,a,u)}v.memoizedState=u;var _={value:u,getSnapshot:a};return v.queue=_,zy(Ny.bind(null,f,_,s),[s]),f.flags|=2048,Fa(9,{destroy:void 0},Ey.bind(null,f,_,u,a),null),u},useId:function(){var s=Un(),a=Et.identifierPrefix;if(ot){var u=ws,f=Ss;u=(f&~(1<<32-Vt(f)-1)).toString(32)+u,a="_"+a+"R_"+u,u=Nd++,0<u&&(a+="H"+u.toString(32)),a+="_"}else u=eC++,a="_"+a+"r_"+u.toString(32)+"_";return s.memoizedState=a},useHostTransitionStatus:Qp,useFormState:Py,useActionState:Py,useOptimistic:function(s){var a=Un();a.memoizedState=a.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=Zp.bind(null,Xe,!0,u),u.dispatch=a,[s,a]},useMemoCache:Gp,useCacheRefresh:function(){return Un().memoizedState=oC.bind(null,Xe)},useEffectEvent:function(s){var a=Un(),u={impl:s};return a.memoizedState=u,function(){if((pt&2)!==0)throw Error(i(440));return u.impl.apply(void 0,arguments)}}},em={readContext:_n,use:kd,useCallback:$y,useContext:_n,useEffect:Jp,useImperativeHandle:qy,useInsertionEffect:Fy,useLayoutEffect:Gy,useMemo:Yy,useReducer:Ad,useRef:Vy,useState:function(){return Ad(Ys)},useDebugValue:Kp,useDeferredValue:function(s,a){var u=Ft();return Jy(u,Tt.memoizedState,s,a)},useTransition:function(){var s=Ad(Ys)[0],a=Ft().memoizedState;return[typeof s=="boolean"?s:_c(s),a]},useSyncExternalStore:Sy,useId:Qy,useHostTransitionStatus:Qp,useFormState:Ly,useActionState:Ly,useOptimistic:function(s,a){var u=Ft();return Ay(u,Tt,s,a)},useMemoCache:Gp,useCacheRefresh:Zy};em.useEffectEvent=Hy;var sv={readContext:_n,use:kd,useCallback:$y,useContext:_n,useEffect:Jp,useImperativeHandle:qy,useInsertionEffect:Fy,useLayoutEffect:Gy,useMemo:Yy,useReducer:qp,useRef:Vy,useState:function(){return qp(Ys)},useDebugValue:Kp,useDeferredValue:function(s,a){var u=Ft();return Tt===null?Xp(u,s,a):Jy(u,Tt.memoizedState,s,a)},useTransition:function(){var s=qp(Ys)[0],a=Ft().memoizedState;return[typeof s=="boolean"?s:_c(s),a]},useSyncExternalStore:Sy,useId:Qy,useHostTransitionStatus:Qp,useFormState:Uy,useActionState:Uy,useOptimistic:function(s,a){var u=Ft();return Tt!==null?Ay(u,Tt,s,a):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:Gp,useCacheRefresh:Zy};sv.useEffectEvent=Hy;function tm(s,a,u,f){a=s.memoizedState,u=u(f,a),u=u==null?a:b({},a,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var nm={enqueueSetState:function(s,a,u){s=s._reactInternals;var f=ci(),v=Rr(f);v.payload=a,u!=null&&(v.callback=u),a=jr(s,v,f),a!==null&&(Jn(a,s,f),xc(a,s,f))},enqueueReplaceState:function(s,a,u){s=s._reactInternals;var f=ci(),v=Rr(f);v.tag=1,v.payload=a,u!=null&&(v.callback=u),a=jr(s,v,f),a!==null&&(Jn(a,s,f),xc(a,s,f))},enqueueForceUpdate:function(s,a){s=s._reactInternals;var u=ci(),f=Rr(u);f.tag=2,a!=null&&(f.callback=a),a=jr(s,f,u),a!==null&&(Jn(a,s,u),xc(a,s,u))}};function rv(s,a,u,f,v,_,N){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,_,N):a.prototype&&a.prototype.isPureReactComponent?!cc(u,f)||!cc(v,_):!0}function ov(s,a,u,f){s=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,f),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,f),a.state!==s&&nm.enqueueReplaceState(a,a.state,null)}function Bo(s,a){var u=a;if("ref"in a){u={};for(var f in a)f!=="ref"&&(u[f]=a[f])}if(s=s.defaultProps){u===a&&(u=b({},u));for(var v in s)u[v]===void 0&&(u[v]=s[v])}return u}function av(s){ud(s)}function lv(s){console.error(s)}function cv(s){ud(s)}function Dd(s,a){try{var u=s.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(f){setTimeout(function(){throw f})}}function uv(s,a,u){try{var f=s.onCaughtError;f(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(v){setTimeout(function(){throw v})}}function im(s,a,u){return u=Rr(u),u.tag=3,u.payload={element:null},u.callback=function(){Dd(s,a)},u}function dv(s){return s=Rr(s),s.tag=3,s}function fv(s,a,u,f){var v=u.type.getDerivedStateFromError;if(typeof v=="function"){var _=f.value;s.payload=function(){return v(_)},s.callback=function(){uv(a,u,f)}}var N=u.stateNode;N!==null&&typeof N.componentDidCatch=="function"&&(s.callback=function(){uv(a,u,f),typeof v!="function"&&(Ur===null?Ur=new Set([this]):Ur.add(this));var V=f.stack;this.componentDidCatch(f.value,{componentStack:V!==null?V:""})})}function lC(s,a,u,f,v){if(u.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(a=u.alternate,a!==null&&Ma(a,u,v,!0),u=ri.current,u!==null){switch(u.tag){case 31:case 13:return Ci===null?qd():u.alternate===null&&Ut===0&&(Ut=3),u.flags&=-257,u.flags|=65536,u.lanes=v,f===bd?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([f]):a.add(f),km(s,f,v)),!1;case 22:return u.flags|=65536,f===bd?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([f])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([f]):u.add(f)),km(s,f,v)),!1}throw Error(i(435,u.tag))}return km(s,f,v),qd(),!1}if(ot)return a=ri.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=v,f!==Tp&&(s=Error(i(422),{cause:f}),fc(Si(s,u)))):(f!==Tp&&(a=Error(i(423),{cause:f}),fc(Si(a,u))),s=s.current.alternate,s.flags|=65536,v&=-v,s.lanes|=v,f=Si(f,u),v=im(s.stateNode,f,v),Dp(s,v),Ut!==4&&(Ut=2)),!1;var _=Error(i(520),{cause:f});if(_=Si(_,u),Rc===null?Rc=[_]:Rc.push(_),Ut!==4&&(Ut=2),a===null)return!0;f=Si(f,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,s=v&-v,u.lanes|=s,s=im(u.stateNode,f,s),Dp(u,s),!1;case 1:if(a=u.type,_=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ur===null||!Ur.has(_))))return u.flags|=65536,v&=-v,u.lanes|=v,v=dv(v),fv(v,s,u,f),Dp(u,v),!1}u=u.return}while(u!==null);return!1}var sm=Error(i(461)),Wt=!1;function Tn(s,a,u,f){a.child=s===null?gy(a,null,u,f):Fo(a,s.child,u,f)}function hv(s,a,u,f,v){u=u.render;var _=a.ref;if("ref"in f){var N={};for(var V in f)V!=="ref"&&(N[V]=f[V])}else N=f;return Uo(a),f=Vp(s,a,u,N,_,v),V=zp(),s!==null&&!Wt?(Hp(s,a,v),Js(s,a,v)):(ot&&V&&bp(a),a.flags|=1,Tn(s,a,f,v),a.child)}function pv(s,a,u,f,v){if(s===null){var _=u.type;return typeof _=="function"&&!xp(_)&&_.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=_,mv(s,a,_,f,v)):(s=pd(u.type,null,f,a,a.mode,v),s.ref=a.ref,s.return=a,a.child=s)}if(_=s.child,!fm(s,v)){var N=_.memoizedProps;if(u=u.compare,u=u!==null?u:cc,u(N,f)&&s.ref===a.ref)return Js(s,a,v)}return a.flags|=1,s=Fs(_,f),s.ref=a.ref,s.return=a,a.child=s}function mv(s,a,u,f,v){if(s!==null){var _=s.memoizedProps;if(cc(_,f)&&s.ref===a.ref)if(Wt=!1,a.pendingProps=f=_,fm(s,v))(s.flags&131072)!==0&&(Wt=!0);else return a.lanes=s.lanes,Js(s,a,v)}return rm(s,a,u,f,v)}function gv(s,a,u,f){var v=f.children,_=s!==null?s.memoizedState:null;if(s===null&&a.stateNode===null&&(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((a.flags&128)!==0){if(_=_!==null?_.baseLanes|u:u,s!==null){for(f=a.child=s.child,v=0;f!==null;)v=v|f.lanes|f.childLanes,f=f.sibling;f=v&~_}else f=0,a.child=null;return xv(s,a,_,u,f)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},s!==null&&yd(a,_!==null?_.cachePool:null),_!==null?vy(a,_):Pp(),by(a);else return f=a.lanes=536870912,xv(s,a,_!==null?_.baseLanes|u:u,u,f)}else _!==null?(yd(a,_.cachePool),vy(a,_),Mr(),a.memoizedState=null):(s!==null&&yd(a,null),Pp(),Mr());return Tn(s,a,v,u),a.child}function wc(s,a){return s!==null&&s.tag===22||a.stateNode!==null||(a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),a.sibling}function xv(s,a,u,f,v){var _=Ap();return _=_===null?null:{parent:Kt._currentValue,pool:_},a.memoizedState={baseLanes:u,cachePool:_},s!==null&&yd(a,null),Pp(),by(a),s!==null&&Ma(s,a,f,!0),a.childLanes=v,null}function Md(s,a){return a=Ld({mode:a.mode,children:a.children},s.mode),a.ref=s.ref,s.child=a,a.return=s,a}function yv(s,a,u){return Fo(a,s.child,null,u),s=Md(a,a.pendingProps),s.flags|=2,oi(a),a.memoizedState=null,s}function cC(s,a,u){var f=a.pendingProps,v=(a.flags&128)!==0;if(a.flags&=-129,s===null){if(ot){if(f.mode==="hidden")return s=Md(a,f),a.lanes=536870912,wc(null,s);if(Op(a),(s=Nt)?(s=Ib(s,Ni),s=s!==null&&s.data==="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Nr!==null?{id:Ss,overflow:ws}:null,retryLane:536870912,hydrationErrors:null},u=ty(s),u.return=a,a.child=u,bn=a,Nt=null)):s=null,s===null)throw kr(a);return a.lanes=536870912,null}return Md(a,f)}var _=s.memoizedState;if(_!==null){var N=_.dehydrated;if(Op(a),v)if(a.flags&256)a.flags&=-257,a=yv(s,a,u);else if(a.memoizedState!==null)a.child=s.child,a.flags|=128,a=null;else throw Error(i(558));else if(Wt||Ma(s,a,u,!1),v=(u&s.childLanes)!==0,Wt||v){if(f=Et,f!==null&&(N=ql(f,u),N!==0&&N!==_.retryLane))throw _.retryLane=N,Mo(s,N),Jn(f,s,N),sm;qd(),a=yv(s,a,u)}else s=_.treeContext,Nt=ki(N.nextSibling),bn=a,ot=!0,Cr=null,Ni=!1,s!==null&&sy(a,s),a=Md(a,f),a.flags|=4096;return a}return s=Fs(s.child,{mode:f.mode,children:f.children}),s.ref=a.ref,a.child=s,s.return=a,s}function Pd(s,a){var u=a.ref;if(u===null)s!==null&&s.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(s===null||s.ref!==u)&&(a.flags|=4194816)}}function rm(s,a,u,f,v){return Uo(a),u=Vp(s,a,u,f,void 0,v),f=zp(),s!==null&&!Wt?(Hp(s,a,v),Js(s,a,v)):(ot&&f&&bp(a),a.flags|=1,Tn(s,a,u,v),a.child)}function vv(s,a,u,f,v,_){return Uo(a),a.updateQueue=null,u=Ty(a,f,u,v),_y(s),f=zp(),s!==null&&!Wt?(Hp(s,a,_),Js(s,a,_)):(ot&&f&&bp(a),a.flags|=1,Tn(s,a,u,_),a.child)}function bv(s,a,u,f,v){if(Uo(a),a.stateNode===null){var _=Ia,N=u.contextType;typeof N=="object"&&N!==null&&(_=_n(N)),_=new u(f,_),a.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=nm,a.stateNode=_,_._reactInternals=a,_=a.stateNode,_.props=f,_.state=a.memoizedState,_.refs={},Rp(a),N=u.contextType,_.context=typeof N=="object"&&N!==null?_n(N):Ia,_.state=a.memoizedState,N=u.getDerivedStateFromProps,typeof N=="function"&&(tm(a,u,N,f),_.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(N=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),N!==_.state&&nm.enqueueReplaceState(_,_.state,null),vc(a,f,_,v),yc(),_.state=a.memoizedState),typeof _.componentDidMount=="function"&&(a.flags|=4194308),f=!0}else if(s===null){_=a.stateNode;var V=a.memoizedProps,W=Bo(u,V);_.props=W;var oe=_.context,me=u.contextType;N=Ia,typeof me=="object"&&me!==null&&(N=_n(me));var xe=u.getDerivedStateFromProps;me=typeof xe=="function"||typeof _.getSnapshotBeforeUpdate=="function",V=a.pendingProps!==V,me||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(V||oe!==N)&&ov(a,_,f,N),Ir=!1;var ce=a.memoizedState;_.state=ce,vc(a,f,_,v),yc(),oe=a.memoizedState,V||ce!==oe||Ir?(typeof xe=="function"&&(tm(a,u,xe,f),oe=a.memoizedState),(W=Ir||rv(a,u,W,f,ce,oe,N))?(me||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(a.flags|=4194308)):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=f,a.memoizedState=oe),_.props=f,_.state=oe,_.context=N,f=W):(typeof _.componentDidMount=="function"&&(a.flags|=4194308),f=!1)}else{_=a.stateNode,jp(s,a),N=a.memoizedProps,me=Bo(u,N),_.props=me,xe=a.pendingProps,ce=_.context,oe=u.contextType,W=Ia,typeof oe=="object"&&oe!==null&&(W=_n(oe)),V=u.getDerivedStateFromProps,(oe=typeof V=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(N!==xe||ce!==W)&&ov(a,_,f,W),Ir=!1,ce=a.memoizedState,_.state=ce,vc(a,f,_,v),yc();var fe=a.memoizedState;N!==xe||ce!==fe||Ir||s!==null&&s.dependencies!==null&&gd(s.dependencies)?(typeof V=="function"&&(tm(a,u,V,f),fe=a.memoizedState),(me=Ir||rv(a,u,me,f,ce,fe,W)||s!==null&&s.dependencies!==null&&gd(s.dependencies))?(oe||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(f,fe,W),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(f,fe,W)),typeof _.componentDidUpdate=="function"&&(a.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof _.componentDidUpdate!="function"||N===s.memoizedProps&&ce===s.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ce===s.memoizedState||(a.flags|=1024),a.memoizedProps=f,a.memoizedState=fe),_.props=f,_.state=fe,_.context=W,f=me):(typeof _.componentDidUpdate!="function"||N===s.memoizedProps&&ce===s.memoizedState||(a.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||N===s.memoizedProps&&ce===s.memoizedState||(a.flags|=1024),f=!1)}return _=f,Pd(s,a),f=(a.flags&128)!==0,_||f?(_=a.stateNode,u=f&&typeof u.getDerivedStateFromError!="function"?null:_.render(),a.flags|=1,s!==null&&f?(a.child=Fo(a,s.child,null,v),a.child=Fo(a,null,u,v)):Tn(s,a,u,v),a.memoizedState=_.state,s=a.child):s=Js(s,a,v),s}function _v(s,a,u,f){return Lo(),a.flags|=256,Tn(s,a,u,f),a.child}var om={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function am(s){return{baseLanes:s,cachePool:uy()}}function lm(s,a,u){return s=s!==null?s.childLanes&~u:0,a&&(s|=li),s}function Tv(s,a,u){var f=a.pendingProps,v=!1,_=(a.flags&128)!==0,N;if((N=_)||(N=s!==null&&s.memoizedState===null?!1:(Ht.current&2)!==0),N&&(v=!0,a.flags&=-129),N=(a.flags&32)!==0,a.flags&=-33,s===null){if(ot){if(v?Dr(a):Mr(),(s=Nt)?(s=Ib(s,Ni),s=s!==null&&s.data!=="&"?s:null,s!==null&&(a.memoizedState={dehydrated:s,treeContext:Nr!==null?{id:Ss,overflow:ws}:null,retryLane:536870912,hydrationErrors:null},u=ty(s),u.return=a,a.child=u,bn=a,Nt=null)):s=null,s===null)throw kr(a);return Bm(s)?a.lanes=32:a.lanes=536870912,null}var V=f.children;return f=f.fallback,v?(Mr(),v=a.mode,V=Ld({mode:"hidden",children:V},v),f=Po(f,v,u,null),V.return=a,f.return=a,V.sibling=f,a.child=V,f=a.child,f.memoizedState=am(u),f.childLanes=lm(s,N,u),a.memoizedState=om,wc(null,f)):(Dr(a),cm(a,V))}var W=s.memoizedState;if(W!==null&&(V=W.dehydrated,V!==null)){if(_)a.flags&256?(Dr(a),a.flags&=-257,a=um(s,a,u)):a.memoizedState!==null?(Mr(),a.child=s.child,a.flags|=128,a=null):(Mr(),V=f.fallback,v=a.mode,f=Ld({mode:"visible",children:f.children},v),V=Po(V,v,u,null),V.flags|=2,f.return=a,V.return=a,f.sibling=V,a.child=f,Fo(a,s.child,null,u),f=a.child,f.memoizedState=am(u),f.childLanes=lm(s,N,u),a.memoizedState=om,a=wc(null,f));else if(Dr(a),Bm(V)){if(N=V.nextSibling&&V.nextSibling.dataset,N)var oe=N.dgst;N=oe,f=Error(i(419)),f.stack="",f.digest=N,fc({value:f,source:null,stack:null}),a=um(s,a,u)}else if(Wt||Ma(s,a,u,!1),N=(u&s.childLanes)!==0,Wt||N){if(N=Et,N!==null&&(f=ql(N,u),f!==0&&f!==W.retryLane))throw W.retryLane=f,Mo(s,f),Jn(N,s,f),sm;Gm(V)||qd(),a=um(s,a,u)}else Gm(V)?(a.flags|=192,a.child=s.child,a=null):(s=W.treeContext,Nt=ki(V.nextSibling),bn=a,ot=!0,Cr=null,Ni=!1,s!==null&&sy(a,s),a=cm(a,f.children),a.flags|=4096);return a}return v?(Mr(),V=f.fallback,v=a.mode,W=s.child,oe=W.sibling,f=Fs(W,{mode:"hidden",children:f.children}),f.subtreeFlags=W.subtreeFlags&65011712,oe!==null?V=Fs(oe,V):(V=Po(V,v,u,null),V.flags|=2),V.return=a,f.return=a,f.sibling=V,a.child=f,wc(null,f),f=a.child,V=s.child.memoizedState,V===null?V=am(u):(v=V.cachePool,v!==null?(W=Kt._currentValue,v=v.parent!==W?{parent:W,pool:W}:v):v=uy(),V={baseLanes:V.baseLanes|u,cachePool:v}),f.memoizedState=V,f.childLanes=lm(s,N,u),a.memoizedState=om,wc(s.child,f)):(Dr(a),u=s.child,s=u.sibling,u=Fs(u,{mode:"visible",children:f.children}),u.return=a,u.sibling=null,s!==null&&(N=a.deletions,N===null?(a.deletions=[s],a.flags|=16):N.push(s)),a.child=u,a.memoizedState=null,u)}function cm(s,a){return a=Ld({mode:"visible",children:a},s.mode),a.return=s,s.child=a}function Ld(s,a){return s=si(22,s,null,a),s.lanes=0,s}function um(s,a,u){return Fo(a,s.child,null,u),s=cm(a,a.pendingProps.children),s.flags|=2,a.memoizedState=null,s}function Sv(s,a,u){s.lanes|=a;var f=s.alternate;f!==null&&(f.lanes|=a),Ep(s.return,a,u)}function dm(s,a,u,f,v,_){var N=s.memoizedState;N===null?s.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:f,tail:u,tailMode:v,treeForkCount:_}:(N.isBackwards=a,N.rendering=null,N.renderingStartTime=0,N.last=f,N.tail=u,N.tailMode=v,N.treeForkCount=_)}function wv(s,a,u){var f=a.pendingProps,v=f.revealOrder,_=f.tail;f=f.children;var N=Ht.current,V=(N&2)!==0;if(V?(N=N&1|2,a.flags|=128):N&=1,he(Ht,N),Tn(s,a,f,u),f=ot?dc:0,!V&&s!==null&&(s.flags&128)!==0)e:for(s=a.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Sv(s,u,a);else if(s.tag===19)Sv(s,u,a);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(v){case"forwards":for(u=a.child,v=null;u!==null;)s=u.alternate,s!==null&&wd(s)===null&&(v=u),u=u.sibling;u=v,u===null?(v=a.child,a.child=null):(v=u.sibling,u.sibling=null),dm(a,!1,v,u,_,f);break;case"backwards":case"unstable_legacy-backwards":for(u=null,v=a.child,a.child=null;v!==null;){if(s=v.alternate,s!==null&&wd(s)===null){a.child=v;break}s=v.sibling,v.sibling=u,u=v,v=s}dm(a,!0,u,null,_,f);break;case"together":dm(a,!1,null,null,void 0,f);break;default:a.memoizedState=null}return a.child}function Js(s,a,u){if(s!==null&&(a.dependencies=s.dependencies),Or|=a.lanes,(u&a.childLanes)===0)if(s!==null){if(Ma(s,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(s!==null&&a.child!==s.child)throw Error(i(153));if(a.child!==null){for(s=a.child,u=Fs(s,s.pendingProps),a.child=u,u.return=a;s.sibling!==null;)s=s.sibling,u=u.sibling=Fs(s,s.pendingProps),u.return=a;u.sibling=null}return a.child}function fm(s,a){return(s.lanes&a)!==0?!0:(s=s.dependencies,!!(s!==null&&gd(s)))}function uC(s,a,u){switch(a.tag){case 3:Te(a,a.stateNode.containerInfo),Ar(a,Kt,s.memoizedState.cache),Lo();break;case 27:case 5:Be(a);break;case 4:Te(a,a.stateNode.containerInfo);break;case 10:Ar(a,a.type,a.memoizedProps.value);break;case 31:if(a.memoizedState!==null)return a.flags|=128,Op(a),null;break;case 13:var f=a.memoizedState;if(f!==null)return f.dehydrated!==null?(Dr(a),a.flags|=128,null):(u&a.child.childLanes)!==0?Tv(s,a,u):(Dr(a),s=Js(s,a,u),s!==null?s.sibling:null);Dr(a);break;case 19:var v=(s.flags&128)!==0;if(f=(u&a.childLanes)!==0,f||(Ma(s,a,u,!1),f=(u&a.childLanes)!==0),v){if(f)return wv(s,a,u);a.flags|=128}if(v=a.memoizedState,v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),he(Ht,Ht.current),f)break;return null;case 22:return a.lanes=0,gv(s,a,u,a.pendingProps);case 24:Ar(a,Kt,s.memoizedState.cache)}return Js(s,a,u)}function Ev(s,a,u){if(s!==null)if(s.memoizedProps!==a.pendingProps)Wt=!0;else{if(!fm(s,u)&&(a.flags&128)===0)return Wt=!1,uC(s,a,u);Wt=(s.flags&131072)!==0}else Wt=!1,ot&&(a.flags&1048576)!==0&&iy(a,dc,a.index);switch(a.lanes=0,a.tag){case 16:e:{var f=a.pendingProps;if(s=zo(a.elementType),a.type=s,typeof s=="function")xp(s)?(f=Bo(s,f),a.tag=1,a=bv(null,a,s,f,u)):(a.tag=0,a=rm(null,a,s,f,u));else{if(s!=null){var v=s.$$typeof;if(v===J){a.tag=11,a=hv(null,a,s,f,u);break e}else if(v===R){a.tag=14,a=pv(null,a,s,f,u);break e}}throw a=q(s)||s,Error(i(306,a,""))}}return a;case 0:return rm(s,a,a.type,a.pendingProps,u);case 1:return f=a.type,v=Bo(f,a.pendingProps),bv(s,a,f,v,u);case 3:e:{if(Te(a,a.stateNode.containerInfo),s===null)throw Error(i(387));f=a.pendingProps;var _=a.memoizedState;v=_.element,jp(s,a),vc(a,f,null,u);var N=a.memoizedState;if(f=N.cache,Ar(a,Kt,f),f!==_.cache&&Np(a,[Kt],u,!0),yc(),f=N.element,_.isDehydrated)if(_={element:f,isDehydrated:!1,cache:N.cache},a.updateQueue.baseState=_,a.memoizedState=_,a.flags&256){a=_v(s,a,f,u);break e}else if(f!==v){v=Si(Error(i(424)),a),fc(v),a=_v(s,a,f,u);break e}else{switch(s=a.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Nt=ki(s.firstChild),bn=a,ot=!0,Cr=null,Ni=!0,u=gy(a,null,f,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Lo(),f===v){a=Js(s,a,u);break e}Tn(s,a,f,u)}a=a.child}return a;case 26:return Pd(s,a),s===null?(u=Lb(a.type,null,a.pendingProps,null))?a.memoizedState=u:ot||(u=a.type,s=a.pendingProps,f=Qd(ye.current).createElement(u),f[$t]=a,f[cn]=s,Sn(f,u,s),Yt(f),a.stateNode=f):a.memoizedState=Lb(a.type,s.memoizedProps,a.pendingProps,s.memoizedState),null;case 27:return Be(a),s===null&&ot&&(f=a.stateNode=Db(a.type,a.pendingProps,ye.current),bn=a,Ni=!0,v=Nt,Fr(a.type)?(qm=v,Nt=ki(f.firstChild)):Nt=v),Tn(s,a,a.pendingProps.children,u),Pd(s,a),s===null&&(a.flags|=4194304),a.child;case 5:return s===null&&ot&&((v=f=Nt)&&(f=zC(f,a.type,a.pendingProps,Ni),f!==null?(a.stateNode=f,bn=a,Nt=ki(f.firstChild),Ni=!1,v=!0):v=!1),v||kr(a)),Be(a),v=a.type,_=a.pendingProps,N=s!==null?s.memoizedProps:null,f=_.children,zm(v,_)?f=null:N!==null&&zm(v,N)&&(a.flags|=32),a.memoizedState!==null&&(v=Vp(s,a,tC,null,null,u),Vc._currentValue=v),Pd(s,a),Tn(s,a,f,u),a.child;case 6:return s===null&&ot&&((s=u=Nt)&&(u=HC(u,a.pendingProps,Ni),u!==null?(a.stateNode=u,bn=a,Nt=null,s=!0):s=!1),s||kr(a)),null;case 13:return Tv(s,a,u);case 4:return Te(a,a.stateNode.containerInfo),f=a.pendingProps,s===null?a.child=Fo(a,null,f,u):Tn(s,a,f,u),a.child;case 11:return hv(s,a,a.type,a.pendingProps,u);case 7:return Tn(s,a,a.pendingProps,u),a.child;case 8:return Tn(s,a,a.pendingProps.children,u),a.child;case 12:return Tn(s,a,a.pendingProps.children,u),a.child;case 10:return f=a.pendingProps,Ar(a,a.type,f.value),Tn(s,a,f.children,u),a.child;case 9:return v=a.type._context,f=a.pendingProps.children,Uo(a),v=_n(v),f=f(v),a.flags|=1,Tn(s,a,f,u),a.child;case 14:return pv(s,a,a.type,a.pendingProps,u);case 15:return mv(s,a,a.type,a.pendingProps,u);case 19:return wv(s,a,u);case 31:return cC(s,a,u);case 22:return gv(s,a,u,a.pendingProps);case 24:return Uo(a),f=_n(Kt),s===null?(v=Ap(),v===null&&(v=Et,_=Cp(),v.pooledCache=_,_.refCount++,_!==null&&(v.pooledCacheLanes|=u),v=_),a.memoizedState={parent:f,cache:v},Rp(a),Ar(a,Kt,v)):((s.lanes&u)!==0&&(jp(s,a),vc(a,null,null,u),yc()),v=s.memoizedState,_=a.memoizedState,v.parent!==f?(v={parent:f,cache:f},a.memoizedState=v,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=v),Ar(a,Kt,f)):(f=_.cache,Ar(a,Kt,f),f!==v.cache&&Np(a,[Kt],u,!0))),Tn(s,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function Ks(s){s.flags|=4}function hm(s,a,u,f,v){if((a=(s.mode&32)!==0)&&(a=!1),a){if(s.flags|=16777216,(v&335544128)===v)if(s.stateNode.complete)s.flags|=8192;else if(Qv())s.flags|=8192;else throw Ho=bd,Ip}else s.flags&=-16777217}function Nv(s,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Hb(a))if(Qv())s.flags|=8192;else throw Ho=bd,Ip}function Od(s,a){a!==null&&(s.flags|=4),s.flags&16384&&(a=s.tag!==22?Gu():536870912,s.lanes|=a,$a|=a)}function Ec(s,a){if(!ot)switch(s.tailMode){case"hidden":a=s.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?a||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function Ct(s){var a=s.alternate!==null&&s.alternate.child===s.child,u=0,f=0;if(a)for(var v=s.child;v!==null;)u|=v.lanes|v.childLanes,f|=v.subtreeFlags&65011712,f|=v.flags&65011712,v.return=s,v=v.sibling;else for(v=s.child;v!==null;)u|=v.lanes|v.childLanes,f|=v.subtreeFlags,f|=v.flags,v.return=s,v=v.sibling;return s.subtreeFlags|=f,s.childLanes=u,a}function dC(s,a,u){var f=a.pendingProps;switch(_p(a),a.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ct(a),null;case 1:return Ct(a),null;case 3:return u=a.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),a.memoizedState.cache!==f&&(a.flags|=2048),qs(Kt),Ae(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Da(a)?Ks(a):s===null||s.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,Sp())),Ct(a),null;case 26:var v=a.type,_=a.memoizedState;return s===null?(Ks(a),_!==null?(Ct(a),Nv(a,_)):(Ct(a),hm(a,v,null,f,u))):_?_!==s.memoizedState?(Ks(a),Ct(a),Nv(a,_)):(Ct(a),a.flags&=-16777217):(s=s.memoizedProps,s!==f&&Ks(a),Ct(a),hm(a,v,s,f,u)),null;case 27:if(jt(a),u=ye.current,v=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==f&&Ks(a);else{if(!f){if(a.stateNode===null)throw Error(i(166));return Ct(a),null}s=Q.current,Da(a)?ry(a):(s=Db(v,f,u),a.stateNode=s,Ks(a))}return Ct(a),null;case 5:if(jt(a),v=a.type,s!==null&&a.stateNode!=null)s.memoizedProps!==f&&Ks(a);else{if(!f){if(a.stateNode===null)throw Error(i(166));return Ct(a),null}if(_=Q.current,Da(a))ry(a);else{var N=Qd(ye.current);switch(_){case 1:_=N.createElementNS("http://www.w3.org/2000/svg",v);break;case 2:_=N.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;default:switch(v){case"svg":_=N.createElementNS("http://www.w3.org/2000/svg",v);break;case"math":_=N.createElementNS("http://www.w3.org/1998/Math/MathML",v);break;case"script":_=N.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof f.is=="string"?N.createElement("select",{is:f.is}):N.createElement("select"),f.multiple?_.multiple=!0:f.size&&(_.size=f.size);break;default:_=typeof f.is=="string"?N.createElement(v,{is:f.is}):N.createElement(v)}}_[$t]=a,_[cn]=f;e:for(N=a.child;N!==null;){if(N.tag===5||N.tag===6)_.appendChild(N.stateNode);else if(N.tag!==4&&N.tag!==27&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===a)break e;for(;N.sibling===null;){if(N.return===null||N.return===a)break e;N=N.return}N.sibling.return=N.return,N=N.sibling}a.stateNode=_;e:switch(Sn(_,v,f),v){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&Ks(a)}}return Ct(a),hm(a,a.type,s===null?null:s.memoizedProps,a.pendingProps,u),null;case 6:if(s&&a.stateNode!=null)s.memoizedProps!==f&&Ks(a);else{if(typeof f!="string"&&a.stateNode===null)throw Error(i(166));if(s=ye.current,Da(a)){if(s=a.stateNode,u=a.memoizedProps,f=null,v=bn,v!==null)switch(v.tag){case 27:case 5:f=v.memoizedProps}s[$t]=a,s=!!(s.nodeValue===u||f!==null&&f.suppressHydrationWarning===!0||Tb(s.nodeValue,u)),s||kr(a,!0)}else s=Qd(s).createTextNode(f),s[$t]=a,a.stateNode=s}return Ct(a),null;case 31:if(u=a.memoizedState,s===null||s.memoizedState!==null){if(f=Da(a),u!==null){if(s===null){if(!f)throw Error(i(318));if(s=a.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[$t]=a}else Lo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ct(a),s=!1}else u=Sp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=u),s=!0;if(!s)return a.flags&256?(oi(a),a):(oi(a),null);if((a.flags&128)!==0)throw Error(i(558))}return Ct(a),null;case 13:if(f=a.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(v=Da(a),f!==null&&f.dehydrated!==null){if(s===null){if(!v)throw Error(i(318));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(i(317));v[$t]=a}else Lo(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;Ct(a),v=!1}else v=Sp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=v),v=!0;if(!v)return a.flags&256?(oi(a),a):(oi(a),null)}return oi(a),(a.flags&128)!==0?(a.lanes=u,a):(u=f!==null,s=s!==null&&s.memoizedState!==null,u&&(f=a.child,v=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(v=f.alternate.memoizedState.cachePool.pool),_=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(_=f.memoizedState.cachePool.pool),_!==v&&(f.flags|=2048)),u!==s&&u&&(a.child.flags|=8192),Od(a,a.updateQueue),Ct(a),null);case 4:return Ae(),s===null&&Pm(a.stateNode.containerInfo),Ct(a),null;case 10:return qs(a.type),Ct(a),null;case 19:if(ee(Ht),f=a.memoizedState,f===null)return Ct(a),null;if(v=(a.flags&128)!==0,_=f.rendering,_===null)if(v)Ec(f,!1);else{if(Ut!==0||s!==null&&(s.flags&128)!==0)for(s=a.child;s!==null;){if(_=wd(s),_!==null){for(a.flags|=128,Ec(f,!1),s=_.updateQueue,a.updateQueue=s,Od(a,s),a.subtreeFlags=0,s=u,u=a.child;u!==null;)ey(u,s),u=u.sibling;return he(Ht,Ht.current&1|2),ot&&Gs(a,f.treeForkCount),a.child}s=s.sibling}f.tail!==null&&Ln()>Fd&&(a.flags|=128,v=!0,Ec(f,!1),a.lanes=4194304)}else{if(!v)if(s=wd(_),s!==null){if(a.flags|=128,v=!0,s=s.updateQueue,a.updateQueue=s,Od(a,s),Ec(f,!0),f.tail===null&&f.tailMode==="hidden"&&!_.alternate&&!ot)return Ct(a),null}else 2*Ln()-f.renderingStartTime>Fd&&u!==536870912&&(a.flags|=128,v=!0,Ec(f,!1),a.lanes=4194304);f.isBackwards?(_.sibling=a.child,a.child=_):(s=f.last,s!==null?s.sibling=_:a.child=_,f.last=_)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=Ln(),s.sibling=null,u=Ht.current,he(Ht,v?u&1|2:u&1),ot&&Gs(a,f.treeForkCount),s):(Ct(a),null);case 22:case 23:return oi(a),Lp(),f=a.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(a.flags|=8192):f&&(a.flags|=8192),f?(u&536870912)!==0&&(a.flags&128)===0&&(Ct(a),a.subtreeFlags&6&&(a.flags|=8192)):Ct(a),u=a.updateQueue,u!==null&&Od(a,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),f=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(f=a.memoizedState.cachePool.pool),f!==u&&(a.flags|=2048),s!==null&&ee(Vo),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),qs(Kt),Ct(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function fC(s,a){switch(_p(a),a.tag){case 1:return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 3:return qs(Kt),Ae(),s=a.flags,(s&65536)!==0&&(s&128)===0?(a.flags=s&-65537|128,a):null;case 26:case 27:case 5:return jt(a),null;case 31:if(a.memoizedState!==null){if(oi(a),a.alternate===null)throw Error(i(340));Lo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 13:if(oi(a),s=a.memoizedState,s!==null&&s.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Lo()}return s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 19:return ee(Ht),null;case 4:return Ae(),null;case 10:return qs(a.type),null;case 22:case 23:return oi(a),Lp(),s!==null&&ee(Vo),s=a.flags,s&65536?(a.flags=s&-65537|128,a):null;case 24:return qs(Kt),null;case 25:return null;default:return null}}function Cv(s,a){switch(_p(a),a.tag){case 3:qs(Kt),Ae();break;case 26:case 27:case 5:jt(a);break;case 4:Ae();break;case 31:a.memoizedState!==null&&oi(a);break;case 13:oi(a);break;case 19:ee(Ht);break;case 10:qs(a.type);break;case 22:case 23:oi(a),Lp(),s!==null&&ee(Vo);break;case 24:qs(Kt)}}function Nc(s,a){try{var u=a.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var v=f.next;u=v;do{if((u.tag&s)===s){f=void 0;var _=u.create,N=u.inst;f=_(),N.destroy=f}u=u.next}while(u!==v)}}catch(V){bt(a,a.return,V)}}function Pr(s,a,u){try{var f=a.updateQueue,v=f!==null?f.lastEffect:null;if(v!==null){var _=v.next;f=_;do{if((f.tag&s)===s){var N=f.inst,V=N.destroy;if(V!==void 0){N.destroy=void 0,v=a;var W=u,oe=V;try{oe()}catch(me){bt(v,W,me)}}}f=f.next}while(f!==_)}}catch(me){bt(a,a.return,me)}}function kv(s){var a=s.updateQueue;if(a!==null){var u=s.stateNode;try{yy(a,u)}catch(f){bt(s,s.return,f)}}}function Av(s,a,u){u.props=Bo(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(f){bt(s,a,f)}}function Cc(s,a){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof u=="function"?s.refCleanup=u(f):u.current=f}}catch(v){bt(s,a,v)}}function Es(s,a){var u=s.ref,f=s.refCleanup;if(u!==null)if(typeof f=="function")try{f()}catch(v){bt(s,a,v)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(v){bt(s,a,v)}else u.current=null}function Iv(s){var a=s.type,u=s.memoizedProps,f=s.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&f.focus();break e;case"img":u.src?f.src=u.src:u.srcSet&&(f.srcset=u.srcSet)}}catch(v){bt(s,s.return,v)}}function pm(s,a,u){try{var f=s.stateNode;MC(f,s.type,u,a),f[cn]=a}catch(v){bt(s,s.return,v)}}function Rv(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Fr(s.type)||s.tag===4}function mm(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Rv(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Fr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function gm(s,a,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(s),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=Vi));else if(f!==4&&(f===27&&Fr(s.type)&&(u=s.stateNode,a=null),s=s.child,s!==null))for(gm(s,a,u),s=s.sibling;s!==null;)gm(s,a,u),s=s.sibling}function Ud(s,a,u){var f=s.tag;if(f===5||f===6)s=s.stateNode,a?u.insertBefore(s,a):u.appendChild(s);else if(f!==4&&(f===27&&Fr(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(Ud(s,a,u),s=s.sibling;s!==null;)Ud(s,a,u),s=s.sibling}function jv(s){var a=s.stateNode,u=s.memoizedProps;try{for(var f=s.type,v=a.attributes;v.length;)a.removeAttributeNode(v[0]);Sn(a,f,u),a[$t]=s,a[cn]=u}catch(_){bt(s,s.return,_)}}var Xs=!1,Qt=!1,xm=!1,Dv=typeof WeakSet=="function"?WeakSet:Set,dn=null;function hC(s,a){if(s=s.containerInfo,Um=of,s=qx(s),up(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var f=u.getSelection&&u.getSelection();if(f&&f.rangeCount!==0){u=f.anchorNode;var v=f.anchorOffset,_=f.focusNode;f=f.focusOffset;try{u.nodeType,_.nodeType}catch{u=null;break e}var N=0,V=-1,W=-1,oe=0,me=0,xe=s,ce=null;t:for(;;){for(var fe;xe!==u||v!==0&&xe.nodeType!==3||(V=N+v),xe!==_||f!==0&&xe.nodeType!==3||(W=N+f),xe.nodeType===3&&(N+=xe.nodeValue.length),(fe=xe.firstChild)!==null;)ce=xe,xe=fe;for(;;){if(xe===s)break t;if(ce===u&&++oe===v&&(V=N),ce===_&&++me===f&&(W=N),(fe=xe.nextSibling)!==null)break;xe=ce,ce=xe.parentNode}xe=fe}u=V===-1||W===-1?null:{start:V,end:W}}else u=null}u=u||{start:0,end:0}}else u=null;for(Vm={focusedElem:s,selectionRange:u},of=!1,dn=a;dn!==null;)if(a=dn,s=a.child,(a.subtreeFlags&1028)!==0&&s!==null)s.return=a,dn=s;else for(;dn!==null;){switch(a=dn,_=a.alternate,s=a.flags,a.tag){case 0:if((s&4)!==0&&(s=a.updateQueue,s=s!==null?s.events:null,s!==null))for(u=0;u<s.length;u++)v=s[u],v.ref.impl=v.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&_!==null){s=void 0,u=a,v=_.memoizedProps,_=_.memoizedState,f=u.stateNode;try{var Re=Bo(u.type,v);s=f.getSnapshotBeforeUpdate(Re,_),f.__reactInternalSnapshotBeforeUpdate=s}catch(Ue){bt(u,u.return,Ue)}}break;case 3:if((s&1024)!==0){if(s=a.stateNode.containerInfo,u=s.nodeType,u===9)Fm(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Fm(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=a.sibling,s!==null){s.return=a.return,dn=s;break}dn=a.return}}function Mv(s,a,u){var f=u.flags;switch(u.tag){case 0:case 11:case 15:Qs(s,u),f&4&&Nc(5,u);break;case 1:if(Qs(s,u),f&4)if(s=u.stateNode,a===null)try{s.componentDidMount()}catch(N){bt(u,u.return,N)}else{var v=Bo(u.type,a.memoizedProps);a=a.memoizedState;try{s.componentDidUpdate(v,a,s.__reactInternalSnapshotBeforeUpdate)}catch(N){bt(u,u.return,N)}}f&64&&kv(u),f&512&&Cc(u,u.return);break;case 3:if(Qs(s,u),f&64&&(s=u.updateQueue,s!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{yy(s,a)}catch(N){bt(u,u.return,N)}}break;case 27:a===null&&f&4&&jv(u);case 26:case 5:Qs(s,u),a===null&&f&4&&Iv(u),f&512&&Cc(u,u.return);break;case 12:Qs(s,u);break;case 31:Qs(s,u),f&4&&Ov(s,u);break;case 13:Qs(s,u),f&4&&Uv(s,u),f&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=TC.bind(null,u),FC(s,u))));break;case 22:if(f=u.memoizedState!==null||Xs,!f){a=a!==null&&a.memoizedState!==null||Qt,v=Xs;var _=Qt;Xs=f,(Qt=a)&&!_?Zs(s,u,(u.subtreeFlags&8772)!==0):Qs(s,u),Xs=v,Qt=_}break;case 30:break;default:Qs(s,u)}}function Pv(s){var a=s.alternate;a!==null&&(s.alternate=null,Pv(a)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(a=s.stateNode,a!==null&&ga(a)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Rt=null,Bn=!1;function Ws(s,a,u){for(u=u.child;u!==null;)Lv(s,a,u),u=u.sibling}function Lv(s,a,u){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(Pi,u)}catch{}switch(u.tag){case 26:Qt||Es(u,a),Ws(s,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Qt||Es(u,a);var f=Rt,v=Bn;Fr(u.type)&&(Rt=u.stateNode,Bn=!1),Ws(s,a,u),Lc(u.stateNode),Rt=f,Bn=v;break;case 5:Qt||Es(u,a);case 6:if(f=Rt,v=Bn,Rt=null,Ws(s,a,u),Rt=f,Bn=v,Rt!==null)if(Bn)try{(Rt.nodeType===9?Rt.body:Rt.nodeName==="HTML"?Rt.ownerDocument.body:Rt).removeChild(u.stateNode)}catch(_){bt(u,a,_)}else try{Rt.removeChild(u.stateNode)}catch(_){bt(u,a,_)}break;case 18:Rt!==null&&(Bn?(s=Rt,kb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),el(s)):kb(Rt,u.stateNode));break;case 4:f=Rt,v=Bn,Rt=u.stateNode.containerInfo,Bn=!0,Ws(s,a,u),Rt=f,Bn=v;break;case 0:case 11:case 14:case 15:Pr(2,u,a),Qt||Pr(4,u,a),Ws(s,a,u);break;case 1:Qt||(Es(u,a),f=u.stateNode,typeof f.componentWillUnmount=="function"&&Av(u,a,f)),Ws(s,a,u);break;case 21:Ws(s,a,u);break;case 22:Qt=(f=Qt)||u.memoizedState!==null,Ws(s,a,u),Qt=f;break;default:Ws(s,a,u)}}function Ov(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{el(s)}catch(u){bt(a,a.return,u)}}}function Uv(s,a){if(a.memoizedState===null&&(s=a.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{el(s)}catch(u){bt(a,a.return,u)}}function pC(s){switch(s.tag){case 31:case 13:case 19:var a=s.stateNode;return a===null&&(a=s.stateNode=new Dv),a;case 22:return s=s.stateNode,a=s._retryCache,a===null&&(a=s._retryCache=new Dv),a;default:throw Error(i(435,s.tag))}}function Vd(s,a){var u=pC(s);a.forEach(function(f){if(!u.has(f)){u.add(f);var v=SC.bind(null,s,f);f.then(v,v)}})}function qn(s,a){var u=a.deletions;if(u!==null)for(var f=0;f<u.length;f++){var v=u[f],_=s,N=a,V=N;e:for(;V!==null;){switch(V.tag){case 27:if(Fr(V.type)){Rt=V.stateNode,Bn=!1;break e}break;case 5:Rt=V.stateNode,Bn=!1;break e;case 3:case 4:Rt=V.stateNode.containerInfo,Bn=!0;break e}V=V.return}if(Rt===null)throw Error(i(160));Lv(_,N,v),Rt=null,Bn=!1,_=v.alternate,_!==null&&(_.return=null),v.return=null}if(a.subtreeFlags&13886)for(a=a.child;a!==null;)Vv(a,s),a=a.sibling}var qi=null;function Vv(s,a){var u=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:qn(a,s),$n(s),f&4&&(Pr(3,s,s.return),Nc(3,s),Pr(5,s,s.return));break;case 1:qn(a,s),$n(s),f&512&&(Qt||u===null||Es(u,u.return)),f&64&&Xs&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?f:u.concat(f))));break;case 26:var v=qi;if(qn(a,s),$n(s),f&512&&(Qt||u===null||Es(u,u.return)),f&4){var _=u!==null?u.memoizedState:null;if(f=s.memoizedState,u===null)if(f===null)if(s.stateNode===null){e:{f=s.type,u=s.memoizedProps,v=v.ownerDocument||v;t:switch(f){case"title":_=v.getElementsByTagName("title")[0],(!_||_[ds]||_[$t]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=v.createElement(f),v.head.insertBefore(_,v.querySelector("head > title"))),Sn(_,f,u),_[$t]=s,Yt(_),f=_;break e;case"link":var N=Vb("link","href",v).get(f+(u.href||""));if(N){for(var V=0;V<N.length;V++)if(_=N[V],_.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&_.getAttribute("rel")===(u.rel==null?null:u.rel)&&_.getAttribute("title")===(u.title==null?null:u.title)&&_.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){N.splice(V,1);break t}}_=v.createElement(f),Sn(_,f,u),v.head.appendChild(_);break;case"meta":if(N=Vb("meta","content",v).get(f+(u.content||""))){for(V=0;V<N.length;V++)if(_=N[V],_.getAttribute("content")===(u.content==null?null:""+u.content)&&_.getAttribute("name")===(u.name==null?null:u.name)&&_.getAttribute("property")===(u.property==null?null:u.property)&&_.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&_.getAttribute("charset")===(u.charSet==null?null:u.charSet)){N.splice(V,1);break t}}_=v.createElement(f),Sn(_,f,u),v.head.appendChild(_);break;default:throw Error(i(468,f))}_[$t]=s,Yt(_),f=_}s.stateNode=f}else zb(v,s.type,s.stateNode);else s.stateNode=Ub(v,f,s.memoizedProps);else _!==f?(_===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):_.count--,f===null?zb(v,s.type,s.stateNode):Ub(v,f,s.memoizedProps)):f===null&&s.stateNode!==null&&pm(s,s.memoizedProps,u.memoizedProps)}break;case 27:qn(a,s),$n(s),f&512&&(Qt||u===null||Es(u,u.return)),u!==null&&f&4&&pm(s,s.memoizedProps,u.memoizedProps);break;case 5:if(qn(a,s),$n(s),f&512&&(Qt||u===null||Es(u,u.return)),s.flags&32){v=s.stateNode;try{Gn(v,"")}catch(Re){bt(s,s.return,Re)}}f&4&&s.stateNode!=null&&(v=s.memoizedProps,pm(s,v,u!==null?u.memoizedProps:v)),f&1024&&(xm=!0);break;case 6:if(qn(a,s),$n(s),f&4){if(s.stateNode===null)throw Error(i(162));f=s.memoizedProps,u=s.stateNode;try{u.nodeValue=f}catch(Re){bt(s,s.return,Re)}}break;case 3:if(tf=null,v=qi,qi=Zd(a.containerInfo),qn(a,s),qi=v,$n(s),f&4&&u!==null&&u.memoizedState.isDehydrated)try{el(a.containerInfo)}catch(Re){bt(s,s.return,Re)}xm&&(xm=!1,zv(s));break;case 4:f=qi,qi=Zd(s.stateNode.containerInfo),qn(a,s),$n(s),qi=f;break;case 12:qn(a,s),$n(s);break;case 31:qn(a,s),$n(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Vd(s,f)));break;case 13:qn(a,s),$n(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Hd=Ln()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Vd(s,f)));break;case 22:v=s.memoizedState!==null;var W=u!==null&&u.memoizedState!==null,oe=Xs,me=Qt;if(Xs=oe||v,Qt=me||W,qn(a,s),Qt=me,Xs=oe,$n(s),f&8192)e:for(a=s.stateNode,a._visibility=v?a._visibility&-2:a._visibility|1,v&&(u===null||W||Xs||Qt||qo(s)),u=null,a=s;;){if(a.tag===5||a.tag===26){if(u===null){W=u=a;try{if(_=W.stateNode,v)N=_.style,typeof N.setProperty=="function"?N.setProperty("display","none","important"):N.display="none";else{V=W.stateNode;var xe=W.memoizedProps.style,ce=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;V.style.display=ce==null||typeof ce=="boolean"?"":(""+ce).trim()}}catch(Re){bt(W,W.return,Re)}}}else if(a.tag===6){if(u===null){W=a;try{W.stateNode.nodeValue=v?"":W.memoizedProps}catch(Re){bt(W,W.return,Re)}}}else if(a.tag===18){if(u===null){W=a;try{var fe=W.stateNode;v?Ab(fe,!0):Ab(W.stateNode,!1)}catch(Re){bt(W,W.return,Re)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===s)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}f&4&&(f=s.updateQueue,f!==null&&(u=f.retryQueue,u!==null&&(f.retryQueue=null,Vd(s,u))));break;case 19:qn(a,s),$n(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Vd(s,f)));break;case 30:break;case 21:break;default:qn(a,s),$n(s)}}function $n(s){var a=s.flags;if(a&2){try{for(var u,f=s.return;f!==null;){if(Rv(f)){u=f;break}f=f.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var v=u.stateNode,_=mm(s);Ud(s,_,v);break;case 5:var N=u.stateNode;u.flags&32&&(Gn(N,""),u.flags&=-33);var V=mm(s);Ud(s,V,N);break;case 3:case 4:var W=u.stateNode.containerInfo,oe=mm(s);gm(s,oe,W);break;default:throw Error(i(161))}}catch(me){bt(s,s.return,me)}s.flags&=-3}a&4096&&(s.flags&=-4097)}function zv(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var a=s;zv(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),s=s.sibling}}function Qs(s,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)Mv(s,a.alternate,a),a=a.sibling}function qo(s){for(s=s.child;s!==null;){var a=s;switch(a.tag){case 0:case 11:case 14:case 15:Pr(4,a,a.return),qo(a);break;case 1:Es(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&Av(a,a.return,u),qo(a);break;case 27:Lc(a.stateNode);case 26:case 5:Es(a,a.return),qo(a);break;case 22:a.memoizedState===null&&qo(a);break;case 30:qo(a);break;default:qo(a)}s=s.sibling}}function Zs(s,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var f=a.alternate,v=s,_=a,N=_.flags;switch(_.tag){case 0:case 11:case 15:Zs(v,_,u),Nc(4,_);break;case 1:if(Zs(v,_,u),f=_,v=f.stateNode,typeof v.componentDidMount=="function")try{v.componentDidMount()}catch(oe){bt(f,f.return,oe)}if(f=_,v=f.updateQueue,v!==null){var V=f.stateNode;try{var W=v.shared.hiddenCallbacks;if(W!==null)for(v.shared.hiddenCallbacks=null,v=0;v<W.length;v++)xy(W[v],V)}catch(oe){bt(f,f.return,oe)}}u&&N&64&&kv(_),Cc(_,_.return);break;case 27:jv(_);case 26:case 5:Zs(v,_,u),u&&f===null&&N&4&&Iv(_),Cc(_,_.return);break;case 12:Zs(v,_,u);break;case 31:Zs(v,_,u),u&&N&4&&Ov(v,_);break;case 13:Zs(v,_,u),u&&N&4&&Uv(v,_);break;case 22:_.memoizedState===null&&Zs(v,_,u),Cc(_,_.return);break;case 30:break;default:Zs(v,_,u)}a=a.sibling}}function ym(s,a){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(s=a.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&hc(u))}function vm(s,a){s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&hc(s))}function $i(s,a,u,f){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Hv(s,a,u,f),a=a.sibling}function Hv(s,a,u,f){var v=a.flags;switch(a.tag){case 0:case 11:case 15:$i(s,a,u,f),v&2048&&Nc(9,a);break;case 1:$i(s,a,u,f);break;case 3:$i(s,a,u,f),v&2048&&(s=null,a.alternate!==null&&(s=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==s&&(a.refCount++,s!=null&&hc(s)));break;case 12:if(v&2048){$i(s,a,u,f),s=a.stateNode;try{var _=a.memoizedProps,N=_.id,V=_.onPostCommit;typeof V=="function"&&V(N,a.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(W){bt(a,a.return,W)}}else $i(s,a,u,f);break;case 31:$i(s,a,u,f);break;case 13:$i(s,a,u,f);break;case 23:break;case 22:_=a.stateNode,N=a.alternate,a.memoizedState!==null?_._visibility&2?$i(s,a,u,f):kc(s,a):_._visibility&2?$i(s,a,u,f):(_._visibility|=2,Ga(s,a,u,f,(a.subtreeFlags&10256)!==0||!1)),v&2048&&ym(N,a);break;case 24:$i(s,a,u,f),v&2048&&vm(a.alternate,a);break;default:$i(s,a,u,f)}}function Ga(s,a,u,f,v){for(v=v&&((a.subtreeFlags&10256)!==0||!1),a=a.child;a!==null;){var _=s,N=a,V=u,W=f,oe=N.flags;switch(N.tag){case 0:case 11:case 15:Ga(_,N,V,W,v),Nc(8,N);break;case 23:break;case 22:var me=N.stateNode;N.memoizedState!==null?me._visibility&2?Ga(_,N,V,W,v):kc(_,N):(me._visibility|=2,Ga(_,N,V,W,v)),v&&oe&2048&&ym(N.alternate,N);break;case 24:Ga(_,N,V,W,v),v&&oe&2048&&vm(N.alternate,N);break;default:Ga(_,N,V,W,v)}a=a.sibling}}function kc(s,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=s,f=a,v=f.flags;switch(f.tag){case 22:kc(u,f),v&2048&&ym(f.alternate,f);break;case 24:kc(u,f),v&2048&&vm(f.alternate,f);break;default:kc(u,f)}a=a.sibling}}var Ac=8192;function Ba(s,a,u){if(s.subtreeFlags&Ac)for(s=s.child;s!==null;)Fv(s,a,u),s=s.sibling}function Fv(s,a,u){switch(s.tag){case 26:Ba(s,a,u),s.flags&Ac&&s.memoizedState!==null&&ek(u,qi,s.memoizedState,s.memoizedProps);break;case 5:Ba(s,a,u);break;case 3:case 4:var f=qi;qi=Zd(s.stateNode.containerInfo),Ba(s,a,u),qi=f;break;case 22:s.memoizedState===null&&(f=s.alternate,f!==null&&f.memoizedState!==null?(f=Ac,Ac=16777216,Ba(s,a,u),Ac=f):Ba(s,a,u));break;default:Ba(s,a,u)}}function Gv(s){var a=s.alternate;if(a!==null&&(s=a.child,s!==null)){a.child=null;do a=s.sibling,s.sibling=null,s=a;while(s!==null)}}function Ic(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var f=a[u];dn=f,qv(f,s)}Gv(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Bv(s),s=s.sibling}function Bv(s){switch(s.tag){case 0:case 11:case 15:Ic(s),s.flags&2048&&Pr(9,s,s.return);break;case 3:Ic(s);break;case 12:Ic(s);break;case 22:var a=s.stateNode;s.memoizedState!==null&&a._visibility&2&&(s.return===null||s.return.tag!==13)?(a._visibility&=-3,zd(s)):Ic(s);break;default:Ic(s)}}function zd(s){var a=s.deletions;if((s.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var f=a[u];dn=f,qv(f,s)}Gv(s)}for(s=s.child;s!==null;){switch(a=s,a.tag){case 0:case 11:case 15:Pr(8,a,a.return),zd(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,zd(a));break;default:zd(a)}s=s.sibling}}function qv(s,a){for(;dn!==null;){var u=dn;switch(u.tag){case 0:case 11:case 15:Pr(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var f=u.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:hc(u.memoizedState.cache)}if(f=u.child,f!==null)f.return=u,dn=f;else e:for(u=s;dn!==null;){f=dn;var v=f.sibling,_=f.return;if(Pv(f),f===u){dn=null;break e}if(v!==null){v.return=_,dn=v;break e}dn=_}}}var mC={getCacheForType:function(s){var a=_n(Kt),u=a.data.get(s);return u===void 0&&(u=s(),a.data.set(s,u)),u},cacheSignal:function(){return _n(Kt).controller.signal}},gC=typeof WeakMap=="function"?WeakMap:Map,pt=0,Et=null,Qe=null,tt=0,vt=0,ai=null,Lr=!1,qa=!1,bm=!1,er=0,Ut=0,Or=0,$o=0,_m=0,li=0,$a=0,Rc=null,Yn=null,Tm=!1,Hd=0,$v=0,Fd=1/0,Gd=null,Ur=null,rn=0,Vr=null,Ya=null,tr=0,Sm=0,wm=null,Yv=null,jc=0,Em=null;function ci(){return(pt&2)!==0&&tt!==0?tt&-tt:U.T!==null?Rm():Bu()}function Jv(){if(li===0)if((tt&536870912)===0||ot){var s=vo;vo<<=1,(vo&3932160)===0&&(vo=262144),li=s}else li=536870912;return s=ri.current,s!==null&&(s.flags|=32),li}function Jn(s,a,u){(s===Et&&(vt===2||vt===9)||s.cancelPendingCommit!==null)&&(Ja(s,0),zr(s,tt,li,!1)),bo(s,u),((pt&2)===0||s!==Et)&&(s===Et&&((pt&2)===0&&($o|=u),Ut===4&&zr(s,tt,li,!1)),Ns(s))}function Kv(s,a,u){if((pt&6)!==0)throw Error(i(327));var f=!u&&(a&127)===0&&(a&s.expiredLanes)===0||Li(s,a),v=f?vC(s,a):Cm(s,a,!0),_=f;do{if(v===0){qa&&!f&&zr(s,a,0,!1);break}else{if(u=s.current.alternate,_&&!xC(u)){v=Cm(s,a,!1),_=!1;continue}if(v===2){if(_=a,s.errorRecoveryDisabledLanes&_)var N=0;else N=s.pendingLanes&-536870913,N=N!==0?N:N&536870912?536870912:0;if(N!==0){a=N;e:{var V=s;v=Rc;var W=V.current.memoizedState.isDehydrated;if(W&&(Ja(V,N).flags|=256),N=Cm(V,N,!1),N!==2){if(bm&&!W){V.errorRecoveryDisabledLanes|=_,$o|=_,v=4;break e}_=Yn,Yn=v,_!==null&&(Yn===null?Yn=_:Yn.push.apply(Yn,_))}v=N}if(_=!1,v!==2)continue}}if(v===1){Ja(s,0),zr(s,a,0,!0);break}e:{switch(f=s,_=v,_){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:zr(f,a,li,!Lr);break e;case 2:Yn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(v=Hd+300-Ln(),10<v)){if(zr(f,a,li,!Lr),ls(f,0,!0)!==0)break e;tr=a,f.timeoutHandle=Nb(Xv.bind(null,f,u,Yn,Gd,Tm,a,li,$o,$a,Lr,_,"Throttled",-0,0),v);break e}Xv(f,u,Yn,Gd,Tm,a,li,$o,$a,Lr,_,null,-0,0)}}break}while(!0);Ns(s)}function Xv(s,a,u,f,v,_,N,V,W,oe,me,xe,ce,fe){if(s.timeoutHandle=-1,xe=a.subtreeFlags,xe&8192||(xe&16785408)===16785408){xe={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Vi},Fv(a,_,xe);var Re=(_&62914560)===_?Hd-Ln():(_&4194048)===_?$v-Ln():0;if(Re=tk(xe,Re),Re!==null){tr=_,s.cancelPendingCommit=Re(sb.bind(null,s,a,_,u,f,v,N,V,W,me,xe,null,ce,fe)),zr(s,_,N,!oe);return}}sb(s,a,_,u,f,v,N,V,W)}function xC(s){for(var a=s;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var f=0;f<u.length;f++){var v=u[f],_=v.getSnapshot;v=v.value;try{if(!ii(_(),v))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===s)break;for(;a.sibling===null;){if(a.return===null||a.return===s)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function zr(s,a,u,f){a&=~_m,a&=~$o,s.suspendedLanes|=a,s.pingedLanes&=~a,f&&(s.warmLanes|=a),f=s.expirationTimes;for(var v=a;0<v;){var _=31-Vt(v),N=1<<_;f[_]=-1,v&=~N}u!==0&&_o(s,u,a)}function Bd(){return(pt&6)===0?(Dc(0),!1):!0}function Nm(){if(Qe!==null){if(vt===0)var s=Qe.return;else s=Qe,Bs=Oo=null,Fp(s),Ua=null,mc=0,s=Qe;for(;s!==null;)Cv(s.alternate,s),s=s.return;Qe=null}}function Ja(s,a){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,OC(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),tr=0,Nm(),Et=s,Qe=u=Fs(s.current,null),tt=a,vt=0,ai=null,Lr=!1,qa=Li(s,a),bm=!1,$a=li=_m=$o=Or=Ut=0,Yn=Rc=null,Tm=!1,(a&8)!==0&&(a|=a&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=a;0<f;){var v=31-Vt(f),_=1<<v;a|=s[v],f&=~_}return er=a,dd(),u}function Wv(s,a){Xe=null,U.H=Sc,a===Oa||a===vd?(a=hy(),vt=3):a===Ip?(a=hy(),vt=4):vt=a===sm?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,ai=a,Qe===null&&(Ut=1,Dd(s,Si(a,s.current)))}function Qv(){var s=ri.current;return s===null?!0:(tt&4194048)===tt?Ci===null:(tt&62914560)===tt||(tt&536870912)!==0?s===Ci:!1}function Zv(){var s=U.H;return U.H=Sc,s===null?Sc:s}function eb(){var s=U.A;return U.A=mC,s}function qd(){Ut=4,Lr||(tt&4194048)!==tt&&ri.current!==null||(qa=!0),(Or&134217727)===0&&($o&134217727)===0||Et===null||zr(Et,tt,li,!1)}function Cm(s,a,u){var f=pt;pt|=2;var v=Zv(),_=eb();(Et!==s||tt!==a)&&(Gd=null,Ja(s,a)),a=!1;var N=Ut;e:do try{if(vt!==0&&Qe!==null){var V=Qe,W=ai;switch(vt){case 8:Nm(),N=6;break e;case 3:case 2:case 9:case 6:ri.current===null&&(a=!0);var oe=vt;if(vt=0,ai=null,Ka(s,V,W,oe),u&&qa){N=0;break e}break;default:oe=vt,vt=0,ai=null,Ka(s,V,W,oe)}}yC(),N=Ut;break}catch(me){Wv(s,me)}while(!0);return a&&s.shellSuspendCounter++,Bs=Oo=null,pt=f,U.H=v,U.A=_,Qe===null&&(Et=null,tt=0,dd()),N}function yC(){for(;Qe!==null;)tb(Qe)}function vC(s,a){var u=pt;pt|=2;var f=Zv(),v=eb();Et!==s||tt!==a?(Gd=null,Fd=Ln()+500,Ja(s,a)):qa=Li(s,a);e:do try{if(vt!==0&&Qe!==null){a=Qe;var _=ai;t:switch(vt){case 1:vt=0,ai=null,Ka(s,a,_,1);break;case 2:case 9:if(dy(_)){vt=0,ai=null,nb(a);break}a=function(){vt!==2&&vt!==9||Et!==s||(vt=7),Ns(s)},_.then(a,a);break e;case 3:vt=7;break e;case 4:vt=5;break e;case 7:dy(_)?(vt=0,ai=null,nb(a)):(vt=0,ai=null,Ka(s,a,_,7));break;case 5:var N=null;switch(Qe.tag){case 26:N=Qe.memoizedState;case 5:case 27:var V=Qe;if(N?Hb(N):V.stateNode.complete){vt=0,ai=null;var W=V.sibling;if(W!==null)Qe=W;else{var oe=V.return;oe!==null?(Qe=oe,$d(oe)):Qe=null}break t}}vt=0,ai=null,Ka(s,a,_,5);break;case 6:vt=0,ai=null,Ka(s,a,_,6);break;case 8:Nm(),Ut=6;break e;default:throw Error(i(462))}}bC();break}catch(me){Wv(s,me)}while(!0);return Bs=Oo=null,U.H=f,U.A=v,pt=u,Qe!==null?0:(Et=null,tt=0,dd(),Ut)}function bC(){for(;Qe!==null&&!xo();)tb(Qe)}function tb(s){var a=Ev(s.alternate,s,er);s.memoizedProps=s.pendingProps,a===null?$d(s):Qe=a}function nb(s){var a=s,u=a.alternate;switch(a.tag){case 15:case 0:a=vv(u,a,a.pendingProps,a.type,void 0,tt);break;case 11:a=vv(u,a,a.pendingProps,a.type.render,a.ref,tt);break;case 5:Fp(a);default:Cv(u,a),a=Qe=ey(a,er),a=Ev(u,a,er)}s.memoizedProps=s.pendingProps,a===null?$d(s):Qe=a}function Ka(s,a,u,f){Bs=Oo=null,Fp(a),Ua=null,mc=0;var v=a.return;try{if(lC(s,v,a,u,tt)){Ut=1,Dd(s,Si(u,s.current)),Qe=null;return}}catch(_){if(v!==null)throw Qe=v,_;Ut=1,Dd(s,Si(u,s.current)),Qe=null;return}a.flags&32768?(ot||f===1?s=!0:qa||(tt&536870912)!==0?s=!1:(Lr=s=!0,(f===2||f===9||f===3||f===6)&&(f=ri.current,f!==null&&f.tag===13&&(f.flags|=16384))),ib(a,s)):$d(a)}function $d(s){var a=s;do{if((a.flags&32768)!==0){ib(a,Lr);return}s=a.return;var u=dC(a.alternate,a,er);if(u!==null){Qe=u;return}if(a=a.sibling,a!==null){Qe=a;return}Qe=a=s}while(a!==null);Ut===0&&(Ut=5)}function ib(s,a){do{var u=fC(s.alternate,s);if(u!==null){u.flags&=32767,Qe=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(s=s.sibling,s!==null)){Qe=s;return}Qe=s=u}while(s!==null);Ut=6,Qe=null}function sb(s,a,u,f,v,_,N,V,W){s.cancelPendingCommit=null;do Yd();while(rn!==0);if((pt&6)!==0)throw Error(i(327));if(a!==null){if(a===s.current)throw Error(i(177));if(_=a.lanes|a.childLanes,_|=mp,op(s,u,_,N,V,W),s===Et&&(Qe=Et=null,tt=0),Ya=a,Vr=s,tr=u,Sm=_,wm=v,Yv=f,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,wC(gr,function(){return cb(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||f){f=U.T,U.T=null,v=Y.p,Y.p=2,N=pt,pt|=4;try{hC(s,a,u)}finally{pt=N,Y.p=v,U.T=f}}rn=1,rb(),ob(),ab()}}function rb(){if(rn===1){rn=0;var s=Vr,a=Ya,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=U.T,U.T=null;var f=Y.p;Y.p=2;var v=pt;pt|=4;try{Vv(a,s);var _=Vm,N=qx(s.containerInfo),V=_.focusedElem,W=_.selectionRange;if(N!==V&&V&&V.ownerDocument&&Bx(V.ownerDocument.documentElement,V)){if(W!==null&&up(V)){var oe=W.start,me=W.end;if(me===void 0&&(me=oe),"selectionStart"in V)V.selectionStart=oe,V.selectionEnd=Math.min(me,V.value.length);else{var xe=V.ownerDocument||document,ce=xe&&xe.defaultView||window;if(ce.getSelection){var fe=ce.getSelection(),Re=V.textContent.length,Ue=Math.min(W.start,Re),wt=W.end===void 0?Ue:Math.min(W.end,Re);!fe.extend&&Ue>wt&&(N=wt,wt=Ue,Ue=N);var ne=Gx(V,Ue),Z=Gx(V,wt);if(ne&&Z&&(fe.rangeCount!==1||fe.anchorNode!==ne.node||fe.anchorOffset!==ne.offset||fe.focusNode!==Z.node||fe.focusOffset!==Z.offset)){var re=xe.createRange();re.setStart(ne.node,ne.offset),fe.removeAllRanges(),Ue>wt?(fe.addRange(re),fe.extend(Z.node,Z.offset)):(re.setEnd(Z.node,Z.offset),fe.addRange(re))}}}}for(xe=[],fe=V;fe=fe.parentNode;)fe.nodeType===1&&xe.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof V.focus=="function"&&V.focus(),V=0;V<xe.length;V++){var ge=xe[V];ge.element.scrollLeft=ge.left,ge.element.scrollTop=ge.top}}of=!!Um,Vm=Um=null}finally{pt=v,Y.p=f,U.T=u}}s.current=a,rn=2}}function ob(){if(rn===2){rn=0;var s=Vr,a=Ya,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=U.T,U.T=null;var f=Y.p;Y.p=2;var v=pt;pt|=4;try{Mv(s,a.alternate,a)}finally{pt=v,Y.p=f,U.T=u}}rn=3}}function ab(){if(rn===4||rn===3){rn=0,Ou();var s=Vr,a=Ya,u=tr,f=Yv;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?rn=5:(rn=0,Ya=Vr=null,lb(s,s.pendingLanes));var v=s.pendingLanes;if(v===0&&(Ur=null),Us(u),a=a.stateNode,yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(Pi,a,void 0,(a.current.flags&128)===128)}catch{}if(f!==null){a=U.T,v=Y.p,Y.p=2,U.T=null;try{for(var _=s.onRecoverableError,N=0;N<f.length;N++){var V=f[N];_(V.value,{componentStack:V.stack})}}finally{U.T=a,Y.p=v}}(tr&3)!==0&&Yd(),Ns(s),v=s.pendingLanes,(u&261930)!==0&&(v&42)!==0?s===Em?jc++:(jc=0,Em=s):jc=0,Dc(0)}}function lb(s,a){(s.pooledCacheLanes&=a)===0&&(a=s.pooledCache,a!=null&&(s.pooledCache=null,hc(a)))}function Yd(){return rb(),ob(),ab(),cb()}function cb(){if(rn!==5)return!1;var s=Vr,a=Sm;Sm=0;var u=Us(tr),f=U.T,v=Y.p;try{Y.p=32>u?32:u,U.T=null,u=wm,wm=null;var _=Vr,N=tr;if(rn=0,Ya=Vr=null,tr=0,(pt&6)!==0)throw Error(i(331));var V=pt;if(pt|=4,Bv(_.current),Hv(_,_.current,N,u),pt=V,Dc(0,!1),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(Pi,_)}catch{}return!0}finally{Y.p=v,U.T=f,lb(s,a)}}function ub(s,a,u){a=Si(u,a),a=im(s.stateNode,a,2),s=jr(s,a,2),s!==null&&(bo(s,2),Ns(s))}function bt(s,a,u){if(s.tag===3)ub(s,s,u);else for(;a!==null;){if(a.tag===3){ub(a,s,u);break}else if(a.tag===1){var f=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Ur===null||!Ur.has(f))){s=Si(u,s),u=dv(2),f=jr(a,u,2),f!==null&&(fv(u,f,a,s),bo(f,2),Ns(f));break}}a=a.return}}function km(s,a,u){var f=s.pingCache;if(f===null){f=s.pingCache=new gC;var v=new Set;f.set(a,v)}else v=f.get(a),v===void 0&&(v=new Set,f.set(a,v));v.has(u)||(bm=!0,v.add(u),s=_C.bind(null,s,a,u),a.then(s,s))}function _C(s,a,u){var f=s.pingCache;f!==null&&f.delete(a),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Et===s&&(tt&u)===u&&(Ut===4||Ut===3&&(tt&62914560)===tt&&300>Ln()-Hd?(pt&2)===0&&Ja(s,0):_m|=u,$a===tt&&($a=0)),Ns(s)}function db(s,a){a===0&&(a=Gu()),s=Mo(s,a),s!==null&&(bo(s,a),Ns(s))}function TC(s){var a=s.memoizedState,u=0;a!==null&&(u=a.retryLane),db(s,u)}function SC(s,a){var u=0;switch(s.tag){case 31:case 13:var f=s.stateNode,v=s.memoizedState;v!==null&&(u=v.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(a),db(s,u)}function wC(s,a){return He(s,a)}var Jd=null,Xa=null,Am=!1,Kd=!1,Im=!1,Hr=0;function Ns(s){s!==Xa&&s.next===null&&(Xa===null?Jd=Xa=s:Xa=Xa.next=s),Kd=!0,Am||(Am=!0,NC())}function Dc(s,a){if(!Im&&Kd){Im=!0;do for(var u=!1,f=Jd;f!==null;){if(s!==0){var v=f.pendingLanes;if(v===0)var _=0;else{var N=f.suspendedLanes,V=f.pingedLanes;_=(1<<31-Vt(42|s)+1)-1,_&=v&~(N&~V),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(u=!0,mb(f,_))}else _=tt,_=ls(f,f===Et?_:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(_&3)===0||Li(f,_)||(u=!0,mb(f,_));f=f.next}while(u);Im=!1}}function EC(){fb()}function fb(){Kd=Am=!1;var s=0;Hr!==0&&LC()&&(s=Hr);for(var a=Ln(),u=null,f=Jd;f!==null;){var v=f.next,_=hb(f,a);_===0?(f.next=null,u===null?Jd=v:u.next=v,v===null&&(Xa=u)):(u=f,(s!==0||(_&3)!==0)&&(Kd=!0)),f=v}rn!==0&&rn!==5||Dc(s),Hr!==0&&(Hr=0)}function hb(s,a){for(var u=s.suspendedLanes,f=s.pingedLanes,v=s.expirationTimes,_=s.pendingLanes&-62914561;0<_;){var N=31-Vt(_),V=1<<N,W=v[N];W===-1?((V&u)===0||(V&f)!==0)&&(v[N]=rp(V,a)):W<=a&&(s.expiredLanes|=V),_&=~V}if(a=Et,u=tt,u=ls(s,s===a?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,u===0||s===a&&(vt===2||vt===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&At(f),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Li(s,u)){if(a=u&-u,a===s.callbackPriority)return a;switch(f!==null&&At(f),Us(u)){case 2:case 8:u=Gl;break;case 32:u=gr;break;case 268435456:u=Uu;break;default:u=gr}return f=pb.bind(null,s),u=He(u,f),s.callbackPriority=a,s.callbackNode=u,a}return f!==null&&f!==null&&At(f),s.callbackPriority=2,s.callbackNode=null,2}function pb(s,a){if(rn!==0&&rn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(Yd()&&s.callbackNode!==u)return null;var f=tt;return f=ls(s,s===Et?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(Kv(s,f,a),hb(s,Ln()),s.callbackNode!=null&&s.callbackNode===u?pb.bind(null,s):null)}function mb(s,a){if(Yd())return null;Kv(s,a,!0)}function NC(){UC(function(){(pt&6)!==0?He(Fl,EC):fb()})}function Rm(){if(Hr===0){var s=Pa;s===0&&(s=os,os<<=1,(os&261888)===0&&(os=256)),Hr=s}return Hr}function gb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:ba(""+s)}function xb(s,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,s.id&&u.setAttribute("form",s.id),a.parentNode.insertBefore(u,a),s=new FormData(s),u.parentNode.removeChild(u),s}function CC(s,a,u,f,v){if(a==="submit"&&u&&u.stateNode===v){var _=gb((v[cn]||null).action),N=f.submitter;N&&(a=(a=N[cn]||null)?gb(a.formAction):N.getAttribute("formAction"),a!==null&&(_=a,N=null));var V=new vs("action","action",null,f,v);s.push({event:V,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Hr!==0){var W=N?xb(v,N):new FormData(v);Wp(u,{pending:!0,data:W,method:v.method,action:_},null,W)}}else typeof _=="function"&&(V.preventDefault(),W=N?xb(v,N):new FormData(v),Wp(u,{pending:!0,data:W,method:v.method,action:_},_,W))},currentTarget:v}]})}}for(var jm=0;jm<pp.length;jm++){var Dm=pp[jm],kC=Dm.toLowerCase(),AC=Dm[0].toUpperCase()+Dm.slice(1);Bi(kC,"on"+AC)}Bi(Jx,"onAnimationEnd"),Bi(Kx,"onAnimationIteration"),Bi(Xx,"onAnimationStart"),Bi("dblclick","onDoubleClick"),Bi("focusin","onFocus"),Bi("focusout","onBlur"),Bi(q2,"onTransitionRun"),Bi($2,"onTransitionStart"),Bi(Y2,"onTransitionCancel"),Bi(Wx,"onTransitionEnd"),ms("onMouseEnter",["mouseout","mouseover"]),ms("onMouseLeave",["mouseout","mouseover"]),ms("onPointerEnter",["pointerout","pointerover"]),ms("onPointerLeave",["pointerout","pointerover"]),ps("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ps("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ps("onBeforeInput",["compositionend","keypress","textInput","paste"]),ps("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ps("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Mc));function yb(s,a){a=(a&4)!==0;for(var u=0;u<s.length;u++){var f=s[u],v=f.event;f=f.listeners;e:{var _=void 0;if(a)for(var N=f.length-1;0<=N;N--){var V=f[N],W=V.instance,oe=V.currentTarget;if(V=V.listener,W!==_&&v.isPropagationStopped())break e;_=V,v.currentTarget=oe;try{_(v)}catch(me){ud(me)}v.currentTarget=null,_=W}else for(N=0;N<f.length;N++){if(V=f[N],W=V.instance,oe=V.currentTarget,V=V.listener,W!==_&&v.isPropagationStopped())break e;_=V,v.currentTarget=oe;try{_(v)}catch(me){ud(me)}v.currentTarget=null,_=W}}}}function Ze(s,a){var u=a[ma];u===void 0&&(u=a[ma]=new Set);var f=s+"__bubble";u.has(f)||(vb(a,s,2,!1),u.add(f))}function Mm(s,a,u){var f=0;a&&(f|=4),vb(u,s,f,a)}var Xd="_reactListening"+Math.random().toString(36).slice(2);function Pm(s){if(!s[Xd]){s[Xd]=!0,$l.forEach(function(u){u!=="selectionchange"&&(IC.has(u)||Mm(u,!1,s),Mm(u,!0,s))});var a=s.nodeType===9?s:s.ownerDocument;a===null||a[Xd]||(a[Xd]=!0,Mm("selectionchange",!1,a))}}function vb(s,a,u,f){switch(Jb(a)){case 2:var v=sk;break;case 8:v=rk;break;default:v=Xm}u=v.bind(null,a,u,s),v=void 0,!No||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(v=!0),f?v!==void 0?s.addEventListener(a,u,{capture:!0,passive:v}):s.addEventListener(a,u,!0):v!==void 0?s.addEventListener(a,u,{passive:v}):s.addEventListener(a,u,!1)}function Lm(s,a,u,f,v){var _=f;if((a&1)===0&&(a&2)===0&&f!==null)e:for(;;){if(f===null)return;var N=f.tag;if(N===3||N===4){var V=f.stateNode.containerInfo;if(V===v)break;if(N===4)for(N=f.return;N!==null;){var W=N.tag;if((W===3||W===4)&&N.stateNode.containerInfo===v)return;N=N.return}for(;V!==null;){if(N=fs(V),N===null)return;if(W=N.tag,W===5||W===6||W===26||W===27){f=_=N;continue e}V=V.parentNode}}f=f.return}Tr(function(){var oe=_,me=vi(u),xe=[];e:{var ce=Qx.get(s);if(ce!==void 0){var fe=vs,Re=s;switch(s){case"keypress":if(ko(u)===0)break e;case"keydown":case"keyup":fe=ad;break;case"focusin":Re="focus",fe=Io;break;case"focusout":Re="blur",fe=Io;break;case"beforeblur":case"afterblur":fe=Io;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=rc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=Qu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=w;break;case Jx:case Kx:case Xx:fe=ed;break;case Wx:fe=G;break;case"scroll":case"scrollend":fe=sc;break;case"wheel":fe=de;break;case"copy":case"cut":case"paste":fe=td;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Hs;break;case"toggle":case"beforetoggle":fe=Ke}var Ue=(a&4)!==0,wt=!Ue&&(s==="scroll"||s==="scrollend"),ne=Ue?ce!==null?ce+"Capture":null:ce;Ue=[];for(var Z=oe,re;Z!==null;){var ge=Z;if(re=ge.stateNode,ge=ge.tag,ge!==5&&ge!==26&&ge!==27||re===null||ne===null||(ge=zi(Z,ne),ge!=null&&Ue.push(Pc(Z,ge,re))),wt)break;Z=Z.return}0<Ue.length&&(ce=new fe(ce,Re,null,u,me),xe.push({event:ce,listeners:Ue}))}}if((a&7)===0){e:{if(ce=s==="mouseover"||s==="pointerover",fe=s==="mouseout"||s==="pointerout",ce&&u!==tc&&(Re=u.relatedTarget||u.fromElement)&&(fs(Re)||Re[us]))break e;if((fe||ce)&&(ce=me.window===me?me:(ce=me.ownerDocument)?ce.defaultView||ce.parentWindow:window,fe?(Re=u.relatedTarget||u.toElement,fe=oe,Re=Re?fs(Re):null,Re!==null&&(wt=l(Re),Ue=Re.tag,Re!==wt||Ue!==5&&Ue!==27&&Ue!==6)&&(Re=null)):(fe=null,Re=oe),fe!==Re)){if(Ue=rc,ge="onMouseLeave",ne="onMouseEnter",Z="mouse",(s==="pointerout"||s==="pointerover")&&(Ue=Hs,ge="onPointerLeave",ne="onPointerEnter",Z="pointer"),wt=fe==null?ce:ti(fe),re=Re==null?ce:ti(Re),ce=new Ue(ge,Z+"leave",fe,u,me),ce.target=wt,ce.relatedTarget=re,ge=null,fs(me)===oe&&(Ue=new Ue(ne,Z+"enter",Re,u,me),Ue.target=re,Ue.relatedTarget=wt,ge=Ue),wt=ge,fe&&Re)t:{for(Ue=RC,ne=fe,Z=Re,re=0,ge=ne;ge;ge=Ue(ge))re++;ge=0;for(var Le=Z;Le;Le=Ue(Le))ge++;for(;0<re-ge;)ne=Ue(ne),re--;for(;0<ge-re;)Z=Ue(Z),ge--;for(;re--;){if(ne===Z||Z!==null&&ne===Z.alternate){Ue=ne;break t}ne=Ue(ne),Z=Ue(Z)}Ue=null}else Ue=null;fe!==null&&bb(xe,ce,fe,Ue,!1),Re!==null&&wt!==null&&bb(xe,wt,Re,Ue,!0)}}e:{if(ce=oe?ti(oe):window,fe=ce.nodeName&&ce.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ce.type==="file")var lt=Ox;else if(Px(ce))if(Ux)lt=F2;else{lt=z2;var je=V2}else fe=ce.nodeName,!fe||fe.toLowerCase()!=="input"||ce.type!=="checkbox"&&ce.type!=="radio"?oe&&va(oe.elementType)&&(lt=Ox):lt=H2;if(lt&&(lt=lt(s,oe))){Lx(xe,lt,u,me);break e}je&&je(s,ce,oe),s==="focusout"&&oe&&ce.type==="number"&&oe.memoizedProps.value!=null&&Ql(ce,"number",ce.value)}switch(je=oe?ti(oe):window,s){case"focusin":(Px(je)||je.contentEditable==="true")&&(Ca=je,dp=oe,uc=null);break;case"focusout":uc=dp=Ca=null;break;case"mousedown":fp=!0;break;case"contextmenu":case"mouseup":case"dragend":fp=!1,$x(xe,u,me);break;case"selectionchange":if(B2)break;case"keydown":case"keyup":$x(xe,u,me)}var We;if(ht)e:{switch(s){case"compositionstart":var nt="onCompositionStart";break e;case"compositionend":nt="onCompositionEnd";break e;case"compositionupdate":nt="onCompositionUpdate";break e}nt=void 0}else Na?Ro(s,u)&&(nt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(nt="onCompositionStart");nt&&(Ts&&u.locale!=="ko"&&(Na||nt!=="onCompositionStart"?nt==="onCompositionEnd"&&Na&&(We=ic()):(ys=me,nc="value"in ys?ys.value:ys.textContent,Na=!0)),je=Wd(oe,nt),0<je.length&&(nt=new _s(nt,s,null,u,me),xe.push({event:nt,listeners:je}),We?nt.data=We:(We=Ea(u),We!==null&&(nt.data=We)))),(We=_i?P2(s,u):L2(s,u))&&(nt=Wd(oe,"onBeforeInput"),0<nt.length&&(je=new _s("onBeforeInput","beforeinput",null,u,me),xe.push({event:je,listeners:nt}),je.data=We)),CC(xe,s,oe,u,me)}yb(xe,a)})}function Pc(s,a,u){return{instance:s,listener:a,currentTarget:u}}function Wd(s,a){for(var u=a+"Capture",f=[];s!==null;){var v=s,_=v.stateNode;if(v=v.tag,v!==5&&v!==26&&v!==27||_===null||(v=zi(s,u),v!=null&&f.unshift(Pc(s,v,_)),v=zi(s,a),v!=null&&f.push(Pc(s,v,_))),s.tag===3)return f;s=s.return}return[]}function RC(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function bb(s,a,u,f,v){for(var _=a._reactName,N=[];u!==null&&u!==f;){var V=u,W=V.alternate,oe=V.stateNode;if(V=V.tag,W!==null&&W===f)break;V!==5&&V!==26&&V!==27||oe===null||(W=oe,v?(oe=zi(u,_),oe!=null&&N.unshift(Pc(u,oe,W))):v||(oe=zi(u,_),oe!=null&&N.push(Pc(u,oe,W)))),u=u.return}N.length!==0&&s.push({event:a,listeners:N})}var jC=/\r\n?/g,DC=/\u0000|\uFFFD/g;function _b(s){return(typeof s=="string"?s:""+s).replace(jC,`
`).replace(DC,"")}function Tb(s,a){return a=_b(a),_b(s)===a}function St(s,a,u,f,v,_){switch(u){case"children":typeof f=="string"?a==="body"||a==="textarea"&&f===""||Gn(s,f):(typeof f=="number"||typeof f=="bigint")&&a!=="body"&&Gn(s,""+f);break;case"className":ni(s,"class",f);break;case"tabIndex":ni(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":ni(s,u,f);break;case"style":ec(s,f,_);break;case"data":if(a!=="object"){ni(s,"data",f);break}case"src":case"href":if(f===""&&(a!=="a"||u!=="href")){s.removeAttribute(u);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(u);break}f=ba(""+f),s.setAttribute(u,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(u==="formAction"?(a!=="input"&&St(s,a,"name",v.name,v,null),St(s,a,"formEncType",v.formEncType,v,null),St(s,a,"formMethod",v.formMethod,v,null),St(s,a,"formTarget",v.formTarget,v,null)):(St(s,a,"encType",v.encType,v,null),St(s,a,"method",v.method,v,null),St(s,a,"target",v.target,v,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(u);break}f=ba(""+f),s.setAttribute(u,f);break;case"onClick":f!=null&&(s.onclick=Vi);break;case"onScroll":f!=null&&Ze("scroll",s);break;case"onScrollEnd":f!=null&&Ze("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(u=f.__html,u!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}u=ba(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(u,""+f):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":f===!0?s.setAttribute(u,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(u,f):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(u,f):s.removeAttribute(u);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(u):s.setAttribute(u,f);break;case"popover":Ze("beforetoggle",s),Ze("toggle",s),xa(s,"popover",f);break;case"xlinkActuate":Jt(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Jt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Jt(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Jt(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Jt(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Jt(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Jt(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":xa(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Wu.get(u)||u,xa(s,u,f))}}function Om(s,a,u,f,v,_){switch(u){case"style":ec(s,f,_);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(u=f.__html,u!=null){if(v.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"children":typeof f=="string"?Gn(s,f):(typeof f=="number"||typeof f=="bigint")&&Gn(s,""+f);break;case"onScroll":f!=null&&Ze("scroll",s);break;case"onScrollEnd":f!=null&&Ze("scrollend",s);break;case"onClick":f!=null&&(s.onclick=Vi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Yl.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(v=u.endsWith("Capture"),a=u.slice(2,v?u.length-7:void 0),_=s[cn]||null,_=_!=null?_[u]:null,typeof _=="function"&&s.removeEventListener(a,_,v),typeof f=="function")){typeof _!="function"&&_!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(a,f,v);break e}u in s?s[u]=f:f===!0?s.setAttribute(u,""):xa(s,u,f)}}}function Sn(s,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ze("error",s),Ze("load",s);var f=!1,v=!1,_;for(_ in u)if(u.hasOwnProperty(_)){var N=u[_];if(N!=null)switch(_){case"src":f=!0;break;case"srcSet":v=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:St(s,a,_,N,u,null)}}v&&St(s,a,"srcSet",u.srcSet,u,null),f&&St(s,a,"src",u.src,u,null);return;case"input":Ze("invalid",s);var V=_=N=v=null,W=null,oe=null;for(f in u)if(u.hasOwnProperty(f)){var me=u[f];if(me!=null)switch(f){case"name":v=me;break;case"type":N=me;break;case"checked":W=me;break;case"defaultChecked":oe=me;break;case"value":_=me;break;case"defaultValue":V=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(i(137,a));break;default:St(s,a,f,me,u,null)}}Ju(s,_,V,W,oe,N,v,!1);return;case"select":Ze("invalid",s),f=N=_=null;for(v in u)if(u.hasOwnProperty(v)&&(V=u[v],V!=null))switch(v){case"value":_=V;break;case"defaultValue":N=V;break;case"multiple":f=V;default:St(s,a,v,V,u,null)}a=_,u=N,s.multiple=!!f,a!=null?yr(s,!!f,a,!1):u!=null&&yr(s,!!f,u,!0);return;case"textarea":Ze("invalid",s),_=v=f=null;for(N in u)if(u.hasOwnProperty(N)&&(V=u[N],V!=null))switch(N){case"value":f=V;break;case"defaultValue":v=V;break;case"children":_=V;break;case"dangerouslySetInnerHTML":if(V!=null)throw Error(i(91));break;default:St(s,a,N,V,u,null)}vr(s,f,v,_);return;case"option":for(W in u)if(u.hasOwnProperty(W)&&(f=u[W],f!=null))switch(W){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:St(s,a,W,f,u,null)}return;case"dialog":Ze("beforetoggle",s),Ze("toggle",s),Ze("cancel",s),Ze("close",s);break;case"iframe":case"object":Ze("load",s);break;case"video":case"audio":for(f=0;f<Mc.length;f++)Ze(Mc[f],s);break;case"image":Ze("error",s),Ze("load",s);break;case"details":Ze("toggle",s);break;case"embed":case"source":case"link":Ze("error",s),Ze("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(oe in u)if(u.hasOwnProperty(oe)&&(f=u[oe],f!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:St(s,a,oe,f,u,null)}return;default:if(va(a)){for(me in u)u.hasOwnProperty(me)&&(f=u[me],f!==void 0&&Om(s,a,me,f,u,void 0));return}}for(V in u)u.hasOwnProperty(V)&&(f=u[V],f!=null&&St(s,a,V,f,u,null))}function MC(s,a,u,f){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var v=null,_=null,N=null,V=null,W=null,oe=null,me=null;for(fe in u){var xe=u[fe];if(u.hasOwnProperty(fe)&&xe!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":W=xe;default:f.hasOwnProperty(fe)||St(s,a,fe,null,f,xe)}}for(var ce in f){var fe=f[ce];if(xe=u[ce],f.hasOwnProperty(ce)&&(fe!=null||xe!=null))switch(ce){case"type":_=fe;break;case"name":v=fe;break;case"checked":oe=fe;break;case"defaultChecked":me=fe;break;case"value":N=fe;break;case"defaultValue":V=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(i(137,a));break;default:fe!==xe&&St(s,a,ce,fe,f,xe)}}ya(s,N,V,W,oe,me,_,v);return;case"select":fe=N=V=ce=null;for(_ in u)if(W=u[_],u.hasOwnProperty(_)&&W!=null)switch(_){case"value":break;case"multiple":fe=W;default:f.hasOwnProperty(_)||St(s,a,_,null,f,W)}for(v in f)if(_=f[v],W=u[v],f.hasOwnProperty(v)&&(_!=null||W!=null))switch(v){case"value":ce=_;break;case"defaultValue":V=_;break;case"multiple":N=_;default:_!==W&&St(s,a,v,_,f,W)}a=V,u=N,f=fe,ce!=null?yr(s,!!u,ce,!1):!!f!=!!u&&(a!=null?yr(s,!!u,a,!0):yr(s,!!u,u?[]:"",!1));return;case"textarea":fe=ce=null;for(V in u)if(v=u[V],u.hasOwnProperty(V)&&v!=null&&!f.hasOwnProperty(V))switch(V){case"value":break;case"children":break;default:St(s,a,V,null,f,v)}for(N in f)if(v=f[N],_=u[N],f.hasOwnProperty(N)&&(v!=null||_!=null))switch(N){case"value":ce=v;break;case"defaultValue":fe=v;break;case"children":break;case"dangerouslySetInnerHTML":if(v!=null)throw Error(i(91));break;default:v!==_&&St(s,a,N,v,f,_)}Ku(s,ce,fe);return;case"option":for(var Re in u)if(ce=u[Re],u.hasOwnProperty(Re)&&ce!=null&&!f.hasOwnProperty(Re))switch(Re){case"selected":s.selected=!1;break;default:St(s,a,Re,null,f,ce)}for(W in f)if(ce=f[W],fe=u[W],f.hasOwnProperty(W)&&ce!==fe&&(ce!=null||fe!=null))switch(W){case"selected":s.selected=ce&&typeof ce!="function"&&typeof ce!="symbol";break;default:St(s,a,W,ce,f,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ue in u)ce=u[Ue],u.hasOwnProperty(Ue)&&ce!=null&&!f.hasOwnProperty(Ue)&&St(s,a,Ue,null,f,ce);for(oe in f)if(ce=f[oe],fe=u[oe],f.hasOwnProperty(oe)&&ce!==fe&&(ce!=null||fe!=null))switch(oe){case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(i(137,a));break;default:St(s,a,oe,ce,f,fe)}return;default:if(va(a)){for(var wt in u)ce=u[wt],u.hasOwnProperty(wt)&&ce!==void 0&&!f.hasOwnProperty(wt)&&Om(s,a,wt,void 0,f,ce);for(me in f)ce=f[me],fe=u[me],!f.hasOwnProperty(me)||ce===fe||ce===void 0&&fe===void 0||Om(s,a,me,ce,f,fe);return}}for(var ne in u)ce=u[ne],u.hasOwnProperty(ne)&&ce!=null&&!f.hasOwnProperty(ne)&&St(s,a,ne,null,f,ce);for(xe in f)ce=f[xe],fe=u[xe],!f.hasOwnProperty(xe)||ce===fe||ce==null&&fe==null||St(s,a,xe,ce,f,fe)}function Sb(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function PC(){if(typeof performance.getEntriesByType=="function"){for(var s=0,a=0,u=performance.getEntriesByType("resource"),f=0;f<u.length;f++){var v=u[f],_=v.transferSize,N=v.initiatorType,V=v.duration;if(_&&V&&Sb(N)){for(N=0,V=v.responseEnd,f+=1;f<u.length;f++){var W=u[f],oe=W.startTime;if(oe>V)break;var me=W.transferSize,xe=W.initiatorType;me&&Sb(xe)&&(W=W.responseEnd,N+=me*(W<V?1:(V-oe)/(W-oe)))}if(--f,a+=8*(_+N)/(v.duration/1e3),s++,10<s)break}}if(0<s)return a/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Um=null,Vm=null;function Qd(s){return s.nodeType===9?s:s.ownerDocument}function wb(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Eb(s,a){if(s===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&a==="foreignObject"?0:s}function zm(s,a){return s==="textarea"||s==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Hm=null;function LC(){var s=window.event;return s&&s.type==="popstate"?s===Hm?!1:(Hm=s,!0):(Hm=null,!1)}var Nb=typeof setTimeout=="function"?setTimeout:void 0,OC=typeof clearTimeout=="function"?clearTimeout:void 0,Cb=typeof Promise=="function"?Promise:void 0,UC=typeof queueMicrotask=="function"?queueMicrotask:typeof Cb<"u"?function(s){return Cb.resolve(null).then(s).catch(VC)}:Nb;function VC(s){setTimeout(function(){throw s})}function Fr(s){return s==="head"}function kb(s,a){var u=a,f=0;do{var v=u.nextSibling;if(s.removeChild(u),v&&v.nodeType===8)if(u=v.data,u==="/$"||u==="/&"){if(f===0){s.removeChild(v),el(a);return}f--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")f++;else if(u==="html")Lc(s.ownerDocument.documentElement);else if(u==="head"){u=s.ownerDocument.head,Lc(u);for(var _=u.firstChild;_;){var N=_.nextSibling,V=_.nodeName;_[ds]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&_.rel.toLowerCase()==="stylesheet"||u.removeChild(_),_=N}}else u==="body"&&Lc(s.ownerDocument.body);u=v}while(u);el(a)}function Ab(s,a){var u=s;s=0;do{var f=u.nextSibling;if(u.nodeType===1?a?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(a?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),f&&f.nodeType===8)if(u=f.data,u==="/$"){if(s===0)break;s--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||s++;u=f}while(u)}function Fm(s){var a=s.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Fm(u),ga(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function zC(s,a,u,f){for(;s.nodeType===1;){var v=u;if(s.nodeName.toLowerCase()!==a.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[ds])switch(a){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(_=s.getAttribute("rel"),_==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(_!==v.rel||s.getAttribute("href")!==(v.href==null||v.href===""?null:v.href)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin)||s.getAttribute("title")!==(v.title==null?null:v.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(_=s.getAttribute("src"),(_!==(v.src==null?null:v.src)||s.getAttribute("type")!==(v.type==null?null:v.type)||s.getAttribute("crossorigin")!==(v.crossOrigin==null?null:v.crossOrigin))&&_&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(a==="input"&&s.type==="hidden"){var _=v.name==null?null:""+v.name;if(v.type==="hidden"&&s.getAttribute("name")===_)return s}else return s;if(s=ki(s.nextSibling),s===null)break}return null}function HC(s,a,u){if(a==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=ki(s.nextSibling),s===null))return null;return s}function Ib(s,a){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!a||(s=ki(s.nextSibling),s===null))return null;return s}function Gm(s){return s.data==="$?"||s.data==="$~"}function Bm(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function FC(s,a){var u=s.ownerDocument;if(s.data==="$~")s._reactRetry=a;else if(s.data!=="$?"||u.readyState!=="loading")a();else{var f=function(){a(),u.removeEventListener("DOMContentLoaded",f)};u.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function ki(s){for(;s!=null;s=s.nextSibling){var a=s.nodeType;if(a===1||a===3)break;if(a===8){if(a=s.data,a==="$"||a==="$!"||a==="$?"||a==="$~"||a==="&"||a==="F!"||a==="F")break;if(a==="/$"||a==="/&")return null}}return s}var qm=null;function Rb(s){s=s.nextSibling;for(var a=0;s;){if(s.nodeType===8){var u=s.data;if(u==="/$"||u==="/&"){if(a===0)return ki(s.nextSibling);a--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||a++}s=s.nextSibling}return null}function jb(s){s=s.previousSibling;for(var a=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(a===0)return s;a--}else u!=="/$"&&u!=="/&"||a++}s=s.previousSibling}return null}function Db(s,a,u){switch(a=Qd(u),s){case"html":if(s=a.documentElement,!s)throw Error(i(452));return s;case"head":if(s=a.head,!s)throw Error(i(453));return s;case"body":if(s=a.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function Lc(s){for(var a=s.attributes;a.length;)s.removeAttributeNode(a[0]);ga(s)}var Ai=new Map,Mb=new Set;function Zd(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var nr=Y.d;Y.d={f:GC,r:BC,D:qC,C:$C,L:YC,m:JC,X:XC,S:KC,M:WC};function GC(){var s=nr.f(),a=Bd();return s||a}function BC(s){var a=yi(s);a!==null&&a.tag===5&&a.type==="form"?Wy(a):nr.r(s)}var Wa=typeof document>"u"?null:document;function Pb(s,a,u){var f=Wa;if(f&&typeof a=="string"&&a){var v=Fn(a);v='link[rel="'+s+'"][href="'+v+'"]',typeof u=="string"&&(v+='[crossorigin="'+u+'"]'),Mb.has(v)||(Mb.add(v),s={rel:s,crossOrigin:u,href:a},f.querySelector(v)===null&&(a=f.createElement("link"),Sn(a,"link",s),Yt(a),f.head.appendChild(a)))}}function qC(s){nr.D(s),Pb("dns-prefetch",s,null)}function $C(s,a){nr.C(s,a),Pb("preconnect",s,a)}function YC(s,a,u){nr.L(s,a,u);var f=Wa;if(f&&s&&a){var v='link[rel="preload"][as="'+Fn(a)+'"]';a==="image"&&u&&u.imageSrcSet?(v+='[imagesrcset="'+Fn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(v+='[imagesizes="'+Fn(u.imageSizes)+'"]')):v+='[href="'+Fn(s)+'"]';var _=v;switch(a){case"style":_=Qa(s);break;case"script":_=Za(s)}Ai.has(_)||(s=b({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:s,as:a},u),Ai.set(_,s),f.querySelector(v)!==null||a==="style"&&f.querySelector(Oc(_))||a==="script"&&f.querySelector(Uc(_))||(a=f.createElement("link"),Sn(a,"link",s),Yt(a),f.head.appendChild(a)))}}function JC(s,a){nr.m(s,a);var u=Wa;if(u&&s){var f=a&&typeof a.as=="string"?a.as:"script",v='link[rel="modulepreload"][as="'+Fn(f)+'"][href="'+Fn(s)+'"]',_=v;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Za(s)}if(!Ai.has(_)&&(s=b({rel:"modulepreload",href:s},a),Ai.set(_,s),u.querySelector(v)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Uc(_)))return}f=u.createElement("link"),Sn(f,"link",s),Yt(f),u.head.appendChild(f)}}}function KC(s,a,u){nr.S(s,a,u);var f=Wa;if(f&&s){var v=hs(f).hoistableStyles,_=Qa(s);a=a||"default";var N=v.get(_);if(!N){var V={loading:0,preload:null};if(N=f.querySelector(Oc(_)))V.loading=5;else{s=b({rel:"stylesheet",href:s,"data-precedence":a},u),(u=Ai.get(_))&&$m(s,u);var W=N=f.createElement("link");Yt(W),Sn(W,"link",s),W._p=new Promise(function(oe,me){W.onload=oe,W.onerror=me}),W.addEventListener("load",function(){V.loading|=1}),W.addEventListener("error",function(){V.loading|=2}),V.loading|=4,ef(N,a,f)}N={type:"stylesheet",instance:N,count:1,state:V},v.set(_,N)}}}function XC(s,a){nr.X(s,a);var u=Wa;if(u&&s){var f=hs(u).hoistableScripts,v=Za(s),_=f.get(v);_||(_=u.querySelector(Uc(v)),_||(s=b({src:s,async:!0},a),(a=Ai.get(v))&&Ym(s,a),_=u.createElement("script"),Yt(_),Sn(_,"link",s),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},f.set(v,_))}}function WC(s,a){nr.M(s,a);var u=Wa;if(u&&s){var f=hs(u).hoistableScripts,v=Za(s),_=f.get(v);_||(_=u.querySelector(Uc(v)),_||(s=b({src:s,async:!0,type:"module"},a),(a=Ai.get(v))&&Ym(s,a),_=u.createElement("script"),Yt(_),Sn(_,"link",s),u.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},f.set(v,_))}}function Lb(s,a,u,f){var v=(v=ye.current)?Zd(v):null;if(!v)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=Qa(u.href),u=hs(v).hoistableStyles,f=u.get(a),f||(f={type:"style",instance:null,count:0,state:null},u.set(a,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Qa(u.href);var _=hs(v).hoistableStyles,N=_.get(s);if(N||(v=v.ownerDocument||v,N={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(s,N),(_=v.querySelector(Oc(s)))&&!_._p&&(N.instance=_,N.state.loading=5),Ai.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Ai.set(s,u),_||QC(v,s,u,N.state))),a&&f===null)throw Error(i(528,""));return N}if(a&&f!==null)throw Error(i(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=Za(u),u=hs(v).hoistableScripts,f=u.get(a),f||(f={type:"script",instance:null,count:0,state:null},u.set(a,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Qa(s){return'href="'+Fn(s)+'"'}function Oc(s){return'link[rel="stylesheet"]['+s+"]"}function Ob(s){return b({},s,{"data-precedence":s.precedence,precedence:null})}function QC(s,a,u,f){s.querySelector('link[rel="preload"][as="style"]['+a+"]")?f.loading=1:(a=s.createElement("link"),f.preload=a,a.addEventListener("load",function(){return f.loading|=1}),a.addEventListener("error",function(){return f.loading|=2}),Sn(a,"link",u),Yt(a),s.head.appendChild(a))}function Za(s){return'[src="'+Fn(s)+'"]'}function Uc(s){return"script[async]"+s}function Ub(s,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var f=s.querySelector('style[data-href~="'+Fn(u.href)+'"]');if(f)return a.instance=f,Yt(f),f;var v=b({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),Yt(f),Sn(f,"style",v),ef(f,u.precedence,s),a.instance=f;case"stylesheet":v=Qa(u.href);var _=s.querySelector(Oc(v));if(_)return a.state.loading|=4,a.instance=_,Yt(_),_;f=Ob(u),(v=Ai.get(v))&&$m(f,v),_=(s.ownerDocument||s).createElement("link"),Yt(_);var N=_;return N._p=new Promise(function(V,W){N.onload=V,N.onerror=W}),Sn(_,"link",f),a.state.loading|=4,ef(_,u.precedence,s),a.instance=_;case"script":return _=Za(u.src),(v=s.querySelector(Uc(_)))?(a.instance=v,Yt(v),v):(f=u,(v=Ai.get(_))&&(f=b({},u),Ym(f,v)),s=s.ownerDocument||s,v=s.createElement("script"),Yt(v),Sn(v,"link",f),s.head.appendChild(v),a.instance=v);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(f=a.instance,a.state.loading|=4,ef(f,u.precedence,s));return a.instance}function ef(s,a,u){for(var f=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),v=f.length?f[f.length-1]:null,_=v,N=0;N<f.length;N++){var V=f[N];if(V.dataset.precedence===a)_=V;else if(_!==v)break}_?_.parentNode.insertBefore(s,_.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(s,a.firstChild))}function $m(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.title==null&&(s.title=a.title)}function Ym(s,a){s.crossOrigin==null&&(s.crossOrigin=a.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=a.referrerPolicy),s.integrity==null&&(s.integrity=a.integrity)}var tf=null;function Vb(s,a,u){if(tf===null){var f=new Map,v=tf=new Map;v.set(u,f)}else v=tf,f=v.get(u),f||(f=new Map,v.set(u,f));if(f.has(s))return f;for(f.set(s,null),u=u.getElementsByTagName(s),v=0;v<u.length;v++){var _=u[v];if(!(_[ds]||_[$t]||s==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var N=_.getAttribute(a)||"";N=s+N;var V=f.get(N);V?V.push(_):f.set(N,[_])}}return f}function zb(s,a,u){s=s.ownerDocument||s,s.head.insertBefore(u,a==="title"?s.querySelector("head > title"):null)}function ZC(s,a,u){if(u===1||a.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return s=a.disabled,typeof a.precedence=="string"&&s==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Hb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function ek(s,a,u,f){if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var v=Qa(f.href),_=a.querySelector(Oc(v));if(_){a=_._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(s.count++,s=nf.bind(s),a.then(s,s)),u.state.loading|=4,u.instance=_,Yt(_);return}_=a.ownerDocument||a,f=Ob(f),(v=Ai.get(v))&&$m(f,v),_=_.createElement("link"),Yt(_);var N=_;N._p=new Promise(function(V,W){N.onload=V,N.onerror=W}),Sn(_,"link",f),u.instance=_}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(u,a),(a=u.state.preload)&&(u.state.loading&3)===0&&(s.count++,u=nf.bind(s),a.addEventListener("load",u),a.addEventListener("error",u))}}var Jm=0;function tk(s,a){return s.stylesheets&&s.count===0&&rf(s,s.stylesheets),0<s.count||0<s.imgCount?function(u){var f=setTimeout(function(){if(s.stylesheets&&rf(s,s.stylesheets),s.unsuspend){var _=s.unsuspend;s.unsuspend=null,_()}},6e4+a);0<s.imgBytes&&Jm===0&&(Jm=62500*PC());var v=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&rf(s,s.stylesheets),s.unsuspend)){var _=s.unsuspend;s.unsuspend=null,_()}},(s.imgBytes>Jm?50:800)+a);return s.unsuspend=u,function(){s.unsuspend=null,clearTimeout(f),clearTimeout(v)}}:null}function nf(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)rf(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var sf=null;function rf(s,a){s.stylesheets=null,s.unsuspend!==null&&(s.count++,sf=new Map,a.forEach(nk,s),sf=null,nf.call(s))}function nk(s,a){if(!(a.state.loading&4)){var u=sf.get(s);if(u)var f=u.get(null);else{u=new Map,sf.set(s,u);for(var v=s.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<v.length;_++){var N=v[_];(N.nodeName==="LINK"||N.getAttribute("media")!=="not all")&&(u.set(N.dataset.precedence,N),f=N)}f&&u.set(null,f)}v=a.instance,N=v.getAttribute("data-precedence"),_=u.get(N)||f,_===f&&u.set(null,v),u.set(N,v),this.count++,f=nf.bind(this),v.addEventListener("load",f),v.addEventListener("error",f),_?_.parentNode.insertBefore(v,_.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(v,s.firstChild)),a.state.loading|=4}}var Vc={$$typeof:M,Provider:null,Consumer:null,_currentValue:X,_currentValue2:X,_threadCount:0};function ik(s,a,u,f,v,_,N,V,W){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cs(0),this.hiddenUpdates=cs(null),this.identifierPrefix=f,this.onUncaughtError=v,this.onCaughtError=_,this.onRecoverableError=N,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=W,this.incompleteTransitions=new Map}function Fb(s,a,u,f,v,_,N,V,W,oe,me,xe){return s=new ik(s,a,u,N,W,oe,me,xe,V),a=1,_===!0&&(a|=24),_=si(3,null,null,a),s.current=_,_.stateNode=s,a=Cp(),a.refCount++,s.pooledCache=a,a.refCount++,_.memoizedState={element:f,isDehydrated:u,cache:a},Rp(_),s}function Gb(s){return s?(s=Ia,s):Ia}function Bb(s,a,u,f,v,_){v=Gb(v),f.context===null?f.context=v:f.pendingContext=v,f=Rr(a),f.payload={element:u},_=_===void 0?null:_,_!==null&&(f.callback=_),u=jr(s,f,a),u!==null&&(Jn(u,s,a),xc(u,s,a))}function qb(s,a){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<a?u:a}}function Km(s,a){qb(s,a),(s=s.alternate)&&qb(s,a)}function $b(s){if(s.tag===13||s.tag===31){var a=Mo(s,67108864);a!==null&&Jn(a,s,67108864),Km(s,67108864)}}function Yb(s){if(s.tag===13||s.tag===31){var a=ci();a=To(a);var u=Mo(s,a);u!==null&&Jn(u,s,a),Km(s,a)}}var of=!0;function sk(s,a,u,f){var v=U.T;U.T=null;var _=Y.p;try{Y.p=2,Xm(s,a,u,f)}finally{Y.p=_,U.T=v}}function rk(s,a,u,f){var v=U.T;U.T=null;var _=Y.p;try{Y.p=8,Xm(s,a,u,f)}finally{Y.p=_,U.T=v}}function Xm(s,a,u,f){if(of){var v=Wm(f);if(v===null)Lm(s,a,f,af,u),Kb(s,f);else if(ak(v,s,a,u,f))f.stopPropagation();else if(Kb(s,f),a&4&&-1<ok.indexOf(s)){for(;v!==null;){var _=yi(v);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var N=as(_.pendingLanes);if(N!==0){var V=_;for(V.pendingLanes|=2,V.entangledLanes|=2;N;){var W=1<<31-Vt(N);V.entanglements[1]|=W,N&=~W}Ns(_),(pt&6)===0&&(Fd=Ln()+500,Dc(0))}}break;case 31:case 13:V=Mo(_,2),V!==null&&Jn(V,_,2),Bd(),Km(_,2)}if(_=Wm(f),_===null&&Lm(s,a,f,af,u),_===v)break;v=_}v!==null&&f.stopPropagation()}else Lm(s,a,f,null,u)}}function Wm(s){return s=vi(s),Qm(s)}var af=null;function Qm(s){if(af=null,s=fs(s),s!==null){var a=l(s);if(a===null)s=null;else{var u=a.tag;if(u===13){if(s=c(a),s!==null)return s;s=null}else if(u===31){if(s=d(a),s!==null)return s;s=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;s=null}else a!==s&&(s=null)}}return af=s,null}function Jb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(yo()){case Fl:return 2;case Gl:return 8;case gr:case sp:return 32;case Uu:return 268435456;default:return 32}default:return 32}}var Zm=!1,Gr=null,Br=null,qr=null,zc=new Map,Hc=new Map,$r=[],ok="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Kb(s,a){switch(s){case"focusin":case"focusout":Gr=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":qr=null;break;case"pointerover":case"pointerout":zc.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hc.delete(a.pointerId)}}function Fc(s,a,u,f,v,_){return s===null||s.nativeEvent!==_?(s={blockedOn:a,domEventName:u,eventSystemFlags:f,nativeEvent:_,targetContainers:[v]},a!==null&&(a=yi(a),a!==null&&$b(a)),s):(s.eventSystemFlags|=f,a=s.targetContainers,v!==null&&a.indexOf(v)===-1&&a.push(v),s)}function ak(s,a,u,f,v){switch(a){case"focusin":return Gr=Fc(Gr,s,a,u,f,v),!0;case"dragenter":return Br=Fc(Br,s,a,u,f,v),!0;case"mouseover":return qr=Fc(qr,s,a,u,f,v),!0;case"pointerover":var _=v.pointerId;return zc.set(_,Fc(zc.get(_)||null,s,a,u,f,v)),!0;case"gotpointercapture":return _=v.pointerId,Hc.set(_,Fc(Hc.get(_)||null,s,a,u,f,v)),!0}return!1}function Xb(s){var a=fs(s.target);if(a!==null){var u=l(a);if(u!==null){if(a=u.tag,a===13){if(a=c(u),a!==null){s.blockedOn=a,Oi(s.priority,function(){Yb(u)});return}}else if(a===31){if(a=d(u),a!==null){s.blockedOn=a,Oi(s.priority,function(){Yb(u)});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function lf(s){if(s.blockedOn!==null)return!1;for(var a=s.targetContainers;0<a.length;){var u=Wm(s.nativeEvent);if(u===null){u=s.nativeEvent;var f=new u.constructor(u.type,u);tc=f,u.target.dispatchEvent(f),tc=null}else return a=yi(u),a!==null&&$b(a),s.blockedOn=u,!1;a.shift()}return!0}function Wb(s,a,u){lf(s)&&u.delete(a)}function lk(){Zm=!1,Gr!==null&&lf(Gr)&&(Gr=null),Br!==null&&lf(Br)&&(Br=null),qr!==null&&lf(qr)&&(qr=null),zc.forEach(Wb),Hc.forEach(Wb)}function cf(s,a){s.blockedOn===a&&(s.blockedOn=null,Zm||(Zm=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,lk)))}var uf=null;function Qb(s){uf!==s&&(uf=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){uf===s&&(uf=null);for(var a=0;a<s.length;a+=3){var u=s[a],f=s[a+1],v=s[a+2];if(typeof f!="function"){if(Qm(f||u)===null)continue;break}var _=yi(u);_!==null&&(s.splice(a,3),a-=3,Wp(_,{pending:!0,data:v,method:u.method,action:f},f,v))}}))}function el(s){function a(W){return cf(W,s)}Gr!==null&&cf(Gr,s),Br!==null&&cf(Br,s),qr!==null&&cf(qr,s),zc.forEach(a),Hc.forEach(a);for(var u=0;u<$r.length;u++){var f=$r[u];f.blockedOn===s&&(f.blockedOn=null)}for(;0<$r.length&&(u=$r[0],u.blockedOn===null);)Xb(u),u.blockedOn===null&&$r.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(f=0;f<u.length;f+=3){var v=u[f],_=u[f+1],N=v[cn]||null;if(typeof _=="function")N||Qb(u);else if(N){var V=null;if(_&&_.hasAttribute("formAction")){if(v=_,N=_[cn]||null)V=N.formAction;else if(Qm(v)!==null)continue}else V=N.action;typeof V=="function"?u[f+1]=V:(u.splice(f,3),f-=3),Qb(u)}}}function Zb(){function s(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(N){return v=N})},focusReset:"manual",scroll:"manual"})}function a(){v!==null&&(v(),v=null),f||setTimeout(u,20)}function u(){if(!f&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,v=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",a),navigation.addEventListener("navigateerror",a),setTimeout(u,100),function(){f=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",a),navigation.removeEventListener("navigateerror",a),v!==null&&(v(),v=null)}}}function eg(s){this._internalRoot=s}df.prototype.render=eg.prototype.render=function(s){var a=this._internalRoot;if(a===null)throw Error(i(409));var u=a.current,f=ci();Bb(u,f,s,a,null,null)},df.prototype.unmount=eg.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var a=s.containerInfo;Bb(s.current,2,null,s,null,null),Bd(),a[us]=null}};function df(s){this._internalRoot=s}df.prototype.unstable_scheduleHydration=function(s){if(s){var a=Bu();s={blockedOn:null,target:s,priority:a};for(var u=0;u<$r.length&&a!==0&&a<$r[u].priority;u++);$r.splice(u,0,s),u===0&&Xb(s)}};var e1=e.version;if(e1!=="19.2.4")throw Error(i(527,e1,"19.2.4"));Y.findDOMNode=function(s){var a=s._reactInternals;if(a===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=h(a),s=s!==null?x(s):null,s=s===null?null:s.stateNode,s};var ck={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ff=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ff.isDisabled&&ff.supportsFiber)try{Pi=ff.inject(ck),yn=ff}catch{}}return Bc.createRoot=function(s,a){if(!r(s))throw Error(i(299));var u=!1,f="",v=av,_=lv,N=cv;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(f=a.identifierPrefix),a.onUncaughtError!==void 0&&(v=a.onUncaughtError),a.onCaughtError!==void 0&&(_=a.onCaughtError),a.onRecoverableError!==void 0&&(N=a.onRecoverableError)),a=Fb(s,1,!1,null,null,u,f,null,v,_,N,Zb),s[us]=a.current,Pm(s),new eg(a)},Bc.hydrateRoot=function(s,a,u){if(!r(s))throw Error(i(299));var f=!1,v="",_=av,N=lv,V=cv,W=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onUncaughtError!==void 0&&(_=u.onUncaughtError),u.onCaughtError!==void 0&&(N=u.onCaughtError),u.onRecoverableError!==void 0&&(V=u.onRecoverableError),u.formState!==void 0&&(W=u.formState)),a=Fb(s,1,!0,a,u??null,f,v,W,_,N,V,Zb),a.context=Gb(null),u=a.current,f=ci(),f=To(f),v=Rr(f),v.callback=null,jr(u,v,f),u=f,a.current.lanes=u,bo(a,u),Ns(a),s[us]=a.current,Pm(s),new df(a)},Bc.version="19.2.4",Bc}var u1;function bk(){if(u1)return ig.exports;u1=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),ig.exports=vk(),ig.exports}var _k=bk(),Ge=(n=>(n.EASY="easy",n.NORMAL="normal",n.HARD="hard",n))(Ge||{}),pn=(n=>(n.EASY="easy",n.NORMAL="normal",n.HARD="hard",n))(pn||{}),te=(n=>(n.STR="STR",n.INT="INT",n.DIS="DIS",n.HEA="HEA",n.CRT="CRT",n.SPR="SPR",n.REL="REL",n.FIN="FIN",n))(te||{});/*! Capacitor: https://capacitorjs.com/ - MIT License */var yl;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(yl||(yl={}));class ag extends Error{constructor(e,t,i){super(e),this.message=e,this.code=t,this.data=i}}const Tk=n=>{var e,t;return n!=null&&n.androidBridge?"android":!((t=(e=n==null?void 0:n.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},Sk=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},i=t.Plugins=t.Plugins||{},r=()=>e!==null?e.name:Tk(n),l=()=>r()!=="web",c=b=>{const T=h.get(b);return!!(T!=null&&T.platforms.has(r())||d(b))},d=b=>{var T;return(T=t.PluginHeaders)===null||T===void 0?void 0:T.find(S=>S.name===b)},p=b=>n.console.error(b),h=new Map,x=(b,T={})=>{const S=h.get(b);if(S)return console.warn(`Capacitor plugin "${b}" already registered. Cannot register plugins twice.`),S.proxy;const E=r(),D=d(b);let k;const F=async()=>(!k&&E in T?k=typeof T[E]=="function"?k=await T[E]():k=T[E]:e!==null&&!k&&"web"in T&&(k=typeof T.web=="function"?k=await T.web():k=T.web),k),$=(C,A)=>{var P,L;if(D){const O=D==null?void 0:D.methods.find(j=>A===j.name);if(O)return O.rtype==="promise"?j=>t.nativePromise(b,A.toString(),j):(j,q)=>t.nativeCallback(b,A.toString(),j,q);if(C)return(P=C[A])===null||P===void 0?void 0:P.bind(C)}else{if(C)return(L=C[A])===null||L===void 0?void 0:L.bind(C);throw new ag(`"${b}" plugin is not implemented on ${E}`,yl.Unimplemented)}},M=C=>{let A;const P=(...L)=>{const O=F().then(j=>{const q=$(j,C);if(q){const le=q(...L);return A=le==null?void 0:le.remove,le}else throw new ag(`"${b}.${C}()" is not implemented on ${E}`,yl.Unimplemented)});return C==="addListener"&&(O.remove=async()=>A()),O};return P.toString=()=>`${C.toString()}() { [capacitor code] }`,Object.defineProperty(P,"name",{value:C,writable:!1,configurable:!1}),P},J=M("addListener"),H=M("removeListener"),z=(C,A)=>{const P=J({eventName:C},A),L=async()=>{const j=await P;H({eventName:C,callbackId:j},A)},O=new Promise(j=>P.then(()=>j({remove:L})));return O.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await L()},O},R=new Proxy({},{get(C,A){switch(A){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return D?z:J;case"removeListener":return H;default:return M(A)}}});return i[b]=R,h.set(b,{name:b,proxy:R,platforms:new Set([...Object.keys(T),...D?[E]:[]])}),R};return t.convertFileSrc||(t.convertFileSrc=b=>b),t.getPlatform=r,t.handleError=p,t.isNativePlatform=l,t.isPluginAvailable=c,t.registerPlugin=x,t.Exception=ag,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},wk=n=>n.Capacitor=Sk(n),Ds=wk(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),kl=Ds.registerPlugin;class b0{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let i=!1;this.listeners[e]||(this.listeners[e]=[],i=!0),this.listeners[e].push(t);const l=this.windowListeners[e];l&&!l.registered&&this.addWindowListener(l),i&&this.sendRetainedArgumentsForEvent(e);const c=async()=>this.removeListener(e,t);return Promise.resolve({remove:c})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,i){const r=this.listeners[e];if(!r){if(i){let l=this.retainedEventArguments[e];l||(l=[]),l.push(t),this.retainedEventArguments[e]=l}return}r.forEach(l=>l(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:i=>{this.notifyListeners(t,i)}}}unimplemented(e="not implemented"){return new Ds.Exception(e,yl.Unimplemented)}unavailable(e="not available"){return new Ds.Exception(e,yl.Unavailable)}async removeListener(e,t){const i=this.listeners[e];if(!i)return;const r=i.indexOf(t);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(i=>{this.notifyListeners(e,i)}))}}const d1=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),f1=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Ek extends b0{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(i=>{if(i.length<=0)return;let[r,l]=i.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=f1(r).trim(),l=f1(l).trim(),t[r]=l}),t}async setCookie(e){try{const t=d1(e.key),i=d1(e.value),r=e.expires?`; expires=${e.expires.replace("expires=","")}`:"",l=(e.path||"/").replace("path=",""),c=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${i||""}${r}; path=${l}; ${c};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}kl("CapacitorCookies",{web:()=>new Ek});const Nk=async n=>new Promise((e,t)=>{const i=new FileReader;i.onload=()=>{const r=i.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},i.onerror=r=>t(r),i.readAsDataURL(n)}),Ck=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(r=>r.toLocaleLowerCase()).reduce((r,l,c)=>(r[l]=n[e[c]],r),{})},kk=(n,e=!0)=>n?Object.entries(n).reduce((i,r)=>{const[l,c]=r;let d,p;return Array.isArray(c)?(p="",c.forEach(h=>{d=e?encodeURIComponent(h):h,p+=`${l}=${d}&`}),p.slice(0,-1)):(d=e?encodeURIComponent(c):c,p=`${l}=${d}`),`${i}&${p}`},"").substr(1):null,Ak=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),r=Ck(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(r.includes("application/x-www-form-urlencoded")){const l=new URLSearchParams;for(const[c,d]of Object.entries(n.data||{}))l.set(c,d);t.body=l.toString()}else if(r.includes("multipart/form-data")||n.data instanceof FormData){const l=new FormData;if(n.data instanceof FormData)n.data.forEach((d,p)=>{l.append(p,d)});else for(const d of Object.keys(n.data))l.append(d,n.data[d]);t.body=l;const c=new Headers(t.headers);c.delete("content-type"),t.headers=c}else(r.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class Ik extends b0{async request(e){const t=Ak(e,e.webFetchExtra),i=kk(e.params,e.shouldEncodeUrlParams),r=i?`${e.url}?${i}`:e.url,l=await fetch(r,t),c=l.headers.get("content-type")||"";let{responseType:d="text"}=l.ok?e:{};c.includes("application/json")&&(d="json");let p,h;switch(d){case"arraybuffer":case"blob":h=await l.blob(),p=await Nk(h);break;case"json":p=await l.json();break;case"document":case"text":default:p=await l.text()}const x={};return l.headers.forEach((b,T)=>{x[T]=b}),{data:p,headers:x,status:l.status,url:l.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}kl("CapacitorHttp",{web:()=>new Ik});var h1;(function(n){n.Dark="DARK",n.Light="LIGHT",n.Default="DEFAULT"})(h1||(h1={}));var p1;(function(n){n.StatusBar="StatusBar",n.NavigationBar="NavigationBar"})(p1||(p1={}));class Rk extends b0{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}kl("SystemBars",{web:()=>new Rk});const jk="modulepreload",Dk=function(n){return"/leny-os1/"+n},m1={},_0=function(e,t,i){let r=Promise.resolve();if(t&&t.length>0){let c=function(h){return Promise.all(h.map(x=>Promise.resolve(x).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),p=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=c(t.map(h=>{if(h=Dk(h),h in m1)return;m1[h]=!0;const x=h.endsWith(".css"),b=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${b}`))return;const T=document.createElement("link");if(T.rel=x?"stylesheet":jk,x||(T.as="script"),T.crossOrigin="",T.href=h,p&&T.setAttribute("nonce",p),document.head.appendChild(T),x)return new Promise((S,E)=>{T.addEventListener("load",S),T.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${h}`)))})}))}function l(c){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=c,window.dispatchEvent(d),!d.defaultPrevented)throw c}return r.then(c=>{for(const d of c||[])d.status==="rejected"&&l(d.reason);return e().catch(l)})};var ll;(function(n){n.Heavy="HEAVY",n.Medium="MEDIUM",n.Light="LIGHT"})(ll||(ll={}));var iu;(function(n){n.Success="SUCCESS",n.Warning="WARNING",n.Error="ERROR"})(iu||(iu={}));const Yo=kl("Haptics",{web:()=>_0(()=>import("./web-Dpo8BPbb.js"),[]).then(n=>new n.HapticsWeb)});let lg=null;const Mk=()=>(lg||(lg=new(window.AudioContext||window.webkitAudioContext)),lg),Ii={C4:261.63,G4:392,C5:523.25,E5:659.25,G5:783.99,A5:880,C6:1046.5},tl={click:[5],success:[10,30,10],error:[50,20,50,20,50],levelUp:[50,50,50,50,100,50,200],crit:[10,10,10,50,50,100],delete:[30]},fn=(n,e,t,i,r,l=.1)=>{const c=n.createOscillator(),d=n.createGain();c.type=t,c.frequency.setValueAtTime(e,i),d.gain.setValueAtTime(0,i),d.gain.linearRampToValueAtTime(l,i+.01),d.gain.exponentialRampToValueAtTime(.001,i+r),c.connect(d),d.connect(n.destination),c.start(i),c.stop(i+r+.1)},Ce=async(n,e=!0)=>{if(e){if(Ds.isNativePlatform())try{switch(n){case"click":await Yo.impact({style:ll.Light});break;case"hover":break;case"success":await Yo.notification({type:iu.Success});break;case"level-up":await Yo.notification({type:iu.Success});break;case"crit":await Yo.impact({style:ll.Heavy});break;case"error":await Yo.notification({type:iu.Error});break;case"delete":await Yo.impact({style:ll.Medium});break;default:await Yo.impact({style:ll.Light})}}catch{}else if(navigator.vibrate)switch(n){case"click":navigator.vibrate(tl.click);break;case"success":navigator.vibrate(tl.success);break;case"level-up":navigator.vibrate(tl.levelUp);break;case"crit":navigator.vibrate(tl.crit);break;case"error":navigator.vibrate(tl.error);break;case"delete":navigator.vibrate(tl.delete);break}}if(!e)return;const t=Mk();t.state==="suspended"&&t.resume();const i=t.currentTime;switch(n){case"success":fn(t,Ii.C5,"sine",i,.2,.1),fn(t,Ii.E5,"sine",i+.05,.2,.1),fn(t,Ii.G5,"sine",i+.1,.4,.08);break;case"coin":fn(t,1200,"square",i,.1,.05),fn(t,1800,"square",i+.05,.2,.05);break;case"level-up":fn(t,Ii.C4,"triangle",i,.2,.15),fn(t,Ii.G4,"triangle",i+.15,.2,.15),fn(t,Ii.C5,"triangle",i+.3,.4,.15),fn(t,Ii.E5,"triangle",i+.45,.6,.15),fn(t,Ii.C5,"sine",i,.8,.05);break;case"crit":fn(t,Ii.G5,"sine",i,.3,.2),fn(t,Ii.C6,"sine",i+.05,.4,.2),fn(t,Ii.E5,"square",i,.1,.05),fn(t,Ii.A5,"triangle",i+.1,.5,.1);break;case"delete":const r=t.createOscillator(),l=t.createGain();r.frequency.setValueAtTime(200,i),r.frequency.exponentialRampToValueAtTime(50,i+.3),l.gain.setValueAtTime(.1,i),l.gain.linearRampToValueAtTime(0,i+.3),r.connect(l),l.connect(t.destination),r.start(i),r.stop(i+.3);break;case"click":fn(t,800,"sine",i,.05,.02);break;case"hover":fn(t,400,"sine",i,.02,.005);break;case"error":fn(t,150,"sawtooth",i,.3,.1),fn(t,140,"sawtooth",i+.05,.3,.1);break}};var g1;(function(n){n[n.Sunday=1]="Sunday",n[n.Monday=2]="Monday",n[n.Tuesday=3]="Tuesday",n[n.Wednesday=4]="Wednesday",n[n.Thursday=5]="Thursday",n[n.Friday=6]="Friday",n[n.Saturday=7]="Saturday"})(g1||(g1={}));const Wo=kl("LocalNotifications",{web:()=>_0(()=>import("./web-DfKHUJ5p.js"),[]).then(n=>new n.LocalNotificationsWeb)}),zS="lifeos_dashboard_channel",HS="lifeos_alerts_channel",FS=async()=>{if(Ds.isNativePlatform())try{await Wo.createChannel({id:zS,name:"LifeOS Dashboard",description:"Persistent Daily Summary",importance:2,visibility:1,sound:void 0,vibration:!1}),await Wo.createChannel({id:HS,name:"Mission Alerts",description:"Time-sensitive reminders",importance:5,visibility:1,sound:"beep.wav",vibration:!0}),await Wo.registerActionTypes({types:[{id:"DASHBOARD_ACTIONS",actions:[{id:"OPEN_APP",title:" Open Command",foreground:!0}]},{id:"MISSION_ALERTS",actions:[{id:"COMPLETE",title:" Complete",foreground:!1},{id:"SNOOZE",title:" Snooze 10m",foreground:!1}]}]}),console.log(" Channels Registered: Dashboard (Silent) & Alerts (Loud)")}catch(n){console.error("Failed to register channels",n)}},GS=async()=>Ds.isNativePlatform()?(await Wo.requestPermissions()).display==="granted"?(await FS(),!0):!1:"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.log("This browser does not support desktop notification"),!1),Pk=async(n,e)=>{if(Ds.isNativePlatform())try{await Wo.schedule({notifications:[{id:99999,title:n,body:e,ongoing:!0,autoCancel:!1,silent:!0,smallIcon:"ic_stat_icon_config_sample",channelId:zS,actionTypeId:"DASHBOARD_ACTIONS",schedule:{at:new Date(Date.now()+100)}}]})}catch(t){console.error("Dashboard Update Failed",t)}},Gf=async(n,e,t,i)=>{if(console.log(` sendAlert called: ${e} - ${t}`),Ds.isNativePlatform())try{await Wo.schedule({notifications:[{id:n,title:` ${e}`,body:t,schedule:{at:new Date(Date.now()+100)},sound:"beep.wav",smallIcon:"ic_stat_icon_config_sample",actionTypeId:"MISSION_ALERTS",extra:i||null,channelId:HS}]})}catch(r){console.error("Native alert failed:",r)}else{if(!("Notification"in window)){alert("This browser does not support desktop notification");return}if(Notification.permission!=="granted"&&(console.log(" Permission not granted, requesting..."),await Notification.requestPermission()!=="granted")){alert("Please enable notifications to receive alerts.");return}try{if("serviceWorker"in navigator&&navigator.serviceWorker.controller)await(await navigator.serviceWorker.ready).showNotification(e,{body:t,icon:"/logo192.png",badge:"/logo192.png",vibrate:[200,100,200],tag:String(n),requireInteraction:!0,data:{url:window.location.href}}),console.log(" Service Worker notification sent");else{const r=new Notification(e,{body:t,icon:"/logo192.png",badge:"/logo192.png",vibrate:[200,100,200],tag:String(n),requireInteraction:!0});r.onclick=()=>{window.focus(),r.close()},console.log(" Web notification sent (Classic API)")}}catch(r){console.error("Web notification failed:",r),alert("Failed to send notification. See console for details.")}}},hf=async(n,e)=>{const t=Math.floor(Date.now()+Math.random()*1e4);await Gf(t,n,e)},ui={[Ge.EASY]:"border-life-easy text-life-easy",[Ge.NORMAL]:"border-life-normal text-life-normal",[Ge.HARD]:"border-life-hard text-life-hard"},Eu={[Ge.EASY]:"bg-life-easy/10",[Ge.NORMAL]:"bg-life-normal/10",[Ge.HARD]:"bg-life-hard/10"},ut={[te.STR]:"#ef4444",[te.INT]:"#a855f7",[te.DIS]:"#60a5fa",[te.HEA]:"#10b981",[te.CRT]:"#e879f9",[te.SPR]:"#f43f5e",[te.REL]:"#fbbf24",[te.FIN]:"#14b8a6"},T0={[pn.EASY]:300,[pn.NORMAL]:400,[pn.HARD]:500},Lk={7:300,21:1e3,50:2500,100:5e3},Ok={[Ge.EASY]:{xp:20,gold:10},[Ge.NORMAL]:{xp:50,gold:30},[Ge.HARD]:{xp:100,gold:100}},Uk={[Ge.EASY]:{xp:50,gold:20,stat:2},[Ge.NORMAL]:{xp:30,gold:10,stat:1},[Ge.HARD]:{xp:10,gold:0,stat:0}},jg=[{id:"standard",name:"Shadow Protocol",colors:{"--color-life-black":"#0a0a0a","--color-life-paper":"#121212","--color-life-gold":"#fbbf24","--color-life-text":"#e5e5e5"}},{id:"zayn",name:"Zayn Protocol",colors:{"--color-life-black":"#0a0a0a","--color-life-paper":"#121212","--color-life-gold":"#fbbf24","--color-life-text":"#e5e5e5","--color-life-muted":"#525252","--color-life-crimson":"#dc2626","--color-life-diamond":"#60a5fa","--color-life-hard":"#ef4444"}},{id:"grey",name:"Zenith Grey",colors:{"--color-life-black":"#18181b","--color-life-paper":"#27272a","--color-life-gold":"#a1a1aa","--color-life-text":"#f4f4f5"}},{id:"gold",name:"Midas Touch",colors:{"--color-life-black":"#1a1200","--color-life-paper":"#261a00","--color-life-gold":"#ffd700","--color-life-text":"#fffae6"},customCss:`
            /* Royal Fonts & Shapes */
            @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&display=swap');
            
            body { 
                font-family: 'Cinzel', serif !important; 
            }
            .rounded-xl, .rounded-lg, .rounded-2xl {
                border-radius: 2px !important;
                border: 1px double #ffd700 !important;
            }
            .bg-life-gold {
                background: linear-gradient(135deg, #ffd700 0%, #b8860b 100%) !important;
                box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
            }
        `},{id:"light",name:"Light Protocol",colors:{"--color-life-black":"#f3f4f6","--color-life-paper":"#ffffff","--color-life-gold":"#d97706","--color-life-text":"#111827"}},{id:"crimson",name:"Crimson Ops",colors:{"--color-life-black":"#1a0505","--color-life-paper":"#2b0a0a","--color-life-gold":"#ef4444","--color-life-text":"#fecaca"}},{id:"sunset",name:"Sunset Drive",colors:{"--color-life-black":"#2e1065","--color-life-paper":"#4c1d95","--color-life-gold":"#f472b6","--color-life-text":"#fae8ff"}},{id:"mint",name:"Mint Protocol",colors:{"--color-life-black":"#f0fdf4","--color-life-paper":"#dcfce7","--color-life-gold":"#16a34a","--color-life-text":"#064e3b"}},{id:"azure",name:"Azure Citadel",colors:{"--color-life-black":"#082f49","--color-life-paper":"#0c4a6e","--color-life-gold":"#38bdf8","--color-life-text":"#f0f9ff"}},{id:"toxic",name:"Toxic Grid",colors:{"--color-life-black":"#052e16","--color-life-paper":"#064e3b","--color-life-gold":"#a3e635","--color-life-text":"#ecfccb"}},{id:"cyberpunk",name:"Neon City",colors:{"--color-life-black":"#020617","--color-life-paper":"#0f172a","--color-life-gold":"#22d3ee","--color-life-text":"#e0f2fe"},customCss:`
            /* Cyberpunk Aesthetics */
            @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');
            
            body { 
                font-family: 'Share Tech Mono', monospace !important; 
                letter-spacing: 0.5px;
            }
            
            /* Hard Corners */
            .rounded-xl, .rounded-lg, .rounded-2xl, .rounded-full, .rounded-md, button {
                border-radius: 0px !important;
                clip-path: polygon(
                    0 0, 
                    100% 0, 
                    100% calc(100% - 10px), 
                    calc(100% - 10px) 100%, 
                    0 100%
                );
            }
            
            /* Neon Borders */
            .border {
                border-color: rgba(34, 211, 238, 0.4) !important;
            }
            
            /* Icons Glow */
            svg {
                filter: drop-shadow(0 0 2px currentColor);
            }
            
            .bg-life-gold {
                box-shadow: 0 0 15px #22d3ee, inset 0 0 10px rgba(0,0,0,0.5);
            }
        `},{id:"gamify",name:"Super Duo",colors:{"--color-life-black":"#ffffff","--color-life-paper":"#f3f4f6","--color-life-gold":"#58cc02","--color-life-text":"#3c3c3c"},customCss:`
            /* Bubbly UI */
            @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap');
            
            body { font-family: 'Nunito', sans-serif !important; }
            
            .rounded-xl, .rounded-lg {
                border-radius: 20px !important;
            }
            
            /* 3D Buttons */
            button, .bg-life-paper {
                border-bottom-width: 4px !important;
                border-color: rgba(0,0,0,0.1) !important;
                transition: transform 0.1s;
            }
            
            button:active {
                transform: translateY(4px);
                border-bottom-width: 0px !important;
            }
            
            .bg-life-gold {
                border-color: #46a302 !important; /* Darker Green Border */
            }
        `},{id:"gamify_purple",name:"Super Duo Dark",colors:{"--color-life-black":"#13111C","--color-life-paper":"#1F1C2E","--color-life-gold":"#9333ea","--color-life-text":"#E9D5FF"},customCss:`
            /* Bubbly Dark UI */
            @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;900&display=swap');
            
            body { font-family: 'Nunito', sans-serif !important; }
            
            .rounded-xl, .rounded-lg {
                border-radius: 20px !important;
            }
            
            /* 3D Buttons */
            button, .bg-life-paper {
                border-bottom-width: 4px !important;
                border-color: rgba(0,0,0,0.4) !important;
                transition: transform 0.1s;
            }
            
            button:active {
                transform: translateY(4px);
                border-bottom-width: 0px !important;
            }
        `}],Wc={user:{name:"Shadow Walker",title:"Initiate",level:1,currentXP:0,targetXP:1e3,gold:450,honor:100,honorDailyLog:{},streak:0,shields:1,inventory:[],equippedItems:[],hasOnboarded:!1,purchaseHistory:[],badges:[],badgeTiers:{},badgeHistory:{},featuredBadges:[],dailyXP:0,dailyTarget:T0[pn.NORMAL],currentMode:pn.NORMAL,pendingMode:pn.NORMAL,lastProcessedDate:new Date().toISOString(),consecutiveShields:0,streakHistory:{},metrics:{totalTasksCompleted:0,tasksByDifficulty:{[Ge.EASY]:0,[Ge.NORMAL]:0,[Ge.HARD]:0},totalRaidsWon:0,raidsByDifficulty:{[Ge.EASY]:0,[Ge.NORMAL]:0,[Ge.HARD]:0},totalGoldEarned:450,totalXPEarned:0,highestStreak:0,habitsFixed:0,shieldsUsed:0,resetsCount:0},unlockedThemes:jg,stats:{[te.STR]:1,[te.INT]:1,[te.DIS]:1,[te.HEA]:1,[te.CRT]:1,[te.SPR]:1,[te.REL]:1,[te.FIN]:1},lastOnline:new Date().toISOString(),preferences:{soundEnabled:!0,deviceNotificationsEnabled:!1,theme:"standard",showHighlights:!0,showCampaignUI:!0,unlockAllWeeks:!1,showCalendarSync:!0,statsViewMode:"radar",enableRefiner:!0,copyIncludesHistory:!0,dayStartHour:4,apiKeys:{discussion:"",tasks:"",habits:"",raids:"",themes:"",monitoring:"",refiner:""}}},badgesRegistry:[],ui:{currentView:"tasks",activeModal:"none",modalQueue:[],toasts:[],systemLogs:[],debugDate:null,focusSession:null,habitsViewMode:"list",tasksViewMode:"missions"}},Vk="LIFE_OS_V1_DATA",Dn=[1,2,3,5,8,13,21,34,55,89,144,233,377,610],S0=n=>{let e=Dn.findIndex(h=>h>n)-1;n===0&&(e=-1),n>=610&&(e=Dn.length-1),e<-1&&(e=Dn.length-1);const t=e+1;let i="Initiate",r="text-gray-500 border-gray-500/20";t<=7?(i="Foundation",r="text-gray-400 border-gray-500/30"):t<=10?(i="Solid State",r="text-life-silver border-life-silver/50"):t<=12?(i="Mastery",r="text-life-gold border-life-gold"):t===13?(i="Legendary",r="text-life-diamond border-life-diamond shadow-[0_0_10px_rgba(96,165,250,0.5)]"):(i="The Godfather",r="text-life-crimson border-life-crimson shadow-[0_0_15px_rgba(220,38,38,0.6)]");const l=e>=0?Dn[e]:0,c=e+1<Dn.length?Dn[e+1]:610,d=n>=610;let p=0;if(d)p=100;else{const h=c-l,x=n-l;p=Math.min(100,Math.max(0,x/h*100))}return{level:t,phase:i,phaseColor:r,nextCheckpoint:c,prevCheckpoint:l,progress:p,isMaxLevel:d}},Bf=n=>{if(n<=1)return 0;let e=Dn.findIndex(r=>r>n);e===-1&&(e=Dn.length);const t=e-1,i=Dn[t]||0;return n>i?i:Dn[t-1]||0},vl=(n,e)=>{const t=e?new Date(e):new Date,i=new Date(n.createdAt||new Date().toISOString());t.setHours(0,0,0,0),i.setHours(0,0,0,0);const r=t.getTime()-i.getTime(),l=Math.floor(r/(1e3*60*60*24));if(l<0)return!0;switch(n.type){case"daily":return!0;case"specific_days":return!n.specificDays||n.specificDays.length===0?!0:n.specificDays.includes(t.getDay());case"interval":const c=n.intervalValue||1;return l%c===0;case"custom":if(!n.pattern||n.pattern.length===0)return!0;const d=l%n.pattern.length;return n.pattern[d]==="1";default:return!0}},zk={Wood:"  .    .",Copper:"    .",Iron:"      .",Silver:" .     .",Gold:"    .  .",Diamond:"  .    .",Crimson:" .     ."},Af={[Ge.EASY]:1,[Ge.NORMAL]:3,[Ge.HARD]:9},BS=(n,e,t,i=null)=>{const r=i?new Date(i):new Date,l=r.toISOString().split("T")[0],c=[];let d=0;n.forEach(h=>{if(!h.isArchived){const x=h.deadline||h.scheduledTime;if(x&&x.startsWith(l)){const b=Af[h.difficulty]||1;c.push({id:h.id,title:h.title,type:"task",difficulty:h.difficulty,weight:b,percentage:0,isCompleted:h.isCompleted}),d+=b}}}),e.forEach(h=>{if(vl(h,r.toISOString())){const x=Af[h.difficulty]||1;c.push({id:h.id,title:h.title,type:"habit",difficulty:h.difficulty,weight:x,percentage:0,isCompleted:h.status==="completed"}),d+=x}}),t.forEach(h=>{h.status==="active"&&h.steps.forEach(x=>{const b=x.scheduledTime||x.scheduledDate;if(b&&b.startsWith(l)){const T=Af[h.difficulty]||3;c.push({id:x.id,title:`${h.title}: ${x.title}`,type:"raid",difficulty:h.difficulty,weight:T,percentage:0,isCompleted:x.isCompleted}),d+=T}})});const p=c.map(h=>({...h,percentage:d>0?Math.round(h.weight/d*100):0}));return p.sort((h,x)=>x.weight-h.weight),{items:p,totalWeight:d}},qS=n=>{try{const e=JSON.parse(localStorage.getItem("LIFE_OS_TASKS_DATA")||"[]"),t=JSON.parse(localStorage.getItem("LIFE_OS_HABITS_DATA")||"[]"),i=JSON.parse(localStorage.getItem("LIFE_OS_RAIDS_DATA")||"[]"),{totalWeight:r}=BS(e,t,i),l=Af[n]||1,c=Math.max(l,r);return Math.round(l/c*100)}catch(e){return console.error("Honor Calc Failed:",e),5}},Hk=n=>n>=99?{material:"Crimson",icon:"",tier:"crimson"}:n>=90?{material:"Diamond",icon:"",tier:"diamond"}:n>=80?{material:"Gold",icon:"",tier:"gold"}:n>=70?{material:"Silver",icon:"",tier:"silver"}:n>=60?{material:"Iron",icon:"",tier:"silver"}:n>=40?{material:"Copper",icon:"",tier:"silver"}:{material:"Wood",icon:"",tier:"silver"},du=(n,e=null)=>{const i=(e?new Date(e):new Date).toISOString().slice(0,7),r=Object.entries(n).filter(([c])=>c.startsWith(i)).map(([,c])=>c);if(r.length===0)return 100;const l=r.reduce((c,d)=>c+d,0);return Math.round(l/r.length)},Fk=(n,e=null)=>{const i=(e?new Date(e):new Date).toISOString().slice(0,7),r=Object.entries(n).filter(([p])=>p.startsWith(i));if(r.length===0)return{updatedLog:n,newAverage:100,redeemedDate:null};r.sort((p,h)=>p[1]-h[1]);const l=r[0];if(l[1]>=100)return{updatedLog:n,newAverage:100,redeemedDate:null};const c={...n};c[l[0]]=100;const d=du(c,e);return{updatedLog:c,newAverage:d,redeemedDate:l[0]}},Gk=(n,e,t)=>{const{material:i,icon:r,tier:l}=Hk(n),c=zk[i],d=Math.floor(n*15),p=Math.floor(n*10);return{id:`bdg_honor_${e.toLowerCase()}_${t}`,name:`${i} Honor: ${e} ${t}`,icon:r,description:`Achieved ${n}% Integrity Score in ${e} ${t}. Rank: ${i}.`,category:"consistency",triggerType:"manual",levels:[{tier:l,target:1,quote:c,rewards:{xp:d,gold:p}}]}},x1=(n,e)=>{const t=n.dailyTarget,r=n.dailyXP>=t,l=e?new Date(e):new Date,c=new Date(l);c.setDate(c.getDate()-1);const d=c.toISOString().split("T")[0],p={...n.honorDailyLog||{}};let h=p[d]!==void 0?p[d]:100;r&&(h+=10),h=Math.min(110,Math.max(0,h)),p[d]=h;let x,b="";if(l.getDate()===1){const R=new Date(l);R.setMonth(R.getMonth()-1);const C=R.toLocaleString("default",{month:"long"}),A=R.getFullYear(),P=R.toISOString().slice(0,7),L=Object.entries(p).filter(([O])=>O.startsWith(P)).map(([,O])=>O);if(L.length>0){const O=L.reduce((q,le)=>q+le,0),j=Math.round(O/L.length);x=Gk(j,C,A),b=` |  ${C} Rank: ${j}%`}}const T=du(p,l.toISOString());let S=n.streak,E=n.gold,D=n.shields,k=n.consecutiveShields||0,F=n.metrics.shieldsUsed,$="",M="info";if(r){S++,k=0;const R=n.currentMode===pn.HARD?200:n.currentMode===pn.NORMAL?100:50;E+=R,h>100?($=` Flawless Victory! Honor Overcharged (${h}%) | +${R}G`,M="crit"):($=` New Day! Streak ${S} | +${R}G | Honor +10%`,M="success");const C=Lk[S];C?(E+=C,$=` Milestone: ${S} Days! +${C}G`,M="level-up",n.preferences.deviceNotificationsEnabled&&hf(" Milestone Reached!",`You hit a ${S} day streak! Bonus ${C}G awarded.`)):n.preferences.deviceNotificationsEnabled&&hf(" Protocol Reset",`New day initiated. Streak: ${S}. Honor: ${h}%.`)}else{const R=D>0,C=k<3;R&&C?(D--,k++,F++,$=` Streak Saved by Shield (${D} Remaining)`,M="info",n.preferences.deviceNotificationsEnabled&&hf(" Shield Deployed",`Your streak was saved. ${D} shields remaining.`)):(R&&!C?$=" Shield Limit Exceeded! Streak Shattered.":$=" Target Missed. Streak Lost.",S=0,k=0,M="error",n.preferences.deviceNotificationsEnabled&&hf(" Streak Lost","Protocol failed. System reset to Day 0."))}b&&($+=b,M="level-up");const J=n.pendingMode,H=T0[J];return{newUser:{...n,streak:S,gold:E,shields:D,honor:T,honorDailyLog:p,consecutiveShields:k,dailyXP:0,dailyTarget:H,currentMode:J,lastProcessedDate:l.toISOString(),lastOnline:l.toISOString(),metrics:{...n.metrics,shieldsUsed:F,highestStreak:Math.max(n.metrics.highestStreak,S)}},toastMessage:$,toastType:M,newBadge:x}},cg=kl("App",{web:()=>_0(()=>import("./web-DfuzeRld.js"),[]).then(n=>new n.AppWeb)}),Bk=(n,e)=>{const t=K.useRef(n);K.useEffect(()=>{t.current=n},[n]),K.useEffect(()=>((async()=>{try{await cg.addListener("backButton",({canGoBack:r})=>{const l=t.current,{ui:c}=l;if(c.focusSession){e(d=>({...d,ui:{...d.ui,focusSession:null}}));return}if(c.activeModal!=="none"){e(d=>({...d,ui:{...d.ui,activeModal:"none",modalData:void 0}}));return}if(c.currentView!=="tasks"){e(d=>({...d,ui:{...d.ui,currentView:"tasks"}}));return}cg.exitApp()})}catch(r){console.warn("Native back button listener failed",r)}})(),()=>{cg.removeAllListeners()}),[]),K.useEffect(()=>{const i=r=>{e(l=>l.ui.activeModal!=="none"?{...l,ui:{...l.ui,activeModal:"none",modalData:void 0}}:r.state&&r.state.view?{...l,ui:{...l.ui,currentView:r.state.view}}:l)};return window.addEventListener("popstate",i),window.history.replaceState({view:n.ui.currentView},""),()=>window.removeEventListener("popstate",i)},[])},qk=()=>{};var y1={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},$k=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const l=n[t++];e[i++]=String.fromCharCode((r&31)<<6|l&63)}else if(r>239&&r<365){const l=n[t++],c=n[t++],d=n[t++],p=((r&7)<<18|(l&63)<<12|(c&63)<<6|d&63)-65536;e[i++]=String.fromCharCode(55296+(p>>10)),e[i++]=String.fromCharCode(56320+(p&1023))}else{const l=n[t++],c=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(l&63)<<6|c&63)}}return e.join("")},YS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const l=n[r],c=r+1<n.length,d=c?n[r+1]:0,p=r+2<n.length,h=p?n[r+2]:0,x=l>>2,b=(l&3)<<4|d>>4;let T=(d&15)<<2|h>>6,S=h&63;p||(S=64,c||(T=64)),i.push(t[x],t[b],t[T],t[S])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray($S(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):$k(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const l=t[n.charAt(r++)],d=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const b=r<n.length?t[n.charAt(r)]:64;if(++r,l==null||d==null||h==null||b==null)throw new Yk;const T=l<<2|d>>4;if(i.push(T),h!==64){const S=d<<4&240|h>>2;if(i.push(S),b!==64){const E=h<<6&192|b;i.push(E)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class Yk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Jk=function(n){const e=$S(n);return YS.encodeByteArray(e,!0)},qf=function(n){return Jk(n).replace(/\./g,"")},JS=function(n){try{return YS.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk=()=>Kk().__FIREBASE_DEFAULTS__,Wk=()=>{if(typeof process>"u"||typeof y1>"u")return;const n=y1.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Qk=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&JS(n[1]);return e&&JSON.parse(e)},Nh=()=>{try{return qk()||Xk()||Wk()||Qk()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},KS=n=>{var e,t;return(t=(e=Nh())==null?void 0:e.emulatorHosts)==null?void 0:t[n]},Zk=n=>{const e=KS(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},XS=()=>{var n;return(n=Nh())==null?void 0:n.config},WS=n=>{var e;return(e=Nh())==null?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function QS(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,l=n.sub||n.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c={iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...n};return[qf(JSON.stringify(t)),qf(JSON.stringify(c)),""].join(".")}const su={};function nA(){const n={prod:[],emulator:[]};for(const e of Object.keys(su))su[e]?n.emulator.push(e):n.prod.push(e);return n}function iA(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let v1=!1;function ZS(n,e){if(typeof window>"u"||typeof document>"u"||!Al(window.location.host)||su[n]===e||su[n]||v1)return;su[n]=e;function t(T){return`__firebase__banner__${T}`}const i="__firebase__banner",l=nA().prod.length>0;function c(){const T=document.getElementById(i);T&&T.remove()}function d(T){T.style.display="flex",T.style.background="#7faaf0",T.style.position="fixed",T.style.bottom="5px",T.style.left="5px",T.style.padding=".5em",T.style.borderRadius="5px",T.style.alignItems="center"}function p(T,S){T.setAttribute("width","24"),T.setAttribute("id",S),T.setAttribute("height","24"),T.setAttribute("viewBox","0 0 24 24"),T.setAttribute("fill","none"),T.style.marginLeft="-6px"}function h(){const T=document.createElement("span");return T.style.cursor="pointer",T.style.marginLeft="16px",T.style.fontSize="24px",T.innerHTML=" &times;",T.onclick=()=>{v1=!0,c()},T}function x(T,S){T.setAttribute("id",S),T.innerText="Learn more",T.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",T.setAttribute("target","__blank"),T.style.paddingLeft="5px",T.style.textDecoration="underline"}function b(){const T=iA(i),S=t("text"),E=document.getElementById(S)||document.createElement("span"),D=t("learnmore"),k=document.getElementById(D)||document.createElement("a"),F=t("preprendIcon"),$=document.getElementById(F)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(T.created){const M=T.element;d(M),x(k,D);const J=h();p($,F),M.append($,E,k,J),document.body.appendChild(M)}l?(E.innerText="Preview backend disconnected.",$.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):($.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function sA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pn())}function rA(){var e;const n=(e=Nh())==null?void 0:e.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function oA(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function aA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function lA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function cA(){const n=Pn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function uA(){return!rA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function dA(){try{return typeof indexedDB=="object"}catch{return!1}}function fA(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var l;e(((l=r.error)==null?void 0:l.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="FirebaseError";class fr extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=hA,Object.setPrototypeOf(this,fr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Nu.prototype.create)}}class Nu{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,l=this.errors[e],c=l?pA(l,i):"Error",d=`${this.serviceName}: ${c} (${r}).`;return new fr(r,d,i)}}function pA(n,e){return n.replace(mA,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const mA=/\{\$([^}]+)}/g;function gA(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ea(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const l=n[r],c=e[r];if(b1(l)&&b1(c)){if(!ea(l,c))return!1}else if(l!==c)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function b1(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cu(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function xA(n,e){const t=new yA(n,e);return t.subscribe.bind(t)}class yA{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");vA(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=ug),r.error===void 0&&(r.error=ug),r.complete===void 0&&(r.complete=ug);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vA(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ug(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fi(n){return n&&n._delegate?n._delegate:n}class ta{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new eA;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(e==null?void 0:e.optional)??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(i)return null;throw r}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(TA(e))try{this.getOrInitializeService({instanceIdentifier:Jo})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const l=this.getOrInitializeService({instanceIdentifier:r});i.resolve(l)}catch{}}}}clearInstance(e=Jo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Jo){return this.instances.has(e)}getOptions(e=Jo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[l,c]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(l);i===d&&c.resolve(r)}return r}onInit(e,t){const i=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(i)??new Set;r.add(e),this.onInitCallbacks.set(i,r);const l=this.instances.get(i);return l&&e(l,i),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:_A(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Jo){return this.component?this.component.multipleInstances?e:Jo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function _A(n){return n===Jo?void 0:n}function TA(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new bA(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var it;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(it||(it={}));const wA={debug:it.DEBUG,verbose:it.VERBOSE,info:it.INFO,warn:it.WARN,error:it.ERROR,silent:it.SILENT},EA=it.INFO,NA={[it.DEBUG]:"log",[it.VERBOSE]:"log",[it.INFO]:"info",[it.WARN]:"warn",[it.ERROR]:"error"},CA=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=NA[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class w0{constructor(e){this.name=e,this._logLevel=EA,this._logHandler=CA,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in it))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wA[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,it.DEBUG,...e),this._logHandler(this,it.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,it.VERBOSE,...e),this._logHandler(this,it.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,it.INFO,...e),this._logHandler(this,it.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,it.WARN,...e),this._logHandler(this,it.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,it.ERROR,...e),this._logHandler(this,it.ERROR,...e)}}const kA=(n,e)=>e.some(t=>n instanceof t);let _1,T1;function AA(){return _1||(_1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function IA(){return T1||(T1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ew=new WeakMap,Dg=new WeakMap,tw=new WeakMap,dg=new WeakMap,E0=new WeakMap;function RA(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",l),n.removeEventListener("error",c)},l=()=>{t(to(n.result)),r()},c=()=>{i(n.error),r()};n.addEventListener("success",l),n.addEventListener("error",c)});return e.then(t=>{t instanceof IDBCursor&&ew.set(t,n)}).catch(()=>{}),E0.set(e,n),e}function jA(n){if(Dg.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",l),n.removeEventListener("error",c),n.removeEventListener("abort",c)},l=()=>{t(),r()},c=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",l),n.addEventListener("error",c),n.addEventListener("abort",c)});Dg.set(n,e)}let Mg={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Dg.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tw.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return to(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function DA(n){Mg=n(Mg)}function MA(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(fg(this),e,...t);return tw.set(i,e.sort?e.sort():[e]),to(i)}:IA().includes(n)?function(...e){return n.apply(fg(this),e),to(ew.get(this))}:function(...e){return to(n.apply(fg(this),e))}}function PA(n){return typeof n=="function"?MA(n):(n instanceof IDBTransaction&&jA(n),kA(n,AA())?new Proxy(n,Mg):n)}function to(n){if(n instanceof IDBRequest)return RA(n);if(dg.has(n))return dg.get(n);const e=PA(n);return e!==n&&(dg.set(n,e),E0.set(e,n)),e}const fg=n=>E0.get(n);function LA(n,e,{blocked:t,upgrade:i,blocking:r,terminated:l}={}){const c=indexedDB.open(n,e),d=to(c);return i&&c.addEventListener("upgradeneeded",p=>{i(to(c.result),p.oldVersion,p.newVersion,to(c.transaction),p)}),t&&c.addEventListener("blocked",p=>t(p.oldVersion,p.newVersion,p)),d.then(p=>{l&&p.addEventListener("close",()=>l()),r&&p.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),d}const OA=["get","getKey","getAll","getAllKeys","count"],UA=["put","add","delete","clear"],hg=new Map;function S1(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hg.get(e))return hg.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=UA.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||OA.includes(t)))return;const l=async function(c,...d){const p=this.transaction(c,r?"readwrite":"readonly");let h=p.store;return i&&(h=h.index(d.shift())),(await Promise.all([h[t](...d),r&&p.done]))[0]};return hg.set(e,l),l}DA(n=>({...n,get:(e,t,i)=>S1(e,t)||n.get(e,t,i),has:(e,t)=>!!S1(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(zA(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function zA(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pg="@firebase/app",w1="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const or=new w0("@firebase/app"),HA="@firebase/app-compat",FA="@firebase/analytics-compat",GA="@firebase/analytics",BA="@firebase/app-check-compat",qA="@firebase/app-check",$A="@firebase/auth",YA="@firebase/auth-compat",JA="@firebase/database",KA="@firebase/data-connect",XA="@firebase/database-compat",WA="@firebase/functions",QA="@firebase/functions-compat",ZA="@firebase/installations",eI="@firebase/installations-compat",tI="@firebase/messaging",nI="@firebase/messaging-compat",iI="@firebase/performance",sI="@firebase/performance-compat",rI="@firebase/remote-config",oI="@firebase/remote-config-compat",aI="@firebase/storage",lI="@firebase/storage-compat",cI="@firebase/firestore",uI="@firebase/ai",dI="@firebase/firestore-compat",fI="firebase",hI="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg="[DEFAULT]",pI={[Pg]:"fire-core",[HA]:"fire-core-compat",[GA]:"fire-analytics",[FA]:"fire-analytics-compat",[qA]:"fire-app-check",[BA]:"fire-app-check-compat",[$A]:"fire-auth",[YA]:"fire-auth-compat",[JA]:"fire-rtdb",[KA]:"fire-data-connect",[XA]:"fire-rtdb-compat",[WA]:"fire-fn",[QA]:"fire-fn-compat",[ZA]:"fire-iid",[eI]:"fire-iid-compat",[tI]:"fire-fcm",[nI]:"fire-fcm-compat",[iI]:"fire-perf",[sI]:"fire-perf-compat",[rI]:"fire-rc",[oI]:"fire-rc-compat",[aI]:"fire-gcs",[lI]:"fire-gcs-compat",[cI]:"fire-fst",[dI]:"fire-fst-compat",[uI]:"fire-vertex","fire-js":"fire-js",[fI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $f=new Map,mI=new Map,Og=new Map;function E1(n,e){try{n.container.addComponent(e)}catch(t){or.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function bl(n){const e=n.name;if(Og.has(e))return or.debug(`There were multiple attempts to register component ${e}.`),!1;Og.set(e,n);for(const t of $f.values())E1(t,n);for(const t of mI.values())E1(t,n);return!0}function N0(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Yi(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},no=new Nu("app","Firebase",gI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xI{constructor(e,t,i){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ta("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw no.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il=hI;function nw(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i={name:Lg,automaticDataCollectionEnabled:!0,...e},r=i.name;if(typeof r!="string"||!r)throw no.create("bad-app-name",{appName:String(r)});if(t||(t=XS()),!t)throw no.create("no-options");const l=$f.get(r);if(l){if(ea(t,l.options)&&ea(i,l.config))return l;throw no.create("duplicate-app",{appName:r})}const c=new SA(r);for(const p of Og.values())c.addComponent(p);const d=new xI(t,i,c);return $f.set(r,d),d}function iw(n=Lg){const e=$f.get(n);if(!e&&n===Lg&&XS())return nw();if(!e)throw no.create("no-app",{appName:n});return e}function io(n,e,t){let i=pI[n]??n;t&&(i+=`-${t}`);const r=i.match(/\s|\//),l=e.match(/\s|\//);if(r||l){const c=[`Unable to register library "${i}" with version "${e}":`];r&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),r&&l&&c.push("and"),l&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),or.warn(c.join(" "));return}bl(new ta(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI="firebase-heartbeat-database",vI=1,fu="firebase-heartbeat-store";let pg=null;function sw(){return pg||(pg=LA(yI,vI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(fu)}catch(t){console.warn(t)}}}}).catch(n=>{throw no.create("idb-open",{originalErrorMessage:n.message})})),pg}async function bI(n){try{const t=(await sw()).transaction(fu),i=await t.objectStore(fu).get(rw(n));return await t.done,i}catch(e){if(e instanceof fr)or.warn(e.message);else{const t=no.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});or.warn(t.message)}}}async function N1(n,e){try{const i=(await sw()).transaction(fu,"readwrite");await i.objectStore(fu).put(e,rw(n)),await i.done}catch(t){if(t instanceof fr)or.warn(t.message);else{const i=no.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});or.warn(i.message)}}}function rw(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=1024,TI=30;class SI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new EI(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=C1();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)==null?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(c=>c.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:r}),this._heartbeatsCache.heartbeats.length>TI){const c=NI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(i){or.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=C1(),{heartbeatsToSend:i,unsentEntries:r}=wI(this._heartbeatsCache.heartbeats),l=qf(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),l}catch(t){return or.warn(t),""}}}function C1(){return new Date().toISOString().substring(0,10)}function wI(n,e=_I){const t=[];let i=n.slice();for(const r of n){const l=t.find(c=>c.agent===r.agent);if(l){if(l.dates.push(r.date),k1(t)>e){l.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),k1(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class EI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return dA()?fA().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await bI(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return N1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return N1(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function k1(n){return qf(JSON.stringify({version:2,heartbeats:n})).length}function NI(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let i=1;i<n.length;i++)n[i].date<t&&(t=n[i].date,e=i);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CI(n){bl(new ta("platform-logger",e=>new VA(e),"PRIVATE")),bl(new ta("heartbeat",e=>new SI(e),"PRIVATE")),io(Pg,w1,n),io(Pg,w1,"esm2020"),io("fire-js","")}CI("");var kI="firebase",AI="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */io(kI,AI,"app");function ow(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const II=ow,aw=new Nu("auth","Firebase",ow());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf=new w0("@firebase/auth");function RI(n,...e){Yf.logLevel<=it.WARN&&Yf.warn(`Auth (${Il}): ${n}`,...e)}function If(n,...e){Yf.logLevel<=it.ERROR&&Yf.error(`Auth (${Il}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(n,...e){throw k0(n,...e)}function Wi(n,...e){return k0(n,...e)}function C0(n,e,t){const i={...II(),[e]:t};return new Nu("auth","Firebase",i).create(e,{appName:n.name})}function Qo(n){return C0(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function lw(n,e,t){const i=t;if(!(e instanceof i))throw i.name!==e.constructor.name&&Ms(n,"argument-error"),C0(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function k0(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return aw.create(n,...e)}function Fe(n,e,...t){if(!n)throw k0(e,...t)}function ir(n){const e="INTERNAL ASSERTION FAILED: "+n;throw If(e),new Error(e)}function ar(n,e){n||ir(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.href)||""}function jI(){return A1()==="http:"||A1()==="https:"}function A1(){var n;return typeof self<"u"&&((n=self.location)==null?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(jI()||aA()||"connection"in navigator)?navigator.onLine:!0}function MI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ku{constructor(e,t){this.shortDelay=e,this.longDelay=t,ar(t>e,"Short delay should be less than long delay!"),this.isMobile=sA()||lA()}get(){return DI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(n,e){ar(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ir("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ir("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ir("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],OI=new ku(3e4,6e4);function I0(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function Rl(n,e,t,i,r={}){return uw(n,r,async()=>{let l={},c={};i&&(e==="GET"?c=i:l={body:JSON.stringify(i)});const d=Cu({key:n.config.apiKey,...c}).slice(1),p=await n._getAdditionalHeaders();p["Content-Type"]="application/json",n.languageCode&&(p["X-Firebase-Locale"]=n.languageCode);const h={method:e,headers:p,...l};return oA()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Al(n.emulatorConfig.host)&&(h.credentials="include"),cw.fetch()(await dw(n,n.config.apiHost,t,d),h)})}async function uw(n,e,t){n._canInitEmulator=!1;const i={...PI,...e};try{const r=new VI(n),l=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const c=await l.json();if("needConfirmation"in c)throw pf(n,"account-exists-with-different-credential",c);if(l.ok&&!("errorMessage"in c))return c;{const d=l.ok?c.errorMessage:c.error.message,[p,h]=d.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw pf(n,"credential-already-in-use",c);if(p==="EMAIL_EXISTS")throw pf(n,"email-already-in-use",c);if(p==="USER_DISABLED")throw pf(n,"user-disabled",c);const x=i[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw C0(n,x,h);Ms(n,x)}}catch(r){if(r instanceof fr)throw r;Ms(n,"network-request-failed",{message:String(r)})}}async function UI(n,e,t,i,r={}){const l=await Rl(n,e,t,i,r);return"mfaPendingCredential"in l&&Ms(n,"multi-factor-auth-required",{_serverResponse:l}),l}async function dw(n,e,t,i){const r=`${e}${t}?${i}`,l=n,c=l.config.emulator?A0(n.config,r):`${n.config.apiScheme}://${r}`;return LI.includes(t)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(c).toString():c}class VI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(Wi(this.auth,"network-request-failed")),OI.get())})}}function pf(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=Wi(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zI(n,e){return Rl(n,"POST","/v1/accounts:delete",e)}async function Jf(n,e){return Rl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ru(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function HI(n,e=!1){const t=fi(n),i=await t.getIdToken(e),r=R0(i);Fe(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const l=typeof r.firebase=="object"?r.firebase:void 0,c=l==null?void 0:l.sign_in_provider;return{claims:r,token:i,authTime:ru(mg(r.auth_time)),issuedAtTime:ru(mg(r.iat)),expirationTime:ru(mg(r.exp)),signInProvider:c||null,signInSecondFactor:(l==null?void 0:l.sign_in_second_factor)||null}}function mg(n){return Number(n)*1e3}function R0(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return If("JWT malformed, contained fewer than 3 sections"),null;try{const r=JS(t);return r?JSON.parse(r):(If("Failed to decode base64 JWT payload"),null)}catch(r){return If("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function I1(n){const e=R0(n);return Fe(e,"internal-error"),Fe(typeof e.exp<"u","internal-error"),Fe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hu(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof fr&&FI(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function FI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ru(this.lastLoginAt),this.creationTime=ru(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kf(n){var b;const e=n.auth,t=await n.getIdToken(),i=await hu(n,Jf(e,{idToken:t}));Fe(i==null?void 0:i.users.length,e,"internal-error");const r=i.users[0];n._notifyReloadListener(r);const l=(b=r.providerUserInfo)!=null&&b.length?fw(r.providerUserInfo):[],c=qI(n.providerData,l),d=n.isAnonymous,p=!(n.email&&r.passwordHash)&&!(c!=null&&c.length),h=d?p:!1,x={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:c,metadata:new Vg(r.createdAt,r.lastLoginAt),isAnonymous:h};Object.assign(n,x)}async function BI(n){const e=fi(n);await Kf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qI(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function fw(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $I(n,e){const t=await uw(n,{},async()=>{const i=Cu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:l}=n.config,c=await dw(n,r,"/v1/token",`key=${l}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const p={method:"POST",headers:d,body:i};return n.emulatorConfig&&Al(n.emulatorConfig.host)&&(p.credentials="include"),cw.fetch()(c,p)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function YI(n,e){return Rl(n,"POST","/v2/accounts:revokeToken",I0(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Fe(e.idToken,"internal-error"),Fe(typeof e.idToken<"u","internal-error"),Fe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):I1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Fe(e.length!==0,"internal-error");const t=I1(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Fe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:l}=await $I(e,t);this.updateTokensAndExpiration(i,r,Number(l))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:l}=t,c=new dl;return i&&(Fe(typeof i=="string","internal-error",{appName:e}),c.refreshToken=i),r&&(Fe(typeof r=="string","internal-error",{appName:e}),c.accessToken=r),l&&(Fe(typeof l=="number","internal-error",{appName:e}),c.expirationTime=l),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dl,this.toJSON())}_performRefresh(){return ir("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(n,e){Fe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Ji{constructor({uid:e,auth:t,stsTokenManager:i,...r}){this.providerId="firebase",this.proactiveRefresh=new GI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new Vg(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await hu(this,this.stsTokenManager.getToken(this.auth,e));return Fe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return HI(this,e)}reload(){return BI(this)}_assign(e){this!==e&&(Fe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Ji({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Fe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await Kf(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Yi(this.auth.app))return Promise.reject(Qo(this.auth));const e=await this.getIdToken();return await hu(this,zI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const i=t.displayName??void 0,r=t.email??void 0,l=t.phoneNumber??void 0,c=t.photoURL??void 0,d=t.tenantId??void 0,p=t._redirectEventId??void 0,h=t.createdAt??void 0,x=t.lastLoginAt??void 0,{uid:b,emailVerified:T,isAnonymous:S,providerData:E,stsTokenManager:D}=t;Fe(b&&D,e,"internal-error");const k=dl.fromJSON(this.name,D);Fe(typeof b=="string",e,"internal-error"),Jr(i,e.name),Jr(r,e.name),Fe(typeof T=="boolean",e,"internal-error"),Fe(typeof S=="boolean",e,"internal-error"),Jr(l,e.name),Jr(c,e.name),Jr(d,e.name),Jr(p,e.name),Jr(h,e.name),Jr(x,e.name);const F=new Ji({uid:b,auth:e,email:r,emailVerified:T,displayName:i,isAnonymous:S,photoURL:c,phoneNumber:l,tenantId:d,stsTokenManager:k,createdAt:h,lastLoginAt:x});return E&&Array.isArray(E)&&(F.providerData=E.map($=>({...$}))),p&&(F._redirectEventId=p),F}static async _fromIdTokenResponse(e,t,i=!1){const r=new dl;r.updateFromServerResponse(t);const l=new Ji({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await Kf(l),l}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Fe(r.localId!==void 0,"internal-error");const l=r.providerUserInfo!==void 0?fw(r.providerUserInfo):[],c=!(r.email&&r.passwordHash)&&!(l!=null&&l.length),d=new dl;d.updateFromIdToken(i);const p=new Ji({uid:r.localId,auth:e,stsTokenManager:d,isAnonymous:c}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:l,metadata:new Vg(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(l!=null&&l.length)};return Object.assign(p,h),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1=new Map;function sr(n){ar(n instanceof Function,"Expected a class definition");let e=R1.get(n);return e?(ar(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,R1.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}hw.type="NONE";const j1=hw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(n,e,t){return`firebase:${n}:${e}:${t}`}class fl{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:l}=this.auth;this.fullUserKey=Rf(this.userKey,r.apiKey,l),this.fullPersistenceKey=Rf("persistence",r.apiKey,l),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Jf(this.auth,{idToken:e}).catch(()=>{});return t?Ji._fromGetAccountInfoResponse(this.auth,t,e):null}return Ji._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new fl(sr(j1),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let l=r[0]||sr(j1);const c=Rf(i,e.config.apiKey,e.name);let d=null;for(const h of t)try{const x=await h._get(c);if(x){let b;if(typeof x=="string"){const T=await Jf(e,{idToken:x}).catch(()=>{});if(!T)break;b=await Ji._fromGetAccountInfoResponse(e,T,x)}else b=Ji._fromJSON(e,x);h!==l&&(d=b),l=h;break}}catch{}const p=r.filter(h=>h._shouldAllowMigration);return!l._shouldAllowMigration||!p.length?new fl(l,e,i):(l=p[0],d&&await l._set(c,d.toJSON()),await Promise.all(t.map(async h=>{if(h!==l)try{await h._remove(c)}catch{}})),new fl(l,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D1(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(xw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(pw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(vw(e))return"Blackberry";if(bw(e))return"Webos";if(mw(e))return"Safari";if((e.includes("chrome/")||gw(e))&&!e.includes("edge/"))return"Chrome";if(yw(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function pw(n=Pn()){return/firefox\//i.test(n)}function mw(n=Pn()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function gw(n=Pn()){return/crios\//i.test(n)}function xw(n=Pn()){return/iemobile/i.test(n)}function yw(n=Pn()){return/android/i.test(n)}function vw(n=Pn()){return/blackberry/i.test(n)}function bw(n=Pn()){return/webos/i.test(n)}function j0(n=Pn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function JI(n=Pn()){var e;return j0(n)&&!!((e=window.navigator)!=null&&e.standalone)}function KI(){return cA()&&document.documentMode===10}function _w(n=Pn()){return j0(n)||yw(n)||bw(n)||vw(n)||/windows phone/i.test(n)||xw(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tw(n,e=[]){let t;switch(n){case"Browser":t=D1(Pn());break;case"Worker":t=`${D1(Pn())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Il}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=l=>new Promise((c,d)=>{try{const p=e(l);c(p)}catch(p){d(p)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WI(n,e={}){return Rl(n,"GET","/v2/passwordPolicy",I0(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI=6;class ZI{constructor(e){var i;const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??QI,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((i=e.allowedNonAlphanumericCharacters)==null?void 0:i.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eR{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new M1(this),this.idTokenSubscription=new M1(this),this.beforeStateQueue=new XI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=aw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=sr(t)),this._initializationPromise=this.queue(async()=>{var i,r,l;if(!this._deleted&&(this.persistenceManager=await fl.create(this,e),(i=this._resolvePersistenceManagerAvailable)==null||i.call(this),!this._deleted)){if((r=this._popupRedirectResolver)!=null&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((l=this.currentUser)==null?void 0:l.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Jf(this,{idToken:e}),i=await Ji._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var l;if(Yi(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(d,d))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let i=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(l=this.redirectUser)==null?void 0:l._redirectEventId,d=i==null?void 0:i._redirectEventId,p=await this.tryRedirectSignIn(e);(!c||c===d)&&(p!=null&&p.user)&&(i=p.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Fe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Kf(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=MI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Yi(this.app))return Promise.reject(Qo(this));const t=e?fi(e):null;return t&&Fe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Fe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Yi(this.app)?Promise.reject(Qo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Yi(this.app)?Promise.reject(Qo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(sr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await WI(this),t=new ZI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Nu("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await YI(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&sr(e)||this._popupRedirectResolver;Fe(t,this,"argument-error"),this.redirectPersistenceManager=await fl.create(this,[sr(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)==null?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)==null?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((t=this.currentUser)==null?void 0:t.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const l=typeof t=="function"?t:t.next.bind(t);let c=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Fe(d,this,"internal-error"),d.then(()=>{c||l(this.currentUser)}),typeof t=="function"){const p=e.addObserver(t,i,r);return()=>{c=!0,p()}}else{const p=e.addObserver(t);return()=>{c=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Fe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Tw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var r;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await((r=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:r.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;if(Yi(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((t=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:t.getToken());return e!=null&&e.error&&RI(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ch(n){return fi(n)}class M1{constructor(e){this.auth=e,this.observer=null,this.addObserver=xA(t=>this.observer=t)}get next(){return Fe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let D0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function tR(n){D0=n}function nR(n){return D0.loadJS(n)}function iR(){return D0.gapiScript}function sR(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rR(n,e){const t=N0(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),l=t.getOptions();if(ea(l,e??{}))return r;Ms(r,"already-initialized")}return t.initialize({options:e})}function oR(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(sr);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function aR(n,e,t){const i=Ch(n);Fe(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,l=Sw(e),{host:c,port:d}=lR(e),p=d===null?"":`:${d}`,h={url:`${l}//${c}${p}/`},x=Object.freeze({host:c,port:d,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:r})});if(!i._canInitEmulator){Fe(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Fe(ea(h,i.config.emulator)&&ea(x,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=x,i.settings.appVerificationDisabledForTesting=!0,Al(c)?(QS(`${l}//${c}${p}`),ZS("Auth",!0)):cR()}function Sw(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function lR(n){const e=Sw(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const l=r[1];return{host:l,port:P1(i.substr(l.length+1))}}else{const[l,c]=i.split(":");return{host:l,port:P1(c)}}}function P1(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function cR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ir("not implemented")}_getIdTokenResponse(e){return ir("not implemented")}_linkToIdToken(e,t){return ir("not implemented")}_getReauthenticationResolver(e){return ir("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hl(n,e){return UI(n,"POST","/v1/accounts:signInWithIdp",I0(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR="http://localhost";class na extends ww{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new na(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ms("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r,...l}=t;if(!i||!r)return null;const c=new na(i,r);return c.idToken=l.idToken||void 0,c.accessToken=l.accessToken||void 0,c.secret=l.secret,c.nonce=l.nonce,c.pendingToken=l.pendingToken||null,c}_getIdTokenResponse(e){const t=this.buildRequest();return hl(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,hl(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,hl(e,t)}buildRequest(){const e={requestUri:uR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Cu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au extends kh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr extends Au{constructor(){super("facebook.com")}static credential(e){return na._fromParams({providerId:Kr.PROVIDER_ID,signInMethod:Kr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Kr.credentialFromTaggedObject(e)}static credentialFromError(e){return Kr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Kr.credential(e.oauthAccessToken)}catch{return null}}}Kr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Kr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks extends Au{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return na._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ks.credentialFromTaggedObject(e)}static credentialFromError(e){return ks.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return ks.credential(t,i)}catch{return null}}}ks.GOOGLE_SIGN_IN_METHOD="google.com";ks.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xr extends Au{constructor(){super("github.com")}static credential(e){return na._fromParams({providerId:Xr.PROVIDER_ID,signInMethod:Xr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xr.credentialFromTaggedObject(e)}static credentialFromError(e){return Xr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xr.credential(e.oauthAccessToken)}catch{return null}}}Xr.GITHUB_SIGN_IN_METHOD="github.com";Xr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends Au{constructor(){super("twitter.com")}static credential(e,t){return na._fromParams({providerId:Wr.PROVIDER_ID,signInMethod:Wr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Wr.credentialFromTaggedObject(e)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Wr.credential(t,i)}catch{return null}}}Wr.TWITTER_SIGN_IN_METHOD="twitter.com";Wr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const l=await Ji._fromIdTokenResponse(e,i,r),c=L1(i);return new _l({user:l,providerId:c,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=L1(i);return new _l({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function L1(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xf extends fr{constructor(e,t,i,r){super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Xf.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Xf(e,t,i,r)}}function Ew(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?Xf._fromErrorAndOperation(n,l,e,i):l})}async function dR(n,e,t=!1){const i=await hu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return _l._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fR(n,e,t=!1){const{auth:i}=n;if(Yi(i.app))return Promise.reject(Qo(i));const r="reauthenticate";try{const l=await hu(n,Ew(i,r,e,n),t);Fe(l.idToken,i,"internal-error");const c=R0(l.idToken);Fe(c,i,"internal-error");const{sub:d}=c;return Fe(n.uid===d,i,"user-mismatch"),_l._forOperation(n,r,l)}catch(l){throw(l==null?void 0:l.code)==="auth/user-not-found"&&Ms(i,"user-mismatch"),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hR(n,e,t=!1){if(Yi(n.app))return Promise.reject(Qo(n));const i="signIn",r=await Ew(n,i,e),l=await _l._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(l.user),l}function pR(n,e,t,i){return fi(n).onIdTokenChanged(e,t,i)}function mR(n,e,t){return fi(n).beforeAuthStateChanged(e,t)}function M0(n,e,t,i){return fi(n).onAuthStateChanged(e,t,i)}function gR(n){return fi(n).signOut()}const Wf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Wf,"1"),this.storage.removeItem(Wf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR=1e3,yR=10;class Cw extends Nw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_w(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((c,d,p)=>{this.notifyListeners(c,p)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const c=this.storage.getItem(i);!t&&this.localCache[i]===c||this.notifyListeners(i,c)},l=this.storage.getItem(i);KI()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,yR):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},xR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Cw.type="LOCAL";const vR=Cw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw extends Nw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}kw.type="SESSION";const Aw=kw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new Ah(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:l}=t.data,c=this.handlersMap[r];if(!(c!=null&&c.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const d=Array.from(c).map(async h=>h(t.origin,l)),p=await bR(d);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:p})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ah.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P0(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let l,c;return new Promise((d,p)=>{const h=P0("",20);r.port1.start();const x=setTimeout(()=>{p(new Error("unsupported_event"))},i);c={messageChannel:r,onMessage(b){const T=b;if(T.data.eventId===h)switch(T.data.status){case"ack":clearTimeout(x),l=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),d(T.data.response);break;default:clearTimeout(x),clearTimeout(l),p(new Error("invalid_response"));break}}},this.handlers.add(c),r.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(){return window}function TR(n){As().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(){return typeof As().WorkerGlobalScope<"u"&&typeof As().importScripts=="function"}async function SR(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wR(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)==null?void 0:n.controller)||null}function ER(){return Iw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rw="firebaseLocalStorageDb",NR=1,Qf="firebaseLocalStorage",jw="fbase_key";class Iu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ih(n,e){return n.transaction([Qf],e?"readwrite":"readonly").objectStore(Qf)}function CR(){const n=indexedDB.deleteDatabase(Rw);return new Iu(n).toPromise()}function zg(){const n=indexedDB.open(Rw,NR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Qf,{keyPath:jw})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Qf)?e(i):(i.close(),await CR(),e(await zg()))})})}async function O1(n,e,t){const i=Ih(n,!0).put({[jw]:e,value:t});return new Iu(i).toPromise()}async function kR(n,e){const t=Ih(n,!1).get(e),i=await new Iu(t).toPromise();return i===void 0?null:i.value}function U1(n,e){const t=Ih(n,!0).delete(e);return new Iu(t).toPromise()}const AR=800,IR=3;class Dw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await zg(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>IR)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Iw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ah._getInstance(ER()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var t,i;if(this.activeServiceWorker=await SR(),!this.activeServiceWorker)return;this.sender=new _R(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(t=e[0])!=null&&t.fulfilled&&(i=e[0])!=null&&i.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await zg();return await O1(e,Wf,"1"),await U1(e,Wf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>O1(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>kR(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>U1(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const l=Ih(r,!1).getAll();return new Iu(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:l}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(l)&&(this.notifyListeners(r,l),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),AR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Dw.type="LOCAL";const RR=Dw;new ku(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L0(n,e){return e?sr(e):(Fe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends ww{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return hl(e,this._buildIdpRequest())}_linkToIdToken(e,t){return hl(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return hl(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function jR(n){return hR(n.auth,new O0(n),n.bypassAuthState)}function DR(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),fR(t,new O0(n),n.bypassAuthState)}async function MR(n){const{auth:e,user:t}=n;return Fe(t,e,"internal-error"),dR(t,new O0(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e,t,i,r,l=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:l,error:c,type:d}=e;if(c){this.reject(c);return}const p={auth:this.auth,requestUri:t,sessionId:i,tenantId:l||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(p))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return jR;case"linkViaPopup":case"linkViaRedirect":return MR;case"reauthViaPopup":case"reauthViaRedirect":return DR;default:Ms(this.auth,"internal-error")}}resolve(e){ar(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ar(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PR=new ku(2e3,1e4);async function Pw(n,e,t){if(Yi(n.app))return Promise.reject(Wi(n,"operation-not-supported-in-this-environment"));const i=Ch(n);lw(n,e,kh);const r=L0(i,t);return new Qr(i,"signInViaPopup",e,r).executeNotNull()}async function LR(n,e,t){const i=fi(n);lw(i.auth,e,kh);const r=L0(i.auth,t);return new Qr(i.auth,"linkViaPopup",e,r,i).executeNotNull()}class Qr extends Mw{constructor(e,t,i,r,l){super(e,t,r,l),this.provider=i,this.authWindow=null,this.pollId=null,Qr.currentPopupAction&&Qr.currentPopupAction.cancel(),Qr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Fe(e,this.auth,"internal-error"),e}async onExecution(){ar(this.filter.length===1,"Popup operations only handle one event");const e=P0();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Wi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Wi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if((i=(t=this.authWindow)==null?void 0:t.window)!=null&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Wi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PR.get())};e()}}Qr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="pendingRedirect",jf=new Map;class UR extends Mw{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=jf.get(this.auth._key());if(!e){try{const i=await VR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}jf.set(this.auth._key(),e)}return this.bypassAuthState||jf.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function VR(n,e){const t=FR(e),i=HR(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function zR(n,e){jf.set(n._key(),e)}function HR(n){return sr(n._redirectPersistence)}function FR(n){return Rf(OR,n.config.apiKey,n.name)}async function GR(n,e,t=!1){if(Yi(n.app))return Promise.reject(Qo(n));const i=Ch(n),r=L0(i,e),c=await new UR(i,r,t).execute();return c&&!t&&(delete c.user._redirectEventId,await i._persistUserIfCurrent(c.user),await i._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BR=600*1e3;class qR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$R(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!Lw(e)){const r=((i=e.error.code)==null?void 0:i.split("auth/")[1])||"internal-error";t.onError(Wi(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=BR&&this.cachedEventUids.clear(),this.cachedEventUids.has(V1(e))}saveEventToCache(e){this.cachedEventUids.add(V1(e)),this.lastProcessedEventTime=Date.now()}}function V1(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Lw({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function $R(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Lw(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YR(n,e={}){return Rl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,KR=/^https?/;async function XR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await YR(n);for(const t of e)try{if(WR(t))return}catch{}Ms(n,"unauthorized-domain")}function WR(n){const e=Ug(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const c=new URL(n);return c.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&c.hostname===i}if(!KR.test(t))return!1;if(JR.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=new ku(3e4,6e4);function z1(){const n=As().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function ZR(n){return new Promise((e,t)=>{var r,l,c;function i(){z1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{z1(),t(Wi(n,"network-request-failed"))},timeout:QR.get()})}if((l=(r=As().gapi)==null?void 0:r.iframes)!=null&&l.Iframe)e(gapi.iframes.getContext());else if((c=As().gapi)!=null&&c.load)i();else{const d=sR("iframefcb");return As()[d]=()=>{gapi.load?i():t(Wi(n,"network-request-failed"))},nR(`${iR()}?onload=${d}`).catch(p=>t(p))}}).catch(e=>{throw Df=null,e})}let Df=null;function ej(n){return Df=Df||ZR(n),Df}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj=new ku(5e3,15e3),nj="__/auth/iframe",ij="emulator/auth/iframe",sj={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},rj=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function oj(n){const e=n.config;Fe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?A0(e,ij):`https://${n.config.authDomain}/${nj}`,i={apiKey:e.apiKey,appName:n.name,v:Il},r=rj.get(n.config.apiHost);r&&(i.eid=r);const l=n._getFrameworks();return l.length&&(i.fw=l.join(",")),`${t}?${Cu(i).slice(1)}`}async function aj(n){const e=await ej(n),t=As().gapi;return Fe(t,n,"internal-error"),e.open({where:document.body,url:oj(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sj,dontclear:!0},i=>new Promise(async(r,l)=>{await i.restyle({setHideOnLeave:!1});const c=Wi(n,"network-request-failed"),d=As().setTimeout(()=>{l(c)},tj.get());function p(){As().clearTimeout(d),r(i)}i.ping(p).then(p,()=>{l(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},cj=500,uj=600,dj="_blank",fj="http://localhost";class H1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function hj(n,e,t,i=cj,r=uj){const l=Math.max((window.screen.availHeight-r)/2,0).toString(),c=Math.max((window.screen.availWidth-i)/2,0).toString();let d="";const p={...lj,width:i.toString(),height:r.toString(),top:l,left:c},h=Pn().toLowerCase();t&&(d=gw(h)?dj:t),pw(h)&&(e=e||fj,p.scrollbars="yes");const x=Object.entries(p).reduce((T,[S,E])=>`${T}${S}=${E},`,"");if(JI(h)&&d!=="_self")return pj(e||"",d),new H1(null);const b=window.open(e||"",d,x);Fe(b,n,"popup-blocked");try{b.focus()}catch{}return new H1(b)}function pj(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj="__/auth/handler",gj="emulator/auth/handler",xj=encodeURIComponent("fac");async function F1(n,e,t,i,r,l){Fe(n.config.authDomain,n,"auth-domain-config-required"),Fe(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:Il,eventId:r};if(e instanceof kh){e.setDefaultLanguage(n.languageCode),c.providerId=e.providerId||"",gA(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[x,b]of Object.entries({}))c[x]=b}if(e instanceof Au){const x=e.getScopes().filter(b=>b!=="");x.length>0&&(c.scopes=x.join(","))}n.tenantId&&(c.tid=n.tenantId);const d=c;for(const x of Object.keys(d))d[x]===void 0&&delete d[x];const p=await n._getAppCheckToken(),h=p?`#${xj}=${encodeURIComponent(p)}`:"";return`${yj(n)}?${Cu(d).slice(1)}${h}`}function yj({config:n}){return n.emulator?A0(n,gj):`https://${n.authDomain}/${mj}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg="webStorageSupport";class vj{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Aw,this._completeRedirectFn=GR,this._overrideRedirectResult=zR}async _openPopup(e,t,i,r){var c;ar((c=this.eventManagers[e._key()])==null?void 0:c.manager,"_initialize() not called before _openPopup()");const l=await F1(e,t,i,Ug(),r);return hj(e,l,P0())}async _openRedirect(e,t,i,r){await this._originValidation(e);const l=await F1(e,t,i,Ug(),r);return TR(l),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:l}=this.eventManagers[t];return r?Promise.resolve(r):(ar(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await aj(e),i=new qR(e);return t.register("authEvent",r=>(Fe(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gg,{type:gg},r=>{var c;const l=(c=r==null?void 0:r[0])==null?void 0:c[gg];l!==void 0&&t(!!l),Ms(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=XR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _w()||mw()||j0()}}const bj=vj;var G1="@firebase/auth",B1="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Fe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tj(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Sj(n){bl(new ta("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:c,authDomain:d}=i.options;Fe(c&&!c.includes(":"),"invalid-api-key",{appName:i.name});const p={apiKey:c,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Tw(n)},h=new eR(i,r,l,p);return oR(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),bl(new ta("auth-internal",e=>{const t=Ch(e.getProvider("auth").getImmediate());return(i=>new _j(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),io(G1,B1,Tj(n)),io(G1,B1,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj=300,Ej=WS("authIdTokenMaxAge")||wj;let q1=null;const Nj=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>Ej)return;const r=t==null?void 0:t.token;q1!==r&&(q1=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Cj(n=iw()){const e=N0(n,"auth");if(e.isInitialized())return e.getImmediate();const t=rR(n,{popupRedirectResolver:bj,persistence:[RR,vR,Aw]}),i=WS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const c=Nj(l.toString());mR(t,c,()=>c(t.currentUser)),pR(t,d=>c(d))}}const r=KS("auth");return r&&aR(t,`http://${r}`),t}function kj(){var n;return((n=document.getElementsByTagName("head"))==null?void 0:n[0])??document}tR({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const l=Wi("internal-error");l.customData=r,t(l)},i.type="text/javascript",i.charset="UTF-8",kj().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Sj("Browser");var $1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var so,Ow;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(R,C){function A(){}A.prototype=C.prototype,R.F=C.prototype,R.prototype=new A,R.prototype.constructor=R,R.D=function(P,L,O){for(var j=Array(arguments.length-2),q=2;q<arguments.length;q++)j[q-2]=arguments[q];return C.prototype[L].apply(P,j)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,t),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(R,C,A){A||(A=0);const P=Array(16);if(typeof C=="string")for(var L=0;L<16;++L)P[L]=C.charCodeAt(A++)|C.charCodeAt(A++)<<8|C.charCodeAt(A++)<<16|C.charCodeAt(A++)<<24;else for(L=0;L<16;++L)P[L]=C[A++]|C[A++]<<8|C[A++]<<16|C[A++]<<24;C=R.g[0],A=R.g[1],L=R.g[2];let O=R.g[3],j;j=C+(O^A&(L^O))+P[0]+3614090360&4294967295,C=A+(j<<7&4294967295|j>>>25),j=O+(L^C&(A^L))+P[1]+3905402710&4294967295,O=C+(j<<12&4294967295|j>>>20),j=L+(A^O&(C^A))+P[2]+606105819&4294967295,L=O+(j<<17&4294967295|j>>>15),j=A+(C^L&(O^C))+P[3]+3250441966&4294967295,A=L+(j<<22&4294967295|j>>>10),j=C+(O^A&(L^O))+P[4]+4118548399&4294967295,C=A+(j<<7&4294967295|j>>>25),j=O+(L^C&(A^L))+P[5]+1200080426&4294967295,O=C+(j<<12&4294967295|j>>>20),j=L+(A^O&(C^A))+P[6]+2821735955&4294967295,L=O+(j<<17&4294967295|j>>>15),j=A+(C^L&(O^C))+P[7]+4249261313&4294967295,A=L+(j<<22&4294967295|j>>>10),j=C+(O^A&(L^O))+P[8]+1770035416&4294967295,C=A+(j<<7&4294967295|j>>>25),j=O+(L^C&(A^L))+P[9]+2336552879&4294967295,O=C+(j<<12&4294967295|j>>>20),j=L+(A^O&(C^A))+P[10]+4294925233&4294967295,L=O+(j<<17&4294967295|j>>>15),j=A+(C^L&(O^C))+P[11]+2304563134&4294967295,A=L+(j<<22&4294967295|j>>>10),j=C+(O^A&(L^O))+P[12]+1804603682&4294967295,C=A+(j<<7&4294967295|j>>>25),j=O+(L^C&(A^L))+P[13]+4254626195&4294967295,O=C+(j<<12&4294967295|j>>>20),j=L+(A^O&(C^A))+P[14]+2792965006&4294967295,L=O+(j<<17&4294967295|j>>>15),j=A+(C^L&(O^C))+P[15]+1236535329&4294967295,A=L+(j<<22&4294967295|j>>>10),j=C+(L^O&(A^L))+P[1]+4129170786&4294967295,C=A+(j<<5&4294967295|j>>>27),j=O+(A^L&(C^A))+P[6]+3225465664&4294967295,O=C+(j<<9&4294967295|j>>>23),j=L+(C^A&(O^C))+P[11]+643717713&4294967295,L=O+(j<<14&4294967295|j>>>18),j=A+(O^C&(L^O))+P[0]+3921069994&4294967295,A=L+(j<<20&4294967295|j>>>12),j=C+(L^O&(A^L))+P[5]+3593408605&4294967295,C=A+(j<<5&4294967295|j>>>27),j=O+(A^L&(C^A))+P[10]+38016083&4294967295,O=C+(j<<9&4294967295|j>>>23),j=L+(C^A&(O^C))+P[15]+3634488961&4294967295,L=O+(j<<14&4294967295|j>>>18),j=A+(O^C&(L^O))+P[4]+3889429448&4294967295,A=L+(j<<20&4294967295|j>>>12),j=C+(L^O&(A^L))+P[9]+568446438&4294967295,C=A+(j<<5&4294967295|j>>>27),j=O+(A^L&(C^A))+P[14]+3275163606&4294967295,O=C+(j<<9&4294967295|j>>>23),j=L+(C^A&(O^C))+P[3]+4107603335&4294967295,L=O+(j<<14&4294967295|j>>>18),j=A+(O^C&(L^O))+P[8]+1163531501&4294967295,A=L+(j<<20&4294967295|j>>>12),j=C+(L^O&(A^L))+P[13]+2850285829&4294967295,C=A+(j<<5&4294967295|j>>>27),j=O+(A^L&(C^A))+P[2]+4243563512&4294967295,O=C+(j<<9&4294967295|j>>>23),j=L+(C^A&(O^C))+P[7]+1735328473&4294967295,L=O+(j<<14&4294967295|j>>>18),j=A+(O^C&(L^O))+P[12]+2368359562&4294967295,A=L+(j<<20&4294967295|j>>>12),j=C+(A^L^O)+P[5]+4294588738&4294967295,C=A+(j<<4&4294967295|j>>>28),j=O+(C^A^L)+P[8]+2272392833&4294967295,O=C+(j<<11&4294967295|j>>>21),j=L+(O^C^A)+P[11]+1839030562&4294967295,L=O+(j<<16&4294967295|j>>>16),j=A+(L^O^C)+P[14]+4259657740&4294967295,A=L+(j<<23&4294967295|j>>>9),j=C+(A^L^O)+P[1]+2763975236&4294967295,C=A+(j<<4&4294967295|j>>>28),j=O+(C^A^L)+P[4]+1272893353&4294967295,O=C+(j<<11&4294967295|j>>>21),j=L+(O^C^A)+P[7]+4139469664&4294967295,L=O+(j<<16&4294967295|j>>>16),j=A+(L^O^C)+P[10]+3200236656&4294967295,A=L+(j<<23&4294967295|j>>>9),j=C+(A^L^O)+P[13]+681279174&4294967295,C=A+(j<<4&4294967295|j>>>28),j=O+(C^A^L)+P[0]+3936430074&4294967295,O=C+(j<<11&4294967295|j>>>21),j=L+(O^C^A)+P[3]+3572445317&4294967295,L=O+(j<<16&4294967295|j>>>16),j=A+(L^O^C)+P[6]+76029189&4294967295,A=L+(j<<23&4294967295|j>>>9),j=C+(A^L^O)+P[9]+3654602809&4294967295,C=A+(j<<4&4294967295|j>>>28),j=O+(C^A^L)+P[12]+3873151461&4294967295,O=C+(j<<11&4294967295|j>>>21),j=L+(O^C^A)+P[15]+530742520&4294967295,L=O+(j<<16&4294967295|j>>>16),j=A+(L^O^C)+P[2]+3299628645&4294967295,A=L+(j<<23&4294967295|j>>>9),j=C+(L^(A|~O))+P[0]+4096336452&4294967295,C=A+(j<<6&4294967295|j>>>26),j=O+(A^(C|~L))+P[7]+1126891415&4294967295,O=C+(j<<10&4294967295|j>>>22),j=L+(C^(O|~A))+P[14]+2878612391&4294967295,L=O+(j<<15&4294967295|j>>>17),j=A+(O^(L|~C))+P[5]+4237533241&4294967295,A=L+(j<<21&4294967295|j>>>11),j=C+(L^(A|~O))+P[12]+1700485571&4294967295,C=A+(j<<6&4294967295|j>>>26),j=O+(A^(C|~L))+P[3]+2399980690&4294967295,O=C+(j<<10&4294967295|j>>>22),j=L+(C^(O|~A))+P[10]+4293915773&4294967295,L=O+(j<<15&4294967295|j>>>17),j=A+(O^(L|~C))+P[1]+2240044497&4294967295,A=L+(j<<21&4294967295|j>>>11),j=C+(L^(A|~O))+P[8]+1873313359&4294967295,C=A+(j<<6&4294967295|j>>>26),j=O+(A^(C|~L))+P[15]+4264355552&4294967295,O=C+(j<<10&4294967295|j>>>22),j=L+(C^(O|~A))+P[6]+2734768916&4294967295,L=O+(j<<15&4294967295|j>>>17),j=A+(O^(L|~C))+P[13]+1309151649&4294967295,A=L+(j<<21&4294967295|j>>>11),j=C+(L^(A|~O))+P[4]+4149444226&4294967295,C=A+(j<<6&4294967295|j>>>26),j=O+(A^(C|~L))+P[11]+3174756917&4294967295,O=C+(j<<10&4294967295|j>>>22),j=L+(C^(O|~A))+P[2]+718787259&4294967295,L=O+(j<<15&4294967295|j>>>17),j=A+(O^(L|~C))+P[9]+3951481745&4294967295,R.g[0]=R.g[0]+C&4294967295,R.g[1]=R.g[1]+(L+(j<<21&4294967295|j>>>11))&4294967295,R.g[2]=R.g[2]+L&4294967295,R.g[3]=R.g[3]+O&4294967295}i.prototype.v=function(R,C){C===void 0&&(C=R.length);const A=C-this.blockSize,P=this.C;let L=this.h,O=0;for(;O<C;){if(L==0)for(;O<=A;)r(this,R,O),O+=this.blockSize;if(typeof R=="string"){for(;O<C;)if(P[L++]=R.charCodeAt(O++),L==this.blockSize){r(this,P),L=0;break}}else for(;O<C;)if(P[L++]=R[O++],L==this.blockSize){r(this,P),L=0;break}}this.h=L,this.o+=C},i.prototype.A=function(){var R=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);R[0]=128;for(var C=1;C<R.length-8;++C)R[C]=0;C=this.o*8;for(var A=R.length-8;A<R.length;++A)R[A]=C&255,C/=256;for(this.v(R),R=Array(16),C=0,A=0;A<4;++A)for(let P=0;P<32;P+=8)R[C++]=this.g[A]>>>P&255;return R};function l(R,C){var A=d;return Object.prototype.hasOwnProperty.call(A,R)?A[R]:A[R]=C(R)}function c(R,C){this.h=C;const A=[];let P=!0;for(let L=R.length-1;L>=0;L--){const O=R[L]|0;P&&O==C||(A[L]=O,P=!1)}this.g=A}var d={};function p(R){return-128<=R&&R<128?l(R,function(C){return new c([C|0],C<0?-1:0)}):new c([R|0],R<0?-1:0)}function h(R){if(isNaN(R)||!isFinite(R))return b;if(R<0)return k(h(-R));const C=[];let A=1;for(let P=0;R>=A;P++)C[P]=R/A|0,A*=4294967296;return new c(C,0)}function x(R,C){if(R.length==0)throw Error("number format error: empty string");if(C=C||10,C<2||36<C)throw Error("radix out of range: "+C);if(R.charAt(0)=="-")return k(x(R.substring(1),C));if(R.indexOf("-")>=0)throw Error('number format error: interior "-" character');const A=h(Math.pow(C,8));let P=b;for(let O=0;O<R.length;O+=8){var L=Math.min(8,R.length-O);const j=parseInt(R.substring(O,O+L),C);L<8?(L=h(Math.pow(C,L)),P=P.j(L).add(h(j))):(P=P.j(A),P=P.add(h(j)))}return P}var b=p(0),T=p(1),S=p(16777216);n=c.prototype,n.m=function(){if(D(this))return-k(this).m();let R=0,C=1;for(let A=0;A<this.g.length;A++){const P=this.i(A);R+=(P>=0?P:4294967296+P)*C,C*=4294967296}return R},n.toString=function(R){if(R=R||10,R<2||36<R)throw Error("radix out of range: "+R);if(E(this))return"0";if(D(this))return"-"+k(this).toString(R);const C=h(Math.pow(R,6));var A=this;let P="";for(;;){const L=J(A,C).g;A=F(A,L.j(C));let O=((A.g.length>0?A.g[0]:A.h)>>>0).toString(R);if(A=L,E(A))return O+P;for(;O.length<6;)O="0"+O;P=O+P}},n.i=function(R){return R<0?0:R<this.g.length?this.g[R]:this.h};function E(R){if(R.h!=0)return!1;for(let C=0;C<R.g.length;C++)if(R.g[C]!=0)return!1;return!0}function D(R){return R.h==-1}n.l=function(R){return R=F(this,R),D(R)?-1:E(R)?0:1};function k(R){const C=R.g.length,A=[];for(let P=0;P<C;P++)A[P]=~R.g[P];return new c(A,~R.h).add(T)}n.abs=function(){return D(this)?k(this):this},n.add=function(R){const C=Math.max(this.g.length,R.g.length),A=[];let P=0;for(let L=0;L<=C;L++){let O=P+(this.i(L)&65535)+(R.i(L)&65535),j=(O>>>16)+(this.i(L)>>>16)+(R.i(L)>>>16);P=j>>>16,O&=65535,j&=65535,A[L]=j<<16|O}return new c(A,A[A.length-1]&-2147483648?-1:0)};function F(R,C){return R.add(k(C))}n.j=function(R){if(E(this)||E(R))return b;if(D(this))return D(R)?k(this).j(k(R)):k(k(this).j(R));if(D(R))return k(this.j(k(R)));if(this.l(S)<0&&R.l(S)<0)return h(this.m()*R.m());const C=this.g.length+R.g.length,A=[];for(var P=0;P<2*C;P++)A[P]=0;for(P=0;P<this.g.length;P++)for(let L=0;L<R.g.length;L++){const O=this.i(P)>>>16,j=this.i(P)&65535,q=R.i(L)>>>16,le=R.i(L)&65535;A[2*P+2*L]+=j*le,$(A,2*P+2*L),A[2*P+2*L+1]+=O*le,$(A,2*P+2*L+1),A[2*P+2*L+1]+=j*q,$(A,2*P+2*L+1),A[2*P+2*L+2]+=O*q,$(A,2*P+2*L+2)}for(R=0;R<C;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=C;R<2*C;R++)A[R]=0;return new c(A,0)};function $(R,C){for(;(R[C]&65535)!=R[C];)R[C+1]+=R[C]>>>16,R[C]&=65535,C++}function M(R,C){this.g=R,this.h=C}function J(R,C){if(E(C))throw Error("division by zero");if(E(R))return new M(b,b);if(D(R))return C=J(k(R),C),new M(k(C.g),k(C.h));if(D(C))return C=J(R,k(C)),new M(k(C.g),C.h);if(R.g.length>30){if(D(R)||D(C))throw Error("slowDivide_ only works with positive integers.");for(var A=T,P=C;P.l(R)<=0;)A=H(A),P=H(P);var L=z(A,1),O=z(P,1);for(P=z(P,2),A=z(A,2);!E(P);){var j=O.add(P);j.l(R)<=0&&(L=L.add(A),O=j),P=z(P,1),A=z(A,1)}return C=F(R,L.j(C)),new M(L,C)}for(L=b;R.l(C)>=0;){for(A=Math.max(1,Math.floor(R.m()/C.m())),P=Math.ceil(Math.log(A)/Math.LN2),P=P<=48?1:Math.pow(2,P-48),O=h(A),j=O.j(C);D(j)||j.l(R)>0;)A-=P,O=h(A),j=O.j(C);E(O)&&(O=T),L=L.add(O),R=F(R,j)}return new M(L,R)}n.B=function(R){return J(this,R).h},n.and=function(R){const C=Math.max(this.g.length,R.g.length),A=[];for(let P=0;P<C;P++)A[P]=this.i(P)&R.i(P);return new c(A,this.h&R.h)},n.or=function(R){const C=Math.max(this.g.length,R.g.length),A=[];for(let P=0;P<C;P++)A[P]=this.i(P)|R.i(P);return new c(A,this.h|R.h)},n.xor=function(R){const C=Math.max(this.g.length,R.g.length),A=[];for(let P=0;P<C;P++)A[P]=this.i(P)^R.i(P);return new c(A,this.h^R.h)};function H(R){const C=R.g.length+1,A=[];for(let P=0;P<C;P++)A[P]=R.i(P)<<1|R.i(P-1)>>>31;return new c(A,R.h)}function z(R,C){const A=C>>5;C%=32;const P=R.g.length-A,L=[];for(let O=0;O<P;O++)L[O]=C>0?R.i(O+A)>>>C|R.i(O+A+1)<<32-C:R.i(O+A);return new c(L,R.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,Ow=i,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.B,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=h,c.fromString=x,so=c}).apply(typeof $1<"u"?$1:typeof self<"u"?self:typeof window<"u"?window:{});var mf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Uw,Qc,Vw,Mf,Hg,zw,Hw,Fw;(function(){var n,e=Object.defineProperty;function t(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof mf=="object"&&mf];for(var w=0;w<y.length;++w){var I=y[w];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}var i=t(this);function r(y,w){if(w)e:{var I=i;y=y.split(".");for(var G=0;G<y.length-1;G++){var se=y[G];if(!(se in I))break e;I=I[se]}y=y[y.length-1],G=I[y],w=w(G),w!=G&&w!=null&&e(I,y,{configurable:!0,writable:!0,value:w})}}r("Symbol.dispose",function(y){return y||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(y){return y||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(y){return y||function(w){var I=[],G;for(G in w)Object.prototype.hasOwnProperty.call(w,G)&&I.push([G,w[G]]);return I}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},c=this||self;function d(y){var w=typeof y;return w=="object"&&y!=null||w=="function"}function p(y,w,I){return y.call.apply(y.bind,arguments)}function h(y,w,I){return h=p,h.apply(null,arguments)}function x(y,w){var I=Array.prototype.slice.call(arguments,1);return function(){var G=I.slice();return G.push.apply(G,arguments),y.apply(this,G)}}function b(y,w){function I(){}I.prototype=w.prototype,y.Z=w.prototype,y.prototype=new I,y.prototype.constructor=y,y.Ob=function(G,se,de){for(var Ne=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)Ne[Ke-2]=arguments[Ke];return w.prototype[se].apply(G,Ne)}}var T=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?y=>y&&AsyncContext.Snapshot.wrap(y):y=>y;function S(y){const w=y.length;if(w>0){const I=Array(w);for(let G=0;G<w;G++)I[G]=y[G];return I}return[]}function E(y,w){for(let G=1;G<arguments.length;G++){const se=arguments[G];var I=typeof se;if(I=I!="object"?I:se?Array.isArray(se)?"array":I:"null",I=="array"||I=="object"&&typeof se.length=="number"){I=y.length||0;const de=se.length||0;y.length=I+de;for(let Ne=0;Ne<de;Ne++)y[I+Ne]=se[Ne]}else y.push(se)}}class D{constructor(w,I){this.i=w,this.j=I,this.h=0,this.g=null}get(){let w;return this.h>0?(this.h--,w=this.g,this.g=w.next,w.next=null):w=this.i(),w}}function k(y){c.setTimeout(()=>{throw y},0)}function F(){var y=R;let w=null;return y.g&&(w=y.g,y.g=y.g.next,y.g||(y.h=null),w.next=null),w}class ${constructor(){this.h=this.g=null}add(w,I){const G=M.get();G.set(w,I),this.h?this.h.next=G:this.g=G,this.h=G}}var M=new D(()=>new J,y=>y.reset());class J{constructor(){this.next=this.g=this.h=null}set(w,I){this.h=w,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let H,z=!1,R=new $,C=()=>{const y=Promise.resolve(void 0);H=()=>{y.then(A)}};function A(){for(var y;y=F();){try{y.h.call(y.g)}catch(I){k(I)}var w=M;w.j(y),w.h<100&&(w.h++,y.next=w.g,w.g=y)}z=!1}function P(){this.u=this.u,this.C=this.C}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(y,w){this.type=y,this.g=this.target=w,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var O=(function(){if(!c.addEventListener||!Object.defineProperty)return!1;var y=!1,w=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const I=()=>{};c.addEventListener("test",I,w),c.removeEventListener("test",I,w)}catch{}return y})();function j(y){return/^[\s\xa0]*$/.test(y)}function q(y,w){L.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y&&this.init(y,w)}b(q,L),q.prototype.init=function(y,w){const I=this.type=y.type,G=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;this.target=y.target||y.srcElement,this.g=w,w=y.relatedTarget,w||(I=="mouseover"?w=y.fromElement:I=="mouseout"&&(w=y.toElement)),this.relatedTarget=w,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=y.pointerType,this.state=y.state,this.i=y,y.defaultPrevented&&q.Z.h.call(this)},q.prototype.h=function(){q.Z.h.call(this);const y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var le="closure_listenable_"+(Math.random()*1e6|0),U=0;function Y(y,w,I,G,se){this.listener=y,this.proxy=null,this.src=w,this.type=I,this.capture=!!G,this.ha=se,this.key=++U,this.da=this.fa=!1}function X(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function ie(y,w,I){for(const G in y)w.call(I,y[G],G,y)}function pe(y,w){for(const I in y)w.call(void 0,y[I],I,y)}function B(y){const w={};for(const I in y)w[I]=y[I];return w}const ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function he(y,w){let I,G;for(let se=1;se<arguments.length;se++){G=arguments[se];for(I in G)y[I]=G[I];for(let de=0;de<ee.length;de++)I=ee[de],Object.prototype.hasOwnProperty.call(G,I)&&(y[I]=G[I])}}function Q(y){this.src=y,this.g={},this.h=0}Q.prototype.add=function(y,w,I,G,se){const de=y.toString();y=this.g[de],y||(y=this.g[de]=[],this.h++);const Ne=ye(y,w,G,se);return Ne>-1?(w=y[Ne],I||(w.fa=!1)):(w=new Y(w,this.src,de,!!G,se),w.fa=I,y.push(w)),w};function ae(y,w){const I=w.type;if(I in y.g){var G=y.g[I],se=Array.prototype.indexOf.call(G,w,void 0),de;(de=se>=0)&&Array.prototype.splice.call(G,se,1),de&&(X(w),y.g[I].length==0&&(delete y.g[I],y.h--))}}function ye(y,w,I,G){for(let se=0;se<y.length;++se){const de=y[se];if(!de.da&&de.listener==w&&de.capture==!!I&&de.ha==G)return se}return-1}var ue="closure_lm_"+(Math.random()*1e6|0),Te={};function Ae(y,w,I,G,se){if(Array.isArray(w)){for(let de=0;de<w.length;de++)Ae(y,w[de],I,G,se);return null}return I=_e(I),y&&y[le]?y.J(w,I,d(G)?!!G.capture:!1,se):Be(y,w,I,!1,G,se)}function Be(y,w,I,G,se,de){if(!w)throw Error("Invalid event type");const Ne=d(se)?!!se.capture:!!se;let Ke=Ee(y);if(Ke||(y[ue]=Ke=new Q(y)),I=Ke.add(w,I,G,Ne,de),I.proxy)return I;if(G=jt(),I.proxy=G,G.src=y,G.listener=I,y.addEventListener)O||(se=Ne),se===void 0&&(se=!1),y.addEventListener(w.toString(),G,se);else if(y.attachEvent)y.attachEvent(mt(w.toString()),G);else if(y.addListener&&y.removeListener)y.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return I}function jt(){function y(I){return w.call(y.src,y.listener,I)}const w=we;return y}function Dt(y,w,I,G,se){if(Array.isArray(w))for(var de=0;de<w.length;de++)Dt(y,w[de],I,G,se);else G=d(G)?!!G.capture:!!G,I=_e(I),y&&y[le]?(y=y.i,de=String(w).toString(),de in y.g&&(w=y.g[de],I=ye(w,I,G,se),I>-1&&(X(w[I]),Array.prototype.splice.call(w,I,1),w.length==0&&(delete y.g[de],y.h--)))):y&&(y=Ee(y))&&(w=y.g[w.toString()],y=-1,w&&(y=ye(w,I,G,se)),(I=y>-1?w[y]:null)&&An(I))}function An(y){if(typeof y!="number"&&y&&!y.da){var w=y.src;if(w&&w[le])ae(w.i,y);else{var I=y.type,G=y.proxy;w.removeEventListener?w.removeEventListener(I,G,y.capture):w.detachEvent?w.detachEvent(mt(I),G):w.addListener&&w.removeListener&&w.removeListener(G),(I=Ee(w))?(ae(I,y),I.h==0&&(I.src=null,w[ue]=null)):X(y)}}}function mt(y){return y in Te?Te[y]:Te[y]="on"+y}function we(y,w){if(y.da)y=!0;else{w=new q(w,this);const I=y.listener,G=y.ha||y.src;y.fa&&An(y),y=I.call(G,w)}return y}function Ee(y){return y=y[ue],y instanceof Q?y:null}var De="__closure_events_fn_"+(Math.random()*1e9>>>0);function _e(y){return typeof y=="function"?y:(y[De]||(y[De]=function(w){return y.handleEvent(w)}),y[De])}function Pe(){P.call(this),this.i=new Q(this),this.M=this,this.G=null}b(Pe,P),Pe.prototype[le]=!0,Pe.prototype.removeEventListener=function(y,w,I,G){Dt(this,y,w,I,G)};function He(y,w){var I,G=y.G;if(G)for(I=[];G;G=G.G)I.push(G);if(y=y.M,G=w.type||w,typeof w=="string")w=new L(w,y);else if(w instanceof L)w.target=w.target||y;else{var se=w;w=new L(G,y),he(w,se)}se=!0;let de,Ne;if(I)for(Ne=I.length-1;Ne>=0;Ne--)de=w.g=I[Ne],se=At(de,G,!0,w)&&se;if(de=w.g=y,se=At(de,G,!0,w)&&se,se=At(de,G,!1,w)&&se,I)for(Ne=0;Ne<I.length;Ne++)de=w.g=I[Ne],se=At(de,G,!1,w)&&se}Pe.prototype.N=function(){if(Pe.Z.N.call(this),this.i){var y=this.i;for(const w in y.g){const I=y.g[w];for(let G=0;G<I.length;G++)X(I[G]);delete y.g[w],y.h--}}this.G=null},Pe.prototype.J=function(y,w,I,G){return this.i.add(String(y),w,!1,I,G)},Pe.prototype.K=function(y,w,I,G){return this.i.add(String(y),w,!0,I,G)};function At(y,w,I,G){if(w=y.i.g[String(w)],!w)return!0;w=w.concat();let se=!0;for(let de=0;de<w.length;++de){const Ne=w[de];if(Ne&&!Ne.da&&Ne.capture==I){const Ke=Ne.listener,zt=Ne.ha||Ne.src;Ne.fa&&ae(y.i,Ne),se=Ke.call(zt,G)!==!1&&se}}return se&&!G.defaultPrevented}function xo(y,w){if(typeof y!="function")if(y&&typeof y.handleEvent=="function")y=h(y.handleEvent,y);else throw Error("Invalid listener argument");return Number(w)>2147483647?-1:c.setTimeout(y,w||0)}function Ou(y){y.g=xo(()=>{y.g=null,y.i&&(y.i=!1,Ou(y))},y.l);const w=y.h;y.h=null,y.m.apply(null,w)}class Ln extends P{constructor(w,I){super(),this.m=w,this.l=I,this.h=null,this.i=!1,this.g=null}j(w){this.h=arguments,this.g?this.i=!0:Ou(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yo(y){P.call(this),this.h=y,this.g={}}b(yo,P);var Fl=[];function Gl(y){ie(y.g,function(w,I){this.g.hasOwnProperty(I)&&An(w)},y),y.g={}}yo.prototype.N=function(){yo.Z.N.call(this),Gl(this)},yo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gr=c.JSON.stringify,sp=c.JSON.parse,Uu=class{stringify(y){return c.JSON.stringify(y,void 0)}parse(y){return c.JSON.parse(y,void 0)}};function Vu(){}function zu(){}var Pi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function yn(){L.call(this,"d")}b(yn,L);function xi(){L.call(this,"c")}b(xi,L);var Vt={},Hu=null;function pa(){return Hu=Hu||new Pe}Vt.Ia="serverreachability";function Fu(y){L.call(this,Vt.Ia,y)}b(Fu,L);function os(y){const w=pa();He(w,new Fu(w))}Vt.STAT_EVENT="statevent";function vo(y,w){L.call(this,Vt.STAT_EVENT,y),this.stat=w}b(vo,L);function qt(y){const w=pa();He(w,new vo(w,y))}Vt.Ja="timingevent";function as(y,w){L.call(this,Vt.Ja,y),this.size=w}b(as,L);function ls(y,w){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){y()},w)}function Li(){this.g=!0}Li.prototype.ua=function(){this.g=!1};function rp(y,w,I,G,se,de){y.info(function(){if(y.g)if(de){var Ne="",Ke=de.split("&");for(let ht=0;ht<Ke.length;ht++){var zt=Ke[ht].split("=");if(zt.length>1){const It=zt[0];zt=zt[1];const _i=It.split("_");Ne=_i.length>=2&&_i[1]=="type"?Ne+(It+"="+zt+"&"):Ne+(It+"=redacted&")}}}else Ne=null;else Ne=de;return"XMLHTTP REQ ("+G+") [attempt "+se+"]: "+w+`
`+I+`
`+Ne})}function Gu(y,w,I,G,se,de,Ne){y.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+se+"]: "+w+`
`+I+`
`+de+" "+Ne})}function cs(y,w,I,G){y.info(function(){return"XMLHTTP TEXT ("+w+"): "+op(y,I)+(G?" "+G:"")})}function bo(y,w){y.info(function(){return"TIMEOUT: "+w})}Li.prototype.info=function(){};function op(y,w){if(!y.g)return w;if(!w)return null;try{const de=JSON.parse(w);if(de){for(y=0;y<de.length;y++)if(Array.isArray(de[y])){var I=de[y];if(!(I.length<2)){var G=I[1];if(Array.isArray(G)&&!(G.length<1)){var se=G[0];if(se!="noop"&&se!="stop"&&se!="close")for(let Ne=1;Ne<G.length;Ne++)G[Ne]=""}}}}return gr(de)}catch{return w}}var _o={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Bl={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ql;function To(){}b(To,Vu),To.prototype.g=function(){return new XMLHttpRequest},ql=new To;function Us(y){return encodeURIComponent(String(y))}function Bu(y){var w=1;y=y.split(":");const I=[];for(;w>0&&y.length;)I.push(y.shift()),w--;return y.length&&I.push(y.join(":")),I}function Oi(y,w,I,G){this.j=y,this.i=w,this.l=I,this.S=G||1,this.V=new yo(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ui}function Ui(){this.i=null,this.g="",this.h=!1}var $t={},cn={};function us(y,w,I){y.M=1,y.A=So(Jt(w)),y.u=I,y.R=!0,ma(y,null)}function ma(y,w){y.F=Date.now(),ds(y),y.B=Jt(y.A);var I=y.B,G=y.S;Array.isArray(G)||(G=[String(G)]),va(I.i,"t",G),y.C=0,I=y.j.L,y.h=new Ui,y.g=rd(y.j,I?w:null,!y.u),y.P>0&&(y.O=new Ln(h(y.Y,y,y.g),y.P)),w=y.V,I=y.g,G=y.ba;var se="readystatechange";Array.isArray(se)||(se&&(Fl[0]=se.toString()),se=Fl);for(let de=0;de<se.length;de++){const Ne=Ae(I,se[de],G||w.handleEvent,!1,w.h||w);if(!Ne)break;w.g[Ne.key]=Ne}w=y.J?B(y.J):{},y.u?(y.v||(y.v="POST"),w["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.B,y.v,y.u,w)):(y.v="GET",y.g.ea(y.B,y.v,null,w)),os(),rp(y.i,y.v,y.B,y.l,y.S,y.u)}Oi.prototype.ba=function(y){y=y.target;const w=this.O;w&&Hi(y)==3?w.j():this.Y(y)},Oi.prototype.Y=function(y){try{if(y==this.g)e:{const Ke=Hi(this.g),zt=this.g.ya(),ht=this.g.ca();if(!(Ke<3)&&(Ke!=3||this.g&&(this.h.h||this.g.la()||vn(this.g)))){this.K||Ke!=4||zt==7||(zt==8||ht<=0?os(3):os(2)),fs(this);var w=this.g.ca();this.X=w;var I=ap(this);if(this.o=w==200,Gu(this.i,this.v,this.B,this.l,this.S,Ke,w),this.o){if(this.U&&!this.L){t:{if(this.g){var G,se=this.g;if((G=se.g?se.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(G)){var de=G;break t}}de=null}if(y=de)cs(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,hs(this,y);else{this.o=!1,this.m=3,qt(12),ti(this),yi(this);break e}}if(this.R){y=!0;let It;for(;!this.K&&this.C<I.length;)if(It=$u(this,I),It==cn){Ke==4&&(this.m=4,qt(14),y=!1),cs(this.i,this.l,null,"[Incomplete Response]");break}else if(It==$t){this.m=4,qt(15),cs(this.i,this.l,I,"[Invalid Chunk]"),y=!1;break}else cs(this.i,this.l,It,null),hs(this,It);if(qu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ke!=4||I.length!=0||this.h.h||(this.m=1,qt(16),y=!1),this.o=this.o&&y,!y)cs(this.i,this.l,I,"[Invalid Chunked Response]"),ti(this),yi(this);else if(I.length>0&&!this.W){this.W=!0;var Ne=this.j;Ne.g==this&&Ne.aa&&!Ne.P&&(Ne.j.info("Great, no buffering proxy detected. Bytes received: "+I.length),oc(Ne),Ne.P=!0,qt(11))}}else cs(this.i,this.l,I,null),hs(this,I);Ke==4&&ti(this),this.o&&!this.K&&(Ke==4?td(this.j,this):(this.o=!1,ds(this)))}else zs(this.g),w==400&&I.indexOf("Unknown SID")>0?(this.m=3,qt(12)):(this.m=0,qt(13)),ti(this),yi(this)}}}catch{}finally{}};function ap(y){if(!qu(y))return y.g.la();const w=vn(y.g);if(w==="")return"";let I="";const G=w.length,se=Hi(y.g)==4;if(!y.h.i){if(typeof TextDecoder>"u")return ti(y),yi(y),"";y.h.i=new c.TextDecoder}for(let de=0;de<G;de++)y.h.h=!0,I+=y.h.i.decode(w[de],{stream:!(se&&de==G-1)});return w.length=0,y.h.g+=I,y.C=0,y.h.g}function qu(y){return y.g?y.v=="GET"&&y.M!=2&&y.j.Aa:!1}function $u(y,w){var I=y.C,G=w.indexOf(`
`,I);return G==-1?cn:(I=Number(w.substring(I,G)),isNaN(I)?$t:(G+=1,G+I>w.length?cn:(w=w.slice(G,G+I),y.C=G+I,w)))}Oi.prototype.cancel=function(){this.K=!0,ti(this)};function ds(y){y.T=Date.now()+y.H,ga(y,y.H)}function ga(y,w){if(y.D!=null)throw Error("WatchDog timer not null");y.D=ls(h(y.aa,y),w)}function fs(y){y.D&&(c.clearTimeout(y.D),y.D=null)}Oi.prototype.aa=function(){this.D=null;const y=Date.now();y-this.T>=0?(bo(this.i,this.B),this.M!=2&&(os(),qt(17)),ti(this),this.m=2,yi(this)):ga(this,this.T-y)};function yi(y){y.j.I==0||y.K||td(y.j,y)}function ti(y){fs(y);var w=y.O;w&&typeof w.dispose=="function"&&w.dispose(),y.O=null,Gl(y.V),y.g&&(w=y.g,y.g=null,w.abort(),w.dispose())}function hs(y,w){try{var I=y.j;if(I.I!=0&&(I.g==y||ms(I.h,y))){if(!y.L&&ms(I.h,y)&&I.I==3){try{var G=I.Ba.g.parse(w)}catch{G=null}if(Array.isArray(G)&&G.length==3){var se=G;if(se[0]==0){e:if(!I.v){if(I.g)if(I.g.F+3e3<y.F)wa(I),wr(I);else break e;Io(I),qt(18)}}else I.xa=se[1],0<I.xa-I.K&&se[2]<37500&&I.F&&I.A==0&&!I.C&&(I.C=ls(h(I.Va,I),6e3));ps(I.h)<=1&&I.ta&&(I.ta=void 0)}else _s(I,11)}else if((y.L||I.g==y)&&wa(I),!j(w))for(se=I.Ba.g.parse(w),w=0;w<se.length;w++){let ht=se[w];const It=ht[0];if(!(It<=I.K))if(I.K=It,ht=ht[1],I.I==2)if(ht[0]=="c"){I.M=ht[1],I.ba=ht[2];const _i=ht[3];_i!=null&&(I.ka=_i,I.j.info("VER="+I.ka));const Ts=ht[4];Ts!=null&&(I.za=Ts,I.j.info("SVER="+I.za));const Fi=ht[5];Fi!=null&&typeof Fi=="number"&&Fi>0&&(G=1.5*Fi,I.O=G,I.j.info("backChannelRequestTimeoutMs_="+G)),G=I;const Gi=y.g;if(Gi){const Ro=Gi.g?Gi.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ro){var de=G.h;de.g||Ro.indexOf("spdy")==-1&&Ro.indexOf("quic")==-1&&Ro.indexOf("h2")==-1||(de.j=de.l,de.g=new Set,de.h&&(Jl(de,de.h),de.h=null))}if(G.G){const Ea=Gi.g?Gi.g.getResponseHeader("X-HTTP-Session-Id"):null;Ea&&(G.wa=Ea,yt(G.J,G.G,Ea))}}I.I=3,I.l&&I.l.ra(),I.aa&&(I.T=Date.now()-y.F,I.j.info("Handshake RTT: "+I.T+"ms")),G=I;var Ne=y;if(G.na=sd(G,G.L?G.ba:null,G.W),Ne.L){Kl(G.h,Ne);var Ke=Ne,zt=G.O;zt&&(Ke.H=zt),Ke.D&&(fs(Ke),ds(Ke)),G.g=Ne}else Zu(G);I.i.length>0&&bs(I)}else ht[0]!="stop"&&ht[0]!="close"||_s(I,7);else I.I==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?_s(I,7):sc(I):ht[0]!="noop"&&I.l&&I.l.qa(ht),I.A=0)}}os(4)}catch{}}var Yt=class{constructor(y,w){this.g=y,this.map=w}};function $l(y){this.l=y||10,c.PerformanceNavigationTiming?(y=c.performance.getEntriesByType("navigation"),y=y.length>0&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Yl(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function ps(y){return y.h?1:y.g?y.g.size:0}function ms(y,w){return y.h?y.h==w:y.g?y.g.has(w):!1}function Jl(y,w){y.g?y.g.add(w):y.h=w}function Kl(y,w){y.h&&y.h==w?y.h=null:y.g&&y.g.has(w)&&y.g.delete(w)}$l.prototype.cancel=function(){if(this.i=Xl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Xl(y){if(y.h!=null)return y.i.concat(y.h.G);if(y.g!=null&&y.g.size!==0){let w=y.i;for(const I of y.g.values())w=w.concat(I.G);return w}return S(y.i)}var Yu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function xa(y,w){if(y){y=y.split("&");for(let I=0;I<y.length;I++){const G=y[I].indexOf("=");let se,de=null;G>=0?(se=y[I].substring(0,G),de=y[I].substring(G+1)):se=y[I],w(se,de?decodeURIComponent(de.replace(/\+/g," ")):"")}}}function ni(y){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let w;y instanceof ni?(this.l=y.l,un(this,y.j),this.o=y.o,this.g=y.g,xr(this,y.u),this.h=y.h,Wl(this,Wu(y.i)),this.m=y.m):y&&(w=String(y).match(Yu))?(this.l=!1,un(this,w[1]||"",!0),this.o=gs(w[2]||""),this.g=gs(w[3]||"",!0),xr(this,w[4]),this.h=gs(w[5]||"",!0),Wl(this,w[6]||"",!0),this.m=gs(w[7]||"")):(this.l=!1,this.i=new vr(null,this.l))}ni.prototype.toString=function(){const y=[];var w=this.j;w&&y.push(wo(w,ya,!0),":");var I=this.g;return(I||w=="file")&&(y.push("//"),(w=this.o)&&y.push(wo(w,ya,!0),"@"),y.push(Us(I).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),I=this.u,I!=null&&y.push(":",String(I))),(I=this.h)&&(this.g&&I.charAt(0)!="/"&&y.push("/"),y.push(wo(I,I.charAt(0)=="/"?Ql:Ju,!0))),(I=this.i.toString())&&y.push("?",I),(I=this.m)&&y.push("#",wo(I,Ku)),y.join("")},ni.prototype.resolve=function(y){const w=Jt(this);let I=!!y.j;I?un(w,y.j):I=!!y.o,I?w.o=y.o:I=!!y.g,I?w.g=y.g:I=y.u!=null;var G=y.h;if(I)xr(w,y.u);else if(I=!!y.h){if(G.charAt(0)!="/")if(this.g&&!this.h)G="/"+G;else{var se=w.h.lastIndexOf("/");se!=-1&&(G=w.h.slice(0,se+1)+G)}if(se=G,se==".."||se==".")G="";else if(se.indexOf("./")!=-1||se.indexOf("/.")!=-1){G=se.lastIndexOf("/",0)==0,se=se.split("/");const de=[];for(let Ne=0;Ne<se.length;){const Ke=se[Ne++];Ke=="."?G&&Ne==se.length&&de.push(""):Ke==".."?((de.length>1||de.length==1&&de[0]!="")&&de.pop(),G&&Ne==se.length&&de.push("")):(de.push(Ke),G=!0)}G=de.join("/")}else G=se}return I?w.h=G:I=y.i.toString()!=="",I?Wl(w,Wu(y.i)):I=!!y.m,I&&(w.m=y.m),w};function Jt(y){return new ni(y)}function un(y,w,I){y.j=I?gs(w,!0):w,y.j&&(y.j=y.j.replace(/:$/,""))}function xr(y,w){if(w){if(w=Number(w),isNaN(w)||w<0)throw Error("Bad port number "+w);y.u=w}else y.u=null}function Wl(y,w,I){w instanceof vr?(y.i=w,ba(y.i,y.l)):(I||(w=wo(w,yr)),y.i=new vr(w,y.l))}function yt(y,w,I){y.i.set(w,I)}function So(y){return yt(y,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),y}function gs(y,w){return y?w?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function wo(y,w,I){return typeof y=="string"?(y=encodeURI(y).replace(w,Fn),I&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Fn(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var ya=/[#\/\?@]/g,Ju=/[#\?:]/g,Ql=/[#\?]/g,yr=/[#\?@]/g,Ku=/#/g;function vr(y,w){this.h=this.g=null,this.i=y||null,this.j=!!w}function Gn(y){y.g||(y.g=new Map,y.h=0,y.i&&xa(y.i,function(w,I){y.add(decodeURIComponent(w.replace(/\+/g," ")),I)}))}n=vr.prototype,n.add=function(y,w){Gn(this),this.i=null,y=br(this,y);let I=this.g.get(y);return I||this.g.set(y,I=[]),I.push(w),this.h+=1,this};function Xu(y,w){Gn(y),w=br(y,w),y.g.has(w)&&(y.i=null,y.h-=y.g.get(w).length,y.g.delete(w))}function Zl(y,w){return Gn(y),w=br(y,w),y.g.has(w)}n.forEach=function(y,w){Gn(this),this.g.forEach(function(I,G){I.forEach(function(se){y.call(w,se,G,this)},this)},this)};function ec(y,w){Gn(y);let I=[];if(typeof w=="string")Zl(y,w)&&(I=I.concat(y.g.get(br(y,w))));else for(y=Array.from(y.g.values()),w=0;w<y.length;w++)I=I.concat(y[w]);return I}n.set=function(y,w){return Gn(this),this.i=null,y=br(this,y),Zl(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[w]),this.h+=1,this},n.get=function(y,w){return y?(y=ec(this,y),y.length>0?String(y[0]):w):w};function va(y,w,I){Xu(y,w),I.length>0&&(y.i=null,y.g.set(br(y,w),S(I)),y.h+=I.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],w=Array.from(this.g.keys());for(let G=0;G<w.length;G++){var I=w[G];const se=Us(I);I=ec(this,I);for(let de=0;de<I.length;de++){let Ne=se;I[de]!==""&&(Ne+="="+Us(I[de])),y.push(Ne)}}return this.i=y.join("&")};function Wu(y){const w=new vr;return w.i=y.i,y.g&&(w.g=new Map(y.g),w.h=y.h),w}function br(y,w){return w=String(w),y.j&&(w=w.toLowerCase()),w}function ba(y,w){w&&!y.j&&(Gn(y),y.i=null,y.g.forEach(function(I,G){const se=G.toLowerCase();G!=se&&(Xu(this,G),va(this,se,I))},y)),y.j=w}function Vi(y,w){const I=new Li;if(c.Image){const G=new Image;G.onload=x(vi,I,"TestLoadImage: loaded",!0,w,G),G.onerror=x(vi,I,"TestLoadImage: error",!1,w,G),G.onabort=x(vi,I,"TestLoadImage: abort",!1,w,G),G.ontimeout=x(vi,I,"TestLoadImage: timeout",!1,w,G),c.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=y}else w(!1)}function tc(y,w){const I=new Li,G=new AbortController,se=setTimeout(()=>{G.abort(),vi(I,"TestPingServer: timeout",!1,w)},1e4);fetch(y,{signal:G.signal}).then(de=>{clearTimeout(se),de.ok?vi(I,"TestPingServer: ok",!0,w):vi(I,"TestPingServer: server error",!1,w)}).catch(()=>{clearTimeout(se),vi(I,"TestPingServer: error",!1,w)})}function vi(y,w,I,G,se){try{se&&(se.onload=null,se.onerror=null,se.onabort=null,se.ontimeout=null),G(I)}catch{}}function _r(){this.g=new Uu}function xs(y){this.i=y.Sb||null,this.h=y.ab||!1}b(xs,Vu),xs.prototype.g=function(){return new Eo(this.i,this.h)};function Eo(y,w){Pe.call(this),this.H=y,this.o=w,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}b(Eo,Pe),n=Eo.prototype,n.open=function(y,w){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=y,this.D=w,this.readyState=1,zi(this)},n.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const w={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};y&&(w.body=y),(this.H||c).fetch(new Request(this.D,w)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Tr(this)),this.readyState=0},n.Pa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,zi(this)),this.g&&(this.readyState=3,zi(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;_a(this)}else y.text().then(this.Oa.bind(this),this.ga.bind(this))};function _a(y){y.j.read().then(y.Ma.bind(y)).catch(y.ga.bind(y))}n.Ma=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var w=y.value?y.value:new Uint8Array(0);(w=this.B.decode(w,{stream:!y.done}))&&(this.response=this.responseText+=w)}y.done?Tr(this):zi(this),this.readyState==3&&_a(this)}},n.Oa=function(y){this.g&&(this.response=this.responseText=y,Tr(this))},n.Na=function(y){this.g&&(this.response=y,Tr(this))},n.ga=function(){this.g&&Tr(this)};function Tr(y){y.readyState=4,y.l=null,y.j=null,y.B=null,zi(y)}n.setRequestHeader=function(y,w){this.A.append(y,w)},n.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],w=this.h.entries();for(var I=w.next();!I.done;)I=I.value,y.push(I[0]+": "+I[1]),I=w.next();return y.join(`\r
`)};function zi(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Eo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function bi(y){let w="";return ie(y,function(I,G){w+=G,w+=":",w+=I,w+=`\r
`}),w}function No(y,w,I){e:{for(G in I){var G=!1;break e}G=!0}G||(I=bi(I),typeof y=="string"?I!=null&&Us(I):yt(y,w,I))}function _t(y){Pe.call(this),this.headers=new Map,this.L=y||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}b(_t,Pe);var ys=/^https?$/i,nc=["POST","PUT"];n=_t.prototype,n.Fa=function(y){this.H=y},n.ea=function(y,w,I,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);w=w?w.toUpperCase():"GET",this.D=y,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ql.g(),this.g.onreadystatechange=T(h(this.Ca,this));try{this.B=!0,this.g.open(w,String(y),!0),this.B=!1}catch(de){Co(this,de);return}if(y=I||"",I=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var se in G)I.set(se,G[se]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const de of G.keys())I.set(de,G.get(de));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(I.keys()).find(de=>de.toLowerCase()=="content-type"),se=c.FormData&&y instanceof c.FormData,!(Array.prototype.indexOf.call(nc,w,void 0)>=0)||G||se||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[de,Ne]of I)this.g.setRequestHeader(de,Ne);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(y),this.v=!1}catch(de){Co(this,de)}};function Co(y,w){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=w,y.o=5,ic(y),Vs(y)}function ic(y){y.A||(y.A=!0,He(y,"complete"),He(y,"error"))}n.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=y||7,He(this,"complete"),He(this,"abort"),Vs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vs(this,!0)),_t.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ko(this):this.Xa())},n.Xa=function(){ko(this)};function ko(y){if(y.h&&typeof l<"u"){if(y.v&&Hi(y)==4)setTimeout(y.Ca.bind(y),0);else if(He(y,"readystatechange"),Hi(y)==4){y.h=!1;try{const de=y.ca();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var w=!0;break e;default:w=!1}var I;if(!(I=w)){var G;if(G=de===0){let Ne=String(y.D).match(Yu)[1]||null;!Ne&&c.self&&c.self.location&&(Ne=c.self.location.protocol.slice(0,-1)),G=!ys.test(Ne?Ne.toLowerCase():"")}I=G}if(I)He(y,"complete"),He(y,"success");else{y.o=6;try{var se=Hi(y)>2?y.g.statusText:""}catch{se=""}y.l=se+" ["+y.ca()+"]",ic(y)}}finally{Vs(y)}}}}function Vs(y,w){if(y.g){y.m&&(clearTimeout(y.m),y.m=null);const I=y.g;y.g=null,w||He(y,"ready");try{I.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Hi(y){return y.g?y.g.readyState:0}n.ca=function(){try{return Hi(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(y){if(this.g){var w=this.g.responseText;return y&&w.indexOf(y)==0&&(w=w.substring(y.length)),sp(w)}};function vn(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.F){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function zs(y){const w={};y=(y.g&&Hi(y)>=2&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<y.length;G++){if(j(y[G]))continue;var I=Bu(y[G]);const se=I[0];if(I=I[1],typeof I!="string")continue;I=I.trim();const de=w[se]||[];w[se]=de,de.push(I)}pe(w,function(G){return G.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function vs(y,w,I){return I&&I.internalChannelParams&&I.internalChannelParams[y]||w}function Sr(y){this.za=0,this.i=[],this.j=new Li,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=vs("failFast",!1,y),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=vs("baseRetryDelayMs",5e3,y),this.Za=vs("retryDelaySeedMs",1e4,y),this.Ta=vs("forwardChannelMaxRetries",2,y),this.va=vs("forwardChannelRequestTimeoutMs",2e4,y),this.ma=y&&y.xmlHttpFactory||void 0,this.Ua=y&&y.Rb||void 0,this.Aa=y&&y.useFetchStreams||!1,this.O=void 0,this.L=y&&y.supportsCrossDomainXhr||!1,this.M="",this.h=new $l(y&&y.concurrentRequestLimit),this.Ba=new _r,this.S=y&&y.fastHandshake||!1,this.R=y&&y.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=y&&y.Pb||!1,y&&y.ua&&this.j.ua(),y&&y.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&y&&y.detectBufferingProxy||!1,this.ia=void 0,y&&y.longPollingTimeout&&y.longPollingTimeout>0&&(this.ia=y.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=Sr.prototype,n.ka=8,n.I=1,n.connect=function(y,w,I,G){qt(0),this.W=y,this.H=w||{},I&&G!==void 0&&(this.H.OSID=I,this.H.OAID=G),this.F=this.X,this.J=sd(this,null,this.W),bs(this)};function sc(y){if(Ta(y),y.I==3){var w=y.V++,I=Jt(y.J);if(yt(I,"SID",y.M),yt(I,"RID",w),yt(I,"TYPE","terminate"),Ao(y,I),w=new Oi(y,y.j,w),w.M=2,w.A=So(Jt(I)),I=!1,c.navigator&&c.navigator.sendBeacon)try{I=c.navigator.sendBeacon(w.A.toString(),"")}catch{}!I&&c.Image&&(new Image().src=w.A,I=!0),I||(w.g=rd(w.j,null),w.g.ea(w.A)),w.F=Date.now(),ds(w)}id(y)}function wr(y){y.g&&(oc(y),y.g.cancel(),y.g=null)}function Ta(y){wr(y),y.v&&(c.clearTimeout(y.v),y.v=null),wa(y),y.h.cancel(),y.m&&(typeof y.m=="number"&&c.clearTimeout(y.m),y.m=null)}function bs(y){if(!Yl(y.h)&&!y.m){y.m=!0;var w=y.Ea;H||C(),z||(H(),z=!0),R.add(w,y),y.D=0}}function Sa(y,w){return ps(y.h)>=y.h.j-(y.m?1:0)?!1:y.m?(y.i=w.G.concat(y.i),!0):y.I==1||y.I==2||y.D>=(y.Sa?0:y.Ta)?!1:(y.m=ls(h(y.Ea,y,w),nd(y,y.D)),y.D++,!0)}n.Ea=function(y){if(this.m)if(this.m=null,this.I==1){if(!y){this.V=Math.floor(Math.random()*1e5),y=this.V++;const se=new Oi(this,this.j,y);let de=this.o;if(this.U&&(de?(de=B(de),he(de,this.U)):de=this.U),this.u!==null||this.R||(se.J=de,de=null),this.S)e:{for(var w=0,I=0;I<this.i.length;I++){t:{var G=this.i[I];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(w+=G,w>4096){w=I;break e}if(w===4096||I===this.i.length-1){w=I+1;break e}}w=1e3}else w=1e3;w=Qu(this,se,w),I=Jt(this.J),yt(I,"RID",y),yt(I,"CVER",22),this.G&&yt(I,"X-HTTP-Session-Id",this.G),Ao(this,I),de&&(this.R?w="headers="+Us(bi(de))+"&"+w:this.u&&No(I,this.u,de)),Jl(this.h,se),this.Ra&&yt(I,"TYPE","init"),this.S?(yt(I,"$req",w),yt(I,"SID","null"),se.U=!0,us(se,I,null)):us(se,I,w),this.I=2}}else this.I==3&&(y?rc(this,y):this.i.length==0||Yl(this.h)||rc(this))};function rc(y,w){var I;w?I=w.l:I=y.V++;const G=Jt(y.J);yt(G,"SID",y.M),yt(G,"RID",I),yt(G,"AID",y.K),Ao(y,G),y.u&&y.o&&No(G,y.u,y.o),I=new Oi(y,y.j,I,y.D+1),y.u===null&&(I.J=y.o),w&&(y.i=w.G.concat(y.i)),w=Qu(y,I,1e3),I.H=Math.round(y.va*.5)+Math.round(y.va*.5*Math.random()),Jl(y.h,I),us(I,G,w)}function Ao(y,w){y.H&&ie(y.H,function(I,G){yt(w,G,I)}),y.l&&ie({},function(I,G){yt(w,G,I)})}function Qu(y,w,I){I=Math.min(y.i.length,I);const G=y.l?h(y.l.Ka,y.l,y):null;e:{var se=y.i;let Ke=-1;for(;;){const zt=["count="+I];Ke==-1?I>0?(Ke=se[0].g,zt.push("ofs="+Ke)):Ke=0:zt.push("ofs="+Ke);let ht=!0;for(let It=0;It<I;It++){var de=se[It].g;const _i=se[It].map;if(de-=Ke,de<0)Ke=Math.max(0,se[It].g-100),ht=!1;else try{de="req"+de+"_"||"";try{var Ne=_i instanceof Map?_i:Object.entries(_i);for(const[Ts,Fi]of Ne){let Gi=Fi;d(Fi)&&(Gi=gr(Fi)),zt.push(de+Ts+"="+encodeURIComponent(Gi))}}catch(Ts){throw zt.push(de+"type="+encodeURIComponent("_badmap")),Ts}}catch{G&&G(_i)}}if(ht){Ne=zt.join("&");break e}}Ne=void 0}return y=y.i.splice(0,I),w.G=y,Ne}function Zu(y){if(!y.g&&!y.v){y.Y=1;var w=y.Da;H||C(),z||(H(),z=!0),R.add(w,y),y.A=0}}function Io(y){return y.g||y.v||y.A>=3?!1:(y.Y++,y.v=ls(h(y.Da,y),nd(y,y.A)),y.A++,!0)}n.Da=function(){if(this.v=null,ed(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var y=4*this.T;this.j.info("BP detection timer enabled: "+y),this.B=ls(h(this.Wa,this),y)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qt(10),wr(this),ed(this))};function oc(y){y.B!=null&&(c.clearTimeout(y.B),y.B=null)}function ed(y){y.g=new Oi(y,y.j,"rpc",y.Y),y.u===null&&(y.g.J=y.o),y.g.P=0;var w=Jt(y.na);yt(w,"RID","rpc"),yt(w,"SID",y.M),yt(w,"AID",y.K),yt(w,"CI",y.F?"0":"1"),!y.F&&y.ia&&yt(w,"TO",y.ia),yt(w,"TYPE","xmlhttp"),Ao(y,w),y.u&&y.o&&No(w,y.u,y.o),y.O&&(y.g.H=y.O);var I=y.g;y=y.ba,I.M=1,I.A=So(Jt(w)),I.u=null,I.R=!0,ma(I,y)}n.Va=function(){this.C!=null&&(this.C=null,wr(this),Io(this),qt(19))};function wa(y){y.C!=null&&(c.clearTimeout(y.C),y.C=null)}function td(y,w){var I=null;if(y.g==w){wa(y),oc(y),y.g=null;var G=2}else if(ms(y.h,w))I=w.G,Kl(y.h,w),G=1;else return;if(y.I!=0){if(w.o)if(G==1){I=w.u?w.u.length:0,w=Date.now()-w.F;var se=y.D;G=pa(),He(G,new as(G,I)),bs(y)}else Zu(y);else if(se=w.m,se==3||se==0&&w.X>0||!(G==1&&Sa(y,w)||G==2&&Io(y)))switch(I&&I.length>0&&(w=y.h,w.i=w.i.concat(I)),se){case 1:_s(y,5);break;case 4:_s(y,10);break;case 3:_s(y,6);break;default:_s(y,2)}}}function nd(y,w){let I=y.Qa+Math.floor(Math.random()*y.Za);return y.isActive()||(I*=2),I*w}function _s(y,w){if(y.j.info("Error code "+w),w==2){var I=h(y.bb,y),G=y.Ua;const se=!G;G=new ni(G||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||un(G,"https"),So(G),se?Vi(G.toString(),I):tc(G.toString(),I)}else qt(2);y.I=0,y.l&&y.l.pa(w),id(y),Ta(y)}n.bb=function(y){y?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function id(y){if(y.I=0,y.ja=[],y.l){const w=Xl(y.h);(w.length!=0||y.i.length!=0)&&(E(y.ja,w),E(y.ja,y.i),y.h.i.length=0,S(y.i),y.i.length=0),y.l.oa()}}function sd(y,w,I){var G=I instanceof ni?Jt(I):new ni(I);if(G.g!="")w&&(G.g=w+"."+G.g),xr(G,G.u);else{var se=c.location;G=se.protocol,w=w?w+"."+se.hostname:se.hostname,se=+se.port;const de=new ni(null);G&&un(de,G),w&&(de.g=w),se&&xr(de,se),I&&(de.h=I),G=de}return I=y.G,w=y.wa,I&&w&&yt(G,I,w),yt(G,"VER",y.ka),Ao(y,G),G}function rd(y,w,I){if(w&&!y.L)throw Error("Can't create secondary domain capable XhrIo object.");return w=y.Aa&&!y.ma?new _t(new xs({ab:I})):new _t(y.ma),w.Fa(y.L),w}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function od(){}n=od.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function Er(){}Er.prototype.g=function(y,w){return new On(y,w)};function On(y,w){Pe.call(this),this.g=new Sr(w),this.l=y,this.h=w&&w.messageUrlParams||null,y=w&&w.messageHeaders||null,w&&w.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=w&&w.initMessageHeaders||null,w&&w.messageContentType&&(y?y["X-WebChannel-Content-Type"]=w.messageContentType:y={"X-WebChannel-Content-Type":w.messageContentType}),w&&w.sa&&(y?y["X-WebChannel-Client-Profile"]=w.sa:y={"X-WebChannel-Client-Profile":w.sa}),this.g.U=y,(y=w&&w.Qb)&&!j(y)&&(this.g.u=y),this.A=w&&w.supportsCrossDomainXhr||!1,this.v=w&&w.sendRawJson||!1,(w=w&&w.httpSessionIdParam)&&!j(w)&&(this.g.G=w,y=this.h,y!==null&&w in y&&(y=this.h,w in y&&delete y[w])),this.j=new Hs(this)}b(On,Pe),On.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},On.prototype.close=function(){sc(this.g)},On.prototype.o=function(y){var w=this.g;if(typeof y=="string"){var I={};I.__data__=y,y=I}else this.v&&(I={},I.__data__=gr(y),y=I);w.i.push(new Yt(w.Ya++,y)),w.I==3&&bs(w)},On.prototype.N=function(){this.g.l=null,delete this.j,sc(this.g),delete this.g,On.Z.N.call(this)};function ad(y){yn.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var w=y.__sm__;if(w){e:{for(const I in w){y=I;break e}y=void 0}(this.i=y)&&(y=this.i,w=w!==null&&y in w?w[y]:void 0),this.data=w}else this.data=y}b(ad,yn);function ld(){xi.call(this),this.status=1}b(ld,xi);function Hs(y){this.g=y}b(Hs,od),Hs.prototype.ra=function(){He(this.g,"a")},Hs.prototype.qa=function(y){He(this.g,new ad(y))},Hs.prototype.pa=function(y){He(this.g,new ld)},Hs.prototype.oa=function(){He(this.g,"b")},Er.prototype.createWebChannel=Er.prototype.g,On.prototype.send=On.prototype.o,On.prototype.open=On.prototype.m,On.prototype.close=On.prototype.close,Fw=function(){return new Er},Hw=function(){return pa()},zw=Vt,Hg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},_o.NO_ERROR=0,_o.TIMEOUT=8,_o.HTTP_ERROR=6,Mf=_o,Bl.COMPLETE="complete",Vw=Bl,zu.EventType=Pi,Pi.OPEN="a",Pi.CLOSE="b",Pi.ERROR="c",Pi.MESSAGE="d",Pe.prototype.listen=Pe.prototype.J,Qc=zu,_t.prototype.listenOnce=_t.prototype.K,_t.prototype.getLastError=_t.prototype.Ha,_t.prototype.getLastErrorCode=_t.prototype.ya,_t.prototype.getStatus=_t.prototype.ca,_t.prototype.getResponseJson=_t.prototype.La,_t.prototype.getResponseText=_t.prototype.la,_t.prototype.send=_t.prototype.ea,_t.prototype.setWithCredentials=_t.prototype.Fa,Uw=_t}).apply(typeof mf<"u"?mf:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};jn.UNAUTHENTICATED=new jn(null),jn.GOOGLE_CREDENTIALS=new jn("google-credentials-uid"),jn.FIRST_PARTY=new jn("first-party-uid"),jn.MOCK_USER=new jn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jl="12.9.0";function Aj(n){jl=n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia=new w0("@firebase/firestore");function il(){return ia.logLevel}function Ie(n,...e){if(ia.logLevel<=it.DEBUG){const t=e.map(U0);ia.debug(`Firestore (${jl}): ${n}`,...t)}}function lr(n,...e){if(ia.logLevel<=it.ERROR){const t=e.map(U0);ia.error(`Firestore (${jl}): ${n}`,...t)}}function sa(n,...e){if(ia.logLevel<=it.WARN){const t=e.map(U0);ia.warn(`Firestore (${jl}): ${n}`,...t)}}function U0(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ze(n,e,t){let i="Unexpected state";typeof e=="string"?i=e:t=e,Gw(n,i,t)}function Gw(n,e,t){let i=`FIRESTORE (${jl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{i+=" CONTEXT: "+JSON.stringify(t)}catch{i+=" CONTEXT: "+t}throw lr(i),new Error(i)}function xt(n,e,t,i){let r="Unexpected state";typeof t=="string"?r=t:i=t,n||Gw(e,r,i)}function Je(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Me extends fr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bw{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Ij{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(jn.UNAUTHENTICATED)))}shutdown(){}}class Rj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class jj{constructor(e){this.t=e,this.currentUser=jn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){xt(this.o===void 0,42304);let i=this.i;const r=p=>this.i!==i?(i=this.i,t(p)):Promise.resolve();let l=new ro;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new ro,e.enqueueRetryable((()=>r(this.currentUser)))};const c=()=>{const p=l;e.enqueueRetryable((async()=>{await p.promise,await r(this.currentUser)}))},d=p=>{Ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit((p=>d(p))),setTimeout((()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?d(p):(Ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new ro)}}),0),c()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((i=>this.i!==e?(Ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(xt(typeof i.accessToken=="string",31837,{l:i}),new Bw(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return xt(e===null||typeof e=="string",2055,{h:e}),new jn(e)}}class Dj{constructor(e,t,i){this.P=e,this.T=t,this.I=i,this.type="FirstParty",this.user=jn.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class Mj{constructor(e,t,i){this.P=e,this.T=t,this.I=i}getToken(){return Promise.resolve(new Dj(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(jn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Y1{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Pj{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Yi(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){xt(this.o===void 0,3512);const i=l=>{l.error!=null&&Ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const c=l.token!==this.m;return this.m=l.token,Ie("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?t(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const r=l=>{Ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>r(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?r(l):Ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Y1(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(xt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Y1(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const r=Lj(40);for(let l=0;l<r.length;++l)i.length<20&&r[l]<t&&(i+=e.charAt(r[l]%62))}return i}}function st(n,e){return n<e?-1:n>e?1:0}function Fg(n,e){const t=Math.min(n.length,e.length);for(let i=0;i<t;i++){const r=n.charAt(i),l=e.charAt(i);if(r!==l)return xg(r)===xg(l)?st(r,l):xg(r)?1:-1}return st(n.length,e.length)}const Oj=55296,Uj=57343;function xg(n){const e=n.charCodeAt(0);return e>=Oj&&e<=Uj}function Tl(n,e,t){return n.length===e.length&&n.every(((i,r)=>t(i,e[r])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1="__name__";class Cs{constructor(e,t,i){t===void 0?t=0:t>e.length&&ze(637,{offset:t,range:e.length}),i===void 0?i=e.length-t:i>e.length-t&&ze(1746,{length:i,range:e.length-t}),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Cs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Cs?e.forEach((i=>{t.push(i)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const l=Cs.compareSegments(e.get(r),t.get(r));if(l!==0)return l}return st(e.length,t.length)}static compareSegments(e,t){const i=Cs.isNumericId(e),r=Cs.isNumericId(t);return i&&!r?-1:!i&&r?1:i&&r?Cs.extractNumericId(e).compare(Cs.extractNumericId(t)):Fg(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return so.fromString(e.substring(4,e.length-2))}}class Mt extends Cs{construct(e,t,i){return new Mt(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Me(Se.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter((r=>r.length>0)))}return new Mt(t)}static emptyPath(){return new Mt([])}}const Vj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class En extends Cs{construct(e,t,i){return new En(e,t,i)}static isValidIdentifier(e){return Vj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),En.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===J1}static keyField(){return new En([J1])}static fromServerFormat(e){const t=[];let i="",r=0;const l=()=>{if(i.length===0)throw new Me(Se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let c=!1;for(;r<e.length;){const d=e[r];if(d==="\\"){if(r+1===e.length)throw new Me(Se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[r+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new Me(Se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=p,r+=2}else d==="`"?(c=!c,r++):d!=="."||c?(i+=d,r++):(l(),r++)}if(l(),c)throw new Me(Se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new En(t)}static emptyPath(){return new En([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.path=e}static fromPath(e){return new Oe(Mt.fromString(e))}static fromName(e){return new Oe(Mt.fromString(e).popFirst(5))}static empty(){return new Oe(Mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Mt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Oe(new Mt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(n,e,t){if(!t)throw new Me(Se.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Hj(n,e,t,i){if(e===!0&&i===!0)throw new Me(Se.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function K1(n){if(!Oe.isDocumentKey(n))throw new Me(Se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function qw(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function z0(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":ze(12329,{type:typeof n})}function pu(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Me(Se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=z0(n);throw new Me(Se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(n,e){const t={typeString:n};return e&&(t.value=e),t}function Ru(n,e){if(!qw(n))throw new Me(Se.INVALID_ARGUMENT,"JSON must be an object");let t;for(const i in e)if(e[i]){const r=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in n)){t=`JSON missing required field: '${i}'`;break}const c=n[i];if(r&&typeof c!==r){t=`JSON field '${i}' must be a ${r}.`;break}if(l!==void 0&&c!==l.value){t=`Expected '${i}' field to equal '${l.value}'`;break}}if(t)throw new Me(Se.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1=-62135596800,W1=1e6;class kt{static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor((e-1e3*t)*W1);return new kt(t,i)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Me(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Me(Se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<X1)throw new Me(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Me(Se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/W1}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:kt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ru(e,kt._jsonSchema))return new kt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-X1;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}kt._jsonSchemaVersion="firestore/timestamp/1.0",kt._jsonSchema={type:en("string",kt._jsonSchemaVersion),seconds:en("number"),nanoseconds:en("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{static fromTimestamp(e){return new $e(e)}static min(){return new $e(new kt(0,0))}static max(){return new $e(new kt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu=-1;function Fj(n,e){const t=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=$e.fromTimestamp(i===1e9?new kt(t+1,0):new kt(t,i));return new ao(r,Oe.empty(),e)}function Gj(n){return new ao(n.readTime,n.key,mu)}class ao{constructor(e,t,i){this.readTime=e,this.documentKey=t,this.largestBatchId=i}static min(){return new ao($e.min(),Oe.empty(),mu)}static max(){return new ao($e.max(),Oe.empty(),mu)}}function Bj(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Oe.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $j{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Dl(n){if(n.code!==Se.FAILED_PRECONDITION||n.message!==qj)throw n;Ie("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ve(((i,r)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,r)},this.catchCallback=l=>{this.wrapFailure(t,l).next(i,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ve?t:ve.resolve(t)}catch(t){return ve.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ve.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ve.reject(t)}static resolve(e){return new ve(((t,i)=>{t(e)}))}static reject(e){return new ve(((t,i)=>{i(e)}))}static waitFor(e){return new ve(((t,i)=>{let r=0,l=0,c=!1;e.forEach((d=>{++r,d.next((()=>{++l,c&&l===r&&t()}),(p=>i(p)))})),c=!0,l===r&&t()}))}static or(e){let t=ve.resolve(!1);for(const i of e)t=t.next((r=>r?ve.resolve(r):i()));return t}static forEach(e,t){const i=[];return e.forEach(((r,l)=>{i.push(t.call(this,r,l))})),this.waitFor(i)}static mapArray(e,t){return new ve(((i,r)=>{const l=e.length,c=new Array(l);let d=0;for(let p=0;p<l;p++){const h=p;t(e[h]).next((x=>{c[h]=x,++d,d===l&&i(c)}),(x=>r(x)))}}))}static doWhile(e,t){return new ve(((i,r)=>{const l=()=>{e()===!0?t().next((()=>{l()}),r):i()};l()}))}}function Yj(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ml(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>t.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Rh.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0=-1;function jh(n){return n==null}function Zf(n){return n===0&&1/n==-1/0}function Jj(n){return typeof n=="number"&&Number.isInteger(n)&&!Zf(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="";function Kj(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Q1(e)),e=Xj(n.get(t),e);return Q1(e)}function Xj(n,e){let t=e;const i=n.length;for(let r=0;r<i;r++){const l=n.charAt(r);switch(l){case"\0":t+="";break;case $w:t+="";break;default:t+=l}}return t}function Q1(n){return n+$w+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z1(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function oa(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Yw(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,t){this.comparator=e,this.root=t||wn.EMPTY}insert(e,t){return new Pt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,wn.BLACK,null,null))}remove(e){return new Pt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,wn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(i===0)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const r=this.comparator(e,i.key);if(r===0)return t+i.left.size;r<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,i)=>(e(t,i),!1)))}toString(){const e=[];return this.inorderTraversal(((t,i)=>(e.push(`${t}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new gf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new gf(this.root,e,this.comparator,!1)}getReverseIterator(){return new gf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new gf(this.root,e,this.comparator,!0)}}class gf{constructor(e,t,i,r){this.isReverse=r,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=t?i(e.key,t):1,t&&r&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class wn{constructor(e,t,i,r,l){this.key=e,this.value=t,this.color=i??wn.RED,this.left=r??wn.EMPTY,this.right=l??wn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,r,l){return new wn(e??this.key,t??this.value,i??this.color,r??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let r=this;const l=i(e,r.key);return r=l<0?r.copy(null,null,null,r.left.insert(e,t,i),null):l===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return wn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),t(e,r.key)===0){if(r.right.isEmpty())return wn.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,wn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,wn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ze(27949);return e+(this.isRed()?0:1)}}wn.EMPTY=null,wn.RED=!0,wn.BLACK=!1;wn.EMPTY=new class{constructor(){this.size=0}get key(){throw ze(57766)}get value(){throw ze(16141)}get color(){throw ze(16727)}get left(){throw ze(29726)}get right(){throw ze(36894)}copy(e,t,i,r,l){return this}insert(e,t,i){return new wn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.comparator=e,this.data=new Pt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,i)=>(e(t),!1)))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const r=i.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let i;for(i=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new e_(this.data.getIterator())}getIteratorFrom(e){return new e_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((i=>{t=t.add(i)})),t}isEqual(e){if(!(e instanceof an)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const r=t.getNext().key,l=i.getNext().key;if(this.comparator(r,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new an(this.comparator);return t.data=e,t}}class e_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(e){this.fields=e,e.sort(En.comparator)}static empty(){return new Ki([])}unionWith(e){let t=new an(En.comparator);for(const i of this.fields)t=t.add(i);for(const i of e)t=t.add(i);return new Ki(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Tl(this.fields,e.fields,((t,i)=>t.isEqual(i)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(r){try{return atob(r)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new Jw("Invalid base64 string: "+l):l}})(e);return new Cn(t)}static fromUint8Array(e){const t=(function(r){let l="";for(let c=0;c<r.length;++c)l+=String.fromCharCode(r[c]);return l})(e);return new Cn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const i=new Uint8Array(t.length);for(let r=0;r<t.length;r++)i[r]=t.charCodeAt(r);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Cn.EMPTY_BYTE_STRING=new Cn("");const Wj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function lo(n){if(xt(!!n,39018),typeof n=="string"){let e=0;const t=Wj.exec(n);if(xt(!!t,46558,{timestamp:n}),t[1]){let r=t[1];r=(r+"000000000").substr(0,9),e=Number(r)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Gt(n.seconds),nanos:Gt(n.nanos)}}function Gt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function co(n){return typeof n=="string"?Cn.fromBase64String(n):Cn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kw="server_timestamp",Xw="__type__",Ww="__previous_value__",Qw="__local_write_time__";function F0(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Xw])==null?void 0:i.stringValue)===Kw}function Dh(n){const e=n.mapValue.fields[Ww];return F0(e)?Dh(e):e}function gu(n){const e=lo(n.mapValue.fields[Qw].timestampValue);return new kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qj{constructor(e,t,i,r,l,c,d,p,h,x,b){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=r,this.ssl=l,this.forceLongPolling=c,this.autoDetectLongPolling=d,this.longPollingOptions=p,this.useFetchStreams=h,this.isUsingEmulator=x,this.apiKey=b}}const eh="(default)";class xu{constructor(e,t){this.projectId=e,this.database=t||eh}static empty(){return new xu("","")}get isDefaultDatabase(){return this.database===eh}isEqual(e){return e instanceof xu&&e.projectId===this.projectId&&e.database===this.database}}function Zj(n,e){if(!Object.prototype.hasOwnProperty.apply(n.options,["projectId"]))throw new Me(Se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xu(n.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw="__type__",eD="__max__",xf={mapValue:{}},eE="__vector__",th="value";function uo(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?F0(n)?4:nD(n)?9007199254740991:tD(n)?10:11:ze(28295,{value:n})}function Ps(n,e){if(n===e)return!0;const t=uo(n);if(t!==uo(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return gu(n).isEqual(gu(e));case 3:return(function(r,l){if(typeof r.timestampValue=="string"&&typeof l.timestampValue=="string"&&r.timestampValue.length===l.timestampValue.length)return r.timestampValue===l.timestampValue;const c=lo(r.timestampValue),d=lo(l.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(r,l){return co(r.bytesValue).isEqual(co(l.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(r,l){return Gt(r.geoPointValue.latitude)===Gt(l.geoPointValue.latitude)&&Gt(r.geoPointValue.longitude)===Gt(l.geoPointValue.longitude)})(n,e);case 2:return(function(r,l){if("integerValue"in r&&"integerValue"in l)return Gt(r.integerValue)===Gt(l.integerValue);if("doubleValue"in r&&"doubleValue"in l){const c=Gt(r.doubleValue),d=Gt(l.doubleValue);return c===d?Zf(c)===Zf(d):isNaN(c)&&isNaN(d)}return!1})(n,e);case 9:return Tl(n.arrayValue.values||[],e.arrayValue.values||[],Ps);case 10:case 11:return(function(r,l){const c=r.mapValue.fields||{},d=l.mapValue.fields||{};if(Z1(c)!==Z1(d))return!1;for(const p in c)if(c.hasOwnProperty(p)&&(d[p]===void 0||!Ps(c[p],d[p])))return!1;return!0})(n,e);default:return ze(52216,{left:n})}}function yu(n,e){return(n.values||[]).find((t=>Ps(t,e)))!==void 0}function Sl(n,e){if(n===e)return 0;const t=uo(n),i=uo(e);if(t!==i)return st(t,i);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return(function(l,c){const d=Gt(l.integerValue||l.doubleValue),p=Gt(c.integerValue||c.doubleValue);return d<p?-1:d>p?1:d===p?0:isNaN(d)?isNaN(p)?0:-1:1})(n,e);case 3:return t_(n.timestampValue,e.timestampValue);case 4:return t_(gu(n),gu(e));case 5:return Fg(n.stringValue,e.stringValue);case 6:return(function(l,c){const d=co(l),p=co(c);return d.compareTo(p)})(n.bytesValue,e.bytesValue);case 7:return(function(l,c){const d=l.split("/"),p=c.split("/");for(let h=0;h<d.length&&h<p.length;h++){const x=st(d[h],p[h]);if(x!==0)return x}return st(d.length,p.length)})(n.referenceValue,e.referenceValue);case 8:return(function(l,c){const d=st(Gt(l.latitude),Gt(c.latitude));return d!==0?d:st(Gt(l.longitude),Gt(c.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return n_(n.arrayValue,e.arrayValue);case 10:return(function(l,c){var T,S,E,D;const d=l.fields||{},p=c.fields||{},h=(T=d[th])==null?void 0:T.arrayValue,x=(S=p[th])==null?void 0:S.arrayValue,b=st(((E=h==null?void 0:h.values)==null?void 0:E.length)||0,((D=x==null?void 0:x.values)==null?void 0:D.length)||0);return b!==0?b:n_(h,x)})(n.mapValue,e.mapValue);case 11:return(function(l,c){if(l===xf.mapValue&&c===xf.mapValue)return 0;if(l===xf.mapValue)return 1;if(c===xf.mapValue)return-1;const d=l.fields||{},p=Object.keys(d),h=c.fields||{},x=Object.keys(h);p.sort(),x.sort();for(let b=0;b<p.length&&b<x.length;++b){const T=Fg(p[b],x[b]);if(T!==0)return T;const S=Sl(d[p[b]],h[x[b]]);if(S!==0)return S}return st(p.length,x.length)})(n.mapValue,e.mapValue);default:throw ze(23264,{he:t})}}function t_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=lo(n),i=lo(e),r=st(t.seconds,i.seconds);return r!==0?r:st(t.nanos,i.nanos)}function n_(n,e){const t=n.values||[],i=e.values||[];for(let r=0;r<t.length&&r<i.length;++r){const l=Sl(t[r],i[r]);if(l)return l}return st(t.length,i.length)}function wl(n){return Gg(n)}function Gg(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const i=lo(t);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return co(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return Oe.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let i="[",r=!0;for(const l of t.values||[])r?r=!1:i+=",",i+=Gg(l);return i+"]"})(n.arrayValue):"mapValue"in n?(function(t){const i=Object.keys(t.fields||{}).sort();let r="{",l=!0;for(const c of i)l?l=!1:r+=",",r+=`${c}:${Gg(t.fields[c])}`;return r+"}"})(n.mapValue):ze(61005,{value:n})}function Pf(n){switch(uo(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Dh(n);return e?16+Pf(e):16;case 5:return 2*n.stringValue.length;case 6:return co(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((r,l)=>r+Pf(l)),0)})(n.arrayValue);case 10:case 11:return(function(i){let r=0;return oa(i.fields,((l,c)=>{r+=l.length+Pf(c)})),r})(n.mapValue);default:throw ze(13486,{value:n})}}function Bg(n){return!!n&&"integerValue"in n}function G0(n){return!!n&&"arrayValue"in n}function i_(n){return!!n&&"nullValue"in n}function s_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Lf(n){return!!n&&"mapValue"in n}function tD(n){var t,i;return((i=(((t=n==null?void 0:n.mapValue)==null?void 0:t.fields)||{})[Zw])==null?void 0:i.stringValue)===eE}function ou(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const e={mapValue:{fields:{}}};return oa(n.mapValue.fields,((t,i)=>e.mapValue.fields[t]=ou(i))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ou(n.arrayValue.values[t]);return e}return{...n}}function nD(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===eD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e){this.value=e}static empty(){return new Ri({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!Lf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ou(t)}setAll(e){let t=En.emptyPath(),i={},r=[];e.forEach(((c,d)=>{if(!t.isImmediateParentOf(d)){const p=this.getFieldsMap(t);this.applyChanges(p,i,r),i={},r=[],t=d.popLast()}c?i[d.lastSegment()]=ou(c):r.push(d.lastSegment())}));const l=this.getFieldsMap(t);this.applyChanges(l,i,r)}delete(e){const t=this.field(e.popLast());Lf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ps(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let r=t.mapValue.fields[e.get(i)];Lf(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,i){oa(t,((r,l)=>e[r]=l));for(const r of i)delete e[r]}clone(){return new Ri(ou(this.value))}}function tE(n){const e=[];return oa(n.fields,((t,i)=>{const r=new En([t]);if(Lf(i)){const l=tE(i.mapValue).fields;if(l.length===0)e.push(r);else for(const c of l)e.push(r.child(c))}else e.push(r)})),new Ki(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e,t,i,r,l,c,d){this.key=e,this.documentType=t,this.version=i,this.readTime=r,this.createTime=l,this.data=c,this.documentState=d}static newInvalidDocument(e){return new Mn(e,0,$e.min(),$e.min(),$e.min(),Ri.empty(),0)}static newFoundDocument(e,t,i,r){return new Mn(e,1,t,$e.min(),i,r,0)}static newNoDocument(e,t){return new Mn(e,2,t,$e.min(),$e.min(),Ri.empty(),0)}static newUnknownDocument(e,t){return new Mn(e,3,t,$e.min(),$e.min(),Ri.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual($e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ri.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ri.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=$e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Mn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,t){this.position=e,this.inclusive=t}}function r_(n,e,t){let i=0;for(let r=0;r<n.position.length;r++){const l=e[r],c=n.position[r];if(l.field.isKeyField()?i=Oe.comparator(Oe.fromName(c.referenceValue),t.key):i=Sl(c,t.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function o_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ps(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(e,t="asc"){this.field=e,this.dir=t}}function iD(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{}class on extends nE{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,i):new rD(e,t,i):t==="array-contains"?new lD(e,i):t==="in"?new cD(e,i):t==="not-in"?new uD(e,i):t==="array-contains-any"?new dD(e,i):new on(e,t,i)}static createKeyFieldInFilter(e,t,i){return t==="in"?new oD(e,i):new aD(e,i)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Sl(t,this.value)):t!==null&&uo(this.value)===uo(t)&&this.matchesComparison(Sl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ls extends nE{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Ls(e,t)}matches(e){return iE(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function iE(n){return n.op==="and"}function sE(n){return sD(n)&&iE(n)}function sD(n){for(const e of n.filters)if(e instanceof Ls)return!1;return!0}function qg(n){if(n instanceof on)return n.field.canonicalString()+n.op.toString()+wl(n.value);if(sE(n))return n.filters.map((e=>qg(e))).join(",");{const e=n.filters.map((t=>qg(t))).join(",");return`${n.op}(${e})`}}function rE(n,e){return n instanceof on?(function(i,r){return r instanceof on&&i.op===r.op&&i.field.isEqual(r.field)&&Ps(i.value,r.value)})(n,e):n instanceof Ls?(function(i,r){return r instanceof Ls&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce(((l,c,d)=>l&&rE(c,r.filters[d])),!0):!1})(n,e):void ze(19439)}function oE(n){return n instanceof on?(function(t){return`${t.field.canonicalString()} ${t.op} ${wl(t.value)}`})(n):n instanceof Ls?(function(t){return t.op.toString()+" {"+t.getFilters().map(oE).join(" ,")+"}"})(n):"Filter"}class rD extends on{constructor(e,t,i){super(e,t,i),this.key=Oe.fromName(i.referenceValue)}matches(e){const t=Oe.comparator(e.key,this.key);return this.matchesComparison(t)}}class oD extends on{constructor(e,t){super(e,"in",t),this.keys=aE("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class aD extends on{constructor(e,t){super(e,"not-in",t),this.keys=aE("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function aE(n,e){var t;return(((t=e.arrayValue)==null?void 0:t.values)||[]).map((i=>Oe.fromName(i.referenceValue)))}class lD extends on{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return G0(t)&&yu(t.arrayValue,this.value)}}class cD extends on{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&yu(this.value.arrayValue,t)}}class uD extends on{constructor(e,t){super(e,"not-in",t)}matches(e){if(yu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!yu(this.value.arrayValue,t)}}class dD extends on{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!G0(t)||!t.arrayValue.values)&&t.arrayValue.values.some((i=>yu(this.value.arrayValue,i)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e,t=null,i=[],r=[],l=null,c=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=r,this.limit=l,this.startAt=c,this.endAt=d,this.Te=null}}function a_(n,e=null,t=[],i=[],r=null,l=null,c=null){return new fD(n,e,t,i,r,l,c)}function B0(n){const e=Je(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((i=>qg(i))).join(","),t+="|ob:",t+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),jh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((i=>wl(i))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((i=>wl(i))).join(",")),e.Te=t}return e.Te}function q0(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!iD(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!rE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!o_(n.startAt,e.startAt)&&o_(n.endAt,e.endAt)}function $g(n){return Oe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(e,t=null,i=[],r=[],l=null,c="F",d=null,p=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=l,this.limitType=c,this.startAt=d,this.endAt=p,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function hD(n,e,t,i,r,l,c,d){return new Mh(n,e,t,i,r,l,c,d)}function $0(n){return new Mh(n)}function l_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function pD(n){return Oe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function mD(n){return n.collectionGroup!==null}function au(n){const e=Je(n);if(e.Ie===null){e.Ie=[];const t=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),t.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let d=new an(En.comparator);return c.filters.forEach((p=>{p.getFlattenedFilters().forEach((h=>{h.isInequality()&&(d=d.add(h.field))}))})),d})(e).forEach((l=>{t.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new ih(l,i))})),t.has(En.keyField().canonicalString())||e.Ie.push(new ih(En.keyField(),i))}return e.Ie}function Is(n){const e=Je(n);return e.Ee||(e.Ee=gD(e,au(n))),e.Ee}function gD(n,e){if(n.limitType==="F")return a_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((r=>{const l=r.dir==="desc"?"asc":"desc";return new ih(r.field,l)}));const t=n.endAt?new nh(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new nh(n.startAt.position,n.startAt.inclusive):null;return a_(n.path,n.collectionGroup,e,n.filters,n.limit,t,i)}}function Yg(n,e,t){return new Mh(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ph(n,e){return q0(Is(n),Is(e))&&n.limitType===e.limitType}function lE(n){return`${B0(Is(n))}|lt:${n.limitType}`}function sl(n){return`Query(target=${(function(t){let i=t.path.canonicalString();return t.collectionGroup!==null&&(i+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(i+=`, filters: [${t.filters.map((r=>oE(r))).join(", ")}]`),jh(t.limit)||(i+=", limit: "+t.limit),t.orderBy.length>0&&(i+=`, orderBy: [${t.orderBy.map((r=>(function(c){return`${c.field.canonicalString()} (${c.dir})`})(r))).join(", ")}]`),t.startAt&&(i+=", startAt: ",i+=t.startAt.inclusive?"b:":"a:",i+=t.startAt.position.map((r=>wl(r))).join(",")),t.endAt&&(i+=", endAt: ",i+=t.endAt.inclusive?"a:":"b:",i+=t.endAt.position.map((r=>wl(r))).join(",")),`Target(${i})`})(Is(n))}; limitType=${n.limitType})`}function Lh(n,e){return e.isFoundDocument()&&(function(i,r){const l=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):Oe.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(n,e)&&(function(i,r){for(const l of au(i))if(!l.field.isKeyField()&&r.data.field(l.field)===null)return!1;return!0})(n,e)&&(function(i,r){for(const l of i.filters)if(!l.matches(r))return!1;return!0})(n,e)&&(function(i,r){return!(i.startAt&&!(function(c,d,p){const h=r_(c,d,p);return c.inclusive?h<=0:h<0})(i.startAt,au(i),r)||i.endAt&&!(function(c,d,p){const h=r_(c,d,p);return c.inclusive?h>=0:h>0})(i.endAt,au(i),r))})(n,e)}function xD(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function cE(n){return(e,t)=>{let i=!1;for(const r of au(n)){const l=yD(r,e,t);if(l!==0)return l;i=i||r.field.isKeyField()}return 0}}function yD(n,e,t){const i=n.field.isKeyField()?Oe.comparator(e.key,t.key):(function(l,c,d){const p=c.data.field(l),h=d.data.field(l);return p!==null&&h!==null?Sl(p,h):ze(42886)})(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return ze(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i!==void 0){for(const[r,l]of i)if(this.equalsFn(r,e))return l}}has(e){return this.get(e)!==void 0}set(e,t){const i=this.mapKeyFn(e),r=this.inner[i];if(r===void 0)return this.inner[i]=[[e,t]],void this.innerSize++;for(let l=0;l<r.length;l++)if(this.equalsFn(r[l][0],e))return void(r[l]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e))return i.length===1?delete this.inner[t]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(e){oa(this.inner,((t,i)=>{for(const[r,l]of i)e(r,l)}))}isEmpty(){return Yw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new Pt(Oe.comparator);function cr(){return vD}const uE=new Pt(Oe.comparator);function Zc(...n){let e=uE;for(const t of n)e=e.insert(t.key,t);return e}function dE(n){let e=uE;return n.forEach(((t,i)=>e=e.insert(t,i.overlayedDocument))),e}function Xo(){return lu()}function fE(){return lu()}function lu(){return new aa((n=>n.toString()),((n,e)=>n.isEqual(e)))}const bD=new Pt(Oe.comparator),_D=new an(Oe.comparator);function rt(...n){let e=_D;for(const t of n)e=e.add(t);return e}const TD=new an(st);function SD(){return TD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zf(e)?"-0":e}}function hE(n){return{integerValue:""+n}}function wD(n,e){return Jj(e)?hE(e):Y0(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(){this._=void 0}}function ED(n,e,t){return n instanceof sh?(function(r,l){const c={fields:{[Xw]:{stringValue:Kw},[Qw]:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return l&&F0(l)&&(l=Dh(l)),l&&(c.fields[Ww]=l),{mapValue:c}})(t,e):n instanceof vu?mE(n,e):n instanceof bu?gE(n,e):(function(r,l){const c=pE(r,l),d=c_(c)+c_(r.Ae);return Bg(c)&&Bg(r.Ae)?hE(d):Y0(r.serializer,d)})(n,e)}function ND(n,e,t){return n instanceof vu?mE(n,e):n instanceof bu?gE(n,e):t}function pE(n,e){return n instanceof rh?(function(i){return Bg(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class sh extends Oh{}class vu extends Oh{constructor(e){super(),this.elements=e}}function mE(n,e){const t=xE(e);for(const i of n.elements)t.some((r=>Ps(r,i)))||t.push(i);return{arrayValue:{values:t}}}class bu extends Oh{constructor(e){super(),this.elements=e}}function gE(n,e){let t=xE(e);for(const i of n.elements)t=t.filter((r=>!Ps(r,i)));return{arrayValue:{values:t}}}class rh extends Oh{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function c_(n){return Gt(n.integerValue||n.doubleValue)}function xE(n){return G0(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function CD(n,e){return n.field.isEqual(e.field)&&(function(i,r){return i instanceof vu&&r instanceof vu||i instanceof bu&&r instanceof bu?Tl(i.elements,r.elements,Ps):i instanceof rh&&r instanceof rh?Ps(i.Ae,r.Ae):i instanceof sh&&r instanceof sh})(n.transform,e.transform)}class kD{constructor(e,t){this.version=e,this.transformResults=t}}class rr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rr}static exists(e){return new rr(void 0,e)}static updateTime(e){return new rr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Of(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Uh{}function yE(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new bE(n.key,rr.none()):new ju(n.key,n.data,rr.none());{const t=n.data,i=Ri.empty();let r=new an(En.comparator);for(let l of e.fields)if(!r.has(l)){let c=t.field(l);c===null&&l.length>1&&(l=l.popLast(),c=t.field(l)),c===null?i.delete(l):i.set(l,c),r=r.add(l)}return new la(n.key,i,new Ki(r.toArray()),rr.none())}}function AD(n,e,t){n instanceof ju?(function(r,l,c){const d=r.value.clone(),p=d_(r.fieldTransforms,l,c.transformResults);d.setAll(p),l.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(n,e,t):n instanceof la?(function(r,l,c){if(!Of(r.precondition,l))return void l.convertToUnknownDocument(c.version);const d=d_(r.fieldTransforms,l,c.transformResults),p=l.data;p.setAll(vE(r)),p.setAll(d),l.convertToFoundDocument(c.version,p).setHasCommittedMutations()})(n,e,t):(function(r,l,c){l.convertToNoDocument(c.version).setHasCommittedMutations()})(0,e,t)}function cu(n,e,t,i){return n instanceof ju?(function(l,c,d,p){if(!Of(l.precondition,c))return d;const h=l.value.clone(),x=f_(l.fieldTransforms,p,c);return h.setAll(x),c.convertToFoundDocument(c.version,h).setHasLocalMutations(),null})(n,e,t,i):n instanceof la?(function(l,c,d,p){if(!Of(l.precondition,c))return d;const h=f_(l.fieldTransforms,p,c),x=c.data;return x.setAll(vE(l)),x.setAll(h),c.convertToFoundDocument(c.version,x).setHasLocalMutations(),d===null?null:d.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((b=>b.field)))})(n,e,t,i):(function(l,c,d){return Of(l.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):d})(n,e,t)}function ID(n,e){let t=null;for(const i of n.fieldTransforms){const r=e.data.field(i.field),l=pE(i.transform,r||null);l!=null&&(t===null&&(t=Ri.empty()),t.set(i.field,l))}return t||null}function u_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&Tl(i,r,((l,c)=>CD(l,c)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class ju extends Uh{constructor(e,t,i,r=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class la extends Uh{constructor(e,t,i,r,l=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=r,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function vE(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}})),e}function d_(n,e,t){const i=new Map;xt(n.length===t.length,32656,{Ve:t.length,de:n.length});for(let r=0;r<t.length;r++){const l=n[r],c=l.transform,d=e.data.field(l.field);i.set(l.field,ND(c,d,t[r]))}return i}function f_(n,e,t){const i=new Map;for(const r of n){const l=r.transform,c=t.data.field(r.field);i.set(r.field,ED(l,c,e))}return i}class bE extends Uh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class RD extends Uh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e,t,i,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const l=this.mutations[r];l.key.isEqual(e.key)&&AD(l,e,i[r])}}applyToLocalView(e,t){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(t=cu(i,e,t,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(t=cu(i,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const i=fE();return this.mutations.forEach((r=>{const l=e.get(r.key),c=l.overlayedDocument;let d=this.applyToLocalView(c,l.mutatedFields);d=t.has(r.key)?null:d;const p=yE(c,d);p!==null&&i.set(r.key,p),c.isValidDocument()||c.convertToNoDocument($e.min())})),i}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),rt())}isEqual(e){return this.batchId===e.batchId&&Tl(this.mutations,e.mutations,((t,i)=>u_(t,i)))&&Tl(this.baseMutations,e.baseMutations,((t,i)=>u_(t,i)))}}class J0{constructor(e,t,i,r){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=r}static from(e,t,i){xt(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let r=(function(){return bD})();const l=e.mutations;for(let c=0;c<l.length;c++)r=r.insert(l[c].key,i[c].version);return new J0(e,t,i,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zt,at;function PD(n){switch(n){case Se.OK:return ze(64938);case Se.CANCELLED:case Se.UNKNOWN:case Se.DEADLINE_EXCEEDED:case Se.RESOURCE_EXHAUSTED:case Se.INTERNAL:case Se.UNAVAILABLE:case Se.UNAUTHENTICATED:return!1;case Se.INVALID_ARGUMENT:case Se.NOT_FOUND:case Se.ALREADY_EXISTS:case Se.PERMISSION_DENIED:case Se.FAILED_PRECONDITION:case Se.ABORTED:case Se.OUT_OF_RANGE:case Se.UNIMPLEMENTED:case Se.DATA_LOSS:return!0;default:return ze(15467,{code:n})}}function _E(n){if(n===void 0)return lr("GRPC error has no .code"),Se.UNKNOWN;switch(n){case Zt.OK:return Se.OK;case Zt.CANCELLED:return Se.CANCELLED;case Zt.UNKNOWN:return Se.UNKNOWN;case Zt.DEADLINE_EXCEEDED:return Se.DEADLINE_EXCEEDED;case Zt.RESOURCE_EXHAUSTED:return Se.RESOURCE_EXHAUSTED;case Zt.INTERNAL:return Se.INTERNAL;case Zt.UNAVAILABLE:return Se.UNAVAILABLE;case Zt.UNAUTHENTICATED:return Se.UNAUTHENTICATED;case Zt.INVALID_ARGUMENT:return Se.INVALID_ARGUMENT;case Zt.NOT_FOUND:return Se.NOT_FOUND;case Zt.ALREADY_EXISTS:return Se.ALREADY_EXISTS;case Zt.PERMISSION_DENIED:return Se.PERMISSION_DENIED;case Zt.FAILED_PRECONDITION:return Se.FAILED_PRECONDITION;case Zt.ABORTED:return Se.ABORTED;case Zt.OUT_OF_RANGE:return Se.OUT_OF_RANGE;case Zt.UNIMPLEMENTED:return Se.UNIMPLEMENTED;case Zt.DATA_LOSS:return Se.DATA_LOSS;default:return ze(39323,{code:n})}}(at=Zt||(Zt={}))[at.OK=0]="OK",at[at.CANCELLED=1]="CANCELLED",at[at.UNKNOWN=2]="UNKNOWN",at[at.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",at[at.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",at[at.NOT_FOUND=5]="NOT_FOUND",at[at.ALREADY_EXISTS=6]="ALREADY_EXISTS",at[at.PERMISSION_DENIED=7]="PERMISSION_DENIED",at[at.UNAUTHENTICATED=16]="UNAUTHENTICATED",at[at.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",at[at.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",at[at.ABORTED=10]="ABORTED",at[at.OUT_OF_RANGE=11]="OUT_OF_RANGE",at[at.UNIMPLEMENTED=12]="UNIMPLEMENTED",at[at.INTERNAL=13]="INTERNAL",at[at.UNAVAILABLE=14]="UNAVAILABLE",at[at.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LD(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD=new so([4294967295,4294967295],0);function h_(n){const e=LD().encode(n),t=new Ow;return t.update(e),new Uint8Array(t.digest())}function p_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),i=e.getUint32(4,!0),r=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new so([t,i],0),new so([r,l],0)]}class K0{constructor(e,t,i){if(this.bitmap=e,this.padding=t,this.hashCount=i,t<0||t>=8)throw new eu(`Invalid padding: ${t}`);if(i<0)throw new eu(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new eu(`Invalid hash count: ${i}`);if(e.length===0&&t!==0)throw new eu(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=so.fromNumber(this.ge)}ye(e,t,i){let r=e.add(t.multiply(so.fromNumber(i)));return r.compare(OD)===1&&(r=new so([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const t=h_(e),[i,r]=p_(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,r,l);if(!this.we(c))return!1}return!0}static create(e,t,i){const r=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),c=new K0(l,r,t);return i.forEach((d=>c.insert(d))),c}insert(e){if(this.ge===0)return;const t=h_(e),[i,r]=p_(t);for(let l=0;l<this.hashCount;l++){const c=this.ye(i,r,l);this.be(c)}}be(e){const t=Math.floor(e/8),i=e%8;this.bitmap[t]|=1<<i}}class eu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,t,i,r,l){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,t,i){const r=new Map;return r.set(e,Du.createSynthesizedTargetChangeForCurrentChange(e,t,i)),new Vh($e.min(),r,new Pt(st),cr(),rt())}}class Du{constructor(e,t,i,r,l){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,t,i){return new Du(i,t,rt(),rt(),rt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uf{constructor(e,t,i,r){this.Se=e,this.removedTargetIds=t,this.key=i,this.De=r}}class TE{constructor(e,t){this.targetId=e,this.Ce=t}}class SE{constructor(e,t,i=Cn.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=r}}class m_{constructor(){this.ve=0,this.Fe=g_(),this.Me=Cn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=rt(),t=rt(),i=rt();return this.Fe.forEach(((r,l)=>{switch(l){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:i=i.add(r);break;default:ze(38017,{changeType:l})}})),new Du(this.Me,this.xe,e,t,i)}Ke(){this.Oe=!1,this.Fe=g_()}qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,xt(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class UD{constructor(e){this.Ge=e,this.ze=new Map,this.je=cr(),this.He=yf(),this.Je=yf(),this.Ze=new Pt(st)}Xe(e){for(const t of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const i=this.nt(t);switch(e.state){case 0:this.rt(t)&&i.Le(e.resumeToken);break;case 1:i.We(),i.Ne||i.Ke(),i.Le(e.resumeToken);break;case 2:i.We(),i.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(i.Qe(),i.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),i.Le(e.resumeToken));break;default:ze(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((i,r)=>{this.rt(r)&&t(r)}))}st(e){const t=e.targetId,i=e.Ce.count,r=this.ot(t);if(r){const l=r.target;if($g(l))if(i===0){const c=new Oe(l.path);this.et(t,c,Mn.newNoDocument(c,$e.min()))}else xt(i===1,20013,{expectedCount:i});else{const c=this._t(t);if(c!==i){const d=this.ut(e),p=d?this.ct(d,e,c):1;if(p!==0){this.it(t);const h=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,h)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:i="",padding:r=0},hashCount:l=0}=t;let c,d;try{c=co(i).toUint8Array()}catch(p){if(p instanceof Jw)return sa("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{d=new K0(c,r,l)}catch(p){return sa(p instanceof eu?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return d.ge===0?null:d}ct(e,t,i){return t.Ce.count===i-this.Pt(e,t.targetId)?0:2}Pt(e,t){const i=this.Ge.getRemoteKeysForTarget(t);let r=0;return i.forEach((l=>{const c=this.Ge.ht(),d=`projects/${c.projectId}/databases/${c.database}/documents/${l.path.canonicalString()}`;e.mightContain(d)||(this.et(t,l,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((l,c)=>{const d=this.ot(c);if(d){if(l.current&&$g(d.target)){const p=new Oe(d.target.path);this.It(p).has(c)||this.Et(c,p)||this.et(c,p,Mn.newNoDocument(p,e))}l.Be&&(t.set(c,l.ke()),l.Ke())}}));let i=rt();this.Je.forEach(((l,c)=>{let d=!0;c.forEachWhile((p=>{const h=this.ot(p);return!h||h.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(i=i.add(l))})),this.je.forEach(((l,c)=>c.setReadTime(e)));const r=new Vh(e,t,this.Ze,this.je,i);return this.je=cr(),this.He=yf(),this.Je=yf(),this.Ze=new Pt(st),r}Ye(e,t){if(!this.rt(e))return;const i=this.Et(e,t.key)?2:0;this.nt(e).qe(t.key,i),this.je=this.je.insert(t.key,t),this.He=this.He.insert(t.key,this.It(t.key).add(e)),this.Je=this.Je.insert(t.key,this.Rt(t.key).add(e))}et(e,t,i){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.qe(t,1):r.Ue(t),this.Je=this.Je.insert(t,this.Rt(t).delete(e)),this.Je=this.Je.insert(t,this.Rt(t).add(e)),i&&(this.je=this.je.insert(t,i))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let t=this.ze.get(e);return t||(t=new m_,this.ze.set(e,t)),t}Rt(e){let t=this.Je.get(e);return t||(t=new an(st),this.Je=this.Je.insert(e,t)),t}It(e){let t=this.He.get(e);return t||(t=new an(st),this.He=this.He.insert(e,t)),t}rt(e){const t=this.ot(e)!==null;return t||Ie("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new m_),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function yf(){return new Pt(Oe.comparator)}function g_(){return new Pt(Oe.comparator)}const VD={asc:"ASCENDING",desc:"DESCENDING"},zD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},HD={and:"AND",or:"OR"};class FD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Jg(n,e){return n.useProto3Json||jh(e)?e:{value:e}}function oh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wE(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function GD(n,e){return oh(n,e.toTimestamp())}function Rs(n){return xt(!!n,49232),$e.fromTimestamp((function(t){const i=lo(t);return new kt(i.seconds,i.nanos)})(n))}function X0(n,e){return Kg(n,e).canonicalString()}function Kg(n,e){const t=(function(r){return new Mt(["projects",r.projectId,"databases",r.database])})(n).child("documents");return e===void 0?t:t.child(e)}function EE(n){const e=Mt.fromString(n);return xt(IE(e),10190,{key:e.toString()}),e}function Xg(n,e){return X0(n.databaseId,e.path)}function yg(n,e){const t=EE(e);if(t.get(1)!==n.databaseId.projectId)throw new Me(Se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Me(Se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Oe(CE(t))}function NE(n,e){return X0(n.databaseId,e)}function BD(n){const e=EE(n);return e.length===4?Mt.emptyPath():CE(e)}function Wg(n){return new Mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function CE(n){return xt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function x_(n,e,t){return{name:Xg(n,e),fields:t.value.mapValue.fields}}function qD(n,e){let t;if("targetChange"in e){e.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:ze(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],l=(function(h,x){return h.useProto3Json?(xt(x===void 0||typeof x=="string",58123),Cn.fromBase64String(x||"")):(xt(x===void 0||x instanceof Buffer||x instanceof Uint8Array,16193),Cn.fromUint8Array(x||new Uint8Array))})(n,e.targetChange.resumeToken),c=e.targetChange.cause,d=c&&(function(h){const x=h.code===void 0?Se.UNKNOWN:_E(h.code);return new Me(x,h.message||"")})(c);t=new SE(i,r,l,d||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=yg(n,i.document.name),l=Rs(i.document.updateTime),c=i.document.createTime?Rs(i.document.createTime):$e.min(),d=new Ri({mapValue:{fields:i.document.fields}}),p=Mn.newFoundDocument(r,l,c,d),h=i.targetIds||[],x=i.removedTargetIds||[];t=new Uf(h,x,p.key,p)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=yg(n,i.document),l=i.readTime?Rs(i.readTime):$e.min(),c=Mn.newNoDocument(r,l),d=i.removedTargetIds||[];t=new Uf([],d,c.key,c)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=yg(n,i.document),l=i.removedTargetIds||[];t=new Uf([],l,r,null)}else{if(!("filter"in e))return ze(11601,{Vt:e});{e.filter;const i=e.filter;i.targetId;const{count:r=0,unchangedNames:l}=i,c=new MD(r,l),d=i.targetId;t=new TE(d,c)}}return t}function $D(n,e){let t;if(e instanceof ju)t={update:x_(n,e.key,e.value)};else if(e instanceof bE)t={delete:Xg(n,e.key)};else if(e instanceof la)t={update:x_(n,e.key,e.data),updateMask:tM(e.fieldMask)};else{if(!(e instanceof RD))return ze(16599,{dt:e.type});t={verify:Xg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((i=>(function(l,c){const d=c.transform;if(d instanceof sh)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof vu)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof bu)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof rh)return{fieldPath:c.field.canonicalString(),increment:d.Ae};throw ze(20930,{transform:c.transform})})(0,i)))),e.precondition.isNone||(t.currentDocument=(function(r,l){return l.updateTime!==void 0?{updateTime:GD(r,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:ze(27497)})(n,e.precondition)),t}function YD(n,e){return n&&n.length>0?(xt(e!==void 0,14353),n.map((t=>(function(r,l){let c=r.updateTime?Rs(r.updateTime):Rs(l);return c.isEqual($e.min())&&(c=Rs(l)),new kD(c,r.transformResults||[])})(t,e)))):[]}function JD(n,e){return{documents:[NE(n,e.path)]}}function KD(n,e){const t={structuredQuery:{}},i=e.path;let r;e.collectionGroup!==null?(r=i,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=i.popLast(),t.structuredQuery.from=[{collectionId:i.lastSegment()}]),t.parent=NE(n,r);const l=(function(h){if(h.length!==0)return AE(Ls.create(h,"and"))})(e.filters);l&&(t.structuredQuery.where=l);const c=(function(h){if(h.length!==0)return h.map((x=>(function(T){return{field:rl(T.field),direction:QD(T.dir)}})(x)))})(e.orderBy);c&&(t.structuredQuery.orderBy=c);const d=Jg(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:r}}function XD(n){let e=BD(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let r=null;if(i>0){xt(i===1,65062);const x=t.from[0];x.allDescendants?r=x.collectionId:e=e.child(x.collectionId)}let l=[];t.where&&(l=(function(b){const T=kE(b);return T instanceof Ls&&sE(T)?T.getFilters():[T]})(t.where));let c=[];t.orderBy&&(c=(function(b){return b.map((T=>(function(E){return new ih(ol(E.field),(function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(E.direction))})(T)))})(t.orderBy));let d=null;t.limit&&(d=(function(b){let T;return T=typeof b=="object"?b.value:b,jh(T)?null:T})(t.limit));let p=null;t.startAt&&(p=(function(b){const T=!!b.before,S=b.values||[];return new nh(S,T)})(t.startAt));let h=null;return t.endAt&&(h=(function(b){const T=!b.before,S=b.values||[];return new nh(S,T)})(t.endAt)),hD(e,r,c,l,d,"F",p,h)}function WD(n,e){const t=(function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ze(28987,{purpose:r})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function kE(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const i=ol(t.unaryFilter.field);return on.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=ol(t.unaryFilter.field);return on.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=ol(t.unaryFilter.field);return on.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=ol(t.unaryFilter.field);return on.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ze(61313);default:return ze(60726)}})(n):n.fieldFilter!==void 0?(function(t){return on.create(ol(t.fieldFilter.field),(function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ze(58110);default:return ze(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Ls.create(t.compositeFilter.filters.map((i=>kE(i))),(function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return ze(1026)}})(t.compositeFilter.op))})(n):ze(30097,{filter:n})}function QD(n){return VD[n]}function ZD(n){return zD[n]}function eM(n){return HD[n]}function rl(n){return{fieldPath:n.canonicalString()}}function ol(n){return En.fromServerFormat(n.fieldPath)}function AE(n){return n instanceof on?(function(t){if(t.op==="=="){if(s_(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NAN"}};if(i_(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(s_(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NOT_NAN"}};if(i_(t.value))return{unaryFilter:{field:rl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:rl(t.field),op:ZD(t.op),value:t.value}}})(n):n instanceof Ls?(function(t){const i=t.getFilters().map((r=>AE(r)));return i.length===1?i[0]:{compositeFilter:{op:eM(t.op),filters:i}}})(n):ze(54877,{filter:n})}function tM(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function IE(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}function RE(n){return!!n&&typeof n._toProto=="function"&&n._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e,t,i,r,l=$e.min(),c=$e.min(),d=Cn.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=d,this.expectedCount=p}withSequenceNumber(e){return new Zr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Zr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e){this.yt=e}}function iM(n){const e=XD({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Yg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(){this.Sn=new rM}addToCollectionParentIndex(e,t){return this.Sn.add(t),ve.resolve()}getCollectionParents(e,t){return ve.resolve(this.Sn.getEntries(t))}addFieldIndex(e,t){return ve.resolve()}deleteFieldIndex(e,t){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,t){return ve.resolve()}getDocumentsMatchingTarget(e,t){return ve.resolve(null)}getIndexType(e,t){return ve.resolve(0)}getFieldIndexes(e,t){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,t){return ve.resolve(ao.min())}getMinOffsetFromCollectionGroup(e,t){return ve.resolve(ao.min())}updateCollectionGroup(e,t,i){return ve.resolve()}updateIndexEntries(e,t){return ve.resolve()}}class rM{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t]||new an(Mt.comparator),l=!r.has(i);return this.index[t]=r.add(i),l}has(e){const t=e.lastSegment(),i=e.popLast(),r=this.index[t];return r&&r.has(i)}getEntries(e){return(this.index[e]||new an(Mt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jE=41943040;class Kn{static withCacheSize(e){return new Kn(e,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Kn.DEFAULT_COLLECTION_PERCENTILE=10,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kn.DEFAULT=new Kn(jE,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kn.DISABLED=new Kn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new El(0)}static ar(){return new El(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v_="LruGarbageCollector",oM=1048576;function b_([n,e],[t,i]){const r=st(n,t);return r===0?st(e,i):r}class aM{constructor(e){this.Pr=e,this.buffer=new an(b_),this.Tr=0}Ir(){return++this.Tr}Er(e){const t=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();b_(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class lM{constructor(e,t,i){this.garbageCollector=e,this.asyncQueue=t,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){Ie(v_,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Ml(t)?Ie(v_,"Ignoring IndexedDB error during garbage collection: ",t):await Dl(t)}await this.Ar(3e5)}))}}class cM{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.dr(e).next((i=>Math.floor(t/100*i)))}nthSequenceNumber(e,t){if(t===0)return ve.resolve(Rh.ce);const i=new aM(t);return this.Vr.forEachTarget(e,(r=>i.Er(r.sequenceNumber))).next((()=>this.Vr.mr(e,(r=>i.Er(r))))).next((()=>i.maxValue))}removeTargets(e,t,i){return this.Vr.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Ie("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(y_)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),y_):this.gr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,t){let i,r,l,c,d,p,h;const x=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((b=>(b>this.params.maximumSequenceNumbersToCollect?(Ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),r=this.params.maximumSequenceNumbersToCollect):r=b,c=Date.now(),this.nthSequenceNumber(e,r)))).next((b=>(i=b,d=Date.now(),this.removeTargets(e,i,t)))).next((b=>(l=b,p=Date.now(),this.removeOrphanedDocuments(e,i)))).next((b=>(h=Date.now(),il()<=it.DEBUG&&Ie("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-x}ms
	Determined least recently used ${r} in `+(d-c)+`ms
	Removed ${l} targets in `+(p-d)+`ms
	Removed ${b} documents in `+(h-p)+`ms
Total Duration: ${h-x}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:l,documentsRemoved:b}))))}}function uM(n,e){return new cM(n,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(){this.changes=new aa((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return i!==void 0?ve.resolve(i):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hM{constructor(e,t,i,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=i,this.indexManager=r}getDocument(e,t){let i=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(i=r,this.remoteDocumentCache.getEntry(e,t)))).next((r=>(i!==null&&cu(i.mutation,r,Ki.empty(),kt.now()),r)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.getLocalViewOfDocuments(e,i,rt()).next((()=>i))))}getLocalViewOfDocuments(e,t,i=rt()){const r=Xo();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,i).next((l=>{let c=Zc();return l.forEach(((d,p)=>{c=c.insert(d,p.overlayedDocument)})),c}))))}getOverlayedDocuments(e,t){const i=Xo();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,rt())))}populateOverlays(e,t,i){const r=[];return i.forEach((l=>{t.has(l)||r.push(l)})),this.documentOverlayCache.getOverlays(e,r).next((l=>{l.forEach(((c,d)=>{t.set(c,d)}))}))}computeViews(e,t,i,r){let l=cr();const c=lu(),d=(function(){return lu()})();return t.forEach(((p,h)=>{const x=i.get(h.key);r.has(h.key)&&(x===void 0||x.mutation instanceof la)?l=l.insert(h.key,h):x!==void 0?(c.set(h.key,x.mutation.getFieldMask()),cu(x.mutation,h,x.mutation.getFieldMask(),kt.now())):c.set(h.key,Ki.empty())})),this.recalculateAndSaveOverlays(e,l).next((p=>(p.forEach(((h,x)=>c.set(h,x))),t.forEach(((h,x)=>d.set(h,new fM(x,c.get(h)??null)))),d)))}recalculateAndSaveOverlays(e,t){const i=lu();let r=new Pt(((c,d)=>c-d)),l=rt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((c=>{for(const d of c)d.keys().forEach((p=>{const h=t.get(p);if(h===null)return;let x=i.get(p)||Ki.empty();x=d.applyToLocalView(h,x),i.set(p,x);const b=(r.get(d.batchId)||rt()).add(p);r=r.insert(d.batchId,b)}))})).next((()=>{const c=[],d=r.getReverseIterator();for(;d.hasNext();){const p=d.getNext(),h=p.key,x=p.value,b=fE();x.forEach((T=>{if(!l.has(T)){const S=yE(t.get(T),i.get(T));S!==null&&b.set(T,S),l=l.add(T)}})),c.push(this.documentOverlayCache.saveOverlays(e,h,b))}return ve.waitFor(c)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,t,i,r){return pD(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):mD(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,i,r):this.getDocumentsMatchingCollectionQuery(e,t,i,r)}getNextDocuments(e,t,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,i,r).next((l=>{const c=r-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,i.largestBatchId,r-l.size):ve.resolve(Xo());let d=mu,p=l;return c.next((h=>ve.forEach(h,((x,b)=>(d<b.largestBatchId&&(d=b.largestBatchId),l.get(x)?ve.resolve():this.remoteDocumentCache.getEntry(e,x).next((T=>{p=p.insert(x,T)}))))).next((()=>this.populateOverlays(e,h,l))).next((()=>this.computeViews(e,p,h,rt()))).next((x=>({batchId:d,changes:dE(x)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Oe(t)).next((i=>{let r=Zc();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r}))}getDocumentsMatchingCollectionGroupQuery(e,t,i,r){const l=t.collectionGroup;let c=Zc();return this.indexManager.getCollectionParents(e,l).next((d=>ve.forEach(d,(p=>{const h=(function(b,T){return new Mh(T,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)})(t,p.child(l));return this.getDocumentsMatchingCollectionQuery(e,h,i,r).next((x=>{x.forEach(((b,T)=>{c=c.insert(b,T)}))}))})).next((()=>c))))}getDocumentsMatchingCollectionQuery(e,t,i,r){let l;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,i.largestBatchId).next((c=>(l=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,i,l,r)))).next((c=>{l.forEach(((p,h)=>{const x=h.getKey();c.get(x)===null&&(c=c.insert(x,Mn.newInvalidDocument(x)))}));let d=Zc();return c.forEach(((p,h)=>{const x=l.get(p);x!==void 0&&cu(x.mutation,h,Ki.empty(),kt.now()),Lh(t,h)&&(d=d.insert(p,h))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,t){return ve.resolve(this.Nr.get(t))}saveBundleMetadata(e,t){return this.Nr.set(t.id,(function(r){return{id:r.id,version:r.version,createTime:Rs(r.createTime)}})(t)),ve.resolve()}getNamedQuery(e,t){return ve.resolve(this.Br.get(t))}saveNamedQuery(e,t){return this.Br.set(t.name,(function(r){return{name:r.name,query:iM(r.bundledQuery),readTime:Rs(r.readTime)}})(t)),ve.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(){this.overlays=new Pt(Oe.comparator),this.Lr=new Map}getOverlay(e,t){return ve.resolve(this.overlays.get(t))}getOverlays(e,t){const i=Xo();return ve.forEach(t,(r=>this.getOverlay(e,r).next((l=>{l!==null&&i.set(r,l)})))).next((()=>i))}saveOverlays(e,t,i){return i.forEach(((r,l)=>{this.bt(e,t,l)})),ve.resolve()}removeOverlaysForBatchId(e,t,i){const r=this.Lr.get(i);return r!==void 0&&(r.forEach((l=>this.overlays=this.overlays.remove(l))),this.Lr.delete(i)),ve.resolve()}getOverlaysForCollection(e,t,i){const r=Xo(),l=t.length+1,c=new Oe(t.child("")),d=this.overlays.getIteratorFrom(c);for(;d.hasNext();){const p=d.getNext().value,h=p.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===l&&p.largestBatchId>i&&r.set(p.getKey(),p)}return ve.resolve(r)}getOverlaysForCollectionGroup(e,t,i,r){let l=new Pt(((h,x)=>h-x));const c=this.overlays.getIterator();for(;c.hasNext();){const h=c.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>i){let x=l.get(h.largestBatchId);x===null&&(x=Xo(),l=l.insert(h.largestBatchId,x)),x.set(h.getKey(),h)}}const d=Xo(),p=l.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach(((h,x)=>d.set(h,x))),!(d.size()>=r)););return ve.resolve(d)}bt(e,t,i){const r=this.overlays.get(i.key);if(r!==null){const c=this.Lr.get(r.largestBatchId).delete(i.key);this.Lr.set(r.largestBatchId,c)}this.overlays=this.overlays.insert(i.key,new DD(t,i));let l=this.Lr.get(t);l===void 0&&(l=rt(),this.Lr.set(t,l)),this.Lr.set(t,l.add(i.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gM{constructor(){this.sessionToken=Cn.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ve.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(){this.kr=new an(hn.Kr),this.qr=new an(hn.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,t){const i=new hn(e,t);this.kr=this.kr.add(i),this.qr=this.qr.add(i)}$r(e,t){e.forEach((i=>this.addReference(i,t)))}removeReference(e,t){this.Wr(new hn(e,t))}Qr(e,t){e.forEach((i=>this.removeReference(i,t)))}Gr(e){const t=new Oe(new Mt([])),i=new hn(t,e),r=new hn(t,e+1),l=[];return this.qr.forEachInRange([i,r],(c=>{this.Wr(c),l.push(c.key)})),l}zr(){this.kr.forEach((e=>this.Wr(e)))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const t=new Oe(new Mt([])),i=new hn(t,e),r=new hn(t,e+1);let l=rt();return this.qr.forEachInRange([i,r],(c=>{l=l.add(c.key)})),l}containsKey(e){const t=new hn(e,0),i=this.kr.firstAfterOrEqual(t);return i!==null&&e.isEqual(i.key)}}class hn{constructor(e,t){this.key=e,this.Hr=t}static Kr(e,t){return Oe.comparator(e.key,t.key)||st(e.Hr,t.Hr)}static Ur(e,t){return st(e.Hr,t.Hr)||Oe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Yn=1,this.Jr=new an(hn.Kr)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,i,r){const l=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new jD(l,t,i,r);this.mutationQueue.push(c);for(const d of r)this.Jr=this.Jr.add(new hn(d.key,l)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ve.resolve(c)}lookupMutationBatch(e,t){return ve.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const i=t+1,r=this.Xr(i),l=r<0?0:r;return ve.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?H0:this.Yn-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new hn(t,0),r=new hn(t,Number.POSITIVE_INFINITY),l=[];return this.Jr.forEachInRange([i,r],(c=>{const d=this.Zr(c.Hr);l.push(d)})),ve.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new an(st);return t.forEach((r=>{const l=new hn(r,0),c=new hn(r,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([l,c],(d=>{i=i.add(d.Hr)}))})),ve.resolve(this.Yr(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,r=i.length+1;let l=i;Oe.isDocumentKey(l)||(l=l.child(""));const c=new hn(new Oe(l),0);let d=new an(st);return this.Jr.forEachWhile((p=>{const h=p.key.path;return!!i.isPrefixOf(h)&&(h.length===r&&(d=d.add(p.Hr)),!0)}),c),ve.resolve(this.Yr(d))}Yr(e){const t=[];return e.forEach((i=>{const r=this.Zr(i);r!==null&&t.push(r)})),t}removeMutationBatch(e,t){xt(this.ei(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Jr;return ve.forEach(t.mutations,(r=>{const l=new hn(r.key,t.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Jr=i}))}nr(e){}containsKey(e,t){const i=new hn(t,0),r=this.Jr.firstAfterOrEqual(i);return ve.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ei(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{constructor(e){this.ti=e,this.docs=(function(){return new Pt(Oe.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const i=t.key,r=this.docs.get(i),l=r?r.size:0,c=this.ti(t);return this.docs=this.docs.insert(i,{document:t.mutableCopy(),size:c}),this.size+=c-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return ve.resolve(i?i.document.mutableCopy():Mn.newInvalidDocument(t))}getEntries(e,t){let i=cr();return t.forEach((r=>{const l=this.docs.get(r);i=i.insert(r,l?l.document.mutableCopy():Mn.newInvalidDocument(r))})),ve.resolve(i)}getDocumentsMatchingQuery(e,t,i,r){let l=cr();const c=t.path,d=new Oe(c.child("__id-9223372036854775808__")),p=this.docs.getIteratorFrom(d);for(;p.hasNext();){const{key:h,value:{document:x}}=p.getNext();if(!c.isPrefixOf(h.path))break;h.path.length>c.length+1||Bj(Gj(x),i)<=0||(r.has(x.key)||Lh(t,x))&&(l=l.insert(x.key,x.mutableCopy()))}return ve.resolve(l)}getAllFromCollectionGroup(e,t,i,r){ze(9500)}ni(e,t){return ve.forEach(this.docs,(i=>t(i)))}newChangeBuffer(e){return new vM(this)}getSize(e){return ve.resolve(this.size)}}class vM extends dM{constructor(e){super(),this.Mr=e}applyChanges(e){const t=[];return this.changes.forEach(((i,r)=>{r.isValidDocument()?t.push(this.Mr.addEntry(e,r)):this.Mr.removeEntry(i)})),ve.waitFor(t)}getFromCache(e,t){return this.Mr.getEntry(e,t)}getAllFromCache(e,t){return this.Mr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(e){this.persistence=e,this.ri=new aa((t=>B0(t)),q0),this.lastRemoteSnapshotVersion=$e.min(),this.highestTargetId=0,this.ii=0,this.si=new W0,this.targetCount=0,this.oi=El._r()}forEachTarget(e,t){return this.ri.forEach(((i,r)=>t(r))),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.ii&&(this.ii=t),ve.resolve()}lr(e){this.ri.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.oi=new El(t),this.highestTargetId=t),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,t){return this.lr(t),this.targetCount+=1,ve.resolve()}updateTargetData(e,t){return this.lr(t),ve.resolve()}removeTargetData(e,t){return this.ri.delete(t.target),this.si.Gr(t.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,t,i){let r=0;const l=[];return this.ri.forEach(((c,d)=>{d.sequenceNumber<=t&&i.get(d.targetId)===null&&(this.ri.delete(c),l.push(this.removeMatchingKeysForTargetId(e,d.targetId)),r++)})),ve.waitFor(l).next((()=>r))}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,t){const i=this.ri.get(t)||null;return ve.resolve(i)}addMatchingKeys(e,t,i){return this.si.$r(t,i),ve.resolve()}removeMatchingKeys(e,t,i){this.si.Qr(t,i);const r=this.persistence.referenceDelegate,l=[];return r&&t.forEach((c=>{l.push(r.markPotentiallyOrphaned(e,c))})),ve.waitFor(l)}removeMatchingKeysForTargetId(e,t){return this.si.Gr(t),ve.resolve()}getMatchingKeysForTargetId(e,t){const i=this.si.jr(t);return ve.resolve(i)}containsKey(e,t){return ve.resolve(this.si.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e,t){this._i={},this.overlays={},this.ai=new Rh(0),this.ui=!1,this.ui=!0,this.ci=new gM,this.referenceDelegate=e(this),this.li=new bM(this),this.indexManager=new sM,this.remoteDocumentCache=(function(r){return new yM(r)})((i=>this.referenceDelegate.hi(i))),this.serializer=new nM(t),this.Pi=new pM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new mM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let i=this._i[e.toKey()];return i||(i=new xM(t,this.referenceDelegate),this._i[e.toKey()]=i),i}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,t,i){Ie("MemoryPersistence","Starting transaction:",e);const r=new _M(this.ai.next());return this.referenceDelegate.Ti(),i(r).next((l=>this.referenceDelegate.Ii(r).next((()=>l)))).toPromise().then((l=>(r.raiseOnCommittedEvent(),l)))}Ei(e,t){return ve.or(Object.values(this._i).map((i=>()=>i.containsKey(e,t))))}}class _M extends $j{constructor(e){super(),this.currentSequenceNumber=e}}class Q0{constructor(e){this.persistence=e,this.Ri=new W0,this.Ai=null}static Vi(e){return new Q0(e)}get di(){if(this.Ai)return this.Ai;throw ze(60996)}addReference(e,t,i){return this.Ri.addReference(i,t),this.di.delete(i.toString()),ve.resolve()}removeReference(e,t,i){return this.Ri.removeReference(i,t),this.di.add(i.toString()),ve.resolve()}markPotentiallyOrphaned(e,t){return this.di.add(t.toString()),ve.resolve()}removeTarget(e,t){this.Ri.Gr(t.targetId).forEach((r=>this.di.add(r.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next((r=>{r.forEach((l=>this.di.add(l.toString())))})).next((()=>i.removeTargetData(e,t)))}Ti(){this.Ai=new Set}Ii(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.di,(i=>{const r=Oe.fromPath(i);return this.mi(e,r).next((l=>{l||t.removeEntry(r,$e.min())}))})).next((()=>(this.Ai=null,t.apply(e))))}updateLimboDocument(e,t){return this.mi(e,t).next((i=>{i?this.di.delete(t.toString()):this.di.add(t.toString())}))}hi(e){return 0}mi(e,t){return ve.or([()=>ve.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class ah{constructor(e,t){this.persistence=e,this.fi=new aa((i=>Kj(i.path)),((i,r)=>i.isEqual(r))),this.garbageCollector=uM(this,t)}static Vi(e,t){return new ah(e,t)}Ti(){}Ii(e){return ve.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}dr(e){const t=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>t.next((r=>i+r))))}pr(e){let t=0;return this.mr(e,(i=>{t++})).next((()=>t))}mr(e,t){return ve.forEach(this.fi,((i,r)=>this.wr(e,i,r).next((l=>l?ve.resolve():t(r)))))}removeTargets(e,t,i){return this.persistence.getTargetCache().removeTargets(e,t,i)}removeOrphanedDocuments(e,t){let i=0;const r=this.persistence.getRemoteDocumentCache(),l=r.newChangeBuffer();return r.ni(e,(c=>this.wr(e,c,t).next((d=>{d||(i++,l.removeEntry(c,$e.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,t){return this.fi.set(t,e.currentSequenceNumber),ve.resolve()}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ve.resolve()}removeReference(e,t,i){return this.fi.set(i,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,t){return this.fi.set(t,e.currentSequenceNumber),ve.resolve()}hi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Pf(e.data.value)),t}wr(e,t,i){return ve.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const r=this.fi.get(t);return ve.resolve(r!==void 0&&r>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(e,t,i,r){this.targetId=e,this.fromCache=t,this.Ts=i,this.Is=r}static Es(e,t){let i=rt(),r=rt();for(const l of t.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:r=r.add(l.doc.key)}return new Z0(e,t.fromCache,i,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(function(){return uA()?8:Yj(Pn())>0?6:4})()}initialize(e,t){this.fs=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,i,r){const l={result:null};return this.gs(e,t).next((c=>{l.result=c})).next((()=>{if(!l.result)return this.ps(e,t,r,i).next((c=>{l.result=c}))})).next((()=>{if(l.result)return;const c=new TM;return this.ys(e,t,c).next((d=>{if(l.result=d,this.As)return this.ws(e,t,c,d.size)}))})).next((()=>l.result))}ws(e,t,i,r){return i.documentReadCount<this.Vs?(il()<=it.DEBUG&&Ie("QueryEngine","SDK will not create cache indexes for query:",sl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ve.resolve()):(il()<=it.DEBUG&&Ie("QueryEngine","Query:",sl(t),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.ds*r?(il()<=it.DEBUG&&Ie("QueryEngine","The SDK decides to create cache indexes for query:",sl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Is(t))):ve.resolve())}gs(e,t){if(l_(t))return ve.resolve(null);let i=Is(t);return this.indexManager.getIndexType(e,i).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=Yg(t,null,"F"),i=Is(t)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const c=rt(...l);return this.fs.getDocuments(e,c).next((d=>this.indexManager.getMinOffset(e,i).next((p=>{const h=this.bs(t,d);return this.Ss(t,h,c,p.readTime)?this.gs(e,Yg(t,null,"F")):this.Ds(e,h,t,p)}))))})))))}ps(e,t,i,r){return l_(t)||r.isEqual($e.min())?ve.resolve(null):this.fs.getDocuments(e,i).next((l=>{const c=this.bs(t,l);return this.Ss(t,c,i,r)?ve.resolve(null):(il()<=it.DEBUG&&Ie("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),sl(t)),this.Ds(e,c,t,Fj(r,mu)).next((d=>d)))}))}bs(e,t){let i=new an(cE(e));return t.forEach(((r,l)=>{Lh(e,l)&&(i=i.add(l))})),i}Ss(e,t,i,r){if(e.limit===null)return!1;if(i.size!==t.size)return!0;const l=e.limitType==="F"?t.last():t.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(r)>0)}ys(e,t,i){return il()<=it.DEBUG&&Ie("QueryEngine","Using full collection scan to execute query:",sl(t)),this.fs.getDocumentsMatchingQuery(e,t,ao.min(),i)}Ds(e,t,i,r){return this.fs.getDocumentsMatchingQuery(e,i,r).next((l=>(t.forEach((c=>{l=l.insert(c.key,c)})),l)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="LocalStore",wM=3e8;class EM{constructor(e,t,i,r){this.persistence=e,this.Cs=t,this.serializer=r,this.vs=new Pt(st),this.Fs=new aa((l=>B0(l)),q0),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(i)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hM(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.vs)))}}function NM(n,e,t,i){return new EM(n,e,t,i)}async function ME(n,e){const t=Je(n);return await t.persistence.runTransaction("Handle user change","readonly",(i=>{let r;return t.mutationQueue.getAllMutationBatches(i).next((l=>(r=l,t.Os(e),t.mutationQueue.getAllMutationBatches(i)))).next((l=>{const c=[],d=[];let p=rt();for(const h of r){c.push(h.batchId);for(const x of h.mutations)p=p.add(x.key)}for(const h of l){d.push(h.batchId);for(const x of h.mutations)p=p.add(x.key)}return t.localDocuments.getDocuments(i,p).next((h=>({Ns:h,removedBatchIds:c,addedBatchIds:d})))}))}))}function CM(n,e){const t=Je(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const r=e.batch.keys(),l=t.xs.newChangeBuffer({trackRemovals:!0});return(function(d,p,h,x){const b=h.batch,T=b.keys();let S=ve.resolve();return T.forEach((E=>{S=S.next((()=>x.getEntry(p,E))).next((D=>{const k=h.docVersions.get(E);xt(k!==null,48541),D.version.compareTo(k)<0&&(b.applyToRemoteDocument(D,h),D.isValidDocument()&&(D.setReadTime(h.commitVersion),x.addEntry(D)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(p,b)))})(t,i,e,l).next((()=>l.apply(i))).next((()=>t.mutationQueue.performConsistencyCheck(i))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(i,r,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(d){let p=rt();for(let h=0;h<d.mutationResults.length;++h)d.mutationResults[h].transformResults.length>0&&(p=p.add(d.batch.mutations[h].key));return p})(e)))).next((()=>t.localDocuments.getDocuments(i,r)))}))}function PE(n){const e=Je(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.li.getLastRemoteSnapshotVersion(t)))}function kM(n,e){const t=Je(n),i=e.snapshotVersion;let r=t.vs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const c=t.xs.newChangeBuffer({trackRemovals:!0});r=t.vs;const d=[];e.targetChanges.forEach(((x,b)=>{const T=r.get(b);if(!T)return;d.push(t.li.removeMatchingKeys(l,x.removedDocuments,b).next((()=>t.li.addMatchingKeys(l,x.addedDocuments,b))));let S=T.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(b)!==null?S=S.withResumeToken(Cn.EMPTY_BYTE_STRING,$e.min()).withLastLimboFreeSnapshotVersion($e.min()):x.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(x.resumeToken,i)),r=r.insert(b,S),(function(D,k,F){return D.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=wM?!0:F.addedDocuments.size+F.modifiedDocuments.size+F.removedDocuments.size>0})(T,S,x)&&d.push(t.li.updateTargetData(l,S))}));let p=cr(),h=rt();if(e.documentUpdates.forEach((x=>{e.resolvedLimboDocuments.has(x)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(l,x))})),d.push(AM(l,c,e.documentUpdates).next((x=>{p=x.Bs,h=x.Ls}))),!i.isEqual($e.min())){const x=t.li.getLastRemoteSnapshotVersion(l).next((b=>t.li.setTargetsMetadata(l,l.currentSequenceNumber,i)));d.push(x)}return ve.waitFor(d).next((()=>c.apply(l))).next((()=>t.localDocuments.getLocalViewOfDocuments(l,p,h))).next((()=>p))})).then((l=>(t.vs=r,l)))}function AM(n,e,t){let i=rt(),r=rt();return t.forEach((l=>i=i.add(l))),e.getEntries(n,i).next((l=>{let c=cr();return t.forEach(((d,p)=>{const h=l.get(d);p.isFoundDocument()!==h.isFoundDocument()&&(r=r.add(d)),p.isNoDocument()&&p.version.isEqual($e.min())?(e.removeEntry(d,p.readTime),c=c.insert(d,p)):!h.isValidDocument()||p.version.compareTo(h.version)>0||p.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(p),c=c.insert(d,p)):Ie(ex,"Ignoring outdated watch update for ",d,". Current version:",h.version," Watch version:",p.version)})),{Bs:c,Ls:r}}))}function IM(n,e){const t=Je(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=H0),t.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function RM(n,e){const t=Je(n);return t.persistence.runTransaction("Allocate target","readwrite",(i=>{let r;return t.li.getTargetData(i,e).next((l=>l?(r=l,ve.resolve(r)):t.li.allocateTargetId(i).next((c=>(r=new Zr(e,c,"TargetPurposeListen",i.currentSequenceNumber),t.li.addTargetData(i,r).next((()=>r)))))))})).then((i=>{const r=t.vs.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(t.vs=t.vs.insert(i.targetId,i),t.Fs.set(e,i.targetId)),i}))}async function Qg(n,e,t){const i=Je(n),r=i.vs.get(e),l=t?"readwrite":"readwrite-primary";try{t||await i.persistence.runTransaction("Release target",l,(c=>i.persistence.referenceDelegate.removeTarget(c,r)))}catch(c){if(!Ml(c))throw c;Ie(ex,`Failed to update sequence numbers for target ${e}: ${c}`)}i.vs=i.vs.remove(e),i.Fs.delete(r.target)}function __(n,e,t){const i=Je(n);let r=$e.min(),l=rt();return i.persistence.runTransaction("Execute query","readwrite",(c=>(function(p,h,x){const b=Je(p),T=b.Fs.get(x);return T!==void 0?ve.resolve(b.vs.get(T)):b.li.getTargetData(h,x)})(i,c,Is(e)).next((d=>{if(d)return r=d.lastLimboFreeSnapshotVersion,i.li.getMatchingKeysForTargetId(c,d.targetId).next((p=>{l=p}))})).next((()=>i.Cs.getDocumentsMatchingQuery(c,e,t?r:$e.min(),t?l:rt()))).next((d=>(jM(i,xD(e),d),{documents:d,ks:l})))))}function jM(n,e,t){let i=n.Ms.get(e)||$e.min();t.forEach(((r,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),n.Ms.set(e,i)}class T_{constructor(){this.activeTargetIds=SD()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class DM{constructor(){this.vo=new T_,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e,t=!0){return t&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,t,i){this.Fo[e]=t}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new T_,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MM{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S_="ConnectivityMonitor";class w_{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){Ie(S_,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){Ie(S_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vf=null;function Zg(){return vf===null?vf=(function(){return 268435456+Math.round(2147483648*Math.random())})():vf++,"0x"+vf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg="RestConnection",PM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class LM{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.qo=t+"://"+e.host,this.Uo=`projects/${i}/databases/${r}`,this.$o=this.databaseId.database===eh?`project_id=${i}`:`project_id=${i}&database_id=${r}`}Wo(e,t,i,r,l){const c=Zg(),d=this.Qo(e,t.toUriEncodedString());Ie(vg,`Sending RPC '${e}' ${c}:`,d,i);const p={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(p,r,l);const{host:h}=new URL(d),x=Al(h);return this.zo(e,d,p,i,x).then((b=>(Ie(vg,`Received RPC '${e}' ${c}: `,b),b)),(b=>{throw sa(vg,`RPC '${e}' ${c} failed with error: `,b,"url: ",d,"request:",i),b}))}jo(e,t,i,r,l,c){return this.Wo(e,t,i,r,l)}Go(e,t,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+jl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((r,l)=>e[l]=r)),i&&i.headers.forEach(((r,l)=>e[l]=r))}Qo(e,t){const i=PM[e];let r=`${this.qo}/v1/${t}:${i}`;return this.databaseInfo.apiKey&&(r=`${r}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),r}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OM{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rn="WebChannelConnection",qc=(n,e,t)=>{n.listen(e,(i=>{try{t(i)}catch(r){setTimeout((()=>{throw r}),0)}}))};class pl extends LM{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!pl.c_){const e=Hw();qc(e,zw.STAT_EVENT,(t=>{t.stat===Hg.PROXY?Ie(Rn,"STAT_EVENT: detected buffering proxy"):t.stat===Hg.NOPROXY&&Ie(Rn,"STAT_EVENT: detected no buffering proxy")})),pl.c_=!0}}zo(e,t,i,r,l){const c=Zg();return new Promise(((d,p)=>{const h=new Uw;h.setWithCredentials(!0),h.listenOnce(Vw.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Mf.NO_ERROR:const b=h.getResponseJson();Ie(Rn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(b)),d(b);break;case Mf.TIMEOUT:Ie(Rn,`RPC '${e}' ${c} timed out`),p(new Me(Se.DEADLINE_EXCEEDED,"Request time out"));break;case Mf.HTTP_ERROR:const T=h.getStatus();if(Ie(Rn,`RPC '${e}' ${c} failed with status:`,T,"response text:",h.getResponseText()),T>0){let S=h.getResponseJson();Array.isArray(S)&&(S=S[0]);const E=S==null?void 0:S.error;if(E&&E.status&&E.message){const D=(function(F){const $=F.toLowerCase().replace(/_/g,"-");return Object.values(Se).indexOf($)>=0?$:Se.UNKNOWN})(E.status);p(new Me(D,E.message))}else p(new Me(Se.UNKNOWN,"Server responded with status "+h.getStatus()))}else p(new Me(Se.UNAVAILABLE,"Connection failed."));break;default:ze(9055,{l_:e,streamId:c,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{Ie(Rn,`RPC '${e}' ${c} completed.`)}}));const x=JSON.stringify(r);Ie(Rn,`RPC '${e}' ${c} sending request:`,r),h.send(t,"POST",x,i,15)}))}T_(e,t,i){const r=Zg(),l=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=this.createWebChannelTransport(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Go(d.initMessageHeaders,t,i),d.encodeInitMessageHeaders=!0;const h=l.join("");Ie(Rn,`Creating RPC '${e}' stream ${r}: ${h}`,d);const x=c.createWebChannel(h,d);this.I_(x);let b=!1,T=!1;const S=new OM({Ho:E=>{T?Ie(Rn,`Not sending because RPC '${e}' stream ${r} is closed:`,E):(b||(Ie(Rn,`Opening RPC '${e}' stream ${r} transport.`),x.open(),b=!0),Ie(Rn,`RPC '${e}' stream ${r} sending:`,E),x.send(E))},Jo:()=>x.close()});return qc(x,Qc.EventType.OPEN,(()=>{T||(Ie(Rn,`RPC '${e}' stream ${r} transport opened.`),S.i_())})),qc(x,Qc.EventType.CLOSE,(()=>{T||(T=!0,Ie(Rn,`RPC '${e}' stream ${r} transport closed`),S.o_(),this.E_(x))})),qc(x,Qc.EventType.ERROR,(E=>{T||(T=!0,sa(Rn,`RPC '${e}' stream ${r} transport errored. Name:`,E.name,"Message:",E.message),S.o_(new Me(Se.UNAVAILABLE,"The operation could not be completed")))})),qc(x,Qc.EventType.MESSAGE,(E=>{var D;if(!T){const k=E.data[0];xt(!!k,16349);const F=k,$=(F==null?void 0:F.error)||((D=F[0])==null?void 0:D.error);if($){Ie(Rn,`RPC '${e}' stream ${r} received error:`,$);const M=$.status;let J=(function(R){const C=Zt[R];if(C!==void 0)return _E(C)})(M),H=$.message;M==="NOT_FOUND"&&H.includes("database")&&H.includes("does not exist")&&H.includes(this.databaseId.database)&&sa(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),J===void 0&&(J=Se.INTERNAL,H="Unknown error status: "+M+" with message "+$.message),T=!0,S.o_(new Me(J,H)),x.close()}else Ie(Rn,`RPC '${e}' stream ${r} received:`,k),S.__(k)}})),pl.u_(),setTimeout((()=>{S.s_()}),0),S}terminate(){this.a_.forEach((e=>e.close())),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter((t=>t===e))}Go(e,t,i){super.Go(e,t,i),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return Fw()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UM(n){return new pl(n)}function bg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zh(n){return new FD(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pl.c_=!1;class LE{constructor(e,t,i=1e3,r=1.5,l=6e4){this.Ci=e,this.timerId=t,this.R_=i,this.A_=r,this.V_=l,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const t=Math.floor(this.d_+this.y_()),i=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-i);r>0&&Ie("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.d_} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_="PersistentStream";class OE{constructor(e,t,i,r,l,c,d,p){this.Ci=e,this.b_=i,this.S_=r,this.connection=l,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=d,this.listener=p,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new LE(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,(()=>this.k_())))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===Se.RESOURCE_EXHAUSTED?(lr(t.toString()),lr("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===Se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(t)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,r])=>{this.D_===t&&this.G_(i,r)}),(i=>{e((()=>{const r=new Me(Se.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(r)}))}))}G_(e,t){const i=this.Q_(this.D_);this.stream=this.j_(e,t),this.stream.Zo((()=>{i((()=>this.listener.Zo()))})),this.stream.Yo((()=>{i((()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.Yo())))})),this.stream.t_((r=>{i((()=>this.z_(r)))})),this.stream.onMessage((r=>{i((()=>++this.F_==1?this.H_(r):this.onNext(r)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ie(E_,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return t=>{this.Ci.enqueueAndForget((()=>this.D_===e?t():(Ie(E_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class VM extends OE{constructor(e,t,i,r,l,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,i,r,c),this.serializer=l}j_(e,t){return this.connection.T_("Listen",e,t)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=qD(this.serializer,e),i=(function(l){if(!("targetChange"in l))return $e.min();const c=l.targetChange;return c.targetIds&&c.targetIds.length?$e.min():c.readTime?Rs(c.readTime):$e.min()})(e);return this.listener.J_(t,i)}Z_(e){const t={};t.database=Wg(this.serializer),t.addTarget=(function(l,c){let d;const p=c.target;if(d=$g(p)?{documents:JD(l,p)}:{query:KD(l,p).ft},d.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){d.resumeToken=wE(l,c.resumeToken);const h=Jg(l,c.expectedCount);h!==null&&(d.expectedCount=h)}else if(c.snapshotVersion.compareTo($e.min())>0){d.readTime=oh(l,c.snapshotVersion.toTimestamp());const h=Jg(l,c.expectedCount);h!==null&&(d.expectedCount=h)}return d})(this.serializer,e);const i=WD(this.serializer,e);i&&(t.labels=i),this.K_(t)}X_(e){const t={};t.database=Wg(this.serializer),t.removeTarget=e,this.K_(t)}}class zM extends OE{constructor(e,t,i,r,l,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,i,r,c),this.serializer=l}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}H_(e){return xt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,xt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){xt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=YD(e.writeResults,e.commitTime),i=Rs(e.commitTime);return this.listener.na(i,t)}ra(){const e={};e.database=Wg(this.serializer),this.K_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((i=>$D(this.serializer,i)))};this.K_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{}class FM extends HM{constructor(e,t,i,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=i,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Me(Se.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,i,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,c])=>this.connection.Wo(e,Kg(t,i),r,l,c))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Me(Se.UNKNOWN,l.toString())}))}jo(e,t,i,r,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([c,d])=>this.connection.jo(e,Kg(t,i),r,c,d,l))).catch((c=>{throw c.name==="FirebaseError"?(c.code===Se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Me(Se.UNKNOWN,c.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}function GM(n,e,t,i){return new FM(n,e,t,i)}class BM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(lr(t),this.aa=!1):Ie("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ra="RemoteStore";class qM{constructor(e,t,i,r,l){this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=l,this.Aa.Mo((c=>{i.enqueueAndForget((async()=>{ca(this)&&(Ie(ra,"Restarting streams for network reachability change."),await(async function(p){const h=Je(p);h.Ea.add(4),await Mu(h),h.Va.set("Unknown"),h.Ea.delete(4),await Hh(h)})(this))}))})),this.Va=new BM(i,r)}}async function Hh(n){if(ca(n))for(const e of n.Ra)await e(!0)}async function Mu(n){for(const e of n.Ra)await e(!1)}function UE(n,e){const t=Je(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),sx(t)?ix(t):Pl(t).O_()&&nx(t,e))}function tx(n,e){const t=Je(n),i=Pl(t);t.Ia.delete(e),i.O_()&&VE(t,e),t.Ia.size===0&&(i.O_()?i.L_():ca(t)&&t.Va.set("Unknown"))}function nx(n,e){if(n.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo($e.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Pl(n).Z_(e)}function VE(n,e){n.da.$e(e),Pl(n).X_(e)}function ix(n){n.da=new UD({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Pl(n).start(),n.Va.ua()}function sx(n){return ca(n)&&!Pl(n).x_()&&n.Ia.size>0}function ca(n){return Je(n).Ea.size===0}function zE(n){n.da=void 0}async function $M(n){n.Va.set("Online")}async function YM(n){n.Ia.forEach(((e,t)=>{nx(n,e)}))}async function JM(n,e){zE(n),sx(n)?(n.Va.ha(e),ix(n)):n.Va.set("Unknown")}async function KM(n,e,t){if(n.Va.set("Online"),e instanceof SE&&e.state===2&&e.cause)try{await(async function(r,l){const c=l.cause;for(const d of l.targetIds)r.Ia.has(d)&&(await r.remoteSyncer.rejectListen(d,c),r.Ia.delete(d),r.da.removeTarget(d))})(n,e)}catch(i){Ie(ra,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await lh(n,i)}else if(e instanceof Uf?n.da.Xe(e):e instanceof TE?n.da.st(e):n.da.tt(e),!t.isEqual($e.min()))try{const i=await PE(n.localStore);t.compareTo(i)>=0&&await(function(l,c){const d=l.da.Tt(c);return d.targetChanges.forEach(((p,h)=>{if(p.resumeToken.approximateByteSize()>0){const x=l.Ia.get(h);x&&l.Ia.set(h,x.withResumeToken(p.resumeToken,c))}})),d.targetMismatches.forEach(((p,h)=>{const x=l.Ia.get(p);if(!x)return;l.Ia.set(p,x.withResumeToken(Cn.EMPTY_BYTE_STRING,x.snapshotVersion)),VE(l,p);const b=new Zr(x.target,p,h,x.sequenceNumber);nx(l,b)})),l.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(i){Ie(ra,"Failed to raise snapshot:",i),await lh(n,i)}}async function lh(n,e,t){if(!Ml(e))throw e;n.Ea.add(1),await Mu(n),n.Va.set("Offline"),t||(t=()=>PE(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{Ie(ra,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await Hh(n)}))}function HE(n,e){return e().catch((t=>lh(n,t,e)))}async function Fh(n){const e=Je(n),t=fo(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:H0;for(;XM(e);)try{const r=await IM(e.localStore,i);if(r===null){e.Ta.length===0&&t.L_();break}i=r.batchId,WM(e,r)}catch(r){await lh(e,r)}FE(e)&&GE(e)}function XM(n){return ca(n)&&n.Ta.length<10}function WM(n,e){n.Ta.push(e);const t=fo(n);t.O_()&&t.Y_&&t.ea(e.mutations)}function FE(n){return ca(n)&&!fo(n).x_()&&n.Ta.length>0}function GE(n){fo(n).start()}async function QM(n){fo(n).ra()}async function ZM(n){const e=fo(n);for(const t of n.Ta)e.ea(t.mutations)}async function e5(n,e,t){const i=n.Ta.shift(),r=J0.from(i,e,t);await HE(n,(()=>n.remoteSyncer.applySuccessfulWrite(r))),await Fh(n)}async function t5(n,e){e&&fo(n).Y_&&await(async function(i,r){if((function(c){return PD(c)&&c!==Se.ABORTED})(r.code)){const l=i.Ta.shift();fo(i).B_(),await HE(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,r))),await Fh(i)}})(n,e),FE(n)&&GE(n)}async function N_(n,e){const t=Je(n);t.asyncQueue.verifyOperationInProgress(),Ie(ra,"RemoteStore received new credentials");const i=ca(t);t.Ea.add(3),await Mu(t),i&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await Hh(t)}async function n5(n,e){const t=Je(n);e?(t.Ea.delete(2),await Hh(t)):e||(t.Ea.add(2),await Mu(t),t.Va.set("Unknown"))}function Pl(n){return n.ma||(n.ma=(function(t,i,r){const l=Je(t);return l.sa(),new VM(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,r)})(n.datastore,n.asyncQueue,{Zo:$M.bind(null,n),Yo:YM.bind(null,n),t_:JM.bind(null,n),J_:KM.bind(null,n)}),n.Ra.push((async e=>{e?(n.ma.B_(),sx(n)?ix(n):n.Va.set("Unknown")):(await n.ma.stop(),zE(n))}))),n.ma}function fo(n){return n.fa||(n.fa=(function(t,i,r){const l=Je(t);return l.sa(),new zM(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,r)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),Yo:QM.bind(null,n),t_:t5.bind(null,n),ta:ZM.bind(null,n),na:e5.bind(null,n)}),n.Ra.push((async e=>{e?(n.fa.B_(),await Fh(n)):(await n.fa.stop(),n.Ta.length>0&&(Ie(ra,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(e,t,i,r,l){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=l,this.deferred=new ro,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((c=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,l){const c=Date.now()+i,d=new rx(e,t,c,r,l);return d.start(i),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Me(Se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ox(n,e){if(lr("AsyncQueue",`${e}: ${n}`),Ml(n))return new Me(Se.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{static emptySet(e){return new ml(e.comparator)}constructor(e){this.comparator=e?(t,i)=>e(t,i)||Oe.comparator(t.key,i.key):(t,i)=>Oe.comparator(t.key,i.key),this.keyedMap=Zc(),this.sortedSet=new Pt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,i)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ml)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const r=t.getNext().key,l=i.getNext().key;if(!r.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const i=new ml;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(){this.ga=new Pt(Oe.comparator)}track(e){const t=e.doc.key,i=this.ga.get(t);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(t,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(t,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(t):e.type===1&&i.type===2?this.ga=this.ga.insert(t,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ze(63341,{Vt:e,pa:i}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,i)=>{e.push(i)})),e}}class Nl{constructor(e,t,i,r,l,c,d,p,h){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=l,this.fromCache=c,this.syncStateChanged=d,this.excludesMetadataChanges=p,this.hasCachedResults=h}static fromInitialDocuments(e,t,i,r,l){const c=[];return t.forEach((d=>{c.push({type:0,doc:d})})),new Nl(e,t,ml.emptySet(t),c,i,r,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ph(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==i[r].type||!t[r].doc.isEqual(i[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i5{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some((e=>e.Da()))}}class s5{constructor(){this.queries=k_(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,i){const r=Je(t),l=r.queries;r.queries=k_(),l.forEach(((c,d)=>{for(const p of d.ba)p.onError(i)}))})(this,new Me(Se.ABORTED,"Firestore shutting down"))}}function k_(){return new aa((n=>lE(n)),Ph)}async function r5(n,e){const t=Je(n);let i=3;const r=e.query;let l=t.queries.get(r);l?!l.Sa()&&e.Da()&&(i=2):(l=new i5,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await t.onListen(r,!0);break;case 1:l.wa=await t.onListen(r,!1);break;case 2:await t.onFirstRemoteStoreListen(r)}}catch(c){const d=ox(c,`Initialization of query '${sl(e.query)}' failed`);return void e.onError(d)}t.queries.set(r,l),l.ba.push(e),e.va(t.onlineState),l.wa&&e.Fa(l.wa)&&ax(t)}async function o5(n,e){const t=Je(n),i=e.query;let r=3;const l=t.queries.get(i);if(l){const c=l.ba.indexOf(e);c>=0&&(l.ba.splice(c,1),l.ba.length===0?r=e.Da()?0:1:!l.Sa()&&e.Da()&&(r=2))}switch(r){case 0:return t.queries.delete(i),t.onUnlisten(i,!0);case 1:return t.queries.delete(i),t.onUnlisten(i,!1);case 2:return t.onLastRemoteStoreUnlisten(i);default:return}}function a5(n,e){const t=Je(n);let i=!1;for(const r of e){const l=r.query,c=t.queries.get(l);if(c){for(const d of c.ba)d.Fa(r)&&(i=!0);c.wa=r}}i&&ax(t)}function l5(n,e,t){const i=Je(n),r=i.queries.get(e);if(r)for(const l of r.ba)l.onError(t);i.queries.delete(e)}function ax(n){n.Ca.forEach((e=>{e.next()}))}var e0,A_;(A_=e0||(e0={})).Ma="default",A_.Cache="cache";class c5{constructor(e,t,i){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const r of e.docChanges)r.type!==3&&i.push(r);e=new Nl(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;const i=t!=="Offline";return(!this.options.Ka||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Nl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==e0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BE{constructor(e){this.key=e}}class qE{constructor(e){this.key=e}}class u5{constructor(e,t){this.query=e,this.Za=t,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=rt(),this.mutatedKeys=rt(),this.eu=cE(e),this.tu=new ml(this.eu)}get nu(){return this.Za}ru(e,t){const i=t?t.iu:new C_,r=t?t.tu:this.tu;let l=t?t.mutatedKeys:this.mutatedKeys,c=r,d=!1;const p=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,h=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((x,b)=>{const T=r.get(x),S=Lh(this.query,b)?b:null,E=!!T&&this.mutatedKeys.has(T.key),D=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let k=!1;T&&S?T.data.isEqual(S.data)?E!==D&&(i.track({type:3,doc:S}),k=!0):this.su(T,S)||(i.track({type:2,doc:S}),k=!0,(p&&this.eu(S,p)>0||h&&this.eu(S,h)<0)&&(d=!0)):!T&&S?(i.track({type:0,doc:S}),k=!0):T&&!S&&(i.track({type:1,doc:T}),k=!0,(p||h)&&(d=!0)),k&&(S?(c=c.add(S),l=D?l.add(x):l.delete(x)):(c=c.delete(x),l=l.delete(x)))})),this.query.limit!==null)for(;c.size>this.query.limit;){const x=this.query.limitType==="F"?c.last():c.first();c=c.delete(x.key),l=l.delete(x.key),i.track({type:1,doc:x})}return{tu:c,iu:i,Ss:d,mutatedKeys:l}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i,r){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const c=e.iu.ya();c.sort(((x,b)=>(function(S,E){const D=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ze(20277,{Vt:k})}};return D(S)-D(E)})(x.type,b.type)||this.eu(x.doc,b.doc))),this.ou(i),r=r??!1;const d=t&&!r?this._u():[],p=this.Ya.size===0&&this.current&&!r?1:0,h=p!==this.Xa;return this.Xa=p,c.length!==0||h?{snapshot:new Nl(this.query,e.tu,l,c,e.mutatedKeys,p===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:d}:{au:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new C_,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Za=this.Za.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Za=this.Za.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=rt(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Ya=this.Ya.add(i.key))}));const t=[];return e.forEach((i=>{this.Ya.has(i)||t.push(new qE(i))})),this.Ya.forEach((i=>{e.has(i)||t.push(new BE(i))})),t}cu(e){this.Za=e.ks,this.Ya=rt();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Nl.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const lx="SyncEngine";class d5{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class f5{constructor(e){this.key=e,this.hu=!1}}class h5{constructor(e,t,i,r,l,c){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=r,this.currentUser=l,this.maxConcurrentLimboResolutions=c,this.Pu={},this.Tu=new aa((d=>lE(d)),Ph),this.Iu=new Map,this.Eu=new Set,this.Ru=new Pt(Oe.comparator),this.Au=new Map,this.Vu=new W0,this.du={},this.mu=new Map,this.fu=El.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function p5(n,e,t=!0){const i=WE(n);let r;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),r=l.view.lu()):r=await $E(i,e,t,!0),r}async function m5(n,e){const t=WE(n);await $E(t,e,!0,!1)}async function $E(n,e,t,i){const r=await RM(n.localStore,Is(e)),l=r.targetId,c=n.sharedClientState.addLocalQueryTarget(l,t);let d;return i&&(d=await g5(n,e,l,c==="current",r.resumeToken)),n.isPrimaryClient&&t&&UE(n.remoteStore,r),d}async function g5(n,e,t,i,r){n.pu=(b,T,S)=>(async function(D,k,F,$){let M=k.view.ru(F);M.Ss&&(M=await __(D.localStore,k.query,!1).then((({documents:R})=>k.view.ru(R,M))));const J=$&&$.targetChanges.get(k.targetId),H=$&&$.targetMismatches.get(k.targetId)!=null,z=k.view.applyChanges(M,D.isPrimaryClient,J,H);return R_(D,k.targetId,z.au),z.snapshot})(n,b,T,S);const l=await __(n.localStore,e,!0),c=new u5(e,l.ks),d=c.ru(l.documents),p=Du.createSynthesizedTargetChangeForCurrentChange(t,i&&n.onlineState!=="Offline",r),h=c.applyChanges(d,n.isPrimaryClient,p);R_(n,t,h.au);const x=new d5(e,t,c);return n.Tu.set(e,x),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function x5(n,e,t){const i=Je(n),r=i.Tu.get(e),l=i.Iu.get(r.targetId);if(l.length>1)return i.Iu.set(r.targetId,l.filter((c=>!Ph(c,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||await Qg(i.localStore,r.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(r.targetId),t&&tx(i.remoteStore,r.targetId),t0(i,r.targetId)})).catch(Dl)):(t0(i,r.targetId),await Qg(i.localStore,r.targetId,!0))}async function y5(n,e){const t=Je(n),i=t.Tu.get(e),r=t.Iu.get(i.targetId);t.isPrimaryClient&&r.length===1&&(t.sharedClientState.removeLocalQueryTarget(i.targetId),tx(t.remoteStore,i.targetId))}async function v5(n,e,t){const i=N5(n);try{const r=await(function(c,d){const p=Je(c),h=kt.now(),x=d.reduce(((S,E)=>S.add(E.key)),rt());let b,T;return p.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let E=cr(),D=rt();return p.xs.getEntries(S,x).next((k=>{E=k,E.forEach(((F,$)=>{$.isValidDocument()||(D=D.add(F))}))})).next((()=>p.localDocuments.getOverlayedDocuments(S,E))).next((k=>{b=k;const F=[];for(const $ of d){const M=ID($,b.get($.key).overlayedDocument);M!=null&&F.push(new la($.key,M,tE(M.value.mapValue),rr.exists(!0)))}return p.mutationQueue.addMutationBatch(S,h,F,d)})).next((k=>{T=k;const F=k.applyToLocalDocumentSet(b,D);return p.documentOverlayCache.saveOverlays(S,k.batchId,F)}))})).then((()=>({batchId:T.batchId,changes:dE(b)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(r.batchId),(function(c,d,p){let h=c.du[c.currentUser.toKey()];h||(h=new Pt(st)),h=h.insert(d,p),c.du[c.currentUser.toKey()]=h})(i,r.batchId,t),await Pu(i,r.changes),await Fh(i.remoteStore)}catch(r){const l=ox(r,"Failed to persist write");t.reject(l)}}async function YE(n,e){const t=Je(n);try{const i=await kM(t.localStore,e);e.targetChanges.forEach(((r,l)=>{const c=t.Au.get(l);c&&(xt(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?c.hu=!0:r.modifiedDocuments.size>0?xt(c.hu,14607):r.removedDocuments.size>0&&(xt(c.hu,42227),c.hu=!1))})),await Pu(t,i,e)}catch(i){await Dl(i)}}function I_(n,e,t){const i=Je(n);if(i.isPrimaryClient&&t===0||!i.isPrimaryClient&&t===1){const r=[];i.Tu.forEach(((l,c)=>{const d=c.view.va(e);d.snapshot&&r.push(d.snapshot)})),(function(c,d){const p=Je(c);p.onlineState=d;let h=!1;p.queries.forEach(((x,b)=>{for(const T of b.ba)T.va(d)&&(h=!0)})),h&&ax(p)})(i.eventManager,e),r.length&&i.Pu.J_(r),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function b5(n,e,t){const i=Je(n);i.sharedClientState.updateQueryState(e,"rejected",t);const r=i.Au.get(e),l=r&&r.key;if(l){let c=new Pt(Oe.comparator);c=c.insert(l,Mn.newNoDocument(l,$e.min()));const d=rt().add(l),p=new Vh($e.min(),new Map,new Pt(st),c,d);await YE(i,p),i.Ru=i.Ru.remove(l),i.Au.delete(e),cx(i)}else await Qg(i.localStore,e,!1).then((()=>t0(i,e,t))).catch(Dl)}async function _5(n,e){const t=Je(n),i=e.batch.batchId;try{const r=await CM(t.localStore,e);KE(t,i,null),JE(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),await Pu(t,r)}catch(r){await Dl(r)}}async function T5(n,e,t){const i=Je(n);try{const r=await(function(c,d){const p=Je(c);return p.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let x;return p.mutationQueue.lookupMutationBatch(h,d).next((b=>(xt(b!==null,37113),x=b.keys(),p.mutationQueue.removeMutationBatch(h,b)))).next((()=>p.mutationQueue.performConsistencyCheck(h))).next((()=>p.documentOverlayCache.removeOverlaysForBatchId(h,x,d))).next((()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,x))).next((()=>p.localDocuments.getDocuments(h,x)))}))})(i.localStore,e);KE(i,e,t),JE(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),await Pu(i,r)}catch(r){await Dl(r)}}function JE(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function KE(n,e,t){const i=Je(n);let r=i.du[i.currentUser.toKey()];if(r){const l=r.get(e);l&&(t?l.reject(t):l.resolve(),r=r.remove(e)),i.du[i.currentUser.toKey()]=r}}function t0(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.Iu.get(e))n.Tu.delete(i),t&&n.Pu.yu(i,t);n.Iu.delete(e),n.isPrimaryClient&&n.Vu.Gr(e).forEach((i=>{n.Vu.containsKey(i)||XE(n,i)}))}function XE(n,e){n.Eu.delete(e.path.canonicalString());const t=n.Ru.get(e);t!==null&&(tx(n.remoteStore,t),n.Ru=n.Ru.remove(e),n.Au.delete(t),cx(n))}function R_(n,e,t){for(const i of t)i instanceof BE?(n.Vu.addReference(i.key,e),S5(n,i)):i instanceof qE?(Ie(lx,"Document no longer in limbo: "+i.key),n.Vu.removeReference(i.key,e),n.Vu.containsKey(i.key)||XE(n,i.key)):ze(19791,{wu:i})}function S5(n,e){const t=e.key,i=t.path.canonicalString();n.Ru.get(t)||n.Eu.has(i)||(Ie(lx,"New document in limbo: "+t),n.Eu.add(i),cx(n))}function cx(n){for(;n.Eu.size>0&&n.Ru.size<n.maxConcurrentLimboResolutions;){const e=n.Eu.values().next().value;n.Eu.delete(e);const t=new Oe(Mt.fromString(e)),i=n.fu.next();n.Au.set(i,new f5(t)),n.Ru=n.Ru.insert(t,i),UE(n.remoteStore,new Zr(Is($0(t.path)),i,"TargetPurposeLimboResolution",Rh.ce))}}async function Pu(n,e,t){const i=Je(n),r=[],l=[],c=[];i.Tu.isEmpty()||(i.Tu.forEach(((d,p)=>{c.push(i.pu(p,e,t).then((h=>{var x;if((h||t)&&i.isPrimaryClient){const b=h?!h.fromCache:(x=t==null?void 0:t.targetChanges.get(p.targetId))==null?void 0:x.current;i.sharedClientState.updateQueryState(p.targetId,b?"current":"not-current")}if(h){r.push(h);const b=Z0.Es(p.targetId,h);l.push(b)}})))})),await Promise.all(c),i.Pu.J_(r),await(async function(p,h){const x=Je(p);try{await x.persistence.runTransaction("notifyLocalViewChanges","readwrite",(b=>ve.forEach(h,(T=>ve.forEach(T.Ts,(S=>x.persistence.referenceDelegate.addReference(b,T.targetId,S))).next((()=>ve.forEach(T.Is,(S=>x.persistence.referenceDelegate.removeReference(b,T.targetId,S)))))))))}catch(b){if(!Ml(b))throw b;Ie(ex,"Failed to update sequence numbers: "+b)}for(const b of h){const T=b.targetId;if(!b.fromCache){const S=x.vs.get(T),E=S.snapshotVersion,D=S.withLastLimboFreeSnapshotVersion(E);x.vs=x.vs.insert(T,D)}}})(i.localStore,l))}async function w5(n,e){const t=Je(n);if(!t.currentUser.isEqual(e)){Ie(lx,"User change. New user:",e.toKey());const i=await ME(t.localStore,e);t.currentUser=e,(function(l,c){l.mu.forEach((d=>{d.forEach((p=>{p.reject(new Me(Se.CANCELLED,c))}))})),l.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await Pu(t,i.Ns)}}function E5(n,e){const t=Je(n),i=t.Au.get(e);if(i&&i.hu)return rt().add(i.key);{let r=rt();const l=t.Iu.get(e);if(!l)return r;for(const c of l){const d=t.Tu.get(c);r=r.unionWith(d.view.nu)}return r}}function WE(n){const e=Je(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=YE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=E5.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=b5.bind(null,e),e.Pu.J_=a5.bind(null,e.eventManager),e.Pu.yu=l5.bind(null,e.eventManager),e}function N5(n){const e=Je(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_5.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=T5.bind(null,e),e}class ch{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=zh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return NM(this.persistence,new SM,e.initialUser,this.serializer)}Cu(e){return new DE(Q0.Vi,this.serializer)}Du(e){return new DM}async terminate(){var e,t;(e=this.gcScheduler)==null||e.stop(),(t=this.indexBackfillerScheduler)==null||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ch.provider={build:()=>new ch};class C5 extends ch{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){xt(this.persistence.referenceDelegate instanceof ah,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new lM(i,e.asyncQueue,t)}Cu(e){const t=this.cacheSizeBytes!==void 0?Kn.withCacheSize(this.cacheSizeBytes):Kn.DEFAULT;return new DE((i=>ah.Vi(i,t)),this.serializer)}}class n0{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>I_(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=w5.bind(null,this.syncEngine),await n5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new s5})()}createDatastore(e){const t=zh(e.databaseInfo.databaseId),i=UM(e.databaseInfo);return GM(e.authCredentials,e.appCheckCredentials,i,t)}createRemoteStore(e){return(function(i,r,l,c,d){return new qM(i,r,l,c,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>I_(this.syncEngine,t,0)),(function(){return w_.v()?new w_:new MM})())}createSyncEngine(e,t){return(function(r,l,c,d,p,h,x){const b=new h5(r,l,c,d,p,h);return x&&(b.gu=!0),b})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(r){const l=Je(r);Ie(ra,"RemoteStore shutting down."),l.Ea.add(5),await Mu(l),l.Aa.shutdown(),l.Va.set("Unknown")})(this.remoteStore),(e=this.datastore)==null||e.terminate(),(t=this.eventManager)==null||t.terminate()}}n0.provider={build:()=>new n0};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k5{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):lr("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho="FirestoreClient";class A5{constructor(e,t,i,r,l){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=i,this._databaseInfo=r,this.user=jn.UNAUTHENTICATED,this.clientId=V0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async c=>{Ie(ho,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c})),this.appCheckCredentials.start(i,(c=>(Ie(ho,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ro;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const i=ox(t,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function _g(n,e){n.asyncQueue.verifyOperationInProgress(),Ie(ho,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener((async r=>{i.isEqual(r)||(await ME(e.localStore,r),i=r)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function j_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await I5(n);Ie(ho,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((i=>N_(e.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,r)=>N_(e.remoteStore,r))),n._onlineComponents=e}async function I5(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ie(ho,"Using user provided OfflineComponentProvider");try{await _g(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(r){return r.name==="FirebaseError"?r.code===Se.FAILED_PRECONDITION||r.code===Se.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11})(t))throw t;sa("Error using user provided cache. Falling back to memory cache: "+t),await _g(n,new ch)}}else Ie(ho,"Using default OfflineComponentProvider"),await _g(n,new C5(void 0));return n._offlineComponents}async function QE(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ie(ho,"Using user provided OnlineComponentProvider"),await j_(n,n._uninitializedComponentsProvider._online)):(Ie(ho,"Using default OnlineComponentProvider"),await j_(n,new n0))),n._onlineComponents}function R5(n){return QE(n).then((e=>e.syncEngine))}async function j5(n){const e=await QE(n),t=e.eventManager;return t.onListen=p5.bind(null,e.syncEngine),t.onUnlisten=x5.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=m5.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=y5.bind(null,e.syncEngine),t}function D5(n,e,t={}){const i=new ro;return n.asyncQueue.enqueueAndForget((async()=>(function(l,c,d,p,h){const x=new k5({next:T=>{x.Nu(),c.enqueueAndForget((()=>o5(l,b)));const S=T.docs.has(d);!S&&T.fromCache?h.reject(new Me(Se.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&T.fromCache&&p&&p.source==="server"?h.reject(new Me(Se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(T)},error:T=>h.reject(T)}),b=new c5($0(d.path),x,{includeMetadataChanges:!0,Ka:!0});return r5(l,b)})(await j5(n),n.asyncQueue,e,t,i))),i.promise}function M5(n,e){const t=new ro;return n.asyncQueue.enqueueAndForget((async()=>v5(await R5(n),e,t))),t.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZE(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P5="ComponentProvider",D_=new Map;function L5(n,e,t,i,r){return new Qj(n,e,t,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,ZE(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator,i)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN="firestore.googleapis.com",M_=!0;class P_{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Me(Se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=eN,this.ssl=M_}else this.host=e.host,this.ssl=e.ssl??M_;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jE;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<oM)throw new Me(Se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Hj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZE(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Me(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Me(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Me(Se.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,r){return i.timeoutSeconds===r.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ux{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new P_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Me(Se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Me(Se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new P_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Ij;switch(i.type){case"firstParty":return new Mj(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Me(Se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const i=D_.get(t);i&&(Ie(P5,"Removing Datastore"),D_.delete(t),i.terminate())})(this),Promise.resolve()}}function O5(n,e,t,i={}){var h;n=pu(n,ux);const r=Al(e),l=n._getSettings(),c={...l,emulatorOptions:n._getEmulatorOptions()},d=`${e}:${t}`;r&&(QS(`https://${d}`),ZS("Firestore",!0)),l.host!==eN&&l.host!==d&&sa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p={...l,host:d,ssl:r,emulatorOptions:i};if(!ea(p,c)&&(n._setSettings(p),i.mockUserToken)){let x,b;if(typeof i.mockUserToken=="string")x=i.mockUserToken,b=jn.MOCK_USER;else{x=tA(i.mockUserToken,(h=n._app)==null?void 0:h.options.projectId);const T=i.mockUserToken.sub||i.mockUserToken.user_id;if(!T)throw new Me(Se.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");b=new jn(T)}n._authCredentials=new Rj(new Bw(x,b))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new dx(this.firestore,e,this._query)}}class mn{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _u(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mn(this.firestore,e,this._key)}toJSON(){return{type:mn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,i){if(Ru(t,mn._jsonSchema))return new mn(e,i||null,new Oe(Mt.fromString(t.referencePath)))}}mn._jsonSchemaVersion="firestore/documentReference/1.0",mn._jsonSchema={type:en("string",mn._jsonSchemaVersion),referencePath:en("string")};class _u extends dx{constructor(e,t,i){super(e,t,$0(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new mn(this.firestore,null,new Oe(e))}withConverter(e){return new _u(this.firestore,e,this._path)}}function L_(n,e,...t){if(n=fi(n),arguments.length===1&&(e=V0.newId()),zj("doc","path",e),n instanceof ux){const i=Mt.fromString(e,...t);return K1(i),new mn(n,null,new Oe(i))}{if(!(n instanceof mn||n instanceof _u))throw new Me(Se.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(Mt.fromString(e,...t));return K1(i),new mn(n.firestore,n instanceof _u?n.converter:null,new Oe(i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="AsyncQueue";class U_{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new LE(this,"async_queue_retry"),this._c=()=>{const i=bg();i&&Ie(O_,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const t=bg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=bg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new ro;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Yu.push(e),this.lc())))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ml(e))throw e;Ie(O_,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,lr("INTERNAL UNHANDLED ERROR: ",V_(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=t,t}enqueueAfterDelay(e,t,i){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=rx.createAndSchedule(this,e,t,i,(l=>this.hc(l)));return this.tc.push(r),r}uc(){this.nc&&ze(47125,{Pc:V_(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,i)=>t.targetTimeMs-i.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}Rc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function V_(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}class fx extends ux{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new U_,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new U_(e),this._firestoreClient=void 0,await e}}}function U5(n,e){const t=typeof n=="object"?n:iw(),i=typeof n=="string"?n:eh,r=N0(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const l=Zk("firestore");l&&O5(r,...l)}return r}function tN(n){if(n._terminated)throw new Me(Se.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||V5(n),n._firestoreClient}function V5(n){var i,r,l,c;const e=n._freezeSettings(),t=L5(n._databaseId,((i=n._app)==null?void 0:i.options.appId)||"",n._persistenceKey,(r=n._app)==null?void 0:r.options.apiKey,e);n._componentsProvider||(l=e.localCache)!=null&&l._offlineComponentProvider&&((c=e.localCache)!=null&&c._onlineComponentProvider)&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new A5(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(p){const h=p==null?void 0:p._online.build();return{_offline:p==null?void 0:p._offline.build(h),_online:h}})(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ji(Cn.fromBase64String(e))}catch(t){throw new Me(Se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ji(Cn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ji._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ru(e,ji._jsonSchema))return ji.fromBase64String(e.bytes)}}ji._jsonSchemaVersion="firestore/bytes/1.0",ji._jsonSchema={type:en("string",ji._jsonSchemaVersion),bytes:en("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Me(Se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new En(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Me(Se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Me(Se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:js._jsonSchemaVersion}}static fromJSON(e){if(Ru(e,js._jsonSchema))return new js(e.latitude,e.longitude)}}js._jsonSchemaVersion="firestore/geoPoint/1.0",js._jsonSchema={type:en("string",js._jsonSchemaVersion),latitude:en("number"),longitude:en("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,r){if(i.length!==r.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==r[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Qi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ru(e,Qi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Qi(e.vectorValues);throw new Me(Se.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Qi._jsonSchemaVersion="firestore/vectorValue/1.0",Qi._jsonSchema={type:en("string",Qi._jsonSchemaVersion),vectorValues:en("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z5=/^__.*__$/;class H5{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return this.fieldMask!==null?new la(e,this.data,this.fieldMask,t,this.fieldTransforms):new ju(e,this.data,t,this.fieldTransforms)}}function sN(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ze(40011,{dataSource:n})}}class hx{constructor(e,t,i,r,l,c){this.settings=e,this.databaseId=t,this.serializer=i,this.ignoreUndefinedProperties=r,l===void 0&&this.validatePath(),this.fieldTransforms=l||[],this.fieldMask=c||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new hx({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePathSegment(e),i}childContextForFieldPath(e){var r;const t=(r=this.path)==null?void 0:r.child(e),i=this.contextWith({path:t,arrayElement:!1});return i.validatePath(),i}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return uh(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(sN(this.dataSource)&&z5.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class F5{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=i||zh(e)}createContext(e,t,i,r=!1){return new hx({dataSource:e,methodName:t,targetDoc:i,path:En.emptyPath(),arrayElement:!1,hasConverter:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function G5(n){const e=n._freezeSettings(),t=zh(n._databaseId);return new F5(n._databaseId,!!e.ignoreUndefinedProperties,t)}function B5(n,e,t,i,r,l={}){const c=n.createContext(l.merge||l.mergeFields?2:0,e,t,r);lN("Data must be an object, but it was:",c,i);const d=oN(i,c);let p,h;if(l.merge)p=new Ki(c.fieldMask),h=c.fieldTransforms;else if(l.mergeFields){const x=[];for(const b of l.mergeFields){const T=px(e,b,t);if(!c.contains(T))throw new Me(Se.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);Y5(x,T)||x.push(T)}p=new Ki(x),h=c.fieldTransforms.filter((b=>p.covers(b.field)))}else p=null,h=c.fieldTransforms;return new H5(new Ri(d),p,h)}function rN(n,e){if(aN(n=fi(n)))return lN("Unsupported field value:",e,n),oN(n,e);if(n instanceof iN)return(function(i,r){if(!sN(r.dataSource))throw r.createError(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(r);l&&r.fieldTransforms.push(l)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return(function(i,r){const l=[];let c=0;for(const d of i){let p=rN(d,r.childContextForArray(c));p==null&&(p={nullValue:"NULL_VALUE"}),l.push(p),c++}return{arrayValue:{values:l}}})(n,e)}return(function(i,r){if((i=fi(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return wD(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=kt.fromDate(i);return{timestampValue:oh(r.serializer,l)}}if(i instanceof kt){const l=new kt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:oh(r.serializer,l)}}if(i instanceof js)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ji)return{bytesValue:wE(r.serializer,i._byteString)};if(i instanceof mn){const l=r.databaseId,c=i.firestore._databaseId;if(!c.isEqual(l))throw r.createError(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:X0(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof Qi)return(function(c,d){const p=c instanceof Qi?c.toArray():c;return{mapValue:{fields:{[Zw]:{stringValue:eE},[th]:{arrayValue:{values:p.map((x=>{if(typeof x!="number")throw d.createError("VectorValues must only contain numeric values.");return Y0(d.serializer,x)}))}}}}}})(i,r);if(RE(i))return i._toProto(r.serializer);throw r.createError(`Unsupported field value: ${z0(i)}`)})(n,e)}function oN(n,e){const t={};return Yw(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):oa(n,((i,r)=>{const l=rN(r,e.childContextForField(i));l!=null&&(t[i]=l)})),{mapValue:{fields:t}}}function aN(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof kt||n instanceof js||n instanceof ji||n instanceof mn||n instanceof iN||n instanceof Qi||RE(n))}function lN(n,e,t){if(!aN(t)||!qw(t)){const i=z0(t);throw i==="an object"?e.createError(n+" a custom object"):e.createError(n+" "+i)}}function px(n,e,t){if((e=fi(e))instanceof nN)return e._internalPath;if(typeof e=="string")return $5(n,e);throw uh("Field path arguments must be of type string or ",n,!1,void 0,t)}const q5=new RegExp("[~\\*/\\[\\]]");function $5(n,e,t){if(e.search(q5)>=0)throw uh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new nN(...e.split("."))._internalPath}catch{throw uh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function uh(n,e,t,i,r){const l=i&&!i.isEmpty(),c=r!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let p="";return(l||c)&&(p+=" (found",l&&(p+=` in field ${i}`),c&&(p+=` in document ${r}`),p+=")"),new Me(Se.INVALID_ARGUMENT,d+n+p)}function Y5(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J5{convertValue(e,t="none"){switch(uo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Gt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(co(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ze(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const i={};return oa(e,((r,l)=>{i[r]=this.convertValue(l,t)})),i}convertVectorValue(e){var i,r,l;const t=(l=(r=(i=e.fields)==null?void 0:i[th].arrayValue)==null?void 0:r.values)==null?void 0:l.map((c=>Gt(c.doubleValue)));return new Qi(t)}convertGeoPoint(e){return new js(Gt(e.latitude),Gt(e.longitude))}convertArray(e,t){return(e.values||[]).map((i=>this.convertValue(i,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Dh(e);return i==null?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(gu(e));default:return null}}convertTimestamp(e){const t=lo(e);return new kt(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=Mt.fromString(e);xt(IE(i),9688,{name:e});const r=new xu(i.get(1),i.get(3)),l=new Oe(i.popFirst(5));return r.isEqual(t)||lr(`Document ${l} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),l}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K5 extends J5{constructor(e){super(),this.firestore=e}convertBytes(e){return new ji(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,t)}}const z_="@firebase/firestore",H_="4.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e,t,i,r,l){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=r,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new mn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new X5(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const t=this._document.data.field(px("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class X5 extends cN{data(){return super.data()}}function W5(n,e,t){let i;return i=n?n.toFirestore(e):e,i}class tu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zo extends cN{constructor(e,t,i,r,l,c){super(e,t,i,r,c),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Vf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(px("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Me(Se.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Zo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}Zo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Zo._jsonSchema={type:en("string",Zo._jsonSchemaVersion),bundleSource:en("string","DocumentSnapshot"),bundleName:en("string"),bundle:en("string")};class Vf extends Zo{data(e={}){return super.data(e)}}class uu{constructor(e,t,i,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new tu(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((i=>{e.call(t,new Vf(this._firestore,this._userDataWriter,i.key,i,new tu(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Me(Se.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(r,l){if(r._snapshot.oldDocs.isEmpty()){let c=0;return r._snapshot.docChanges.map((d=>{const p=new Vf(r._firestore,r._userDataWriter,d.doc.key,d.doc,new tu(r._snapshot.mutatedKeys.has(d.doc.key),r._snapshot.fromCache),r.query.converter);return d.doc,{type:"added",doc:p,oldIndex:-1,newIndex:c++}}))}{let c=r._snapshot.oldDocs;return r._snapshot.docChanges.filter((d=>l||d.type!==3)).map((d=>{const p=new Vf(r._firestore,r._userDataWriter,d.doc.key,d.doc,new tu(r._snapshot.mutatedKeys.has(d.doc.key),r._snapshot.fromCache),r.query.converter);let h=-1,x=-1;return d.type!==0&&(h=c.indexOf(d.doc.key),c=c.delete(d.doc.key)),d.type!==1&&(c=c.add(d.doc),x=c.indexOf(d.doc.key)),{type:Q5(d.type),doc:p,oldIndex:h,newIndex:x}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Me(Se.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=uu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=V0.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],i=[],r=[];return this.docs.forEach((l=>{l._document!==null&&(t.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),r.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Q5(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ze(61501,{type:n})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */uu._jsonSchemaVersion="firestore/querySnapshot/1.0",uu._jsonSchema={type:en("string",uu._jsonSchemaVersion),bundleSource:en("string","QuerySnapshot"),bundleName:en("string"),bundle:en("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z5(n){n=pu(n,mn);const e=pu(n.firestore,fx),t=tN(e);return D5(t,n._key).then((i=>n4(e,n,i)))}function e4(n,e,t){n=pu(n,mn);const i=pu(n.firestore,fx),r=W5(n.converter,e),l=G5(i);return t4(i,[B5(l,"setDoc",n._key,r,n.converter!==null,t).toMutation(n._key,rr.none())])}function t4(n,e){const t=tN(n);return M5(t,e)}function n4(n,e,t){const i=t.docs.get(e._key),r=new K5(n);return new Zo(n,r,e._key,i,new tu(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){Aj(Il),bl(new ta("firestore",((i,{instanceIdentifier:r,options:l})=>{const c=i.getProvider("app").getImmediate(),d=new fx(new jj(i.getProvider("auth-internal")),new Pj(c,i.getProvider("app-check-internal")),Zj(c,r),c);return l={useFetchStreams:t,...l},d._setSettings(l),d}),"PUBLIC").setMultipleInstances(!0)),io(z_,H_,e),io(z_,H_,"esm2020")})();const i4={apiKey:"AIzaSyANv4kf7cjoLdTGGZqkI3DX0TVMyi6j2_A",authDomain:"life-os-6c01f.firebaseapp.com",projectId:"life-os-6c01f",storageBucket:"life-os-6c01f.firebasestorage.app",messagingSenderId:"870895248318",appId:"1:870895248318:web:0de4b80a0cf8663b564fef",measurementId:"G-W7RN5B5WZP"},uN=nw(i4),oo=Cj(uN),F_=U5(uN);function Ll(n,e,t,i){const[r,l]=K.useState(e),[c,d]=K.useState(!0),[p,h]=K.useState(null),x=K.useRef(!1);return K.useEffect(()=>{const b=M0(oo,async T=>{if(h(T),d(!0),T)try{const S=L_(F_,"users",T.uid,"modules",t),E=await Z5(S);if(E.exists()){let D=E.data();i&&(D=i(D)),l(D)}else l(e)}catch(S){console.error(`Error fetching ${t}:`,S),l(e)}else try{const S=localStorage.getItem(n);if(S){let E=JSON.parse(S);i&&(E=i(E)),l(E)}else l(e)}catch(S){console.warn(`Error loading local ${n}:`,S),l(e)}d(!1),x.current=!0});return()=>b()},[n,t]),K.useEffect(()=>{if(!x.current)return;const b=setTimeout(async()=>{if(p)try{const T=L_(F_,"users",p.uid,"modules",t),S=JSON.parse(JSON.stringify(r,(E,D)=>D===void 0?null:D));await e4(T,S)}catch(T){console.error(`Error saving ${t}:`,T)}else localStorage.setItem(n,JSON.stringify(r))},1e3);return()=>clearTimeout(b)},[r,p,n,t]),[r,l,c]}const dN=K.createContext(void 0),s4=n=>{var r,l,c,d,p,h,x,b,T,S,E,D,k,F;const e=((r=n.user)==null?void 0:r.stats)||{},t={[te.STR]:e.STR||1,[te.INT]:e.INT||1,[te.DIS]:e.DIS||1,[te.HEA]:e.HEA||e.EMT||1,[te.CRT]:e.CRT||1,[te.SPR]:e.SPR||e.PCE||1,[te.REL]:e.REL||e.CAM||1,[te.FIN]:e.FIN||1};return{user:{...Wc.user,...n.user,metrics:{...Wc.user.metrics,...((l=n.user)==null?void 0:l.metrics)||{}},preferences:{...Wc.user.preferences,...((c=n.user)==null?void 0:c.preferences)||{}},stats:t,inventory:((d=n.user)==null?void 0:d.inventory)||[],equippedItems:((p=n.user)==null?void 0:p.equippedItems)||[],badges:((h=n.user)==null?void 0:h.badges)||[],featuredBadges:((x=n.user)==null?void 0:x.featuredBadges)||[],unlockedThemes:(b=n.user)!=null&&b.unlockedThemes?[...n.user.unlockedThemes,...jg.filter($=>!n.user.unlockedThemes.some(M=>M.id===$.id))]:jg,lastOnline:((T=n.user)==null?void 0:T.lastOnline)||new Date().toISOString(),hasOnboarded:((S=n.user)==null?void 0:S.hasOnboarded)??((E=n.user)==null?void 0:E.name)!=="Shadow Walker"},badgesRegistry:n.badgesRegistry||[],ui:{...Wc.ui,...n.ui,currentView:((D=n.ui)==null?void 0:D.currentView)||"tasks",debugDate:((k=n.ui)==null?void 0:k.debugDate)||null,habitsViewMode:((F=n.ui)==null?void 0:F.habitsViewMode)||"list",modalQueue:[]}}},r4=({children:n})=>{const[e,t,i]=Ll(Vk,Wc,"lifeos_data",s4);Bk(e,t),K.useEffect(()=>{const U=e.user.preferences.theme,Y=e.user.unlockedThemes.find(B=>B.id===U)||e.user.unlockedThemes[0],X=document.documentElement;Y&&Object.entries(Y.colors).forEach(([B,ee])=>X.style.setProperty(B,ee)),document.body.setAttribute("data-theme",U);const ie="theme-custom-structural-css";let pe=document.getElementById(ie);Y!=null&&Y.customCss?(pe||(pe=document.createElement("style"),pe.id=ie,document.head.appendChild(pe)),pe.innerHTML=Y.customCss):pe&&(pe.innerHTML="")},[e.user.preferences.theme,e.user.unlockedThemes]),K.useEffect(()=>{const U=()=>{const X=e.ui.debugDate?new Date(e.ui.debugDate):new Date,ie=new Date(e.user.lastProcessedDate),pe=e.user.preferences.dayStartHour??4,B=Q=>{const ae=new Date(Q);return ae.setHours(Q.getHours()-pe),ae},ee=B(X),he=B(ie);if(ee.getDate()!==he.getDate()||ee.getMonth()!==he.getMonth()){const Q=`day_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,ae=new Date().toISOString();t(ye=>{const{newUser:ue,toastMessage:Te,toastType:Ae,newBadge:Be}=x1(ye.user,ye.ui.debugDate),jt={id:Q,message:Te,type:Ae,timestamp:ae};let Dt=ye.badgesRegistry;return Be&&(Dt=[...ye.badgesRegistry,Be],ue.badges.includes(Be.id)||(ue.badges.push(Be.id),ue.badgeTiers[Be.id]="gold",ue.badgeHistory[Be.id]||(ue.badgeHistory[Be.id]={}),ue.badgeHistory[Be.id].gold=new Date().toISOString())),{...ye,user:ue,badgesRegistry:Dt,ui:{...ye.ui,toasts:[...ye.ui.toasts,jt],systemLogs:[jt,...ye.ui.systemLogs||[]].slice(0,100)}}})}else t(Q=>({...Q,user:{...Q.user,lastOnline:X.toISOString()}}))};U();const Y=setInterval(U,5e3);return()=>clearInterval(Y)},[e.ui.debugDate,e.user.lastProcessedDate,e.user.preferences.dayStartHour]),K.useEffect(()=>{if(e.user.currentXP<e.user.targetXP)return;let U={...e.user},Y=!1;const X=U.level;for(;U.currentXP>=U.targetXP;){Y=!0;const ie=U.currentXP-U.targetXP,pe=U.level+1,B=Math.round(U.targetXP*1.15);U={...U,level:pe,currentXP:ie,targetXP:B}}if(Y){const ie=U;t(pe=>({...pe,user:ie,ui:{...pe.ui,activeModal:"levelUp",modalData:{newLevel:ie.level,oldLevel:X}}})),Ce("level-up",e.user.preferences.soundEnabled)}},[e.user.currentXP,e.user.targetXP]);const r=e.user.preferences.soundEnabled,l=U=>t(Y=>({...Y,user:{...Y.user,...U}})),c=U=>{U!==e.ui.currentView&&(Ce("click",r),window.history.pushState({view:U},"",""),t(Y=>({...Y,ui:{...Y.ui,currentView:U}})))},d=U=>{Ce("click",r),t(Y=>({...Y,ui:{...Y.ui,habitsViewMode:U}}))},p=U=>{Ce("click",r),t(Y=>({...Y,ui:{...Y.ui,tasksViewMode:U}}))},h=(U,Y)=>{U!=="none"&&Ce("click",r),t(X=>({...X,ui:{...X.ui,activeModal:U,modalData:Y??null}}))},x=(U,Y="info")=>{const X=`${Date.now()}-${Math.random().toString(36).substr(2,9)}`;t(ie=>({...ie,ui:{...ie.ui,toasts:[...ie.ui.toasts,{id:X,message:U,type:Y,timestamp:new Date().toISOString()}],systemLogs:[{id:X,message:U,type:Y,timestamp:new Date().toISOString()},...ie.ui.systemLogs||[]].slice(0,100)}})),setTimeout(()=>b(X),3e3)},b=U=>t(Y=>({...Y,ui:{...Y.ui,toasts:Y.ui.toasts.filter(X=>X.id!==U)}})),T=(U,Y,X="task")=>{Ce("click",r),t(ie=>({...ie,ui:{...ie.ui,focusSession:{itemId:U,startTime:new Date().toISOString(),durationMinutes:Y,isActive:!0,itemType:X}}}))},S=()=>t(U=>({...U,ui:{...U.ui,focusSession:null}})),E=()=>l({preferences:{...e.user.preferences,soundEnabled:!e.user.preferences.soundEnabled}}),D=U=>{if(U==="deviceNotificationsEnabled"&&!e.user.preferences.deviceNotificationsEnabled){F();return}l({preferences:{...e.user.preferences,[U]:!e.user.preferences[U]}}),Ce("click",r)},k=U=>{l({preferences:{...e.user.preferences,dayStartHour:U}}),x(`Day Start set to ${U}:00`,"info")},F=async()=>{const U=await GS();return l({preferences:{...e.user.preferences,deviceNotificationsEnabled:U}}),x(U?"Notifications Enabled":"Permission Denied",U?"success":"error"),U},$=()=>{localStorage.clear(),Ce("delete",r),window.location.reload()},M=(U,Y,X)=>l({name:U,title:Y,hasOnboarded:!0,stats:{...e.user.stats,[X]:e.user.stats[X]+2}}),J=U=>{let Y=[...e.user.inventory];if(U.type==="custom"||U.type==="redemption"||!U.isInfinite){const ie=Y.indexOf(U.id);ie>-1&&Y.splice(ie,1)}U.id==="item_potion_xp"?(l({currentXP:e.user.currentXP+500,inventory:Y}),Ce("level-up",r),x("Potion Consumed: +500 XP","success")):(l({inventory:Y}),x(`${U.title} Used`,"info"))},H=U=>{let Y=[...e.user.equippedItems];if(Y.includes(U))Y=Y.filter(X=>X!==U),x("Artifact Unequipped","info");else{if(Y.length>=3){x("Max 3 Artifacts","error");return}Y.push(U),x("Artifact Equipped","success")}l({equippedItems:Y}),Ce("click",r)},z=U=>{e.badgesRegistry.some(Y=>Y.id===U.id)||t(Y=>({...Y,badgesRegistry:[...Y.badgesRegistry,U]}))},R=U=>{e.user.badges.includes(U)||(l({badges:[...e.user.badges,U]}),x("New Badge!","level-up"),Ce("level-up",r))},C=U=>{e.user.unlockedThemes.some(Y=>Y.id===U.id)||l({unlockedThemes:[...e.user.unlockedThemes,U]})},A=U=>{e.user.preferences.theme===U&&P("standard"),l({unlockedThemes:e.user.unlockedThemes.filter(Y=>Y.id!==U)}),x("Theme Deleted","info")},P=U=>{l({preferences:{...e.user.preferences,theme:U}}),Ce("click",r)},L=U=>{try{const Y=JSON.parse(U);if(!Y.user)throw new Error;t(Y),x("System Restored","success"),Ce("level-up",r)}catch{x("Import Failed","error")}},O=()=>JSON.stringify(e,null,2),j=()=>{const{newUser:U,toastMessage:Y,toastType:X,newBadge:ie}=x1(e.user,e.ui.debugDate);let pe=e.badgesRegistry;ie&&(pe=[...e.badgesRegistry,ie],U.badges.includes(ie.id)||(U.badges.push(ie.id),U.badgeTiers[ie.id]="gold",U.badgeHistory[ie.id]||(U.badgeHistory[ie.id]={}),U.badgeHistory[ie.id].gold=new Date().toISOString())),t(B=>({...B,user:U,badgesRegistry:pe})),x(Y,X),Ce("level-up",r)},q=U=>t(Y=>({...Y,ui:{...Y.ui,debugDate:U}})),le=U=>{const Y=URL.createObjectURL(U);t(X=>({...X,ui:{...X.ui,customAudio:{name:U.name,url:Y}}})),x(`Audio Loaded: ${U.name}`,"success")};return o.jsx(dN.Provider,{value:{state:e,isDataLoaded:!i,dispatch:{updateUser:l,setView:c,setModal:h,addToast:x,removeToast:b,resetSystem:$,toggleSound:E,togglePreference:D,useItem:J,addBadge:z,awardBadge:R,addTheme:C,deleteTheme:A,setTheme:P,importData:L,exportData:O,triggerDailyReset:j,setDebugDate:q,startFocusSession:T,endFocusSession:S,completeOnboarding:M,setHabitsViewMode:d,setTasksViewMode:p,toggleEquip:H,enableNotifications:F,setCustomAudio:le,setDayStartHour:k}},children:n})},Ve=()=>{const n=K.useContext(dN);if(!n)throw new Error("useLifeOS must be used within a LifeOSProvider");return n};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fN=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o4=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a4=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G_=n=>{const e=a4(n);return e.charAt(0).toUpperCase()+e.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var l4={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c4=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u4=K.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:r="",children:l,iconNode:c,...d},p)=>K.createElement("svg",{ref:p,...l4,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:fN("lucide",r),...!l&&!c4(d)&&{"aria-hidden":"true"},...d},[...c.map(([h,x])=>K.createElement(h,x)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=(n,e)=>{const t=K.forwardRef(({className:i,...r},l)=>K.createElement(u4,{ref:l,iconNode:e,className:fN(`lucide-${o4(G_(n))}`,`lucide-${n}`,i),...r}));return t.displayName=G_(n),t};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d4=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Lt=be("activity",d4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f4=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Tu=be("archive",f4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h4=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],hN=be("arrow-left",h4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p4=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],po=be("award",p4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m4=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],ur=be("bell",m4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g4=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],hi=be("book-open",g4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x4=[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]],y4=be("box",x4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v4=[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]],tn=be("brain",v4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b4=[["path",{d:"M16 19h6",key:"xwg31i"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M19 16v6",key:"tddt3s"}],["path",{d:"M21 12.598V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8.5",key:"1glfrc"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 2v4",key:"1cmpym"}]],Gh=be("calendar-plus",b4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _4=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Wn=be("calendar",_4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T4=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],pN=be("chart-column",T4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S4=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],gt=be("check",S4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w4=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Xn=be("chevron-down",w4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],mN=be("chevron-left",E4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N4=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Bt=be("chevron-right",N4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C4=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Xi=be("chevron-up",C4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],A4=be("circle-alert",k4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Os=be("circle-check-big",I4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],j4=be("circle-check",R4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],M4=be("circle-x",D4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],L4=be("circle",P4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],ln=be("clock",O4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U4=[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M16 14v6",key:"1j4efv"}],["path",{d:"M8 14v6",key:"17c4r9"}],["path",{d:"M12 16v6",key:"c8a4gj"}]],B_=be("cloud-rain",U4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V4=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],z4=be("code",V4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H4=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],gN=be("coffee",H4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],pi=be("coins",F4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G4=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],mi=be("copy",G4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B4=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],Bh=be("crown",B4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q4=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]],ua=be("crosshair",q4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],qh=be("database",$4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y4=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],dh=be("download",Y4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J4=[["path",{d:"M17.596 12.768a2 2 0 1 0 2.829-2.829l-1.768-1.767a2 2 0 0 0 2.828-2.829l-2.828-2.828a2 2 0 0 0-2.829 2.828l-1.767-1.768a2 2 0 1 0-2.829 2.829z",key:"9m4mmf"}],["path",{d:"m2.5 21.5 1.4-1.4",key:"17g3f0"}],["path",{d:"m20.1 3.9 1.4-1.4",key:"1qn309"}],["path",{d:"M5.343 21.485a2 2 0 1 0 2.829-2.828l1.767 1.768a2 2 0 1 0 2.829-2.829l-6.364-6.364a2 2 0 1 0-2.829 2.829l1.768 1.767a2 2 0 0 0-2.828 2.829z",key:"1t2c92"}],["path",{d:"m9.6 14.4 4.8-4.8",key:"6umqxw"}]],Qn=be("dumbbell",J4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K4=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],zf=be("eye",K4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X4=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Ol=be("file-text",X4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W4=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],Mi=be("flame",W4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q4=[["path",{d:"M14 2v6a2 2 0 0 0 .245.96l5.51 10.08A2 2 0 0 1 18 22H6a2 2 0 0 1-1.755-2.96l5.51-10.08A2 2 0 0 0 10 8V2",key:"18mbvz"}],["path",{d:"M6.453 15h11.094",key:"3shlmq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}]],xN=be("flask-conical",Q4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z4=[["path",{d:"M2 9V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H20a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-1",key:"fm4g5t"}],["path",{d:"M2 13h10",key:"pgb2dq"}],["path",{d:"m9 16 3-3-3-3",key:"6m91ic"}]],mx=be("folder-input",Z4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],yN=be("folder-plus",eP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tP=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],vN=be("folder",tP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nP=[["line",{x1:"6",x2:"10",y1:"12",y2:"12",key:"161bw2"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"15",x2:"15.01",y1:"13",y2:"13",key:"dqpgro"}],["line",{x1:"18",x2:"18.01",y1:"11",y2:"11",key:"meh2c"}],["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}]],iP=be("gamepad",nP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sP=[["path",{d:"m14 13-8.381 8.38a1 1 0 0 1-3.001-3l8.384-8.381",key:"pgg06f"}],["path",{d:"m16 16 6-6",key:"vzrcl6"}],["path",{d:"m21.5 10.5-8-8",key:"a17d9x"}],["path",{d:"m8 8 6-6",key:"18bi4p"}],["path",{d:"m8.5 7.5 8 8",key:"1oyaui"}]],bN=be("gavel",sP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rP=[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]],_N=be("gift",rP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],aP=be("globe",oP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lP=[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]],cP=be("hash",lP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uP=[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]],gi=be("heart",uP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=[["path",{d:"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z",key:"yt0hxn"}]],fP=be("hexagon",dP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hP=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],pP=be("history",hP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],gP=be("info",mP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=[["path",{d:"M10 18v-7",key:"wt116b"}],["path",{d:"M11.12 2.198a2 2 0 0 1 1.76.006l7.866 3.847c.476.233.31.949-.22.949H3.474c-.53 0-.695-.716-.22-.949z",key:"1m329m"}],["path",{d:"M14 18v-7",key:"vav6t3"}],["path",{d:"M18 18v-7",key:"aexdmj"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M6 18v-7",key:"1ivflk"}]],yP=be("landmark",xP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vP=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],bP=be("layout-grid",vP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],TP=be("layout-list",_P);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["rect",{x:"3",y:"4",width:"6",height:"6",rx:"1",key:"cif1o7"}]],q_=be("list-todo",SP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],EP=be("list",wP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],CP=be("loader-circle",NP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kP=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],da=be("lock",kP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],IP=be("log-in",AP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],TN=be("log-out",RP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jP=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Su=be("maximize-2",jP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=[["path",{d:"M5 12h14",key:"1ays0h"}]],fh=be("minus",DP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],gx=be("moon",MP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],hh=be("music",PP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],OP=be("package",LP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UP=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],kn=be("palette",UP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],zP=be("pause",VP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],Tg=be("pen",HP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],xx=be("pencil",FP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]],BP=be("pin",GP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],$h=be("play",qP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],nn=be("plus",$P);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YP=[["path",{d:"M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"14sxne"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16",key:"1hlbsb"}],["path",{d:"M16 16h5v5",key:"ccwih5"}]],JP=be("refresh-ccw",YP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KP=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],SN=be("refresh-cw",KP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XP=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],wN=be("repeat",XP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],yx=be("rotate-ccw",WP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ZP=be("save",QP);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=[["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"m19 8 3 8a5 5 0 0 1-6 0zV7",key:"zcdpyk"}],["path",{d:"M3 7h1a17 17 0 0 0 8-2 17 17 0 0 0 8 2h1",key:"1yorad"}],["path",{d:"m5 8 3 8a5 5 0 0 1-6 0zV7",key:"eua70x"}],["path",{d:"M7 21h10",key:"1b0cd5"}]],Yh=be("scale",e3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=[["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],n3=be("scroll",t3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=[["path",{d:"M15 12h-5",key:"r7krc0"}],["path",{d:"M15 8h-5",key:"1khuty"}],["path",{d:"M19 17V5a2 2 0 0 0-2-2H4",key:"zz82l3"}],["path",{d:"M8 21h12a2 2 0 0 0 2-2v-1a1 1 0 0 0-1-1H11a1 1 0 0 0-1 1v1a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v2a1 1 0 0 0 1 1h3",key:"1ph1d7"}]],fa=be("scroll-text",i3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],r3=be("settings-2",s3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],a3=be("settings",o3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],ph=be("shield-alert",l3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],mh=be("shield-check",c3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Zi=be("shield",u3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=[["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}],["path",{d:"M3.103 6.034h17.794",key:"awc11p"}],["path",{d:"M3.4 5.467a2 2 0 0 0-.4 1.2V20a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6.667a2 2 0 0 0-.4-1.2l-2-2.667A2 2 0 0 0 17 2H7a2 2 0 0 0-1.6.8z",key:"o988cm"}]],vx=be("shopping-bag",d3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],EN=be("shopping-cart",f3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],NN=be("skull",h3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=[["path",{d:"m10 20-1.25-2.5L6 18",key:"18frcb"}],["path",{d:"M10 4 8.75 6.5 6 6",key:"7mghy3"}],["path",{d:"m14 20 1.25-2.5L18 18",key:"1chtki"}],["path",{d:"m14 4 1.25 2.5L18 6",key:"1b4wsy"}],["path",{d:"m17 21-3-6h-4",key:"15hhxa"}],["path",{d:"m17 3-3 6 1.5 3",key:"11697g"}],["path",{d:"M2 12h6.5L10 9",key:"kv9z4n"}],["path",{d:"m20 10-1.5 2 1.5 2",key:"1swlpi"}],["path",{d:"M22 12h-6.5L14 15",key:"1mxi28"}],["path",{d:"m4 10 1.5 2L4 14",key:"k9enpj"}],["path",{d:"m7 21 3-6-1.5-3",key:"j8hb9u"}],["path",{d:"m7 3 3 6h4",key:"1otusx"}]],$_=be("snowflake",p3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],gh=be("sparkles",m3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ns=be("square-check-big",g3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x3=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],y3=be("square-pen",x3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v3=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],b3=be("square",v3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _3=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],xh=be("star",_3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T3=[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]],Y_=be("sticky-note",T3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S3=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],is=be("target",S3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w3=[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]],zn=be("terminal",w3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E3=[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]],Jh=be("text-align-start",E3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],C3=be("timer",N3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k3=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Nn=be("trash-2",k3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A3=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],CN=be("trash",A3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Kh=be("trending-up",I3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R3=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],hr=be("triangle-alert",R3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j3=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Xh=be("trophy",j3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D3=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],yh=be("upload",D3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],bx=be("user",M3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],mo=be("users",P3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]],O3=be("utensils",L3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],V3=be("volume-2",U3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z3=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],J_=be("volume-x",z3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H3=[["path",{d:"M2 6c.6.5 1.2 1 2.5 1C7 7 7 5 9.5 5c2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"knzxuh"}],["path",{d:"M2 12c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"2jd2cc"}],["path",{d:"M2 18c.6.5 1.2 1 2.5 1 2.5 0 2.5-2 5-2 2.6 0 2.4 2 5 2 2.5 0 2.5-2 5-2 1.3 0 1.9.5 2.5 1",key:"rd2r6e"}]],K_=be("waves",H3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F3=[["path",{d:"M2 22 16 8",key:"60hf96"}],["path",{d:"M3.47 12.53 5 11l1.53 1.53a3.5 3.5 0 0 1 0 4.94L5 19l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1rdhi6"}],["path",{d:"M7.47 8.53 9 7l1.53 1.53a3.5 3.5 0 0 1 0 4.94L9 15l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"1sdzmb"}],["path",{d:"M11.47 4.53 13 3l1.53 1.53a3.5 3.5 0 0 1 0 4.94L13 11l-1.53-1.53a3.5 3.5 0 0 1 0-4.94Z",key:"eoatbi"}],["path",{d:"M20 2h2v2a4 4 0 0 1-4 4h-2V6a4 4 0 0 1 4-4Z",key:"19rau1"}],["path",{d:"M11.47 17.47 13 19l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L5 19l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"tc8ph9"}],["path",{d:"M15.47 13.47 17 15l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L9 15l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"2m8kc5"}],["path",{d:"M19.47 9.47 21 11l-1.53 1.53a3.5 3.5 0 0 1-4.94 0L13 11l1.53-1.53a3.5 3.5 0 0 1 4.94 0Z",key:"vex3ng"}]],G3=be("wheat",F3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],et=be("x",B3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q3=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],dt=be("zap",q3),$3=()=>{const{state:n,dispatch:e}=Ve(),{currentView:t,habitsViewMode:i,tasksViewMode:r}=n.ui,{user:l}=n,c=l.preferences.showCampaignUI,[d,p]=K.useState(null);K.useEffect(()=>{const A=M0(oo,P=>p(P));return()=>A()},[]);const[h,x]=K.useState("profile"),[b,T]=K.useState("raids"),S=()=>{if(t===h){let A="profile";h==="profile"?A="skills":h==="skills"?A="shop":A="profile",x(A),e.setView(A)}else e.setView(h)},E=()=>{if(!c){t!=="raids"&&e.setView("raids");return}if(t===b){let A="raids";b==="raids"?A="campaign":A="raids",T(A),e.setView(A)}else e.setView(b)},D=()=>{if(t==="tasks"){const A=r==="missions"?"codex":"missions";e.setTasksViewMode(A)}else e.setView("tasks")},k=()=>{let A="mission";t==="habits"?A="protocol":(t==="raids"||t==="campaign")&&(A="operation"),e.setModal("addTask",{defaultType:A})},F=()=>{if(t==="habits"){const A=i==="list"?"calendar":"list";e.setHabitsViewMode(A)}else e.setView("habits")},$=()=>{e.setModal("login")},M=A=>t===A,J=M("profile")||M("shop")||M("skills"),H=M("raids")||M("campaign"),z=M("tasks"),R=M("habits"),C=!c&&b==="campaign"?"raids":b;return o.jsxs("nav",{className:"h-24 pb-6 pt-2 bg-life-black/80 backdrop-blur-xl border-t border-zinc-800 flex items-center justify-around px-4 z-30 shadow-[0_-10px_40px_rgba(0,0,0,0.5)] relative",children:[o.jsxs("button",{onClick:S,className:`flex flex-col items-center justify-center w-16 h-16 rounded-xl transition-all duration-300 relative group ${J?"text-life-gold bg-life-gold/10 scale-105":"text-life-muted hover:text-life-silver"}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`transition-all duration-300 transform ${h==="profile"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(bx,{size:24})}),o.jsx("div",{className:`transition-all duration-300 transform ${h==="skills"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(hi,{size:24})}),o.jsx("div",{className:`transition-all duration-300 transform ${h==="shop"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(vx,{size:24})})]}),o.jsx("span",{className:"text-[10px] mt-1 font-bold uppercase tracking-wider",children:h}),J&&o.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-life-gold rounded-full"})]}),o.jsxs("button",{onClick:D,className:`flex flex-col items-center justify-center w-16 h-16 rounded-xl transition-all duration-300 relative ${z?r==="codex"?"text-red-500 bg-red-950/20 scale-105":"text-life-easy bg-life-easy/10 scale-105":"text-life-muted hover:text-life-silver"}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`transition-all duration-300 transform ${r==="missions"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(ns,{size:24})}),o.jsx("div",{className:`transition-all duration-300 transform ${r==="codex"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(Yh,{size:24})})]}),o.jsx("span",{className:"text-[10px] mt-1 font-bold uppercase tracking-wider",children:r==="codex"?"Codex":"Missions"}),z&&o.jsx("div",{className:`absolute -bottom-1 w-1 h-1 rounded-full ${r==="codex"?"bg-red-500":"bg-life-easy"}`})]}),o.jsxs("div",{className:"relative -mt-12 group z-20",children:[o.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-16 h-16 bg-life-crimson/40 blur-[30px] rounded-full pointer-events-none group-hover:bg-life-crimson/60 transition-colors duration-500 animate-pulse-slow"}),o.jsx("button",{onClick:k,className:"relative w-16 h-16 bg-gradient-to-br from-life-crimson to-red-700 rounded-full shadow-[0_8px_30px_rgba(220,38,38,0.4)] flex items-center justify-center text-white hover:scale-110 active:scale-95 transition-all duration-300 border-4 border-life-black ring-2 ring-life-crimson/20",children:o.jsx(nn,{size:32,strokeWidth:3,className:"group-active:rotate-90 transition-transform duration-300 drop-shadow-md"})})]}),o.jsxs("button",{onClick:F,className:`flex flex-col items-center justify-center w-16 h-16 rounded-xl transition-all duration-300 relative ${R?"text-life-normal bg-life-normal/10 scale-105":"text-life-muted hover:text-life-silver"}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`transition-all duration-300 transform ${i==="list"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(is,{size:24})}),o.jsx("div",{className:`transition-all duration-300 transform ${i==="calendar"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(Wn,{size:24})})]}),o.jsx("span",{className:"text-[10px] mt-1 font-bold uppercase tracking-wider",children:i==="calendar"?"Planner":"Habits"}),R&&o.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-life-normal rounded-full"})]}),o.jsxs("button",{onClick:E,className:`flex flex-col items-center justify-center w-16 h-16 rounded-xl transition-all duration-300 relative ${H?"text-life-hard bg-life-hard/10 scale-105":"text-life-muted hover:text-life-silver"}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`transition-all duration-300 transform ${C==="raids"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(dt,{size:24})}),c&&o.jsx("div",{className:`transition-all duration-300 transform ${C==="campaign"?"scale-100 opacity-100":"scale-0 opacity-0 absolute top-0"}`,children:o.jsx(TP,{size:24})})]}),o.jsx("span",{className:"text-[10px] mt-1 font-bold uppercase tracking-wider",children:C}),H&&o.jsx("div",{className:"absolute -bottom-1 w-1 h-1 bg-life-hard rounded-full"})]}),!d&&o.jsx("button",{onClick:$,className:"absolute top-[-40px] right-4 bg-life-black/80 backdrop-blur border border-life-gold/30 text-life-gold p-2 rounded-full shadow-lg animate-bounce",title:"Secure Link",children:o.jsx(IP,{size:16})})]})},i0=n=>Math.floor(100*Math.pow(n,1.5)),kN=n=>n>=100?"Grandmaster":n>=50?"Master":n>=25?"Expert":n>=10?"Adept":"Novice",Y3=n=>{const e=new Date(n),i=Math.abs(new Date().getTime()-e.getTime());return Math.ceil(i/(1e3*60*60*24))>30},J3=[{id:"sk_01",title:"Coding",description:"Building the matrix.",relatedStats:[te.INT],level:1,currentXP:0,targetXP:100,rank:"Novice",lastPracticed:new Date().toISOString(),isRusty:!1,createdAt:new Date().toISOString()}],AN=K.createContext(void 0),K3=n=>({...n,targetXP:n.targetXP||i0(n.level||1),rank:n.rank||kN(n.level||1),isRusty:n.isRusty??!1,lastPracticed:n.lastPracticed||new Date().toISOString()}),X3=n=>({skills:(Array.isArray(n)?n:n.skills||[]).map(K3)}),W3=({children:n})=>{const{state:e,dispatch:t}=Ve(),i=e.user.preferences.soundEnabled,[r,l]=Ll("LIFE_OS_SKILLS_DATA",{skills:J3},"skills_data",X3),{skills:c}=r,[d,p]=K.useState(null);K.useEffect(()=>{(()=>{l(D=>({...D,skills:D.skills.map(k=>({...k,isRusty:Y3(k.lastPracticed)}))}))})()},[]);const h=E=>{E&&Ce("click",i),p(E)},x=(E,D,k="")=>{const F={id:`sk_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,title:E,description:k,relatedStats:D,level:1,currentXP:0,targetXP:i0(1),rank:"Novice",lastPracticed:new Date().toISOString(),isRusty:!1,createdAt:new Date().toISOString()};Ce("click",i),l($=>({...$,skills:[...$.skills,F]})),t.addToast(`Skill Acquired: ${E}`,"success")},b=(E,D)=>{l(k=>({...k,skills:k.skills.map(F=>{if(F.id!==E)return F;const $=F.isRusty;let M=F.currentXP+D,J=F.level,H=F.targetXP,z=!1;for(;M>=H;)M-=H,J++,H=i0(J),z=!0;const R=kN(J);return z&&(Ce("level-up",i),t.addToast(`${F.title} reached Level ${J}!`,"level-up")),$&&t.addToast(`${F.title} is no longer Rusty!`,"success"),{...F,level:J,currentXP:M,targetXP:H,rank:R,lastPracticed:new Date().toISOString(),isRusty:!1}})}))},T=E=>{Ce("delete",i),l(D=>({...D,skills:D.skills.filter(k=>k.id!==E)})),d===E&&p(null),t.addToast("Skill Deleted","info")},S=E=>{l({skills:E}),t.addToast("Skills Restored","success")};return o.jsx(AN.Provider,{value:{skillState:{skills:c,activeSkillId:d},skillDispatch:{addSkill:x,addSkillXP:b,deleteSkill:T,setActiveSkill:h,restoreData:S}},children:n})},sn=()=>{const n=K.useContext(AN);if(n===void 0)throw new Error("useSkills must be used within a SkillProvider");return n},Q3=()=>{const{state:n,dispatch:e}=Ve(),{user:t}=n,{skillState:i}=sn(),r=(i==null?void 0:i.skills)||[];let l=t.title;const c=t.preferences.useSkillAsTitle&&t.preferences.linkedSkillId?r.find(J=>J.id===t.preferences.linkedSkillId):null;c?l=`${c.rank} ${c.title}`:l=t.title;const d=Math.min(100,t.currentXP/t.targetXP*100),p=Math.min(100,t.dailyXP/t.dailyTarget*100),h=p>=100,x=18,b=3,T=x-b*2,S=T*2*Math.PI,E=S-p/100*S,[D,k]=K.useState(0);K.useEffect(()=>{if(D>0){const J=setTimeout(()=>k(0),1e3);return()=>clearTimeout(J)}},[D]);const F=()=>{k(J=>{const H=J+1;return H>=5?(Ce("level-up",!0),e.setModal("devConsole"),0):H}),n.ui.currentView!=="profile"&&e.setView("profile")},$=()=>{Ce("click",!0),e.setModal("honorBreakdown")},M=async()=>{try{await gR(oo)}catch(J){console.error("Logout Error:",J)}};return o.jsxs("header",{className:"h-16 px-4 border-b border-zinc-800 flex items-center justify-between bg-life-black/60 backdrop-blur-xl z-20 shadow-lg transition-all duration-300 select-none sticky top-0",children:[o.jsxs("div",{onClick:F,className:"flex items-center gap-3 cursor-pointer active:opacity-80 transition-opacity",children:[o.jsxs("div",{className:"w-10 h-10 rounded-full bg-life-muted/20 border border-life-silver flex items-center justify-center relative overflow-hidden ring-1 ring-life-muted/50 group",children:[c&&c.icon?o.jsx("span",{className:"text-xl",children:c.icon}):o.jsx(bx,{size:20,className:"text-life-silver group-hover:scale-110 transition-transform"}),o.jsxs("div",{className:"absolute bottom-0 right-0 bg-life-gold text-life-black text-[9px] font-black px-1.5 py-0.5 rounded-tl-md shadow-sm z-10",children:["L",t.level]}),D>0&&o.jsx("div",{className:"absolute inset-0 bg-life-crimson/20 animate-pulse"})]}),o.jsxs("div",{className:"flex flex-col justify-center",children:[o.jsx("h1",{className:"text-sm font-bold leading-none tracking-wide text-life-text/90 mb-1.5 truncate max-w-[150px] sm:max-w-none",children:l.toUpperCase()}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"font-mono text-[9px] text-life-gold/80",children:[t.currentXP,"/",t.targetXP," XP"]}),o.jsx("div",{className:"w-20 h-1.5 bg-gray-800 rounded-full overflow-hidden border border-gray-700/50",children:o.jsx("div",{className:"h-full bg-gradient-to-r from-life-gold to-yellow-200 transition-all duration-700 ease-out shadow-[0_0_10px_rgba(251,191,36,0.5)]",style:{width:`${d}%`}})})]})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("button",{onClick:()=>e.setModal("devConsole"),className:"p-2 rounded-full text-life-muted hover:text-life-gold hover:bg-life-gold/10 transition-all active:scale-95",title:"System Settings",children:o.jsx(a3,{size:20})}),o.jsx("button",{onClick:M,className:"p-2 rounded-full text-life-muted hover:text-life-hard hover:bg-life-hard/10 transition-all active:scale-95",title:"System Logout",children:o.jsx(TN,{size:20})}),o.jsxs("div",{className:"hidden sm:flex flex-col items-end gap-0.5 mr-1",children:[o.jsxs("div",{className:"flex items-center text-life-gold font-mono text-xs",children:[o.jsx("span",{className:"mr-1.5 text-xs",children:""})," ",t.gold]}),o.jsxs("div",{onClick:$,className:"flex items-center text-indigo-400 font-mono text-xs cursor-pointer hover:text-indigo-300 hover:scale-105 transition-all",children:[o.jsx(po,{size:10,className:"mr-1 fill-current opacity-80"})," ",t.honor,"%"]})]}),o.jsxs("div",{className:"sm:hidden flex items-center gap-2 mr-1",children:[o.jsxs("div",{className:"flex flex-col items-center justify-center w-8 h-8 rounded bg-life-gold/10 border border-life-gold/20",children:[o.jsx("span",{className:"text-[8px]",children:""}),o.jsx("span",{className:"text-[9px] font-bold text-life-gold",children:t.gold})]}),o.jsxs("div",{onClick:$,className:"flex flex-col items-center justify-center w-8 h-8 rounded bg-indigo-500/10 border border-indigo-500/20 cursor-pointer active:scale-95 transition-transform",children:[o.jsx(po,{size:8,className:"text-indigo-400 mb-0.5"}),o.jsxs("span",{className:"text-[9px] font-bold text-indigo-400",children:[t.honor,"%"]})]})]}),o.jsxs("div",{onClick:()=>e.setModal("streak"),className:"relative w-12 h-12 flex items-center justify-center group cursor-pointer hover:scale-105 transition-transform",children:[o.jsxs("svg",{height:x*2,width:x*2,className:"transform -rotate-90 absolute z-0",children:[o.jsx("circle",{stroke:"#333",strokeWidth:b,fill:"transparent",r:T,cx:x,cy:x,opacity:.3}),o.jsx("circle",{stroke:h?"#10b981":"#fbbf24",strokeWidth:b,strokeDasharray:S+" "+S,style:{strokeDashoffset:E,transition:"stroke-dashoffset 0.5s ease-in-out"},strokeLinecap:"round",fill:"transparent",r:T,cx:x,cy:x,className:h?"drop-shadow-[0_0_5px_rgba(16,185,129,0.5)]":""})]}),o.jsxs("div",{className:`
                w-8 h-8 rounded-full flex flex-col items-center justify-center z-10 transition-colors
                ${h?"bg-life-easy/10":"bg-life-black"}
             `,children:[o.jsx(Mi,{size:12,className:`
                    absolute -top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity 
                    ${h?"text-life-easy fill-life-easy/50":"text-life-crimson fill-life-crimson/50"}
                `}),o.jsx("span",{className:"text-[6px] text-life-muted uppercase leading-none mt-0.5 tracking-tighter",children:"Day"}),o.jsx("span",{className:`text-sm font-black leading-none ${h?"text-life-easy":"text-life-crimson"}`,children:t.streak})]})]})]})]})},IN=n=>{const e=/\[?w(\d{1,2})d(\d)\]?/i,t=n.match(e);if(t){const i=parseInt(t[1],10),r=parseInt(t[2],10);return{cleanedTitle:n.replace(e,"").replace(/\s+/," ").trim(),timeCode:{week:i,day:r}}}return{cleanedTitle:n,timeCode:null}},Z3=n=>{const e=/\b(\d{10})\b/,t=n.match(e);if(t){const i=t[1],r=parseInt(i.substring(0,2),10),l=parseInt(i.substring(2,4),10)-1,c=parseInt(i.substring(4,6),10),d=parseInt(i.substring(6,8),10),p=parseInt(i.substring(8,10),10),h=2e3+r,x=new Date(h,l,c,d,p);if(!isNaN(x.getTime()))return{cleanedTitle:n.replace(e,"").replace(/\s+/," ").trim(),dateIso:x.toISOString()}}return{cleanedTitle:n,dateIso:null}},eL=(n,e,t)=>{const i=new Date(n),r=(e-1)*7+(t-1),l=new Date(i);return l.setDate(l.getDate()+r),l.toISOString()},tL=(n,e)=>{if(!n||!e)return null;const t=new Date(n),i=new Date(e);t.setHours(0,0,0,0),i.setHours(0,0,0,0);const r=i.getTime()-t.getTime(),l=Math.floor(r/(1e3*60*60*24));if(l<0)return null;const c=Math.floor(l/7)+1,d=l%7+1;return`W${c}D${d}`},nL=()=>{try{const n=localStorage.getItem("LIFE_OS_CAMPAIGN_DATA_V2");if(n){const e=JSON.parse(n);if(e.isActive&&e.startDate)return e}}catch{return null}return null},Cl=(n,e,t,i,r)=>{const l=Ok[n];let c=1,d=1;return e===pn.HARD?(c+=.2,d+=.5):e===pn.EASY&&(c-=.2),{xp:Math.floor(l.xp*c),gold:Math.floor(l.gold*d)}},iL=[{id:"t_01",title:"Initialize LifeOS Protocol",description:"System calibration complete.",difficulty:Ge.HARD,stat:te.INT,isCompleted:!1,isTimed:!1,deadline:"2024-12-31",subtasks:[{id:"st_1",title:"Check Audio Systems",isCompleted:!0},{id:"st_2",title:"Verify Data Persistence",isCompleted:!1}],energyLevel:"high"}],RN=[{id:"cat_work",title:" Work Operations",isCollapsed:!1},{id:"cat_personal",title:" Personal Logs",isCollapsed:!1}],jN=K.createContext(void 0),sL=n=>{let e=n.reminders||[];return!n.reminders&&n.reminderMinutes&&n.reminderMinutes>0&&(e=[{id:`mig_${Date.now()}_${Math.random()}`,minutesBefore:n.reminderMinutes,isSent:!!n.isReminderSent}]),{difficulty:Ge.NORMAL,stat:te.STR,subtasks:[],energyLevel:"medium",isTimed:!1,isArchived:!1,isCompleted:!1,isCampaign:!1,reminders:e,...n}},rL=n=>({tasks:(n.tasks||[]).map(sL),categories:n.categories||RN,laws:n.laws||[]}),oL=({children:n})=>{const{state:e,dispatch:t}=Ve(),{skillDispatch:i,skillState:r}=sn(),l=e.user.preferences.soundEnabled,[c,d]=Ll("LIFE_OS_TASKS_COMBINED",{tasks:iL,categories:RN,laws:[]},"tasks_data",rL),{tasks:p,categories:h,laws:x}=c,b=O=>{let{cleanedTitle:j,timeCode:q}=IN(O.title);const le=Z3(j);let U=O.deadline,Y=O.scheduledTime,X=O.isCampaign||!1,ie=O.isCalendarEvent||!1;if(q){X=!0;const B=nL();B?(U=eL(B.startDate,q.week,q.day),t.addToast(`G12: Scheduled for W${q.week} D${q.day}`,"info")):t.addToast(`No active G12 campaign found for [W${q.week}D${q.day}]`,"error")}le.dateIso&&(j=le.cleanedTitle,Y=le.dateIso,U=le.dateIso,ie=!0,t.addToast("C30: Scheduled via Code","info"));const pe={...O,title:j,deadline:U,scheduledTime:Y,isCampaign:X,isCalendarEvent:ie,id:`t_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,isCompleted:!1,isArchived:!1};Ce("click",l),d(B=>({...B,tasks:[pe,...B.tasks]})),t.setModal("none")},T=(O,j)=>{d(q=>({...q,tasks:q.tasks.map(le=>le.id===O?{...le,...j}:le)})),Ce("click",l)},S=O=>{var U;const j=p.find(Y=>Y.id===O);if(!j)return;const q=!j.isCompleted;let le=null;if(q){let Y=Cl(j.difficulty,e.user.currentMode);j.isCampaign&&(Y.xp=Math.ceil(Y.xp*1.1));const X=Math.random(),ie=j.difficulty===Ge.HARD&&X>.85||j.difficulty===Ge.NORMAL&&X>.9;let pe=null;ie?(Y.xp*=2,Y.gold*=2,le="crit",pe={title:j.title,xp:Y.xp,gold:Y.gold,multiplier:2,message:"Luck favors the bold."}):le="success";const B=e.user.metrics,ee={...B,totalTasksCompleted:B.totalTasksCompleted+1,tasksByDifficulty:{...B.tasksByDifficulty,[j.difficulty]:(B.tasksByDifficulty[j.difficulty]||0)+1},totalGoldEarned:B.totalGoldEarned+Y.gold,totalXPEarned:B.totalXPEarned+Y.xp},he=j.difficulty===Ge.HARD?2:j.difficulty===Ge.NORMAL?1:.5,Q=r.skills.find(Ae=>Ae.id===j.skillId),ae=(U=Q==null?void 0:Q.relatedStats)!=null&&U.length?Q.relatedStats:[j.stat],ye=he/ae.length,ue={...e.user.stats};ae.forEach(Ae=>{ue[Ae]=(ue[Ae]||0)+ye}),t.updateUser({currentXP:e.user.currentXP+Y.xp,dailyXP:e.user.dailyXP+Y.xp,gold:e.user.gold+Y.gold,stats:ue,metrics:ee});let Te=`+${Y.xp} XP  +${Y.gold} G`;if(j.skillId){const Ae=Math.ceil(Y.xp*.5);i.addSkillXP(j.skillId,Ae);const Be=r.skills.find(jt=>jt.id===j.skillId);Be&&(Te+=`  +${Ae} ${Be.title}`)}pe?setTimeout(()=>t.setModal("loot",pe),200):t.addToast(`Mission Complete: ${j.title} | ${Te}`,"success")}else{const Y=Cl(j.difficulty,e.user.currentMode);j.isCampaign&&(Y.xp=Math.ceil(Y.xp*1.1));const X=e.user.metrics,ie={...X,totalTasksCompleted:Math.max(0,X.totalTasksCompleted-1),tasksByDifficulty:{...X.tasksByDifficulty,[j.difficulty]:Math.max(0,(X.tasksByDifficulty[j.difficulty]||0)-1)},totalGoldEarned:Math.max(0,X.totalGoldEarned-Y.gold),totalXPEarned:Math.max(0,X.totalXPEarned-Y.xp)},pe=j.difficulty===Ge.HARD?2:j.difficulty===Ge.NORMAL?1:.5;t.updateUser({currentXP:Math.max(0,e.user.currentXP-Y.xp),dailyXP:Math.max(0,e.user.dailyXP-Y.xp),gold:Math.max(0,e.user.gold-Y.gold),stats:{...e.user.stats,[j.stat]:Math.max(0,e.user.stats[j.stat]-pe)},metrics:ie})}le&&l&&Ce(le,l),d(Y=>({...Y,tasks:Y.tasks.map(X=>X.id===O?{...X,isCompleted:q}:X)}))},E=(O,j)=>{d(q=>({...q,tasks:q.tasks.map(le=>{if(le.id!==O)return le;const U=le.subtasks.map(Y=>Y.id===j?{...Y,isCompleted:!Y.isCompleted}:Y);return{...le,subtasks:U}})})),Ce("click",l)},D=O=>{const j=p.find(q=>q.id===O);if(j){if(!j.isCompleted&&!j.isArchived){const q=Uk[j.difficulty],le=qS(j.difficulty),U=e.ui.debugDate?new Date(e.ui.debugDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],Y=e.user.honorDailyLog[U]!==void 0?e.user.honorDailyLog[U]:100,X=Math.max(0,Y-le),ie={...e.user.honorDailyLog,[U]:X},pe=du(ie,e.ui.debugDate);t.updateUser({currentXP:Math.max(0,e.user.currentXP-q.xp),gold:Math.max(0,e.user.gold-q.gold),stats:{...e.user.stats,[j.stat]:Math.max(0,e.user.stats[j.stat]-q.stat)},honorDailyLog:ie,honor:pe}),t.addToast(`Mission Failed: -${le}% Honor | -${q.xp} XP`,"error"),Ce("error",l)}else Ce("delete",l);d(q=>({...q,tasks:q.tasks.filter(le=>le.id!==O)}))}},k=O=>{const j={id:`cat_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,title:O,isCollapsed:!1};d(q=>({...q,categories:[...q.categories,j]})),Ce("click",l)},F=O=>{d(j=>({...j,categories:j.categories.filter(q=>q.id!==O),tasks:j.tasks.map(q=>q.categoryId===O?{...q,categoryId:void 0}:q)})),Ce("delete",l)},$=(O,j)=>{d(q=>({...q,categories:q.categories.map(le=>le.id===O?{...le,title:j}:le)}))},M=O=>{d(j=>({...j,categories:j.categories.map(q=>q.id===O?{...q,isCollapsed:!q.isCollapsed}:q)}))},J=(O,j)=>{d(q=>({...q,tasks:q.tasks.map(le=>le.id===O?{...le,categoryId:j}:le)})),Ce("click",l)},H=O=>{d(j=>({...j,tasks:j.tasks.map(q=>q.id===O?{...q,isArchived:!0}:q)})),t.addToast("Mission moved to Backlog","info"),Ce("click",l)},z=O=>{d(j=>({...j,tasks:j.tasks.map(q=>q.id===O?{...q,isArchived:!1}:q)})),t.addToast("Mission Restored","success"),Ce("click",l)},R=(O,j,q,le)=>{const U={id:`law_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,title:O,penaltyType:j,penaltyValue:q,statTarget:le,timesBroken:0};d(Y=>({...Y,laws:[...Y.laws,U]})),Ce("click",l),t.addToast("New Law Enacted","info")},C=(O,j)=>{d(q=>({...q,laws:q.laws.map(le=>le.id===O?{...le,...j}:le)})),Ce("click",l)},A=O=>{d(j=>({...j,laws:j.laws.filter(q=>q.id!==O)})),Ce("delete",l)},P=O=>{const j=x.find(q=>q.id===O);if(j){if(j.penaltyType==="gold")t.updateUser({gold:e.user.gold-j.penaltyValue}),t.addToast(`Law Broken: ${j.title} | -${j.penaltyValue} Gold`,"error");else if(j.penaltyType==="xp")t.updateUser({currentXP:e.user.currentXP-j.penaltyValue}),t.addToast(`Law Broken: ${j.title} | -${j.penaltyValue} XP`,"error");else if(j.penaltyType==="stat"&&j.statTarget)t.updateUser({stats:{...e.user.stats,[j.statTarget]:e.user.stats[j.statTarget]-j.penaltyValue}}),t.addToast(`Law Broken: ${j.title} | -${j.penaltyValue} ${j.statTarget}`,"error");else if(j.penaltyType==="honor"){const q=e.ui.debugDate?new Date(e.ui.debugDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],le=e.user.honorDailyLog[q]!==void 0?e.user.honorDailyLog[q]:100,U=Math.max(0,le-j.penaltyValue),Y={...e.user.honorDailyLog,[q]:U},X=du(Y,e.ui.debugDate);t.updateUser({honorDailyLog:Y,honor:X}),t.addToast(`Law Broken: ${j.title} | -${j.penaltyValue} Honor`,"error")}d(q=>({...q,laws:q.laws.map(le=>le.id===O?{...le,timesBroken:le.timesBroken+1}:le)})),Ce("error",l)}},L=(O,j,q)=>{d({tasks:O,categories:j,laws:q}),t.addToast("Tasks & Laws Restored","success")};return o.jsx(jN.Provider,{value:{taskState:c,taskDispatch:{addTask:b,updateTask:T,toggleTask:S,deleteTask:D,addCategory:k,deleteCategory:F,renameCategory:$,toggleCategory:M,moveTask:J,archiveTask:H,restoreTask:z,toggleSubtask:E,addLaw:R,deleteLaw:A,enforceLaw:P,updateLaw:C,restoreData:L}},children:n})},Zn=()=>{const n=K.useContext(jN);if(n===void 0)throw new Error("useTasks must be used within a TaskProvider");return n},aL=[{id:"h_1771593541489_o581bvlg5",title:"Clean room ",description:"",difficulty:Ge.NORMAL,stat:te.DIS,type:"specific_days",specificDays:[1,4,5,6],isTimed:!1,reminders:[],subtasks:[],dailyTarget:1,streak:0,status:"pending",history:[],checkpoint:0,bestStreak:0,createdAt:"2026-02-20T13:19:01.489Z",dailyProgress:0}],DN=[{id:"cat_morning",title:" Morning Protocol",isCollapsed:!1},{id:"cat_health",title:" Health & Body",isCollapsed:!1},{id:"cat_night",title:" Night Routine",isCollapsed:!1}],MN=K.createContext(void 0),lL=n=>{let e=n.reminders||[];return!n.reminders&&n.reminderMinutes&&n.reminderMinutes>0&&(e=[{id:`mig_${Date.now()}_${Math.random()}`,minutesBefore:n.reminderMinutes,isSent:!!n.isReminderSent}]),{difficulty:Ge.NORMAL,stat:te.DIS,type:"daily",history:[],streak:0,checkpoint:0,bestStreak:0,status:"pending",isTimed:!1,durationMinutes:0,reminders:e,subtasks:[],dailyTarget:n.dailyTarget||1,dailyProgress:n.dailyProgress||0,...n}},cL=n=>({habits:(n.habits||[]).map(lL),categories:n.categories||DN}),uL=({children:n})=>{const{state:e,dispatch:t}=Ve(),{skillDispatch:i,skillState:r}=sn(),l=e.user.preferences.soundEnabled,[c,d]=Ll("LIFE_OS_HABITS_COMBINED",{habits:aL,categories:DN},"habits_data",cL),{habits:p,categories:h}=c,[x,b]=K.useState(null);K.useEffect(()=>{const C=()=>{const P=new Date,L=new Date(e.user.lastOnline),O=e.user.preferences.dayStartHour??4,j=Y=>{const X=new Date(Y);return X.setHours(Y.getHours()-O),X},q=j(P),le=j(L);if(q.getDate()!==le.getDate()||q.getMonth()!==le.getMonth()){const Y=new Date(P);Y.setDate(Y.getDate()-1);const X=Y.toISOString();let ie=e.user.shields,pe=0,B={},ee=0,he=0;const Q=p.map(ae=>{const ye=ae.reminders?ae.reminders.map(Be=>({...Be,isSent:!1})):[],ue=ae.subtasks?ae.subtasks.map(Be=>({...Be,isCompleted:!1})):[],Te={reminders:ye,subtasks:ue,dailyProgress:0};if(ae.status==="completed")return{...ae,...Te,status:"pending",shieldUsed:!1,history:[...ae.history,X]};if(ae.status==="failed")return{...ae,...Te,status:"pending",shieldUsed:!1};if(vl(ae,X)&&ae.status==="pending"){if((ae.dailyProgress||0)>0)return he++,{...ae,...Te,status:"pending",shieldUsed:!1};if(ie>0)return ie--,pe++,t.addToast(` Shield protected: ${ae.title}`,"info"),{...ae,...Te,status:"pending",shieldUsed:!0};const Be=Bf(ae.streak);return B[ae.stat]=(B[ae.stat]||0)+1,ee+=1,t.addToast(` Missed ${ae.title}: -1 ${ae.stat} & -1 DIS`,"error"),{...ae,...Te,streak:Be,status:"pending",shieldUsed:!1}}return{...ae,...Te,status:"pending",shieldUsed:!1}});if(d(ae=>({...ae,habits:Q})),pe>0&&(t.updateUser({shields:ie}),Ce("success",l)),he>0&&t.addToast(`${he} habits partially completed (Rest Day recorded)`,"info"),ee>0){Ce("error",l);const ae={...e.user.stats};Object.entries(B).forEach(([ye,ue])=>{const Te=ye;ae[Te]=Math.max(0,ae[Te]-ue)}),ae[te.DIS]=Math.max(0,ae[te.DIS]-ee),t.updateUser({stats:ae})}}};C();const A=setInterval(C,6e4);return()=>clearInterval(A)},[e.user.lastOnline,p,e.user.preferences.dayStartHour]);const T=C=>{C&&Ce("click",l),b(C)},S=C=>{const A={id:`h_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...C,streak:0,status:"pending",history:[],checkpoint:0,bestStreak:0,createdAt:new Date().toISOString(),dailyProgress:0};Ce("click",l),d(P=>({...P,habits:[...P.habits,A]})),t.setModal("none")},E=(C,A)=>{d(P=>({...P,habits:P.habits.map(L=>L.id===C?{...L,...A}:L)})),Ce("click",l)},D=(C,A)=>{d(P=>({...P,habits:P.habits.map(L=>{if(L.id!==C)return L;const O=L.subtasks.map(j=>j.id===A?{...j,isCompleted:!j.isCompleted}:j);return{...L,subtasks:O}})})),Ce("click",l)},k=(C,A)=>{var q;const P=p.find(le=>le.id===C);if(!P)return;if(A==="completed"&&P.dailyTarget&&P.dailyTarget>1){const U=(P.dailyProgress||0)+1;if(U<P.dailyTarget){d(Y=>({...Y,habits:Y.habits.map(X=>X.id===C?{...X,dailyProgress:U}:X)})),Ce("click",l),t.addToast(`${P.title}: Rep ${U}/${P.dailyTarget}`,"info");return}}let L=P.streak,O=P.history,j="success";if(A==="completed"){L+=1;const le=new Date().toISOString().split("T")[0];O.some(he=>he.startsWith(le))||(O=[...O,new Date().toISOString()]);let U=Cl(P.difficulty,e.user.currentMode);Math.random()>.95?(U.xp*=2,U.gold*=2,j="crit",t.setModal("loot",{title:P.title,xp:U.xp,gold:U.gold,multiplier:2,message:"Consistency is Power."})):t.addToast(`${P.title} Complete | +${U.xp} XP`,"success");const X=P.difficulty===Ge.HARD?2:P.difficulty===Ge.NORMAL?1:.5,ie=r.skills.find(he=>he.id===P.skillId),pe=(q=ie==null?void 0:ie.relatedStats)!=null&&q.length?ie.relatedStats:[P.stat],B=X/pe.length,ee={...e.user.stats};if(pe.forEach(he=>{ee[he]=(ee[he]||0)+B}),t.updateUser({currentXP:e.user.currentXP+U.xp,dailyXP:e.user.dailyXP+U.xp,gold:e.user.gold+U.gold,stats:ee,metrics:{...e.user.metrics,habitsFixed:e.user.metrics.habitsFixed+1}}),P.skillId){const he=Math.ceil(U.xp*.5);i.addSkillXP(P.skillId,he)}}else if(A==="failed"){L=Bf(P.streak),j="error";const le=qS(P.difficulty),U=e.ui.debugDate?new Date(e.ui.debugDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],Y=e.user.honorDailyLog[U]!==void 0?e.user.honorDailyLog[U]:100,X=Math.max(0,Y-le),ie={...e.user.honorDailyLog,[U]:X},pe=du(ie,e.ui.debugDate);t.updateUser({honorDailyLog:ie,honor:pe}),t.addToast(`${P.title} Failed | Streak Reset & -${le}% Honor`,"error")}d(le=>({...le,habits:le.habits.map(U=>U.id===C?{...U,status:A,streak:L,history:O,bestStreak:Math.max(U.bestStreak,L),dailyProgress:A==="completed"?U.dailyTarget:U.dailyProgress}:U)})),Ce(j,l)},F=C=>{d(A=>({...A,habits:A.habits.filter(P=>P.id!==C)})),Ce("delete",l),t.addToast("Protocol Deleted","info"),x===C&&b(null)},$=C=>{const A={id:`cat_h_${Date.now()}`,title:C,isCollapsed:!1};d(P=>({...P,categories:[...P.categories,A]})),Ce("click",l)},M=C=>{d(A=>({...A,categories:A.categories.filter(P=>P.id!==C),habits:A.habits.map(P=>P.categoryId===C?{...P,categoryId:void 0}:P)})),Ce("delete",l)},J=(C,A)=>{d(P=>({...P,categories:P.categories.map(L=>L.id===C?{...L,title:A}:L)}))},H=C=>{d(A=>({...A,categories:A.categories.map(P=>P.id===C?{...P,isCollapsed:!P.isCollapsed}:P)}))},z=(C,A)=>{d(P=>({...P,habits:P.habits.map(L=>L.id===C?{...L,categoryId:A}:L)})),Ce("click",l)},R=(C,A)=>{d({habits:C,categories:A}),t.addToast("Habits Restored","success")};return o.jsx(MN.Provider,{value:{habitState:{habits:p,categories:h,activeHabitId:x},habitDispatch:{addHabit:S,updateHabit:E,processHabit:k,deleteHabit:F,setActiveHabit:T,addCategory:$,deleteCategory:M,renameCategory:J,toggleCategory:H,moveHabit:z,toggleSubtask:D,restoreData:R}},children:n})},ei=()=>{const n=K.useContext(MN);if(n===void 0)throw new Error("useHabits must be used within a HabitProvider");return n},dL=()=>{var X,ie,pe;const{state:n,dispatch:e}=Ve(),{taskState:t,taskDispatch:i}=Zn(),{habitState:r,habitDispatch:l}=ei(),{focusSession:c}=n.ui,d=K.useRef(null),p=K.useRef(null),h=K.useRef(null),x=K.useRef(null),[b,T]=K.useState(0),[S,E]=K.useState(!1),[D,k]=K.useState("none"),[F,$]=K.useState(!1),[M,J]=K.useState("none"),[H,z]=K.useState(""),R=K.useMemo(()=>c?c.itemType==="habit"?r.habits.find(ee=>ee.id===c.itemId):t.tasks.find(ee=>ee.id===c.itemId):null,[c,r.habits,t.tasks]),C=()=>{if(p.current){try{p.current.stop(),p.current.disconnect()}catch{}p.current=null}if(h.current){try{h.current.disconnect()}catch{}h.current=null}if(d.current&&d.current.state!=="closed"){try{d.current.close()}catch{}d.current=null}x.current&&(x.current.pause(),x.current.src="",x.current=null)};if(K.useEffect(()=>{c&&(T(c.durationMinutes*60),E(!1))},[c==null?void 0:c.itemId,c==null?void 0:c.startTime]),K.useEffect(()=>()=>C(),[]),K.useEffect(()=>{c&&!R&&(C(),e.endFocusSession())},[c,R,e]),K.useEffect(()=>{var B;if(C(),!(D==="none"||!c)){if(D==="custom"){if((B=n.ui.customAudio)!=null&&B.url){const ee=new Audio(n.ui.customAudio.url);ee.loop=!0,ee.volume=.5,ee.play().catch(he=>console.error("Playback failed",he)),x.current=ee}else e.addToast("No Custom Track Loaded","error"),k("none");return}try{d.current=new(window.AudioContext||window.webkitAudioContext);const ee=d.current;h.current=ee.createGain(),h.current.connect(ee.destination);let he=null;if(D==="brown"){const Q=2*ee.sampleRate;he=ee.createBuffer(1,Q,ee.sampleRate);const ae=he.getChannelData(0);let ye=0;for(let ue=0;ue<Q;ue++){const Te=Math.random()*2-1;ae[ue]=(ye+.02*Te)/1.02,ye=ae[ue],ae[ue]*=3.5}h.current.gain.value=.15}else if(D==="rain"){const Q=2*ee.sampleRate;he=ee.createBuffer(1,Q,ee.sampleRate);const ae=he.getChannelData(0);let ye=0,ue=0,Te=0,Ae=0,Be=0,jt=0,Dt=0;for(let An=0;An<Q;An++){const mt=Math.random()*2-1;ye=.99886*ye+mt*.0555179,ue=.99332*ue+mt*.0750759,Te=.969*Te+mt*.153852,Ae=.8665*Ae+mt*.3104856,Be=.55*Be+mt*.5329522,jt=-.7616*jt-mt*.016898,ae[An]=(ye+ue+Te+Ae+Be+jt+Dt+mt*.5362)*.11,Dt=mt*.115926}h.current.gain.value=.2}else if(D==="clock"){const Q=ee.sampleRate;he=ee.createBuffer(1,Q,ee.sampleRate);const ae=he.getChannelData(0);for(let ye=0;ye<Q;ye++){const ue=ye/ee.sampleRate;if(ue<.15){const Te=(Math.random()*2-1)*Math.exp(-ue*80),Ae=Math.sin(2*Math.PI*2800*ue)*Math.exp(-ue*100),Be=Math.sin(2*Math.PI*180*ue)*Math.exp(-ue*60);ae[ye]=Te*.4+Ae*.3+Be*.3}else ae[ye]=0}h.current.gain.value=.5}he&&(p.current=ee.createBufferSource(),p.current.buffer=he,p.current.loop=!0,p.current.connect(h.current),p.current.start(0))}catch(ee){console.error("Audio failed",ee)}return()=>C()}},[D,!!c]),K.useEffect(()=>{let B;return!S&&b>0&&c?B=window.setInterval(()=>{T(ee=>ee-1)},1e3):b===0&&!S&&c&&(Ce("level-up",!0),E(!0)),()=>clearInterval(B)},[S,b,!!c]),!c||!R)return null;const A=c.itemType==="habit",P=R.subtasks&&R.subtasks.length>0,L=((X=R.subtasks)==null?void 0:X.filter(B=>B.isCompleted).length)||0,O=((ie=R.subtasks)==null?void 0:ie.length)||0,j=B=>{const ee=Math.floor(B/60),he=B%60;return`${ee.toString().padStart(2,"0")}:${he.toString().padStart(2,"0")}`},q=(B=!1)=>{C();const he=c.durationMinutes*60-b,Q=Math.floor(he/60);if(Q>=1){const ae=Math.floor(Q*2);e.updateUser({currentXP:n.user.currentXP+ae,dailyXP:n.user.dailyXP+ae}),e.addToast(`Focused for ${Q}m (+${ae} XP)`,"success")}if(H.trim()){const ae=H.split(`
`).filter(ye=>ye.trim().length>0);ae.forEach(ye=>{i.addTask({title:ye.trim(),difficulty:Ge.EASY,stat:te.INT,energyLevel:"low",isTimed:!1,subtasks:[],categoryId:void 0})}),e.addToast(`${ae.length} Missions added from notes`,"info")}B&&(A?l.processHabit(R.id,"completed"):i.toggleTask(R.id)),e.endFocusSession()},le=B=>{Ce("click",!0),A?l.toggleSubtask(R.id,B):i.toggleSubtask(R.id,B)},U=()=>{switch(D){case"brown":return"Brown";case"rain":return"Rain";case"clock":return"Tick";case"custom":return"Track";default:return"Mute"}},Y=()=>{switch(D){case"brown":return o.jsx(K_,{size:18});case"rain":return o.jsx(B_,{size:18});case"clock":return o.jsx(ln,{size:18});case"custom":return o.jsx(hh,{size:18});default:return o.jsx(J_,{size:18})}};return o.jsxs("div",{className:"fixed inset-0 z-[200] bg-black text-white flex flex-col animate-in fade-in duration-500",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#0a0a0a] to-[#1a1a1a] pointer-events-none"}),o.jsx("div",{className:`absolute inset-0 bg-life-gold/5 blur-[100px] rounded-full transition-opacity duration-[3000ms] ${S?"opacity-10":"opacity-40 animate-pulse-slow"}`}),o.jsxs("div",{className:"relative z-10 flex justify-between items-center p-6",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-life-muted",children:"Focus Protocol Active"})]}),o.jsxs("button",{onClick:()=>q(!1),className:"p-2 rounded-full hover:bg-white/10 text-life-muted hover:text-life-hard transition-all flex items-center gap-1",children:[o.jsx("span",{className:"text-[10px] font-bold uppercase hidden sm:inline",children:"Abort"}),o.jsx(TN,{size:18})]})]}),o.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center relative z-10 p-6 text-center",children:[o.jsxs("div",{className:"mb-4 text-[9px] font-black uppercase tracking-[0.2em] bg-white/5 px-3 py-1 rounded-full border border-zinc-800 text-life-gold",children:[A?"PROTOCOL":"MISSION"," TARGET"]}),o.jsx("h2",{className:"text-2xl md:text-4xl font-black tracking-tight mb-8 max-w-2xl leading-tight",children:R.title}),o.jsxs("div",{className:"relative mb-12",children:[o.jsxs("svg",{className:"w-64 h-64 md:w-80 md:h-80 transform -rotate-90",children:[o.jsx("circle",{cx:"50%",cy:"50%",r:"48%",className:"stroke-life-muted/10 fill-none",strokeWidth:"4"}),o.jsx("circle",{cx:"50%",cy:"50%",r:"48%",className:`fill-none transition-all duration-1000 ${S?"stroke-life-muted":"stroke-life-gold"}`,strokeWidth:"4",strokeDasharray:"301.59",strokeDashoffset:301.59*(1-b/(c.durationMinutes*60)),pathLength:"301.59",strokeLinecap:"round",style:{filter:S?"none":"drop-shadow(0 0 15px rgba(251,191,36,0.5))"}})]}),o.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[o.jsx("div",{className:"text-6xl md:text-8xl font-mono font-bold tracking-tighter tabular-nums",children:j(b)}),o.jsxs("button",{onClick:()=>E(!S),className:"mt-4 px-6 py-2 rounded-full bg-white/5 hover:bg-white/10 border border-zinc-800 text-xs font-bold uppercase tracking-widest flex items-center gap-2 transition-all",children:[S?o.jsx($h,{size:12,fill:"currentColor"}):o.jsx(zP,{size:12,fill:"currentColor"})," ",S?"Resume":"Pause"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2 w-full justify-center max-w-md relative",children:[o.jsxs("div",{className:"relative",children:[F&&o.jsx("div",{className:"absolute bottom-full left-0 mb-2 w-32 bg-life-black border border-life-gold/30 rounded-xl overflow-hidden shadow-2xl animate-in slide-in-from-bottom-2 z-50 flex flex-col",children:[{id:"none",label:"Mute",icon:o.jsx(J_,{size:14})},{id:"brown",label:"Brown Noise",icon:o.jsx(K_,{size:14})},{id:"rain",label:"Rain",icon:o.jsx(B_,{size:14})},{id:"clock",label:"Tick",icon:o.jsx(ln,{size:14})},{id:"custom",label:"Custom",icon:o.jsx(hh,{size:14})}].map(B=>o.jsxs("button",{onClick:()=>{k(B.id),$(!1)},className:`flex items-center gap-3 px-4 py-3 text-xs font-bold uppercase tracking-wider hover:bg-life-gold/10 transition-colors ${D===B.id?"text-life-gold bg-life-gold/5":"text-life-muted"}`,children:[B.icon," ",B.label]},B.id))}),o.jsxs("button",{onClick:()=>$(!F),className:`p-3 rounded-xl border flex flex-col items-center gap-1 transition-all w-20 shrink-0 ${D!=="none"?"bg-life-gold/20 border-life-gold text-life-gold":"bg-white/5 border-zinc-800 text-life-muted hover:text-white"}`,children:[Y(),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx("span",{className:"text-[8px] font-bold uppercase",children:U()}),o.jsx(Xi,{size:8})]})]})]}),o.jsxs("button",{onClick:()=>J(M==="notes"?"none":"notes"),className:`p-3 rounded-xl border flex flex-col items-center gap-1 transition-all w-20 shrink-0 ${M==="notes"?"bg-life-easy/20 border-life-easy text-life-easy":"bg-white/5 border-zinc-800 text-life-muted hover:text-white"}`,children:[o.jsx(Y_,{size:18}),o.jsx("span",{className:"text-[8px] font-bold uppercase",children:"Notes"})]}),P&&o.jsxs("button",{onClick:()=>J(M==="subtasks"?"none":"subtasks"),className:`p-3 rounded-xl border flex flex-col items-center gap-1 transition-all w-20 shrink-0 ${M==="subtasks"?"bg-life-gold/20 border-life-gold text-life-gold":"bg-white/5 border-zinc-800 text-life-muted hover:text-white"}`,children:[o.jsx(q_,{size:18}),o.jsxs("div",{className:"flex flex-col items-center leading-none",children:[o.jsx("span",{className:"text-[8px] font-bold uppercase",children:"Steps"}),o.jsxs("span",{className:"text-[7px] opacity-60",children:[L,"/",O]})]})]}),o.jsxs("button",{onClick:()=>q(!0),className:"p-3 rounded-xl border border-life-easy/50 bg-life-easy/10 text-life-easy hover:bg-life-easy hover:text-black transition-all flex flex-col items-center gap-1 w-20 shrink-0 group",children:[o.jsx(Os,{size:18,className:"group-hover:scale-110 transition-transform"}),o.jsx("span",{className:"text-[8px] font-bold uppercase",children:"Done"})]})]}),o.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-[#111] border-t border-zinc-800 p-6 rounded-t-3xl transition-transform duration-300 ease-out z-20 shadow-[0_-10px_40px_rgba(0,0,0,0.5)] h-[40vh] flex flex-col ${M==="notes"?"translate-y-0":"translate-y-full"}`,children:[o.jsxs("div",{className:"flex justify-between items-center mb-4 shrink-0",children:[o.jsxs("h3",{className:"text-xs font-bold uppercase text-life-muted tracking-widest flex items-center gap-2",children:[o.jsx(Y_,{size:14})," Distraction Pad"]}),o.jsx("button",{onClick:()=>J("none"),className:"text-life-muted hover:text-white",children:o.jsx(et,{size:16})})]}),o.jsx("textarea",{value:H,onChange:B=>z(B.target.value),placeholder:"Dump thoughts here...",className:"w-full h-full bg-black/50 rounded-xl border border-zinc-800 p-4 text-sm text-life-text focus:outline-none focus:border-life-gold resize-none font-mono leading-relaxed"})]}),o.jsxs("div",{className:`absolute bottom-0 left-0 right-0 bg-[#111] border-t border-zinc-800 p-6 rounded-t-3xl transition-transform duration-300 ease-out z-20 shadow-[0_-10px_40px_rgba(0,0,0,0.5)] h-[50vh] flex flex-col text-left ${M==="subtasks"?"translate-y-0":"translate-y-full"}`,children:[o.jsxs("div",{className:"flex justify-between items-center mb-4 shrink-0",children:[o.jsxs("h3",{className:"text-xs font-bold uppercase text-life-gold tracking-widest flex items-center gap-2",children:[o.jsx(q_,{size:14})," Tactical Objectives"]}),o.jsx("button",{onClick:()=>J("none"),className:"text-life-muted hover:text-white",children:o.jsx(et,{size:16})})]}),o.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:(pe=R.subtasks)==null?void 0:pe.map(B=>o.jsxs("div",{onClick:()=>le(B.id),className:`flex items-center gap-3 p-3 rounded-lg border cursor-pointer transition-all ${B.isCompleted?"bg-life-gold/10 border-life-gold/30 opacity-60":"bg-white/5 border-zinc-800 hover:bg-white/10"}`,children:[o.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors shrink-0 ${B.isCompleted?"bg-life-gold border-life-gold text-black":"border-life-muted text-transparent"}`,children:o.jsx(gt,{size:12,strokeWidth:4})}),o.jsx("span",{className:`text-sm ${B.isCompleted?"line-through text-life-gold":"text-life-text"}`,children:B.title})]},B.id))})]})]})]})},fL=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(0),[i,r]=K.useState(""),[l,c]=K.useState(!1),[d,p]=K.useState(""),[h,x]=K.useState("INITIALIZING NEURAL LINK..."),[b,T]=K.useState(!0);K.useEffect(()=>{p(""),T(!0);let D=0;const k=setInterval(()=>{p(h.slice(0,D+1)),D++,D>=h.length&&(clearInterval(k),T(!1))},30);return()=>clearInterval(k)},[h]);const S=()=>{Ce("click",!0),e===0?(x("IDENTITY VERIFICATION REQUIRED."),t(1)):e===1&&i&&(x("SYNCHRONIZATION COMPLETE. WELCOME."),t(2))},E=()=>{i&&(c(!0),Ce("level-up",!0),setTimeout(()=>{n.completeOnboarding(i,"Initiate",te.DIS)},1e3))};return l?o.jsx("div",{className:"fixed inset-0 z-[999] bg-black flex items-center justify-center animate-out fade-out duration-1000",children:o.jsx("div",{className:"text-life-gold text-sm font-mono animate-pulse",children:"SYSTEM ONLINE"})}):o.jsxs("div",{className:"fixed inset-0 z-[999] bg-[#050505] flex flex-col items-center justify-center p-6 font-mono overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-[0.05] pointer-events-none",style:{backgroundImage:"linear-gradient(0deg, transparent 24%, #222 25%, #222 26%, transparent 27%, transparent 74%, #222 75%, #222 76%, transparent 77%, transparent), linear-gradient(90deg, transparent 24%, #222 25%, #222 26%, transparent 27%, transparent 74%, #222 75%, #222 76%, transparent 77%, transparent)",backgroundSize:"50px 50px"}}),o.jsxs("div",{className:"w-full max-w-md relative z-10 flex flex-col h-full justify-center",children:[o.jsxs("div",{className:"mb-8 min-h-[60px] border-l-2 border-life-gold pl-4 py-2",children:[o.jsxs("div",{className:"text-xs text-life-gold/50 mb-1 flex items-center gap-2",children:[o.jsx(zn,{size:12})," PROTOCOL_INIT_V1.0"]}),o.jsxs("h1",{className:"text-lg md:text-xl text-life-gold font-bold leading-tight",children:[d,o.jsx("span",{className:"animate-pulse",children:"_"})]})]}),e===0&&o.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-8 duration-700",children:[o.jsxs("div",{className:"w-24 h-24 bg-life-gold/10 rounded-full border border-life-gold/30 flex items-center justify-center mx-auto mb-8 relative",children:[o.jsx(Lt,{size:40,className:"text-life-gold animate-pulse-slow"}),o.jsx("div",{className:"absolute inset-0 border border-life-gold rounded-full animate-[spin_10s_linear_infinite] opacity-30 border-t-transparent border-l-transparent"})]}),o.jsx("p",{className:"text-center text-life-muted text-xs mb-12 max-w-xs mx-auto leading-relaxed",children:"Welcome to LifeOS. This interface will augment your daily operations, turning chaos into order and effort into progression."}),o.jsx("button",{onClick:S,disabled:b,className:"w-full py-4 bg-life-gold hover:bg-yellow-400 text-black font-black uppercase tracking-[0.2em] rounded-sm transition-all hover:scale-[1.02]",children:"Start"})]}),e===1&&o.jsxs("div",{className:"animate-in fade-in slide-in-from-right-8 duration-500",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Codename"}),o.jsx("input",{type:"text",value:i,onChange:D=>r(D.target.value),placeholder:"Enter Name...",autoFocus:!0,className:"w-full bg-transparent border-b-2 border-life-muted/30 py-2 text-2xl font-bold text-white focus:outline-none focus:border-life-gold transition-colors text-center"})]}),o.jsx("button",{onClick:S,disabled:!i,className:"w-full py-4 border border-life-gold text-life-gold hover:bg-life-gold hover:text-black font-black uppercase tracking-[0.2em] rounded-sm transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirm Identity"})]}),e===2&&o.jsxs("div",{className:"animate-in fade-in zoom-in-95 duration-700 text-center",children:[o.jsxs("div",{className:"mb-8 border border-life-gold/30 bg-life-gold/5 p-6 rounded-lg relative overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-life-gold animate-[loading_2s_ease-in-out_infinite]"}),o.jsx("h2",{className:"text-2xl font-black text-white uppercase mb-1",children:i}),o.jsx("p",{className:"text-life-gold font-mono text-sm uppercase tracking-widest",children:"READY"}),o.jsxs("div",{className:"mt-4 pt-4 border-t border-life-gold/20 flex justify-center gap-4 text-[10px] text-life-muted uppercase font-bold",children:[o.jsx("span",{children:"Lvl 1"}),o.jsx("span",{children:"Status: ONLINE"})]})]}),o.jsxs("button",{onClick:E,className:"w-full py-4 bg-life-gold hover:bg-yellow-400 text-black font-black uppercase tracking-[0.2em] rounded-sm transition-all hover:scale-[1.02] flex items-center justify-center gap-2",children:["Enter LifeOS ",o.jsx(Bt,{size:18})]})]})]}),o.jsx("div",{className:"absolute bottom-8 flex gap-2",children:[0,1,2].map(D=>o.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-colors ${D===e?"bg-life-gold":"bg-life-muted/20"}`},D))}),o.jsx("style",{children:`
                @keyframes loading {
                    0% { transform: translateX(-100%); }
                    50% { transform: translateX(0); }
                    100% { transform: translateX(100%); }
                }
            `})]})},PN=K.createContext(void 0),hL=n=>({...n,status:n.status||"active",progress:n.progress||0,isCampaign:n.isCampaign||!1,steps:(n.steps||[]).map(e=>({...e,isCompleted:!!e.isCompleted,isLocked:!!e.isLocked,subtasks:e.subtasks||[]}))}),pL=n=>({raids:(Array.isArray(n)?n:n.raids||[]).map(hL)}),mL=({children:n})=>{const{state:e,dispatch:t}=Ve(),{skillDispatch:i,skillState:r}=sn(),l=e.user.preferences.soundEnabled,[c,d]=Ll("LIFE_OS_RAIDS_DATA",{raids:[]},"raids_data",pL),{raids:p}=c,h=H=>{const z={id:`rd_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,...H,status:"active",progress:0,isCampaign:H.isCampaign||!1};d(R=>({...R,raids:[z,...R.raids]})),Ce("click",l),t.addToast("Operation Initialized","success")},x=(H,z)=>{d(R=>({...R,raids:R.raids.map(C=>C.id===H?{...C,...z}:C)})),Ce("click",l)},b=H=>{d(z=>({...z,raids:z.raids.filter(R=>R.id!==H)})),Ce("delete",l),t.addToast("Operation Deleted","info")},T=H=>{d(z=>({...z,raids:z.raids.map(R=>R.id===H?{...R,status:"archived"}:R)})),t.addToast("Operation Archived","info")},S=H=>{d(z=>({...z,raids:z.raids.map(R=>R.id===H?{...R,status:"active"}:R)})),t.addToast("Operation Restored","success")},E=(H,z)=>{d(R=>({...R,raids:R.raids.map(C=>{if(C.id!==H)return C;const A=C.steps.map(P=>P.id===z?{...P,isArchived:!0}:P);return{...C,steps:A}})}))},D=(H,z)=>{d(R=>({...R,raids:R.raids.map(C=>{if(C.id!==H)return C;const A=C.steps.filter(P=>P.id!==z);return{...C,steps:A}})})),t.setModal("none")},k=(H,z,R)=>{d(C=>({...C,raids:C.raids.map(A=>{if(A.id!==H)return A;const P=A.steps.map(L=>L.id===z?{...L,...R}:L);return{...A,steps:P}})}))},F=(H,z)=>{d(R=>({...R,raids:R.raids.map(C=>{if(C.id!==H)return C;const A=new Map(z.map(L=>[L.id,L])),P=C.steps.map(L=>{if(A.has(L.id)){const O=A.get(L.id);return{...L,...O,isCompleted:O.isCompleted!==void 0?O.isCompleted:L.isCompleted}}return L});return{...C,steps:P}})})),t.addToast("Raid Steps Updated","success")},$=(H,z,R)=>{d(C=>({...C,raids:C.raids.map(A=>{if(A.id!==H)return A;const P=A.steps.map(L=>{var j;if(L.id!==z)return L;const O=((j=L.subtasks)==null?void 0:j.map(q=>q.id===R?{...q,isCompleted:!q.isCompleted}:q))||[];return{...L,subtasks:O}});return{...A,steps:P}})})),Ce("click",l)},M=(H,z)=>{var ue;const R=p.find(Te=>Te.id===H);if(!R)return;const C=R.steps.findIndex(Te=>Te.id===z);if(C===-1)return;const A=R.steps[C],P=!A.isCompleted,L=A.difficulty||R.difficulty,O=A.stat||(R.stats&&R.stats.length>0?R.stats[0]:te.STR),j=R.skillId,q=Cl(L,e.user.currentMode),le=q.xp,U=q.gold,Y=L===Ge.HARD?2:L===Ge.NORMAL?1:.5,X=r.skills.find(Te=>Te.id===j),ie=(ue=X==null?void 0:X.relatedStats)!=null&&ue.length?X.relatedStats:[O],pe=Y/ie.length,B={...e.user.stats};ie.forEach(Te=>{B[Te]=(B[Te]||0)+pe});const ee=[...R.steps];ee[C]={...A,isCompleted:P};const he=ee.filter(Te=>Te.isCompleted).length,Q=Math.round(he/ee.length*100),ae=Q===100;let ye=null;if(P)t.updateUser({currentXP:e.user.currentXP+le,dailyXP:e.user.dailyXP+le,gold:e.user.gold+U,stats:B}),j&&i.addSkillXP(j,Math.ceil(le*.5)),ae?(Ce("crit",l),ye={title:`Operation Conquered: ${R.title}`,xp:le*5,gold:U*5,multiplier:5,message:"Sector Secured. Tactical Superiority Achieved."},t.updateUser({currentXP:e.user.currentXP+le*5,gold:e.user.gold+U*5,metrics:{...e.user.metrics,totalRaidsWon:e.user.metrics.totalRaidsWon+1}})):(Ce("success",l),t.addToast(`Step Secured | +${le} XP`,"success"));else{const Te={...e.user.stats};ie.forEach(Ae=>{Te[Ae]=Math.max(0,(Te[Ae]||0)-pe)}),t.updateUser({currentXP:Math.max(0,e.user.currentXP-le),dailyXP:Math.max(0,e.user.dailyXP-le),gold:Math.max(0,e.user.gold-U),stats:Te}),R.status==="completed"?(t.updateUser({currentXP:Math.max(0,e.user.currentXP-le*5),gold:Math.max(0,e.user.gold-U*5),metrics:{...e.user.metrics,totalRaidsWon:Math.max(0,e.user.metrics.totalRaidsWon-1)}}),t.addToast("Step Revoked | Completion Bonus Removed","info")):t.addToast("Step Revoked","info"),Ce("delete",l)}d(Te=>({...Te,raids:Te.raids.map(Ae=>{if(Ae.id!==H)return Ae;const Be=[...Ae.steps];return Be[C]={...A,isCompleted:P},P&&C+1<Be.length&&(Be[C+1]={...Be[C+1],isLocked:!1}),{...Ae,steps:Be,progress:Q,status:ae?"completed":Ae.status==="completed"?"active":Ae.status}})})),ye&&setTimeout(()=>t.setModal("loot",ye),300)},J=H=>{d({raids:H}),t.addToast("Raids Restored","success")};return o.jsx(PN.Provider,{value:{raidState:{raids:p},raidDispatch:{addRaid:h,updateRaid:x,deleteRaid:b,archiveRaid:T,restoreRaid:S,toggleRaidStep:M,updateRaidStep:k,mergeRaidSteps:F,toggleRaidStepSubtask:$,archiveRaidStep:E,deleteRaidStep:D,restoreData:J}},children:n})},ss=()=>{const n=K.useContext(PN);if(n===void 0)throw new Error("useRaids must be used within a RaidProvider");return n},gL=()=>{const{state:n,dispatch:e}=Ve(),{taskState:t,taskDispatch:i}=Zn(),{habitState:r,habitDispatch:l}=ei(),{raidState:c,raidDispatch:d}=ss(),{deviceNotificationsEnabled:p}=n.user.preferences,h=K.useRef("");return K.useEffect(()=>{Ds.isNativePlatform()&&(FS(),Wo.addListener("localNotificationActionPerformed",x=>{const b=x.actionId,T=x.notification.extra;if(b==="COMPLETE"&&T){const{itemId:S,type:E,parentId:D}=T;E==="task"?(i.toggleTask(S),e.addToast("Mission Completed via Uplink","success")):E==="habit"?(l.processHabit(S,"completed"),e.addToast("Protocol Executed via Uplink","success")):E==="raid_step"&&D&&(d.toggleRaidStep(D,S),e.addToast("Operation Step Secured","success")),Ce("success",!0)}b==="SNOOZE"&&e.addToast("Alert Snoozed (Simulation)","info")}))},[]),K.useEffect(()=>{if(!p||!Ds.isNativePlatform())return;const b=setTimeout(()=>{const T=n.ui.debugDate?new Date(n.ui.debugDate).toISOString():new Date().toISOString(),S=r.habits.filter(H=>H.status==="pending"&&vl(H,T)),E=t.tasks.filter(H=>!H.isCompleted&&!H.isArchived&&(!H.scheduledTime||new Date(H.scheduledTime)<=new Date(new Date().getTime()+864e5)));let D=0;c.raids.forEach(H=>{H.status==="active"&&(D+=H.steps.filter(z=>!z.isCompleted&&!z.isLocked).length)});const k=S.length+E.length+D,F=Math.floor(n.user.dailyXP/n.user.dailyTarget*100),$=`LifeOS Active: ${k} Pending`,M=` ${E.length} Missions     ${S.length} Protocols     ${F}% XP`,J=$+M;h.current!==J&&(Pk($,M),h.current=J)},1e3);return()=>clearTimeout(b)},[t.tasks,r.habits,c.raids,n.user.dailyXP,p]),K.useEffect(()=>{if(!p)return;const b=setInterval(()=>{const T=new Date().getTime(),S=300*1e3;t.tasks.forEach(E=>{if(!(E.isCompleted||E.isArchived||!E.scheduledTime)&&E.reminders){const D=new Date(E.scheduledTime).getTime();let k=!1;const F=E.reminders.map($=>{if($.isSent)return $;const M=D-$.minutesBefore*6e4;return T>=M&&T<M+S?(Gf(parseInt(E.id.replace(/\D/g,"").slice(-8))||Date.now(),`Mission Critical: ${E.title}`,`Time: ${new Date(E.scheduledTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}`,{itemId:E.id,type:"task"}),k=!0,{...$,isSent:!0}):$});k&&i.updateTask(E.id,{reminders:F})}}),r.habits.forEach(E=>{if(E.status==="completed"||!E.scheduledTime||!E.reminders)return;const[D,k]=E.scheduledTime.split(":").map(Number),F=new Date;F.setHours(D,k,0,0);const $=F.getTime();let M=!1;const J=E.reminders.map(H=>{if(H.isSent)return H;const z=$-H.minutesBefore*6e4;return T>=z&&T<z+S?(Gf(parseInt(E.id.replace(/\D/g,"").slice(-8))||Date.now(),`Protocol: ${E.title}`,`Time: ${E.scheduledTime}`,{itemId:E.id,type:"habit"}),M=!0,{...H,isSent:!0}):H});M&&l.updateHabit(E.id,{reminders:J})})},15e3);return()=>clearInterval(b)},[t.tasks,r.habits,p]),null},Sg="LIFE_OS_CAMPAIGN_DATA_V2",bf={id:"campaign_root",title:"",startDate:null,isFrozen:!1,currentWeek:0,currentDay:0,totalWeeks:12,isActive:!1},LN=K.createContext(void 0),xL=({children:n})=>{const{state:e,dispatch:t}=Ve(),i=e.user.preferences.soundEnabled,r=()=>{try{const S=localStorage.getItem(Sg);if(S)return JSON.parse(S)}catch(S){console.warn("Failed to load campaign persistence:",S)}return bf},[l,c]=K.useState(r);K.useEffect(()=>{if(!l.startDate||!l.isActive)return;const S=()=>{if(l.isFrozen)return;const D=e.ui.debugDate,k=D?new Date(D):new Date,F=new Date(l.startDate),$=k.getTime()-F.getTime(),M=Math.floor($/(1e3*60*60*24));if(M<0)c(J=>({...J,currentWeek:0,currentDay:0}));else{const J=Math.floor(M/7)+1,H=M%7+1,z=Math.min(J,13);c(R=>R.currentWeek!==z||R.currentDay!==H?{...R,currentWeek:z,currentDay:H}:R)}};S();const E=setInterval(S,6e4);return()=>clearInterval(E)},[l.startDate,l.isActive,l.isFrozen,e.ui.debugDate]),K.useEffect(()=>{const S=setTimeout(()=>{(l.isActive||localStorage.getItem(Sg))&&localStorage.setItem(Sg,JSON.stringify(l))},500);return()=>clearTimeout(S)},[l]);const d=(S,E)=>{const D={...bf,id:`cmp_${Date.now()}`,title:S,startDate:E,isActive:!0};Ce("success",i),c(D),t.addToast("Operation Tempo Initiated","success")},p=()=>{const S=!l.isFrozen;c(E=>({...E,isFrozen:S})),Ce("click",i),t.addToast(S?"Timeline Frozen ":"Timeline Resumed ","info")},h=()=>{c(bf),Ce("delete",i),t.addToast("Campaign Aborted","info")},x=()=>{confirm(` REAP THE HARVEST?
This will conclude the current 12-week cycle and archive the results. Are you ready for the reset?`)&&(c(bf),Ce("level-up",i),t.addToast("Harvest Complete. Cycle Reset.","success"))},b=S=>{c(E=>({...E,startDate:S})),Ce("click",i),t.addToast("Timeline Shifted","info")},T=S=>{c(S),t.addToast("Campaign Restored","success")};return o.jsx(LN.Provider,{value:{campaignState:{campaign:l},campaignDispatch:{initCampaign:d,toggleFreeze:p,resetCampaign:h,completeCampaign:x,updateStartDate:b,restoreData:T}},children:n})},Ul=()=>{const n=K.useContext(LN);if(n===void 0)throw new Error("useCampaign must be used within a CampaignProvider");return n},X_=n=>new Date(n).toISOString().replace(/-|:|\.\d{3}/g,""),Wh=(n,e="",t,i=60)=>{if(!t){alert("    .");return}const r=new Date(t),l=new Date(r.getTime()+i*6e4),c=X_(r.toISOString()),d=X_(l.toISOString()),p=encodeURIComponent(`${e}

Generated by LifeOS`),h=encodeURIComponent(`[LifeOS] ${n}`),x=encodeURIComponent("LifeOS HQ"),b=`https://calendar.google.com/calendar/render?action=TEMPLATE&text=${h}&dates=${c}/${d}&details=${p}&location=${x}`;window.open(b,"_blank")},W_=({stat:n,size:e=14})=>{switch(n){case te.STR:return o.jsx(Qn,{size:e});case te.INT:return o.jsx(tn,{size:e});case te.DIS:return o.jsx(dt,{size:e});case te.HEA:return o.jsx(gi,{size:e});case te.CRT:return o.jsx(kn,{size:e});case te.SPR:return o.jsx(Mi,{size:e});case te.REL:return o.jsx(mo,{size:e});case te.FIN:return o.jsx(pi,{size:e});default:return o.jsx(Lt,{size:e})}},nl=({task:n,onToggle:e,onDelete:t})=>{var O,j;const{dispatch:i,state:r}=Ve(),{skillState:l}=sn(),{taskState:c,taskDispatch:d}=Zn(),{campaignState:p}=Ul(),h=n.skillId?l.skills.find(q=>q.id===n.skillId):null,x=ut[n.stat],b=ui[n.difficulty].split(" ")[0],T=r.user.preferences.showCalendarSync??!0,S=Cl(n.difficulty,r.user.currentMode),E=n.isCampaign?Math.ceil(S.xp*1.1):S.xp,D=n.isCampaign?tL(p.campaign.startDate,n.deadline||n.scheduledTime):null,[k,F]=K.useState(!1),$=((O=n.subtasks)==null?void 0:O.filter(q=>q.isCompleted).length)||0,M=((j=n.subtasks)==null?void 0:j.length)||0,J=M>0?$/M*100:0,H=q=>`${q}m`,z=q=>{q.stopPropagation(),i.startFocusSession(n.id,n.durationMinutes||25)},R=q=>{q.stopPropagation(),i.setModal("itemDetails",{itemId:n.id,type:"task"})},C=q=>{q.stopPropagation(),t(n.id)},A=q=>{const le=q.target.value;d.moveTask(n.id,le||void 0)},P=q=>{q.stopPropagation(),Wh(n.title,n.description,n.scheduledTime||n.deadline,n.durationMinutes||60)},L=n.reminders?n.reminders.length:0;return o.jsxs("div",{onClick:()=>F(!k),className:`
        relative group flex flex-col p-4 mb-3 rounded-xl border border-zinc-800 bg-life-black/40 backdrop-blur-sm shadow-sm cursor-pointer transition-all duration-300 overflow-hidden
        ${n.isCompleted?"opacity-50 grayscale border-gray-800":"hover:border-zinc-700 hover:bg-life-black/60 hover:shadow-md"}
        ${k?"ring-1 ring-life-gold/20 bg-life-black/80":""}
      `,children:[o.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${b.replace("border-","bg-")}`}),M>0&&!n.isCompleted&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-life-muted/10",children:o.jsx("div",{className:"h-full bg-life-gold transition-all duration-500",style:{width:`${J}%`}})}),o.jsxs("div",{className:"flex items-center w-full",children:[o.jsx("div",{className:"mr-4 relative",children:o.jsx("div",{onClick:q=>{q.stopPropagation(),e(n.id)},className:`
                w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all duration-300 hover:scale-110
                ${n.isCompleted?"bg-life-easy border-life-easy text-life-black":"border-life-muted group-hover:border-life-silver bg-transparent"}
                `,children:o.jsx(gt,{size:16,className:`transition-transform duration-300 ${n.isCompleted?"scale-100":"scale-0"}`,strokeWidth:3})})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[n.isCampaign&&o.jsxs("span",{className:"text-[9px] font-black px-1.5 py-0.5 rounded border border-indigo-500/50 bg-indigo-500/10 text-indigo-300 flex items-center gap-1 uppercase tracking-wider shadow-[0_0_8px_rgba(99,102,241,0.2)]",children:[o.jsx(is,{size:10}),D?`G12  ${D}`:"G12"]}),n.isCalendarEvent&&!n.isCampaign&&o.jsxs("span",{className:"text-[9px] font-black px-1.5 py-0.5 rounded border border-blue-500/50 bg-blue-500/10 text-blue-300 flex items-center gap-1 uppercase tracking-wider shadow-[0_0_8px_rgba(59,130,246,0.2)]",children:[o.jsx(Wn,{size:10})," C30"]}),h&&h.relatedStats&&h.relatedStats.length>0?h.relatedStats.map(q=>o.jsxs("span",{className:`text-[9px] font-bold px-1.5 py-0.5 rounded border flex items-center gap-1 uppercase tracking-wider ${n.isCompleted?"border-gray-600 text-gray-500":""}`,style:{borderColor:n.isCompleted?void 0:`${ut[q]}40`,color:n.isCompleted?void 0:ut[q],backgroundColor:n.isCompleted?void 0:`${ut[q]}10`},children:[o.jsx(W_,{stat:q,size:10}),q]},q)):o.jsxs("span",{className:`text-[9px] font-bold px-1.5 py-0.5 rounded border flex items-center gap-1 uppercase tracking-wider ${n.isCompleted?"border-gray-600 text-gray-500":""}`,style:{borderColor:n.isCompleted?void 0:`${x}40`,color:n.isCompleted?void 0:x,backgroundColor:n.isCompleted?void 0:`${x}10`},children:[o.jsx(W_,{stat:n.stat,size:10}),n.stat]}),!n.isCompleted&&o.jsxs("span",{className:"text-[9px] font-mono font-bold text-life-muted bg-life-black px-1.5 py-0.5 rounded border border-life-muted/20",children:["+",E," XP"]}),h&&o.jsxs("span",{className:"text-[9px] text-life-gold border border-life-gold/30 bg-life-gold/10 px-1.5 py-0.5 rounded flex items-center gap-1 uppercase tracking-wider",children:[o.jsx(hi,{size:10})," ",h.title]}),n.isTimed&&!k&&o.jsxs("span",{className:"text-[10px] flex items-center gap-1 text-life-muted",children:[o.jsx(ln,{size:10})," ",H(n.durationMinutes||0)]}),n.scheduledTime&&!k&&o.jsxs("span",{className:"text-[9px] flex items-center gap-1 text-life-gold bg-life-gold/10 px-1.5 py-0.5 rounded border border-life-gold/20",children:[new Date(n.scheduledTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),L>0&&o.jsx(ur,{size:8,className:"fill-current"})]})]}),o.jsx("h3",{className:`text-sm font-medium truncate pr-2 ${n.isCompleted?"line-through text-life-muted":"text-life-text"}`,children:n.title})]})]}),k&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-life-muted/10 animate-in slide-in-from-top-2",children:[o.jsx("div",{className:"flex justify-end mb-3",children:o.jsxs("div",{className:"flex items-center gap-1 bg-life-black/50 rounded-lg p-0.5 border border-life-muted/10",children:[!n.isCompleted&&!n.isArchived&&(n.scheduledTime||n.deadline)&&T&&o.jsx("button",{onClick:P,className:"w-6 h-6 flex items-center justify-center text-blue-400 hover:bg-blue-500/10 rounded transition-all",title:"Add to Google Calendar",children:o.jsx(Gh,{size:12})}),!n.isCompleted&&!n.isArchived&&o.jsx("button",{onClick:z,className:"w-6 h-6 flex items-center justify-center text-life-gold hover:bg-life-gold/10 rounded transition-all",title:"Enter Focus Citadel",children:o.jsx($h,{size:12,fill:"currentColor"})}),!n.isCompleted&&!n.isArchived&&o.jsxs("div",{className:"relative group/move w-6 h-6 flex items-center justify-center",onClick:q=>q.stopPropagation(),children:[o.jsx("button",{className:"text-life-muted hover:text-life-gold transition-colors",children:o.jsx(mx,{size:12})}),o.jsxs("select",{onChange:A,value:n.categoryId||"",className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full",title:"Move to Section",children:[o.jsx("option",{value:"",children:"(Uncategorized)"}),c.categories.map(q=>o.jsx("option",{value:q.id,children:q.title},q.id))]})]}),o.jsx("button",{onClick:R,className:"w-6 h-6 flex items-center justify-center text-life-muted hover:text-life-text hover:bg-life-muted/10 rounded transition-colors",title:"Mission Details",children:o.jsx(Su,{size:12})}),o.jsx("button",{onClick:C,className:"w-6 h-6 flex items-center justify-center text-life-muted hover:text-life-hard hover:bg-life-hard/10 rounded transition-colors",title:"Delete Mission",children:o.jsx(Nn,{size:12})})]})}),n.description&&o.jsxs("div",{className:"flex gap-2 text-xs text-life-muted mb-3",children:[o.jsx(Jh,{size:14,className:"shrink-0 mt-0.5"}),o.jsx("p",{className:"leading-relaxed whitespace-pre-wrap",children:n.description})]}),M>0&&o.jsx("div",{className:"mb-3 space-y-1 pl-1",children:n.subtasks.map(q=>o.jsxs("div",{onClick:le=>{le.stopPropagation(),d.toggleSubtask(n.id,q.id)},className:"flex items-center gap-2 text-xs cursor-pointer hover:bg-life-muted/10 p-1 rounded transition-colors group/sub",children:[o.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${q.isCompleted?"bg-life-gold border-life-gold text-life-black":"border-life-muted text-transparent group-hover/sub:border-life-gold"}`,children:o.jsx(gt,{size:12,strokeWidth:3})}),o.jsx("span",{className:q.isCompleted?"text-life-muted line-through":"text-life-text",children:q.title})]},q.id))}),o.jsx("div",{className:"flex justify-between items-end mt-2",children:o.jsx("div",{className:"flex gap-2 text-[10px] text-life-muted uppercase tracking-wider items-center",children:n.scheduledTime?o.jsxs(o.Fragment,{children:[o.jsx(ur,{size:12})," ",L," Alerts | ",new Date(n.scheduledTime).toLocaleString()]}):n.deadline&&o.jsxs(o.Fragment,{children:[o.jsx(Wn,{size:12})," Due: ",new Date(n.deadline).toLocaleString()]})})})]})]})},yL=({raidOperations:n,expandedNotes:e,expandedSubtasks:t,toggleNotes:i,toggleSubtasksView:r,raidDispatch:l,openRaidStepDetails:c})=>o.jsxs("div",{className:"mb-6 space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-2 px-1 text-life-hard animate-pulse-slow",children:[o.jsx(ua,{size:14}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest",children:"Active Operations (Tip of the Spear)"})]}),n.map(({raid:d,step:p})=>{var S,E;const h=e.has(p.id),x=t.has(p.id),b=((S=p.subtasks)==null?void 0:S.length)||0,T=((E=p.subtasks)==null?void 0:E.filter(D=>D.isCompleted).length)||0;return o.jsxs("div",{onClick:()=>r(p.id),className:`bg-life-paper border-l-4 rounded-r-xl shadow-lg relative overflow-hidden group transition-all duration-300 cursor-pointer ${ui[d.difficulty].split(" ")[0]} hover:bg-white/5`,children:[o.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"radial-gradient(circle, #fff 1px, transparent 1px)",backgroundSize:"8px 8px"}}),o.jsxs("div",{className:"p-3",children:[o.jsxs("div",{className:"flex justify-between items-start relative z-10",children:[o.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[o.jsx("div",{className:"flex items-center gap-2 mb-1",children:o.jsxs("span",{className:"text-[9px] bg-life-black px-1.5 py-0.5 rounded text-life-muted font-bold uppercase tracking-wider border border-zinc-800",children:["OP: ",d.title]})}),o.jsx("h3",{className:"text-sm font-bold text-life-text flex items-center gap-2",children:p.title})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:D=>{D.stopPropagation(),i(p.id)},className:`w-8 h-8 rounded-lg flex items-center justify-center transition-all ${h?"text-life-gold bg-life-gold/10":"text-life-muted hover:text-white hover:bg-life-muted/10"}`,children:o.jsx(Ol,{size:16})}),o.jsx("button",{onClick:D=>{D.stopPropagation(),l.toggleRaidStep(d.id,p.id)},className:"w-8 h-8 rounded-lg bg-life-black border border-zinc-800 flex items-center justify-center text-life-muted hover:text-life-gold hover:border-life-gold transition-all relative z-20",children:o.jsx(ns,{size:16})})]})]}),o.jsxs("div",{className:"mt-2 flex items-center gap-3 text-[10px] text-life-muted/60",children:[o.jsx("span",{className:"uppercase font-bold text-life-hard",children:d.difficulty}),o.jsx("span",{children:""}),o.jsxs("span",{children:["Step ",d.steps.findIndex(D=>D.id===p.id)+1," of ",d.steps.length]}),b>0&&o.jsxs(o.Fragment,{children:[o.jsx("span",{children:""}),o.jsxs("span",{className:`flex items-center gap-1 ${x?"text-life-gold":""}`,children:[o.jsx(ns,{size:10})," ",T,"/",b," Subtasks"]})]})]}),h&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-zinc-800 animate-in slide-in-from-top-2 cursor-default",onClick:D=>D.stopPropagation(),children:[o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Jh,{size:12,className:"text-life-gold mt-0.5 shrink-0"}),o.jsx("div",{className:"text-xs text-life-text leading-relaxed whitespace-pre-wrap flex-1",children:p.notes||o.jsx("span",{className:"text-life-muted italic",children:"No intel provided."})})]}),o.jsx("div",{className:"flex justify-end mt-2",children:o.jsxs("button",{onClick:D=>{D.stopPropagation(),c(p.id,d.id)},className:"text-[9px] flex items-center gap-1 text-life-muted hover:text-life-gold bg-life-black px-2 py-1 rounded border border-zinc-800",children:[o.jsx(Su,{size:10})," Full View"]})})]}),x&&o.jsxs("div",{className:"mt-3 pt-3 border-t border-zinc-800 animate-in slide-in-from-top-2 cursor-default",onClick:D=>D.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("h4",{className:"text-[9px] text-life-muted uppercase font-bold tracking-widest flex items-center gap-1",children:[o.jsx(gt,{size:10})," Tactical Checklist"]}),o.jsxs("button",{onClick:D=>{D.stopPropagation(),c(p.id,d.id)},className:"text-[9px] flex items-center gap-1 text-life-muted hover:text-white",children:[o.jsx(y3,{size:10})," Edit"]})]}),b>0?o.jsx("div",{className:"space-y-1 pl-1 mb-2",children:p.subtasks.map(D=>o.jsxs("div",{onClick:k=>{k.stopPropagation(),l.toggleRaidStepSubtask(d.id,p.id,D.id)},className:`flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-all border ${D.isCompleted?"bg-life-black border-zinc-800 opacity-60":"bg-life-paper/50 border-zinc-800 hover:border-life-gold/30 hover:bg-life-muted/10"}`,children:[o.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-all shrink-0 ${D.isCompleted?"bg-life-gold border-life-gold text-life-black":"border-life-muted text-transparent group-hover:border-life-gold"}`,children:o.jsx(gt,{size:12,strokeWidth:4,className:D.isCompleted?"scale-100":"scale-0"})}),o.jsx("span",{className:`text-xs font-medium leading-tight ${D.isCompleted?"text-life-muted line-through":"text-life-text"}`,children:D.title})]},D.id))}):o.jsx("div",{className:"text-[10px] text-life-muted italic text-center py-2 border border-dashed border-zinc-800 rounded mb-2",children:"No subtasks defined."})]})]})]},p.id)})]}),vL=({onClose:n})=>o.jsxs("div",{className:"bg-life-black border border-zinc-800 rounded-xl p-4 mb-6 animate-in fade-in slide-in-from-top-2",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-2 bg-red-900/20 rounded-lg text-red-500",children:o.jsx(hr,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-bold text-life-text uppercase tracking-wider",children:"Sentencing Guidelines"}),o.jsx("p",{className:"text-[10px] text-life-muted",children:"Economy of Pain & Discipline"})]})]}),o.jsx("button",{onClick:n,className:"text-life-muted hover:text-white",children:o.jsx(et,{size:16})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-[1fr_2fr] gap-3 items-center border-b border-zinc-800 pb-3",children:[o.jsxs("div",{className:"text-right pr-2 border-r border-zinc-800",children:[o.jsx("div",{className:"text-blue-400 font-black text-xs",children:"XP (Experience)"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Growth Metric"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between text-[10px] text-life-muted",children:[o.jsx("span",{children:"Easy Mission Reward"}),o.jsx("span",{className:"text-life-easy",children:"+100 XP"})]}),o.jsxs("div",{className:"flex justify-between text-[10px] text-life-muted",children:[o.jsx("span",{children:"Hard Mission Reward"}),o.jsx("span",{className:"text-life-gold",children:"+500 XP"})]}),o.jsxs("div",{className:"mt-1 p-2 bg-red-950/10 rounded border border-red-900/20",children:[o.jsx("div",{className:"text-[9px] text-red-400 font-bold mb-1",children:"Recommended Penalties:"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[9px]",children:[o.jsx("span",{className:"text-zinc-400",children:"Minor Slip"})," ",o.jsx("span",{className:"text-red-400",children:"-50 XP"}),o.jsx("span",{className:"text-zinc-400",children:"Bad Habit"})," ",o.jsx("span",{className:"text-red-400",children:"-200 XP"}),o.jsx("span",{className:"text-zinc-400",children:"Major Failure"})," ",o.jsx("span",{className:"text-red-400",children:"-1000 XP"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_2fr] gap-3 items-center border-b border-zinc-800 pb-3",children:[o.jsxs("div",{className:"text-right pr-2 border-r border-zinc-800",children:[o.jsx("div",{className:"text-life-gold font-black text-xs",children:"Gold (Currency)"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Reward Power"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between text-[10px] text-life-muted",children:[o.jsx("span",{children:"1 Hour of Work"}),o.jsx("span",{className:"text-life-gold",children:"~50-100 G"})]}),o.jsxs("div",{className:"flex justify-between text-[10px] text-life-muted",children:[o.jsx("span",{children:"Day of Perfection"}),o.jsx("span",{className:"text-life-gold",children:"~500 G"})]}),o.jsxs("div",{className:"mt-1 p-2 bg-red-950/10 rounded border border-red-900/20",children:[o.jsx("div",{className:"text-[9px] text-red-400 font-bold mb-1",children:"Fines:"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[9px]",children:[o.jsx("span",{className:"text-zinc-400",children:"Wasted Time"})," ",o.jsx("span",{className:"text-red-400",children:"-10 G / min"}),o.jsx("span",{className:"text-zinc-400",children:"Impulse Buy"})," ",o.jsx("span",{className:"text-red-400",children:"-100 G"})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_2fr] gap-3 items-center border-b border-zinc-800 pb-3",children:[o.jsxs("div",{className:"text-right pr-2 border-r border-zinc-800",children:[o.jsx("div",{className:"text-purple-400 font-black text-xs",children:"Attributes"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Core Stats"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"text-[10px] text-zinc-400 leading-relaxed",children:["Stats are ",o.jsx("span",{className:"text-white font-bold",children:"extremely hard"})," to earn. You only get ",o.jsx("span",{className:"text-purple-400",children:"+1"})," per completed mission."]}),o.jsxs("div",{className:"mt-1 p-2 bg-red-950/10 rounded border border-red-900/20",children:[o.jsx("div",{className:"text-[9px] text-red-400 font-bold mb-1",children:"Severe Punishment:"}),o.jsxs("div",{className:"text-[9px] text-zinc-400",children:["Losing ",o.jsx("span",{className:"text-red-400",children:"-1 Stat"})," is equivalent to erasing a completed mission from your history. Use sparingly for character flaws (e.g., Anger = -1 HEA)."]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_2fr] gap-3 items-center",children:[o.jsxs("div",{className:"text-right pr-2 border-r border-zinc-800",children:[o.jsx("div",{className:"text-indigo-400 font-black text-xs",children:"Honor"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Integrity Score"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"text-[10px] text-zinc-400 leading-relaxed",children:["Your daily score starts at ",o.jsx("span",{className:"text-indigo-400",children:"100%"}),"."]}),o.jsxs("div",{className:"mt-1 p-2 bg-red-950/10 rounded border border-red-900/20",children:[o.jsx("div",{className:"text-[9px] text-red-400 font-bold mb-1",children:"Impact:"}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 text-[9px]",children:[o.jsx("span",{className:"text-zinc-400",children:"Disappointment"})," ",o.jsx("span",{className:"text-red-400",children:"-5%"}),o.jsx("span",{className:"text-zinc-400",children:"Broken Promise"})," ",o.jsx("span",{className:"text-red-400",children:"-20%"}),o.jsx("span",{className:"text-zinc-400",children:"Betrayal"})," ",o.jsx("span",{className:"text-red-400",children:"-50%"})]})]})]})]})]})]}),bL=()=>{const{taskState:n,taskDispatch:e}=Zn(),{laws:t}=n,[i,r]=K.useState(""),[l,c]=K.useState("honor"),[d,p]=K.useState(50),[h,x]=K.useState(te.DIS),[b,T]=K.useState(!1),[S,E]=K.useState(!1),[D,k]=K.useState(null),[F,$]=K.useState(""),[M,J]=K.useState("honor"),[H,z]=K.useState(0),[R,C]=K.useState(te.DIS),A=O=>{O.preventDefault(),i.trim()&&(e.addLaw(i,l,d,l==="stat"?h:void 0),r(""),p(50),T(!1))},P=O=>{k(O.id),$(O.title),J(O.penaltyType),z(O.penaltyValue),C(O.statTarget||te.DIS)},L=()=>{!D||!F.trim()||(e.updateLaw(D,{title:F,penaltyType:M,penaltyValue:H,statTarget:M==="stat"?R:void 0}),k(null))};return o.jsxs("div",{className:"animate-in fade-in slide-in-from-right-4 duration-500 pb-20",children:[o.jsxs("div",{className:"bg-red-950/20 border border-red-900/50 p-4 rounded-xl mb-6 text-center relative",children:[o.jsx(ph,{className:"w-8 h-8 text-red-500 mx-auto mb-2 animate-pulse"}),o.jsx("h2",{className:"text-lg font-black text-red-500 uppercase tracking-widest mb-1",children:"The Codex"}),o.jsx("p",{className:"text-[10px] text-red-400/70 font-mono uppercase tracking-wider",children:'"He who cannot obey himself will be commanded."'}),o.jsx("button",{onClick:()=>E(!S),className:"absolute top-4 right-4 text-red-500/50 hover:text-red-400 transition-colors",title:"Sentencing Guidelines",children:o.jsx(hi,{size:16})})]}),S&&o.jsx(vL,{onClose:()=>E(!1)}),o.jsxs("div",{className:"space-y-3 mb-8",children:[t.map(O=>D===O.id?o.jsxs("div",{className:"bg-life-black border border-life-gold/50 p-4 rounded-xl space-y-3 animate-in fade-in",children:[o.jsx("input",{type:"text",value:F,onChange:q=>$(q.target.value),className:"w-full bg-[#0a0a0a] border border-red-900/30 rounded-lg p-2 text-xs text-white focus:outline-none focus:border-red-500",autoFocus:!0}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex-1 flex bg-[#0a0a0a] rounded-lg p-1 border border-red-900/30",children:[o.jsx("button",{type:"button",onClick:()=>J("honor"),className:`flex-1 py-1 rounded text-[9px] font-bold ${M==="honor"?"bg-indigo-500 text-white":"text-zinc-500"}`,children:o.jsx(po,{size:10,className:"mx-auto"})}),o.jsx("button",{type:"button",onClick:()=>J("gold"),className:`flex-1 py-1 rounded text-[9px] font-bold ${M==="gold"?"bg-life-gold text-black":"text-zinc-500"}`,children:o.jsx(pi,{size:10,className:"mx-auto"})}),o.jsx("button",{type:"button",onClick:()=>J("xp"),className:`flex-1 py-1 rounded text-[9px] font-bold ${M==="xp"?"bg-blue-500 text-white":"text-zinc-500"}`,children:o.jsx(dt,{size:10,className:"mx-auto"})}),o.jsx("button",{type:"button",onClick:()=>J("stat"),className:`flex-1 py-1 rounded text-[9px] font-bold ${M==="stat"?"bg-purple-500 text-white":"text-zinc-500"}`,children:o.jsx(Lt,{size:10,className:"mx-auto"})})]}),o.jsx("input",{type:"number",value:H,onChange:q=>z(Number(q.target.value)),className:"w-20 bg-[#0a0a0a] border border-red-900/30 rounded-lg p-2 text-xs text-white focus:outline-none focus:border-red-500 text-center"})]}),M==="stat"&&o.jsx("div",{className:"flex gap-1 overflow-x-auto no-scrollbar pb-1",children:Object.values(te).map(q=>o.jsx("button",{onClick:()=>C(q),className:`w-6 h-6 shrink-0 rounded flex items-center justify-center border transition-all text-[9px] ${R===q?"bg-red-900/50 border-red-500 text-white":"border-zinc-800 text-zinc-500"}`,children:q},q))}),o.jsxs("div",{className:"flex gap-2 pt-2",children:[o.jsx("button",{onClick:()=>k(null),className:"flex-1 py-2 rounded bg-life-black border border-life-muted/20 text-life-muted text-xs font-bold hover:text-white",children:"Cancel"}),o.jsxs("button",{onClick:L,className:"flex-1 py-2 rounded bg-life-gold text-black text-xs font-bold hover:bg-yellow-400 flex items-center justify-center gap-1",children:[o.jsx(gt,{size:12})," Save"]})]})]},O.id):o.jsxs("div",{className:"bg-[#0f0505] border border-red-900/30 p-4 rounded-xl flex items-center justify-between group hover:border-red-600/50 transition-all",children:[o.jsxs("div",{className:"flex-1 min-w-0 pr-4",children:[o.jsx("h3",{className:"text-sm font-bold text-red-100 mb-1",children:O.title}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:"text-[9px] bg-red-900/30 text-red-400 px-2 py-0.5 rounded border border-red-900/50 uppercase font-black tracking-wider",children:["Penalty: -",O.penaltyValue," ",O.penaltyType==="stat"?O.statTarget:O.penaltyType.toUpperCase()]}),O.timesBroken>0&&o.jsxs("span",{className:"text-[9px] text-zinc-600 font-mono",children:["Broken ",O.timesBroken,"x"]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("button",{onClick:()=>e.enforceLaw(O.id),className:"bg-red-600 hover:bg-red-500 text-white text-[10px] font-black uppercase tracking-widest px-3 py-2 rounded-lg shadow-[0_0_15px_rgba(220,38,38,0.4)] hover:scale-105 active:scale-95 transition-all flex items-center gap-1 mr-1",children:[o.jsx(bN,{size:12})," Pay Fine"]}),o.jsxs("div",{className:"flex flex-col gap-1",children:[o.jsx("button",{onClick:()=>P(O),className:"text-zinc-600 hover:text-life-gold transition-colors p-1",children:o.jsx(xx,{size:12})}),o.jsx("button",{onClick:()=>e.deleteLaw(O.id),className:"text-zinc-600 hover:text-red-500 transition-colors p-1",children:o.jsx(et,{size:12})})]})]})]},O.id)),t.length===0&&o.jsx("div",{className:"text-center py-8 border-2 border-dashed border-red-900/20 rounded-xl bg-red-950/10",children:o.jsx("p",{className:"text-xs text-red-800/50 font-bold uppercase",children:"No Laws Enacted"})})]}),o.jsx("div",{className:"border-t border-red-900/20 pt-6",children:b?o.jsxs("form",{onSubmit:A,className:"bg-black/40 border border-red-900/30 p-4 rounded-xl space-y-4 animate-in slide-in-from-bottom-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[9px] text-red-500 uppercase font-bold tracking-widest mb-2",children:"Offense Name"}),o.jsx("input",{type:"text",value:i,onChange:O=>r(O.target.value),placeholder:"e.g. Ate Sugar, Missed Prayer...",className:"w-full bg-[#0a0a0a] border border-red-900/30 rounded-lg p-2 text-xs text-white focus:outline-none focus:border-red-500",autoFocus:!0})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[9px] text-red-500 uppercase font-bold tracking-widest mb-2",children:"Penalty Type"}),o.jsxs("div",{className:"flex bg-[#0a0a0a] rounded-lg p-1 border border-red-900/30",children:[o.jsx("button",{type:"button",onClick:()=>c("honor"),className:`flex-1 py-1.5 rounded text-[10px] font-bold ${l==="honor"?"bg-indigo-500 text-white":"text-zinc-500"}`,title:"Honor",children:o.jsx(po,{size:12,className:"mx-auto"})}),o.jsx("button",{type:"button",onClick:()=>c("gold"),className:`flex-1 py-1.5 rounded text-[10px] font-bold ${l==="gold"?"bg-life-gold text-black":"text-zinc-500"}`,title:"Gold",children:o.jsx(pi,{size:12,className:"mx-auto"})}),o.jsx("button",{type:"button",onClick:()=>c("xp"),className:`flex-1 py-1.5 rounded text-[10px] font-bold ${l==="xp"?"bg-blue-500 text-white":"text-zinc-500"}`,title:"XP",children:o.jsx(dt,{size:12,className:"mx-auto"})}),o.jsx("button",{type:"button",onClick:()=>c("stat"),className:`flex-1 py-1.5 rounded text-[10px] font-bold ${l==="stat"?"bg-purple-500 text-white":"text-zinc-500"}`,title:"Stat",children:o.jsx(Lt,{size:12,className:"mx-auto"})})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[9px] text-red-500 uppercase font-bold tracking-widest mb-2",children:"Cost Value"}),o.jsx("input",{type:"number",value:d,onChange:O=>p(Number(O.target.value)),className:"w-full bg-[#0a0a0a] border border-red-900/30 rounded-lg p-2 text-xs text-white focus:outline-none focus:border-red-500 text-center font-mono"})]})]}),l==="stat"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-[9px] text-red-500 uppercase font-bold tracking-widest mb-2",children:"Target Attribute"}),o.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar pb-1",children:Object.values(te).map(O=>o.jsx("button",{type:"button",onClick:()=>x(O),className:`px-3 py-1.5 rounded border text-[9px] font-bold transition-all ${h===O?"bg-red-900/50 border-red-500 text-white":"border-zinc-800 text-zinc-500"}`,style:{color:h===O?ut[O]:void 0,borderColor:h===O?ut[O]:void 0},children:O},O))})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{type:"button",onClick:()=>T(!1),className:"flex-1 py-2 rounded-lg border border-zinc-800 text-zinc-500 text-[10px] font-bold uppercase hover:bg-zinc-900",children:"Cancel"}),o.jsx("button",{type:"submit",className:"flex-1 py-2 rounded-lg bg-red-600 text-white text-[10px] font-bold uppercase hover:bg-red-500 shadow-[0_0_10px_rgba(220,38,38,0.3)]",children:"Confirm Law"})]})]}):o.jsxs("button",{onClick:()=>T(!0),className:"w-full py-3 border border-dashed border-red-900/40 text-red-500/70 rounded-xl flex items-center justify-center gap-2 text-xs font-bold uppercase hover:bg-red-950/20 hover:text-red-400 hover:border-red-500/50 transition-all",children:[o.jsx(nn,{size:14})," Enact New Law"]})})]})},_L=()=>{const{state:n,dispatch:e}=Ve(),{taskState:t,taskDispatch:i}=Zn(),{raidState:r,raidDispatch:l}=ss(),{campaignState:c}=Ul(),{tasks:d,categories:p}=t,{raids:h}=r,{campaign:x}=c,{showHighlights:b}=n.user.preferences,{tasksViewMode:T}=n.ui,[S,E]=K.useState(!1),[D,k]=K.useState(!1),[F,$]=K.useState(!1),[M,J]=K.useState(!1),[H,z]=K.useState(!0),[R,C]=K.useState(new Set),[A,P]=K.useState(new Set),[L,O]=K.useState(""),[j,q]=K.useState(!1),[le,U]=K.useState(null),[Y,X]=K.useState(""),ie=h.filter(we=>we.status==="active").map(we=>{const Ee=we.steps.find(De=>!De.isCompleted&&!De.isLocked&&!De.isArchived);return Ee?{raid:we,step:Ee}:null}).filter(Boolean);h.flatMap(we=>we.steps.filter(Ee=>Ee.isArchived).map(Ee=>({raid:we,step:Ee})));const pe=n.ui.debugDate?new Date(n.ui.debugDate):new Date;pe.setHours(0,0,0,0);let B=null,ee=null;if(x.isActive&&x.startDate){const we=new Date(x.startDate);we.setHours(0,0,0,0);const Ee=Math.max(0,x.currentWeek-1);B=new Date(we),B.setDate(we.getDate()+Ee*7),ee=new Date(B),ee.setDate(B.getDate()+6),ee.setHours(23,59,59,999)}const he=[],Q=[],ae=[],ye=[],ue=[];d.forEach(we=>{if(we.isArchived){ue.push(we);return}if(we.isCompleted){ye.push(we);return}if(we.isCampaign&&x.isActive){const{timeCode:Pe}=IN(we.title);if(Pe&&Pe.week>x.currentWeek)return}const Ee=we.scheduledTime||we.deadline?new Date(we.scheduledTime||we.deadline):null;Ee&&Ee.setHours(0,0,0,0);const De=Ee&&Ee.getTime()>pe.getTime();let _e=!1;we.isCampaign&&B&&ee&&Ee&&Ee.getTime()>=B.getTime()&&Ee.getTime()<=ee.getTime()&&(_e=!0),_e?ae.push(we):De?we.isCampaign||Q.push(we):he.push(we)});const Te=we=>{we.preventDefault(),L.trim()&&(i.addCategory(L),O(""),q(!1))},Ae=we=>{Y.trim()&&(i.renameCategory(we,Y),U(null))},Be=(we,Ee)=>e.setModal("itemDetails",{itemId:we,parentId:Ee,type:"raid_step"}),jt=we=>C(Ee=>{const De=new Set(Ee);return De.has(we)?De.delete(we):De.add(we),De}),Dt=we=>P(Ee=>{const De=new Set(Ee);return De.has(we)?De.delete(we):De.add(we),De}),An=we=>{d.some(De=>De.categoryId===we)?e.setModal("confirmation",{title:"Delete Section?",message:"Items will be moved to Uncategorized.",confirmText:"Delete",isDangerous:!0,onConfirm:()=>i.deleteCategory(we)}):i.deleteCategory(we)},mt=we=>{const Ee=d.find(De=>De.id===we);Ee&&(!Ee.isCompleted&&!Ee.isArchived?e.setModal("confirmation",{title:"Abort Mission?",message:"Abandoning incurs a penalty.",confirmText:"Abort",isDangerous:!0,onConfirm:()=>i.deleteTask(we)}):e.setModal("confirmation",{title:"Delete Log?",message:"Permanently remove entry.",confirmText:"Delete",isDangerous:!0,onConfirm:()=>i.deleteTask(we)}))};return o.jsxs("div",{className:"pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"flex items-end justify-between px-1",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-black text-life-text tracking-tight uppercase",children:T==="missions"?"ACTIVE OPS":"THE CODEX"}),o.jsx("p",{className:"text-xs text-life-muted uppercase tracking-widest mt-1",children:T==="missions"?`${he.length} Missions Pending`:"Strict Liability Protocol"})]}),o.jsx("div",{className:`w-8 h-8 rounded-full border-2 flex items-center justify-center ${T==="codex"?"border-red-500 text-red-500 bg-red-950/30":"border-life-gold text-life-gold bg-life-gold/10"}`,children:T==="missions"?o.jsx("div",{className:"w-5 h-5 rounded-full bg-life-gold/80",style:{opacity:d.length>0?ye.length/d.length:0}}):o.jsx(Yh,{size:16})})]})}),T==="codex"?o.jsx(bL,{}):o.jsxs(o.Fragment,{children:[b&&ie.length>0&&o.jsx(yL,{raidOperations:ie,expandedNotes:R,expandedSubtasks:A,toggleNotes:jt,toggleSubtasksView:Dt,raidDispatch:l,openRaidStepDetails:Be}),ae.length>0&&o.jsxs("div",{className:"mb-4 animate-in slide-in-from-bottom-2",children:[o.jsxs("button",{onClick:()=>z(!H),className:"w-full flex items-center justify-between p-3 rounded-xl border bg-indigo-950/20 border-indigo-500/20 hover:bg-indigo-900/30 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(is,{size:16,className:"text-indigo-400 group-hover:scale-110 transition-transform"}),o.jsx("div",{className:"text-left",children:o.jsxs("span",{className:"text-xs font-bold text-indigo-300 uppercase tracking-widest flex items-center gap-2",children:["Week ",x.currentWeek," Objectives"]})})]}),o.jsx("div",{className:"text-indigo-400/50",children:H?o.jsx(Xi,{size:16}):o.jsx(Xn,{size:16})})]}),H&&o.jsx("div",{className:"mt-2 pl-2 border-l-2 border-indigo-500/10 space-y-2",children:ae.map(we=>o.jsx(nl,{task:we,onToggle:i.toggleTask,onDelete:mt},we.id))})]}),o.jsx("div",{className:"mb-4 flex justify-end",children:j?o.jsxs("form",{onSubmit:Te,className:"flex gap-2 animate-in fade-in",children:[o.jsx("input",{type:"text",value:L,onChange:we=>O(we.target.value),placeholder:"Section Title...",autoFocus:!0,className:"bg-life-black border border-zinc-800 rounded-lg px-3 py-1 text-xs text-life-text focus:border-life-gold outline-none"}),o.jsx("button",{type:"submit",className:"text-life-gold hover:bg-life-gold/10 p-1 rounded",children:o.jsx(nn,{size:16})}),o.jsx("button",{type:"button",onClick:()=>q(!1),className:"text-life-muted hover:text-white p-1",children:o.jsx(nn,{size:16,className:"rotate-45"})})]}):o.jsxs("button",{onClick:()=>q(!0),className:"text-[10px] uppercase font-bold text-life-muted hover:text-life-gold flex items-center gap-1 transition-colors",children:[o.jsx(yN,{size:14})," Add Section"]})}),o.jsxs("div",{className:"space-y-4 mb-4",children:[p.map(we=>{const Ee=he.filter(De=>De.categoryId===we.id);return o.jsxs("div",{className:"animate-in slide-in-from-bottom-2",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2 group relative",children:[le===we.id?o.jsx("div",{className:"flex gap-2 w-full",children:o.jsx("input",{type:"text",value:Y,onChange:De=>X(De.target.value),className:"bg-life-black border border-zinc-800 rounded px-2 py-0.5 text-xs text-life-text w-full focus:border-life-gold outline-none",autoFocus:!0,onBlur:()=>Ae(we.id),onKeyDown:De=>De.key==="Enter"&&Ae(we.id)})}):o.jsxs("button",{onClick:()=>i.toggleCategory(we.id),className:"flex items-center gap-2 text-life-muted hover:text-life-text transition-colors flex-1 text-left py-1",children:[o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-life-gold/80",children:we.isCollapsed?o.jsx(Bt,{size:12}):o.jsx(Xn,{size:12})}),o.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:we.title}),o.jsx("span",{className:"text-[9px] bg-life-muted/10 px-1.5 rounded-full text-life-muted",children:Ee.length})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity z-10",children:[o.jsx("button",{onClick:De=>{De.stopPropagation(),U(we.id),X(we.title)},className:"p-2 text-life-muted hover:text-white hover:bg-life-muted/10 rounded cursor-pointer",children:o.jsx(xx,{size:14})}),o.jsx("button",{onClick:De=>{De.stopPropagation(),An(we.id)},className:"p-2 text-life-muted hover:text-life-hard hover:bg-life-hard/10 rounded cursor-pointer",children:o.jsx(CN,{size:14})})]})]}),!we.isCollapsed&&o.jsxs("div",{className:"space-y-1 pl-1",children:[Ee.map(De=>o.jsx(nl,{task:De,onToggle:i.toggleTask,onDelete:mt},De.id)),Ee.length===0&&o.jsx("div",{className:"text-[10px] text-life-muted/40 italic pl-2",children:"No active missions in section."})]})]},we.id)}),he.filter(we=>!we.categoryId).length>0&&o.jsxs("div",{className:"animate-in slide-in-from-bottom-2",children:[o.jsx("div",{className:"flex items-center gap-2 mb-2 text-life-muted/50 px-1",children:o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"General / Uncategorized"})}),o.jsx("div",{className:"space-y-1",children:he.filter(we=>!we.categoryId).map(we=>o.jsx(nl,{task:we,onToggle:i.toggleTask,onDelete:mt},we.id))})]}),he.length===0&&ie.length===0&&ae.length===0&&o.jsx("div",{className:"py-8 text-center border-2 border-dashed border-zinc-800 rounded-xl bg-life-paper/50",children:o.jsx("p",{className:"text-life-muted text-sm font-medium",children:"All active missions cleared."})})]}),Q.length>0&&o.jsxs("div",{className:"mb-6 animate-in slide-in-from-bottom-2",children:[o.jsxs("button",{onClick:()=>J(!M),className:"w-full flex items-center justify-between p-3 rounded-xl border border-zinc-800 bg-life-black hover:bg-life-muted/5 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(gx,{size:16,className:"text-life-muted group-hover:text-life-text transition-colors"}),o.jsx("div",{className:"text-left",children:o.jsxs("span",{className:"text-xs font-bold text-life-muted group-hover:text-life-text uppercase tracking-widest transition-colors",children:["Future / Sleeping (",Q.length,")"]})})]}),o.jsx("div",{className:"text-life-muted/50",children:M?o.jsx(Xi,{size:16}):o.jsx(Xn,{size:16})})]}),M&&o.jsx("div",{className:"mt-2 pl-2 border-l border-zinc-800 space-y-2 opacity-80",children:Q.map(we=>o.jsx("div",{className:"scale-95 origin-top-left",children:o.jsx(nl,{task:we,onToggle:i.toggleTask,onDelete:mt})},we.id))})]}),ue.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:()=>k(!D),className:"w-full flex items-center justify-between p-2 rounded-lg border border-zinc-800 bg-life-black hover:bg-life-muted/5 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted group-hover:text-life-gold",children:[o.jsx(Tu,{size:14}),o.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:["Mission Backlog (",ue.length,")"]})]}),D?o.jsx(Xi,{size:14,className:"text-life-muted"}):o.jsx(Xn,{size:14,className:"text-life-muted"})]}),D&&o.jsxs("div",{className:"space-y-2 mt-2 pl-2 border-l border-zinc-800",children:[ue.map(we=>o.jsx("div",{className:"opacity-70 grayscale hover:grayscale-0 transition-all",children:o.jsx(nl,{task:we,onToggle:()=>i.restoreTask(we.id),onDelete:mt})},we.id)),o.jsx("div",{className:"text-center py-1 text-[9px] text-life-muted",children:"Click Checkbox to Restore  Trash to Delete Permanently"})]})]}),ye.length>0&&o.jsxs("div",{className:"mb-6",children:[o.jsxs("button",{onClick:()=>$(!F),className:"w-full flex items-center justify-between p-2 rounded-lg border border-zinc-800 bg-life-black hover:bg-life-muted/5 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted group-hover:text-life-easy",children:[o.jsx(j4,{size:14}),o.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:["Completed Log (",ye.length,")"]})]}),F?o.jsx(Xi,{size:14,className:"text-life-muted"}):o.jsx(Xn,{size:14,className:"text-life-muted"})]}),F&&o.jsx("div",{className:"space-y-1 mt-2 pl-2 border-l border-zinc-800 opacity-60 hover:opacity-100 transition-opacity animate-in slide-in-from-top-1",children:ye.map(we=>o.jsx(nl,{task:we,onToggle:i.toggleTask,onDelete:mt},we.id))})]})]})]})},wg=({stat:n,size:e=14})=>{switch(n){case te.STR:return o.jsx(Qn,{size:e});case te.INT:return o.jsx(tn,{size:e});case te.DIS:return o.jsx(dt,{size:e});case te.HEA:return o.jsx(gi,{size:e});case te.CRT:return o.jsx(kn,{size:e});case te.SPR:return o.jsx(Mi,{size:e});case te.REL:return o.jsx(mo,{size:e});case te.FIN:return o.jsx(pi,{size:e});default:return o.jsx(Lt,{size:e})}},$c=({habit:n,onProcess:e,onDelete:t})=>{var le;const{habitState:i,habitDispatch:r}=ei(),{dispatch:l,state:c}=Ve(),{skillState:d}=sn(),{categories:p}=i,[h,x]=K.useState(!1),b=S0(n.streak),T=n.skillId?((le=c.user.skills)==null?void 0:le.find(U=>U.id===n.skillId))||d.skills.find(U=>U.id===n.skillId):null,S=n.status==="completed",E=n.status==="failed",D=n.status==="pending",k=Cl(n.difficulty,c.user.currentMode),F=n.dailyProgress||0,$=n.dailyTarget||1,M=Math.min(100,F/$*100),J=n.subtasks||[],H=J.filter(U=>U.isCompleted).length,z=J.length,R=z>0?H/z*100:0;let C="";S?C="border-life-easy bg-life-easy/5":E?C="border-life-hard bg-life-hard/5":n.shieldUsed?C="border-life-diamond/40 bg-life-diamond/5":C=`${ui[n.difficulty]} border-l-[6px]`;const A=U=>{const Y=U.target.value;r.moveHabit(n.id,Y||void 0)},P=U=>{U.stopPropagation(),l.setModal("itemDetails",{itemId:n.id,type:"habit"})},L=U=>{U.stopPropagation(),r.setActiveHabit(n.id)},O=U=>{U.stopPropagation(),t(n.id)},j=U=>{U.stopPropagation(),l.startFocusSession(n.id,n.durationMinutes||25,"habit")},q=Array.from({length:7}).map((U,Y)=>{const X=new Date;X.setDate(X.getDate()-(6-Y));const ie=X.toISOString().split("T")[0],pe=n.history.some(he=>he.startsWith(ie)),B=Y===6;let ee="bg-life-muted/10";return pe?ee="bg-life-easy":B&&(S?ee="bg-life-easy":E?ee="bg-life-hard":ee="bg-life-muted/30 border border-zinc-800"),{isoDate:ie,statusColor:ee,isToday:B}});return o.jsxs("div",{onClick:()=>x(!h),className:`
        relative overflow-hidden mb-3 rounded-xl border bg-life-paper transition-all duration-300 group cursor-pointer
        ${C}
        ${D?"hover:bg-white/5 hover:scale-[1.01]":""}
      `,children:[o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-black/50",children:o.jsx("div",{className:`h-full transition-all duration-700 ease-out ${S?"bg-life-easy":E?"bg-life-hard":n.shieldUsed?"bg-life-diamond":"bg-life-gold"}`,style:{width:`${b.progress}%`,opacity:.5}})}),$>1&&D&&o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-full pointer-events-none",children:o.jsx("div",{className:"h-full bg-life-easy/10 transition-all duration-300",style:{width:`${M}%`}})}),z>0&&D&&o.jsx("div",{className:"absolute bottom-1 left-0 right-0 h-0.5 bg-life-muted/10",children:o.jsx("div",{className:"h-full bg-life-gold transition-all duration-500",style:{width:`${R}%`}})}),o.jsxs("div",{className:"flex items-center justify-between p-3 relative z-10",children:[o.jsxs("div",{className:"flex items-center gap-3 flex-1 overflow-hidden",children:[o.jsxs("div",{className:"relative shrink-0",children:[o.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center border-2 transition-colors duration-300 bg-life-black
                    ${S?"border-life-easy text-life-easy":E?"border-life-hard text-life-hard":n.shieldUsed?"border-life-diamond text-life-diamond shadow-[0_0_10px_rgba(96,165,250,0.3)]":"border-zinc-800 text-life-muted"}`,children:n.shieldUsed&&D?o.jsx(Zi,{size:16}):E?o.jsx(et,{size:16}):S?o.jsx(gt,{size:16}):o.jsx(wg,{stat:n.stat,size:16})}),o.jsxs("div",{className:`absolute -bottom-1 left-1/2 -translate-x-1/2 px-1 py-px rounded text-[7px] font-black uppercase tracking-tighter border bg-life-black whitespace-nowrap ${b.phaseColor}`,children:["LVL ",b.level]})]}),o.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[o.jsx("h3",{className:`font-bold text-sm leading-tight truncate ${S?"text-life-easy":E?"text-life-hard":"text-life-text"}`,children:n.title}),n.isTimed&&o.jsxs("span",{className:"text-[9px] flex items-center gap-0.5 text-life-muted bg-life-muted/10 px-1.5 py-0.5 rounded",children:[o.jsx(ln,{size:8})," ",n.durationMinutes,"m"]})]}),o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsxs("span",{className:"text-[9px] text-life-muted font-mono flex items-center gap-0.5",children:[o.jsx(Mi,{size:8,className:n.streak>0?"text-life-gold":"text-life-muted"})," ",n.streak]}),o.jsxs("div",{className:"flex items-center gap-1",children:[T&&T.relatedStats&&T.relatedStats.length>0?T.relatedStats.map(U=>o.jsxs("span",{className:"text-[8px] font-black px-1.5 py-0.5 rounded border border-zinc-800 bg-life-black text-life-muted flex items-center gap-1 uppercase tracking-wider",style:{color:ut[U],borderColor:`${ut[U]}40`},children:[o.jsx(wg,{stat:U,size:8})," ",U]},U)):o.jsxs("span",{className:"text-[8px] font-black px-1.5 py-0.5 rounded border border-zinc-800 bg-life-black text-life-muted flex items-center gap-1 uppercase tracking-wider",style:{color:ut[n.stat],borderColor:`${ut[n.stat]}40`},children:[o.jsx(wg,{stat:n.stat,size:8})," ",n.stat]}),D&&o.jsxs("span",{className:"text-[8px] font-mono font-bold text-life-muted bg-life-black px-1.5 py-0.5 rounded border border-zinc-800",children:["+",k.xp," XP"]}),T&&o.jsxs("span",{className:"text-[8px] font-black px-1.5 py-0.5 rounded border border-life-gold/30 bg-life-gold/5 text-life-gold flex items-center gap-1 uppercase tracking-wider",children:[o.jsx(tn,{size:8})," ",T.title]})]}),o.jsx("div",{className:"flex items-center gap-0.5",children:q.map((U,Y)=>o.jsx("div",{className:`w-1 h-1 rounded-full ${U.statusColor} ${U.isToday&&D?"animate-pulse":""}`,title:U.isoDate},Y))})]})]})]}),o.jsx("div",{className:"flex flex-col items-end gap-1.5 shrink-0 ml-2",children:o.jsx("div",{className:"flex items-center gap-2",children:D?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:U=>{U.stopPropagation(),e(n.id,"failed")},className:"w-8 h-8 rounded-lg border border-zinc-800 hover:border-life-hard hover:bg-life-hard/10 text-life-muted hover:text-life-hard flex items-center justify-center transition-all active:scale-95 bg-life-black",title:"Fail",children:o.jsx(et,{size:16,strokeWidth:3})}),o.jsxs("button",{onClick:U=>{U.stopPropagation(),e(n.id,"completed")},className:"w-8 h-8 rounded-lg border border-zinc-800 hover:border-life-easy hover:bg-life-easy/10 text-life-muted hover:text-life-easy flex items-center justify-center transition-all active:scale-95 shadow-sm bg-life-black relative overflow-hidden",title:$>1?`Repetition ${F+1} of ${$}`:"Complete",children:[$>1?o.jsxs("div",{className:"flex flex-col items-center leading-none z-10",children:[o.jsxs("span",{className:`text-[10px] font-black ${F>0?"text-life-easy":""}`,children:[F,"/",$]}),o.jsx("span",{className:"text-[6px] uppercase font-bold text-life-muted/70",children:"Reps"})]}):o.jsx(gt,{size:18,strokeWidth:3}),$>1&&o.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-life-muted/20",children:o.jsx("div",{className:"h-full bg-life-easy transition-all duration-300",style:{width:`${M}%`}})})]})]}):o.jsx("div",{className:`h-8 px-3 flex items-center justify-center rounded-lg border text-[10px] font-black uppercase tracking-wider ${S?"bg-life-easy/10 border-life-easy text-life-easy":"bg-life-hard/10 border-life-hard text-life-hard"}`,children:S?"DONE":"MISS"})})})]}),h&&o.jsxs("div",{className:"px-3 pb-3 animate-in slide-in-from-top-2 border-t border-life-muted/10 pt-2",children:[o.jsx("div",{className:"flex justify-end mb-3",children:o.jsxs("div",{className:"flex items-center gap-1 bg-life-black/50 rounded-lg p-0.5 border border-life-muted/10",children:[o.jsx("button",{onClick:L,className:"w-6 h-6 flex items-center justify-center text-life-muted hover:text-life-gold hover:bg-life-gold/10 rounded transition-colors",title:"View Progress Ladder",children:o.jsx(Kh,{size:12})}),n.isTimed&&D&&o.jsx("button",{onClick:j,className:"w-6 h-6 flex items-center justify-center text-life-gold hover:bg-life-gold/10 rounded transition-colors",title:"Enter Focus Citadel",children:o.jsx($h,{size:12,fill:"currentColor"})}),o.jsx("button",{onClick:P,className:"w-6 h-6 flex items-center justify-center text-life-muted hover:text-life-text hover:bg-life-muted/10 rounded transition-colors",title:"Details & Edit",children:o.jsx(Su,{size:12})}),o.jsxs("div",{className:"relative group/move w-6 h-6 flex items-center justify-center",onClick:U=>U.stopPropagation(),children:[o.jsx("button",{className:"text-life-muted hover:text-life-gold transition-colors",children:o.jsx(mx,{size:12})}),o.jsxs("select",{onChange:A,value:n.categoryId||"",className:"absolute inset-0 opacity-0 cursor-pointer w-full h-full",children:[o.jsx("option",{value:"",children:"(Uncat)"}),p.map(U=>o.jsx("option",{value:U.id,children:U.title},U.id))]})]}),o.jsx("button",{onClick:O,className:"w-6 h-6 flex items-center justify-center text-life-muted hover:text-life-hard hover:bg-life-hard/10 rounded transition-colors",title:"Delete",children:o.jsx(Nn,{size:12})})]})}),J.length>0&&o.jsx("div",{className:"space-y-1",children:J.map(U=>o.jsxs("div",{onClick:Y=>{Y.stopPropagation(),r.toggleSubtask(n.id,U.id)},className:"flex items-center gap-2 text-xs cursor-pointer hover:bg-life-muted/10 p-1.5 rounded transition-colors group/sub",children:[o.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center transition-colors ${U.isCompleted?"bg-life-gold border-life-gold text-life-black":"border-life-muted text-transparent group-hover/sub:border-life-gold"}`,children:o.jsx(gt,{size:12,strokeWidth:3})}),o.jsx("span",{className:U.isCompleted?"text-life-muted line-through":"text-life-text",children:U.title})]},U.id))})]})]})},TL=["S","M","T","W","T","F","S"],SL=()=>{const{habitState:n}=ei(),{taskState:e,taskDispatch:t}=Zn(),{dispatch:i}=Ve(),[r,l]=K.useState(new Date),[c,d]=K.useState(new Date),p=r.getFullYear(),h=r.getMonth(),x=new Date(p,h+1,0).getDate(),b=new Date(p,h,1).getDay(),T=()=>{l(new Date(p,h-1,1)),Ce("click",!0)},S=()=>{l(new Date(p,h+1,1)),Ce("click",!0)},E=M=>{const J=new Date(p,h,M);d(J),Ce("click",!0)},D=M=>{const J=M.toISOString(),H=J.split("T")[0],z=n.habits.filter(C=>{const A=new Date(C.createdAt);return M<A&&M.getDate()!==A.getDate()?!1:vl(C,J)}).map(C=>({id:C.id,title:C.title,type:"habit",isCompleted:C.history.some(A=>A.startsWith(H)),stat:C.stat})),R=e.tasks.filter(C=>{if(!C.deadline&&!C.scheduledTime)return!1;const A=C.scheduledTime?new Date(C.scheduledTime):new Date(C.deadline);return A.getDate()===M.getDate()&&A.getMonth()===M.getMonth()&&A.getFullYear()===M.getFullYear()}).map(C=>({id:C.id,title:C.title,type:"task",isCompleted:C.isCompleted,stat:C.stat}));return[...z,...R]},k=K.useMemo(()=>D(c),[c,n.habits,e.tasks]),F=M=>{const J=new Date(p,h,M);return D(J).length>0},$=()=>{const J=new Date(c.getTime()-c.getTimezoneOffset()*6e4).toISOString().split("T")[0];i.setModal("addTask",{defaultType:"mission",date:J,origin:"calendar"})};return o.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right duration-500",children:[o.jsxs("div",{className:"bg-life-paper border border-zinc-800 rounded-2xl p-4 shadow-lg",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsx("button",{onClick:T,className:"p-2 hover:bg-life-muted/10 rounded-full text-life-muted hover:text-white transition-colors",children:o.jsx(mN,{size:18})}),o.jsx("h3",{className:"text-sm font-black text-life-text uppercase tracking-widest",children:r.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),o.jsx("button",{onClick:S,className:"p-2 hover:bg-life-muted/10 rounded-full text-life-muted hover:text-white transition-colors",children:o.jsx(Bt,{size:18})})]}),o.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:TL.map((M,J)=>o.jsx("div",{className:"text-center text-[9px] font-bold text-life-muted/50 py-1",children:M},J))}),o.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[Array.from({length:b}).map((M,J)=>o.jsx("div",{className:"aspect-square"},`empty-${J}`)),Array.from({length:x}).map((M,J)=>{const H=J+1,z=new Date(p,h,H),R=z.toDateString()===c.toDateString(),C=z.toDateString()===new Date().toDateString(),A=F(H);return o.jsxs("button",{onClick:()=>E(H),className:`
                                    aspect-square rounded-lg flex flex-col items-center justify-center relative transition-all duration-200
                                    ${R?"bg-life-gold text-life-black font-black shadow-[0_0_15px_rgba(251,191,36,0.4)] scale-110 z-10":"hover:bg-life-muted/10 text-life-text"}
                                    ${C&&!R?"border border-life-gold/50 text-life-gold":""}
                                `,children:[o.jsx("span",{className:"text-xs",children:H}),A&&o.jsx("div",{className:`w-1 h-1 rounded-full mt-1 ${R?"bg-black":"bg-life-muted"}`})]},H)})]})]}),o.jsxs("div",{className:"bg-life-black border border-zinc-800 rounded-2xl p-0 overflow-hidden shadow-lg min-h-[200px] flex flex-col",children:[o.jsxs("div",{className:"p-4 border-b border-zinc-800 flex justify-between items-center bg-life-paper/50",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"text-xs font-black uppercase text-life-muted tracking-widest",children:"Tactical Log"}),o.jsx("p",{className:"text-sm font-bold text-life-text mt-0.5",children:c.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric"})})]}),o.jsx("button",{onClick:$,className:"bg-life-gold/10 hover:bg-life-gold/20 text-life-gold border border-life-gold/30 p-2 rounded-lg transition-all",title:"Add Mission for this Day",children:o.jsx(nn,{size:16})})]}),o.jsx("div",{className:"p-2 flex-1 overflow-y-auto max-h-[300px]",children:k.length>0?o.jsx("div",{className:"space-y-1",children:k.map((M,J)=>o.jsxs("div",{className:`
                                        flex items-center gap-3 p-3 rounded-xl border transition-all
                                        ${M.isCompleted?"bg-life-black border-zinc-800 opacity-50":"bg-life-paper border-zinc-800 hover:border-life-gold/30"}
                                    `,children:[o.jsx("div",{className:`
                                        w-8 h-8 rounded-full flex items-center justify-center border-2
                                        ${M.isCompleted?"bg-life-muted border-life-muted text-life-black":M.type==="habit"?"border-life-gold/30 text-life-gold bg-life-gold/5":"border-life-muted/30 text-life-muted"}
                                    `,children:M.type==="habit"?o.jsx(is,{size:14}):o.jsx(ua,{size:14})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:`text-xs font-bold ${M.isCompleted?"line-through text-life-muted":"text-life-text"}`,children:M.title}),o.jsxs("div",{className:"text-[9px] text-life-muted uppercase tracking-wider flex items-center gap-1",children:[M.type==="habit"?"Protocol":"Mission","  ",M.stat]})]}),M.type==="task"&&!M.isCompleted&&o.jsx("button",{onClick:()=>t.toggleTask(M.id),className:"w-6 h-6 rounded border border-life-muted/30 hover:border-life-gold hover:text-life-gold flex items-center justify-center transition-colors",children:o.jsx(L4,{size:14})}),M.isCompleted&&o.jsx(Os,{size:14,className:"text-life-muted"})]},`${M.type}-${M.id}-${J}`))}):o.jsxs("div",{className:"flex flex-col items-center justify-center h-32 text-life-muted/40",children:[o.jsx(Wn,{size:32,className:"mb-2 opacity-50"}),o.jsx("p",{className:"text-[10px] uppercase font-bold tracking-widest",children:"No orders for this sector"})]})})]})]})},wL=()=>{const{habitState:n,habitDispatch:e}=ei(),{state:t,dispatch:i}=Ve(),{habits:r,categories:l}=n,c=t.ui.habitsViewMode,[d,p]=K.useState(!1),[h,x]=K.useState(()=>localStorage.getItem("LIFE_OS_LOG_OPEN")==="true");K.useEffect(()=>{localStorage.setItem("LIFE_OS_LOG_OPEN",String(h))},[h]);const[b,T]=K.useState(""),[S,E]=K.useState(!1),[D,k]=K.useState(null),[F,$]=K.useState(""),M=[],J=[],H=[];r.forEach(q=>{if(q.status!=="pending"){H.push(q);return}vl(q)?M.push(q):J.push(q)});const z=new Date;z.setDate(z.getDate()-1);const R=z.toISOString(),C=R.split("T")[0],A=r.filter(q=>{const le=new Date(q.createdAt);return le>z&&le.getDate()!==z.getDate()?!1:vl(q,R)}).map(q=>{const U=q.history.some(Y=>Y.startsWith(C))?"completed":"failed";return{...q,id:`log_yesterday_${q.id}`,status:U,shieldUsed:!1}}),P=q=>{q.preventDefault(),b.trim()&&(e.addCategory(b),T(""),E(!1))},L=q=>{F.trim()&&(e.renameCategory(q,F),k(null))},O=q=>{r.some(U=>U.categoryId===q)?i.setModal("confirmation",{title:"Delete Section?",message:"This section contains protocols. They will be moved to Uncategorized.",confirmText:"Delete Section",isDangerous:!0,onConfirm:()=>e.deleteCategory(q)}):e.deleteCategory(q)},j=q=>{i.setModal("confirmation",{title:"Delete Protocol?",message:"This action is permanent.",confirmText:"Delete",isDangerous:!0,onConfirm:()=>e.deleteHabit(q)})};return o.jsxs("div",{className:"pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[o.jsx("div",{className:"flex items-end justify-between mb-6 px-1",children:o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-black text-life-text tracking-tight flex items-center gap-2 uppercase",children:c==="calendar"?"Tactical Planner":"Habit Engine"}),o.jsx("p",{className:"text-xs text-life-muted uppercase tracking-widest mt-1",children:c==="calendar"?"Long-term Strategy":`Execution Mode  ${M.length} Remaining`})]})}),c==="calendar"?o.jsx(SL,{}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"mb-4 flex justify-end",children:S?o.jsxs("form",{onSubmit:P,className:"flex gap-2 animate-in fade-in",children:[o.jsx("input",{type:"text",value:b,onChange:q=>T(q.target.value),placeholder:"Section Title...",autoFocus:!0,className:"bg-life-black border border-zinc-800 rounded-lg px-3 py-1 text-xs text-life-text focus:border-life-gold outline-none"}),o.jsx("button",{type:"submit",className:"text-life-gold hover:bg-life-gold/10 p-1 rounded",children:o.jsx(nn,{size:16})}),o.jsx("button",{type:"button",onClick:()=>E(!1),className:"text-life-muted hover:text-white p-1",children:o.jsx(nn,{size:16,className:"rotate-45"})})]}):o.jsxs("button",{onClick:()=>E(!0),className:"text-[10px] uppercase font-bold text-life-muted hover:text-life-gold flex items-center gap-1 transition-colors",children:[o.jsx(yN,{size:14})," Add Section"]})}),o.jsxs("div",{className:"space-y-4 mb-8",children:[l.map(q=>{const le=M.filter(U=>U.categoryId===q.id);return o.jsxs("div",{className:"animate-in slide-in-from-bottom-2",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2 group relative",children:[D===q.id?o.jsx("div",{className:"flex gap-2 w-full",children:o.jsx("input",{type:"text",value:F,onChange:U=>$(U.target.value),className:"bg-life-black border border-zinc-800 rounded px-2 py-0.5 text-xs text-life-text w-full focus:border-life-gold outline-none",autoFocus:!0,onBlur:()=>L(q.id),onKeyDown:U=>U.key==="Enter"&&L(q.id)})}):o.jsxs("button",{onClick:()=>e.toggleCategory(q.id),className:"flex items-center gap-2 text-life-muted hover:text-life-text transition-colors flex-1 text-left py-1",children:[o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-life-gold/80",children:q.isCollapsed?o.jsx(Bt,{size:12}):o.jsx(Xn,{size:12})}),o.jsx("span",{className:"text-xs font-bold uppercase tracking-wider",children:q.title}),o.jsx("span",{className:"text-[9px] bg-life-muted/10 px-1.5 rounded-full text-life-muted",children:le.length})]}),o.jsxs("div",{className:"flex items-center gap-1 opacity-100 sm:opacity-0 sm:group-hover:opacity-100 transition-opacity z-10",children:[o.jsx("button",{onClick:U=>{U.stopPropagation(),k(q.id),$(q.title)},className:"p-2 text-life-muted hover:text-white hover:bg-life-muted/10 rounded cursor-pointer",title:"Edit Name",children:o.jsx(xx,{size:14})}),o.jsx("button",{onClick:U=>{U.stopPropagation(),O(q.id)},className:"p-2 text-life-muted hover:text-life-hard hover:bg-life-hard/10 rounded cursor-pointer",title:"Delete Section",children:o.jsx(CN,{size:14})})]})]}),!q.isCollapsed&&o.jsxs("div",{className:"space-y-1 pl-1",children:[le.map(U=>o.jsx($c,{habit:U,onProcess:e.processHabit,onDelete:j},U.id)),le.length===0&&o.jsx("div",{className:"text-[10px] text-life-muted/40 italic pl-2 py-1",children:"No active protocols in section."})]})]},q.id)}),M.filter(q=>!q.categoryId).length>0&&o.jsxs("div",{className:"animate-in slide-in-from-bottom-2",children:[o.jsx("div",{className:"flex items-center gap-2 mb-2 text-life-muted/50 px-1",children:o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"General / Uncategorized"})}),o.jsx("div",{className:"space-y-1",children:M.filter(q=>!q.categoryId).map(q=>o.jsx($c,{habit:q,onProcess:e.processHabit,onDelete:j},q.id))})]}),M.length===0&&l.length===0&&o.jsxs("div",{className:"py-8 text-center border-2 border-dashed border-zinc-800 rounded-xl bg-life-paper/50",children:[o.jsx("p",{className:"text-life-muted text-sm font-medium",children:"All protocols executed."}),o.jsx("p",{className:"text-[10px] text-life-muted/60 mt-1",children:"Check the Daily Log."})]})]}),(H.length>0||A.length>0)&&o.jsxs("div",{className:"animate-in slide-in-from-bottom-2 fade-in mb-4",children:[o.jsxs("button",{onClick:()=>x(!h),className:"w-full flex items-center justify-between p-3 rounded-lg border border-zinc-800 bg-life-paper hover:bg-life-muted/5 transition-all mb-3 group shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Tu,{size:16,className:"text-life-gold group-hover:scale-110 transition-transform"}),o.jsxs("span",{className:"text-xs font-bold text-life-text uppercase tracking-widest",children:["Activity Log (",H.length+A.length,")"]})]}),o.jsx("div",{className:"text-life-muted",children:h?o.jsx(Xi,{size:16}):o.jsx(Xn,{size:16})})]}),h&&o.jsxs("div",{className:"space-y-4 opacity-90 pb-4",children:[A.length>0&&o.jsxs("div",{className:"animate-in slide-in-from-top-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 px-1 text-life-muted/60",children:[o.jsx(Wn,{size:12}),o.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest",children:"Yesterday's Report"})]}),o.jsx("div",{className:"space-y-1",children:A.map(q=>o.jsx("div",{className:"scale-95 origin-top opacity-80 hover:opacity-100 transition-opacity",children:o.jsx($c,{habit:q,onProcess:()=>{},onDelete:()=>{}})},q.id))})]}),H.length>0&&o.jsxs("div",{className:"animate-in slide-in-from-top-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 px-1 text-life-muted/60",children:[o.jsx(ln,{size:12}),o.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest",children:"Today's Activity"})]}),o.jsx("div",{className:"space-y-1",children:H.map(q=>o.jsx("div",{className:"scale-95 origin-top",children:o.jsx($c,{habit:q,onProcess:e.processHabit,onDelete:j})},q.id))})]})]})]}),J.length>0&&o.jsxs("div",{className:"animate-in slide-in-from-bottom-2 fade-in",children:[o.jsxs("button",{onClick:()=>p(!d),className:"w-full flex items-center justify-between p-3 rounded-lg border border-zinc-800 bg-life-black hover:bg-life-muted/5 transition-all mb-3 group",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(gx,{size:16,className:"text-life-muted group-hover:text-life-gold transition-colors"}),o.jsxs("span",{className:"text-xs font-bold text-life-muted uppercase tracking-widest",children:["Sleep Archive (",J.length,")"]})]}),o.jsx("div",{className:"text-life-muted",children:d?o.jsx(Xi,{size:16}):o.jsx(Xn,{size:16})})]}),d&&o.jsxs("div",{className:"space-y-1 opacity-70 hover:opacity-100 transition-opacity",children:[J.map(q=>o.jsx("div",{className:"scale-95 origin-top",children:o.jsx($c,{habit:q,onProcess:e.processHabit,onDelete:j})},q.id)),o.jsx("div",{className:"text-center py-2",children:o.jsx("p",{className:"text-[9px] text-life-muted uppercase tracking-widest",children:"Recovery Mode  No Streak Penalty"})})]})]})]})]})},_f=({stat:n,size:e=14})=>{switch(n){case te.STR:return o.jsx(Qn,{size:e});case te.INT:return o.jsx(tn,{size:e});case te.DIS:return o.jsx(dt,{size:e});case te.HEA:return o.jsx(gi,{size:e});case te.CRT:return o.jsx(kn,{size:e});case te.SPR:return o.jsx(Mi,{size:e});case te.REL:return o.jsx(mo,{size:e});case te.FIN:return o.jsx(pi,{size:e});default:return o.jsx(Lt,{size:e})}},Eg=({raid:n,onToggleStep:e})=>{const{dispatch:t}=Ve(),[i,r]=K.useState(!1),{skillState:l}=sn(),[c,d]=K.useState(!1),[p,h]=K.useState(new Set),x=n.skillId?l.skills.find(M=>M.id===n.skillId):null;let b=!1,T="";if(n.requirements){const M=l.skills.find(J=>J.id===n.requirements.skillId);M&&M.level<n.requirements.minLevel?(b=!0,T=`Rec: ${M.title} Lv.${n.requirements.minLevel}`):M||(b=!0,T=`Req: Lv.${n.requirements.minLevel}`)}const S=n.stats&&n.stats.length>0?n.stats[0]:te.STR,E=ut[S],D=M=>{M.stopPropagation(),t.setModal("itemDetails",{itemId:n.id,type:"raid"})},k=(M,J)=>{M.stopPropagation(),t.setModal("itemDetails",{itemId:J,parentId:n.id,type:"raid_step"})},F=M=>{h(J=>{const H=new Set(J);return H.has(M)?H.delete(M):H.add(M),H})},$=M=>{M.stopPropagation();const J=n.steps.filter(z=>p.has(z.id));if(J.length===0)return;const H={context:"UPDATE_RAID_STEPS",raidId:n.id,raidTitle:n.title,selectedSteps:J.map(z=>({id:z.id,title:z.title,notes:z.notes,difficulty:z.difficulty,stat:z.stat})),instruction:'Update these steps with more details, better notes, or adjust difficulty/stats. CRITICAL: Preserve all IDs. Return valid JSON: { "raids": [{ "id": "...", "steps": [...] }] }'};navigator.clipboard.writeText(JSON.stringify(H,null,2)),t.addToast(`${p.size} Steps Copied for AI`,"info"),d(!1),h(new Set)};return o.jsxs("div",{className:`mb-4 bg-life-paper border rounded-xl overflow-hidden shadow-lg relative transition-all ${b?"border-orange-500/30":"border-zinc-800"}`,children:[o.jsxs("div",{onClick:()=>r(!i),className:"p-4 bg-life-paper relative cursor-pointer active:bg-life-muted/5 transition-colors group",children:[o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-life-muted/20",children:o.jsx("div",{className:"h-full transition-all duration-700 ease-out",style:{width:`${n.progress}%`,backgroundColor:E}})}),o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-12 h-12 rounded-lg border-2 flex flex-col items-center justify-center bg-life-black ${ui[n.difficulty]}`,style:{borderColor:E},children:o.jsx("div",{className:"flex flex-wrap items-center justify-center gap-0.5 p-0.5",children:(n.stats||[]).slice(0,4).map(M=>o.jsx("div",{style:{color:ut[M]},children:o.jsx(_f,{stat:M,size:10})},M))})}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("h3",{className:"font-bold text-base text-life-text leading-tight",children:n.title}),n.isCampaign&&o.jsxs("span",{className:"text-[8px] font-black px-1.5 py-0.5 rounded border border-indigo-500/50 bg-indigo-500/10 text-indigo-300 flex items-center gap-1 uppercase tracking-wider shadow-[0_0_5px_rgba(99,102,241,0.2)]",children:[o.jsx(is,{size:8})," G12"]}),x&&o.jsxs("span",{className:"text-[8px] border px-1.5 py-px rounded flex items-center gap-1 uppercase tracking-wider text-life-gold border-life-gold/30 bg-life-gold/10",children:[o.jsx(hi,{size:8})," ",x.title]}),x&&x.relatedStats&&x.relatedStats.length>0?x.relatedStats.map(M=>o.jsxs("span",{className:"text-[8px] font-black px-1.5 py-0.5 rounded border border-zinc-800 bg-life-black text-life-muted flex items-center gap-1 uppercase tracking-wider",style:{color:ut[M],borderColor:`${ut[M]}40`},children:[o.jsx(_f,{stat:M,size:8})," ",M]},M)):o.jsxs("span",{className:"text-[8px] font-black px-1.5 py-0.5 rounded border border-zinc-800 bg-life-black text-life-muted flex items-center gap-1 uppercase tracking-wider",style:{color:E,borderColor:`${E}40`},children:[o.jsx(_f,{stat:S,size:8})," ",S]})]}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("span",{className:"text-[10px] font-mono text-life-muted bg-life-muted/10 px-1.5 rounded",children:n.difficulty.toUpperCase()}),n.deadline&&o.jsxs("span",{className:"text-[10px] font-mono text-life-muted flex items-center gap-1",children:[o.jsx(Wn,{size:10})," ",new Date(n.deadline).toLocaleDateString(void 0,{month:"short",day:"numeric"})]}),b&&o.jsxs("span",{className:"text-[9px] font-bold text-orange-400 flex items-center gap-1 bg-orange-400/10 px-1.5 rounded border border-orange-400/20",children:[o.jsx(hr,{size:10})," ",T]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-life-muted",children:[o.jsx("button",{onClick:M=>{M.stopPropagation(),d(!c),r(!0)},className:`p-1.5 rounded-full transition-all ${c?"bg-life-gold text-black":"hover:bg-life-muted/10 text-life-muted"}`,title:"Select Steps for AI Update",children:o.jsx(ns,{size:16})}),o.jsx("button",{onClick:D,className:"p-1.5 rounded-full hover:bg-life-muted/10 opacity-0 group-hover:opacity-100 transition-all",children:o.jsx(Su,{size:16})}),i?o.jsx(Xi,{size:20}):o.jsx(Xn,{size:20})]})]})]}),i&&o.jsxs("div",{className:"bg-black/20 border-t border-life-muted/10 p-2",children:[c&&o.jsxs("div",{className:"flex justify-between items-center mb-2 px-2 animate-in slide-in-from-top-2",children:[o.jsxs("span",{className:"text-[10px] font-bold text-life-gold uppercase tracking-widest",children:[p.size," Selected"]}),o.jsxs("button",{onClick:$,disabled:p.size===0,className:"flex items-center gap-1 bg-life-gold text-black px-3 py-1 rounded text-[10px] font-black uppercase hover:bg-yellow-400 disabled:opacity-50 disabled:cursor-not-allowed",children:[o.jsx(mi,{size:10})," Copy for AI"]})]}),o.jsx("div",{className:"space-y-1",children:n.steps.map(M=>{var C;const J=M.difficulty&&M.difficulty!==n.difficulty,H=M.stat&&M.stat!==S,z=p.has(M.id);let R=E;return J&&(M.difficulty==="easy"?R="#10b981":M.difficulty==="normal"?R="#3b82f6":M.difficulty==="hard"&&(R="#ef4444")),o.jsxs("div",{className:"group flex gap-2 items-center",children:[c&&o.jsx("button",{onClick:()=>F(M.id),className:`shrink-0 transition-all ${z?"text-life-gold":"text-life-muted/30 hover:text-life-muted"}`,children:z?o.jsx(ns,{size:18}):o.jsx(b3,{size:18})}),o.jsx("div",{className:`
                                    w-full flex items-center justify-between p-3 rounded-lg text-left transition-all
                                    ${M.isCompleted?"bg-life-easy/5 text-life-muted line-through opacity-70":M.isLocked?"bg-transparent text-life-muted/30":"bg-life-paper hover:bg-life-muted/10 text-life-text border-l-2"}
                                `,style:{borderLeftColor:!M.isLocked&&!M.isCompleted?R:"transparent"},children:o.jsxs("div",{className:"flex items-center gap-3 flex-1 cursor-pointer",onClick:()=>!c&&k({stopPropagation:()=>{}},M.id),children:[!c&&o.jsxs("button",{disabled:M.isLocked,onClick:A=>{A.stopPropagation(),e(n.id,M.id)},className:`
                                                w-5 h-5 rounded border flex items-center justify-center transition-all shrink-0
                                                ${M.isCompleted?"bg-life-easy border-life-easy text-life-black":M.isLocked?"border-zinc-800 bg-life-muted/5 cursor-not-allowed":"border-life-muted text-transparent hover:border-life-gold"}
                                            `,children:[M.isCompleted&&o.jsx(gt,{size:14,strokeWidth:3}),M.isLocked&&!M.isCompleted&&o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-life-muted/30"})]}),o.jsx("div",{className:"flex flex-col flex-1 min-w-0",children:o.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[o.jsx("span",{className:"text-xs font-medium truncate",children:M.title}),J&&o.jsx("span",{className:`text-[7px] font-black px-1 rounded border uppercase tracking-tighter ${M.difficulty==="easy"?"border-life-easy text-life-easy bg-life-easy/5":M.difficulty==="normal"?"border-blue-500 text-blue-400 bg-blue-500/5":"border-life-hard text-life-hard bg-life-hard/5"}`,children:(C=M.difficulty)==null?void 0:C.substring(0,3)}),H&&o.jsxs("span",{className:"text-[7px] font-black px-1 rounded border border-zinc-800 bg-life-black flex items-center gap-0.5 uppercase tracking-tighter",style:{color:ut[M.stat],borderColor:`${ut[M.stat]}40`},children:[o.jsx(_f,{stat:M.stat,size:6})," ",M.stat]})]})}),!c&&o.jsx("button",{onClick:A=>k(A,M.id),className:"p-1 rounded-full text-life-muted hover:text-life-gold transition-colors",children:M.notes?o.jsx(Ol,{size:12,className:"text-life-gold"}):o.jsx(Su,{size:12})})]})})]},M.id)})})]})]})},EL=({onClose:n})=>o.jsxs("div",{className:"bg-life-black border border-life-muted/20 rounded-xl p-4 mb-6 animate-in fade-in slide-in-from-top-2",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-2 bg-indigo-900/20 rounded-lg text-indigo-400",children:o.jsx(hi,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-bold text-life-text uppercase tracking-wider",children:"Field Manual: Operations"}),o.jsx("p",{className:"text-[10px] text-life-muted",children:"Tactical Guide & AI Uplink"})]})]}),o.jsx("button",{onClick:n,className:"text-life-muted hover:text-white",children:o.jsx(et,{size:16})})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-[1fr_2fr] gap-3 items-start border-b border-zinc-800 pb-3",children:[o.jsxs("div",{className:"text-right pr-2 border-r border-zinc-800",children:[o.jsx("div",{className:"text-life-gold font-black text-xs",children:"Structure"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Raid Anatomy"})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("p",{className:"text-[10px] text-zinc-400 leading-relaxed",children:[o.jsx("span",{className:"text-white font-bold",children:"Raids"})," are multi-step projects. Each step is a tactical objective."]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-1",children:[o.jsxs("div",{className:"bg-life-black p-1.5 rounded border border-zinc-800 text-[9px] text-zinc-500",children:[o.jsx("span",{className:"text-life-easy font-bold",children:"Easy:"})," +100 XP"]}),o.jsxs("div",{className:"bg-life-black p-1.5 rounded border border-zinc-800 text-[9px] text-zinc-500",children:[o.jsx("span",{className:"text-life-hard font-bold",children:"Hard:"})," +500 XP"]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_2fr] gap-3 items-start border-b border-zinc-800 pb-3",children:[o.jsxs("div",{className:"text-right pr-2 border-r border-zinc-800",children:[o.jsx("div",{className:"text-indigo-400 font-black text-xs",children:"AI Uplink"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Update Steps"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("p",{className:"text-[10px] text-zinc-400 leading-relaxed",children:"You can ask AI to refine specific steps without rewriting the whole Raid."}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-zinc-300",children:[o.jsx("span",{className:"bg-life-muted/20 p-1 rounded text-life-gold",children:o.jsx(ns,{size:10})}),o.jsxs("span",{children:["1. Click ",o.jsx("span",{className:"text-life-gold font-bold",children:"Select Mode"})," on Raid Card."]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-zinc-300",children:[o.jsx("span",{className:"bg-life-muted/20 p-1 rounded text-life-gold",children:o.jsx(ns,{size:10})}),o.jsx("span",{children:"2. Select the steps you want to improve."})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-zinc-300",children:[o.jsx("span",{className:"bg-life-muted/20 p-1 rounded text-life-gold",children:o.jsx(mi,{size:10})}),o.jsxs("span",{children:["3. Click ",o.jsx("span",{className:"text-life-gold font-bold",children:"Copy for AI"}),"."]})]}),o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-zinc-300",children:[o.jsx("span",{className:"bg-life-muted/20 p-1 rounded text-life-gold",children:o.jsx(dt,{size:10})}),o.jsxs("span",{children:["4. Paste into AI, then paste result into ",o.jsx("span",{className:"text-life-gold font-bold",children:"Data Uplink"}),"."]})]})]}),o.jsx("div",{className:"p-2 bg-indigo-900/10 border border-indigo-500/20 rounded text-[9px] text-indigo-300 italic",children:'"The system will intelligently merge the new details into your existing progress."'})]})]}),o.jsxs("div",{className:"grid grid-cols-[1fr_2fr] gap-3 items-center",children:[o.jsxs("div",{className:"text-right pr-2 border-r border-zinc-800",children:[o.jsx("div",{className:"text-purple-400 font-black text-xs",children:"Victory"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Completion"})]}),o.jsx("div",{className:"space-y-1",children:o.jsxs("div",{className:"text-[10px] text-zinc-400 leading-relaxed",children:["Completing a Raid grants a massive ",o.jsx("span",{className:"text-life-gold font-bold",children:"5x Bonus"})," to XP and Gold."]})})]})]})]}),NL=()=>{const{raidState:n,raidDispatch:e}=ss(),{raids:t}=n,[i,r]=K.useState(!1),[l,c]=K.useState(!1),[d,p]=K.useState(!1),h=t.filter(T=>T.status==="active"),x=t.filter(T=>T.status==="completed"),b=t.filter(T=>T.status==="archived");return o.jsxs("div",{className:"pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[o.jsxs("div",{className:"flex items-end justify-between mb-6 px-1",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("h2",{className:"text-2xl font-black text-life-text tracking-tight uppercase",children:"Active Operations"}),o.jsx("button",{onClick:()=>p(!d),className:"text-life-muted hover:text-life-gold transition-colors p-1",title:"Field Manual",children:o.jsx(hi,{size:16})})]}),o.jsxs("p",{className:"text-xs text-life-muted uppercase tracking-widest mt-1",children:[h.length," Strategic Objectives In-Progress"]})]}),o.jsx("div",{className:"text-life-hard opacity-50",children:o.jsx(dt,{size:24})})]}),d&&o.jsx(EL,{onClose:()=>p(!1)}),o.jsx("div",{className:"space-y-4",children:h.length>0?h.map(T=>o.jsxs("div",{className:"relative group",children:[o.jsx(Eg,{raid:T,onToggleStep:e.toggleRaidStep}),o.jsxs("div",{className:"absolute -right-2 -top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[o.jsx("button",{onClick:()=>e.archiveRaid(T.id),className:"bg-life-black border border-zinc-800 text-life-muted hover:text-life-text p-1.5 rounded-full shadow-sm hover:scale-110 transition-transform",title:"Archive Operation",children:o.jsx(Tu,{size:12})}),o.jsx("button",{onClick:()=>e.deleteRaid(T.id),className:"bg-life-black border border-zinc-800 text-life-muted hover:text-life-hard p-1.5 rounded-full shadow-sm hover:scale-110 transition-transform",title:"Abort / Delete Operation",children:o.jsx(Nn,{size:12})})]})]},T.id)):o.jsxs("div",{className:"py-12 text-center border-2 border-dashed border-zinc-800 rounded-xl bg-life-paper/30",children:[o.jsx("p",{className:"text-life-muted text-sm font-bold",children:"No Active Operations"}),o.jsx("p",{className:"text-[10px] text-life-muted/60 mt-1 uppercase tracking-wider",children:"Initiate a new Raid via Command Line (+)."})]})}),b.length>0&&o.jsxs("div",{className:"mt-8",children:[o.jsxs("button",{onClick:()=>c(!l),className:"w-full flex items-center justify-between p-3 rounded-xl border border-zinc-800 bg-life-black hover:bg-life-muted/5 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-life-muted/10 text-life-muted group-hover:text-life-text transition-colors",children:o.jsx(mx,{size:16})}),o.jsxs("div",{className:"text-left",children:[o.jsx("h3",{className:"text-xs font-black text-life-muted uppercase tracking-widest group-hover:text-life-text transition-colors",children:"Declassified Ops (Archive)"}),o.jsxs("p",{className:"text-[9px] text-life-muted/60 uppercase tracking-wider",children:[b.length," Operations Stored"]})]})]}),o.jsx("div",{className:"text-life-muted/50",children:l?o.jsx(Xi,{size:18}):o.jsx(Xn,{size:18})})]}),l&&o.jsx("div",{className:"mt-4 space-y-4 animate-in slide-in-from-top-2",children:b.map(T=>o.jsxs("div",{className:"opacity-60 hover:opacity-100 transition-opacity grayscale relative group",children:[o.jsx(Eg,{raid:T,onToggleStep:()=>{}}),o.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 bg-life-black/80 backdrop-blur rounded-lg p-1 border border-zinc-800",children:[o.jsxs("button",{onClick:()=>e.restoreRaid(T.id),className:"flex items-center gap-1 px-2 py-1 rounded hover:bg-life-muted/20 text-[9px] font-bold text-life-gold uppercase",children:[o.jsx(JP,{size:10})," Restore"]}),o.jsx("div",{className:"w-px bg-life-muted/20"}),o.jsxs("button",{onClick:()=>e.deleteRaid(T.id),className:"flex items-center gap-1 px-2 py-1 rounded hover:bg-life-hard/20 text-[9px] font-bold text-life-hard uppercase",children:[o.jsx(Nn,{size:10})," Delete"]})]})]},T.id))})]}),x.length>0&&o.jsxs("div",{className:"mt-4 pt-4 border-t border-life-muted/10",children:[o.jsxs("button",{onClick:()=>r(!i),className:"w-full flex items-center justify-between p-3 rounded-xl bg-life-gold/5 border border-life-gold/10 hover:bg-life-gold/10 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 rounded-lg bg-life-gold/20 text-life-gold",children:o.jsx(Xh,{size:16})}),o.jsxs("div",{className:"text-left",children:[o.jsx("h3",{className:"text-xs font-black text-life-gold uppercase tracking-widest",children:"Victory Archive"}),o.jsxs("p",{className:"text-[9px] text-life-gold/60 uppercase tracking-wider",children:[x.length," Operations Conquered"]})]})]}),o.jsx("div",{className:"text-life-gold/50",children:i?o.jsx(Xi,{size:18}):o.jsx(Xn,{size:18})})]}),i&&o.jsx("div",{className:"mt-4 space-y-4 animate-in slide-in-from-top-2",children:x.map(T=>o.jsxs("div",{className:"opacity-70 hover:opacity-100 transition-opacity grayscale hover:grayscale-0 relative group",children:[o.jsx(Eg,{raid:T,onToggleStep:e.toggleRaidStep}),o.jsxs("div",{className:"absolute -right-2 -top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[o.jsx("button",{onClick:()=>e.archiveRaid(T.id),className:"bg-life-black border border-zinc-800 text-life-muted hover:text-life-text p-1.5 rounded-full shadow-sm",title:"Move to Archive",children:o.jsx(Tu,{size:12})}),o.jsx("button",{onClick:()=>e.deleteRaid(T.id),className:"bg-life-black border border-zinc-800 text-life-muted hover:text-life-hard p-1.5 rounded-full shadow-sm",title:"Delete Log",children:o.jsx(Nn,{size:12})})]})]},T.id))})]})]})},ON=[{id:"item_shield",title:"Streak Shield",description:"Prevents your streak from resetting if you miss a day.",cost:1e3,type:"system",icon:"Shield",isInfinite:!0}],UN=K.createContext(void 0),CL=n=>{const e=Array.isArray(n)?n:n.storeItems||[],t=new Set,i=[];for(const r of e)t.has(r.id)||(t.add(r.id),i.push(r));return{storeItems:i.length>0?i:ON}},kL=({children:n})=>{const{state:e,dispatch:t}=Ve(),{user:i}=e,r=i.preferences.soundEnabled,[l,c]=Ll("LIFE_OS_SHOP_DATA",{storeItems:ON},"shop_data",CL),{storeItems:d}=l;K.useEffect(()=>{c(S=>{const E=new Set,D=[];for(const k of S.storeItems)E.has(k.id)||(E.add(k.id),D.push(k));return D.length!==S.storeItems.length?(console.log(" ShopContext: Removed duplicate items."),{...S,storeItems:D}):S})},[]);const p=S=>{const E=d.find($=>$.id===S);if(!E)return!1;if(i.gold<E.cost)return Ce("error",r),t.addToast("Insufficient Funds","error"),!1;if(S==="item_shield"&&i.shields>=3)return t.addToast(" Max Shield Capacity (3) Reached","error"),Ce("error",r),!1;if((E.type==="system"||E.type==="artifact")&&!E.isInfinite&&i.inventory.includes(S))return t.addToast("Already Owned","error"),!1;const k={gold:i.gold-E.cost};if(S==="item_shield")k.shields=i.shields+1,t.addToast(`Shield Acquired! (${k.shields}/3)`,"info");else if(E.type==="redemption"){const{updatedLog:$,newAverage:M,redeemedDate:J}=Fk(i.honorDailyLog,e.ui.debugDate);if(!J)return t.addToast("Honor is already perfect.","info"),!1;k.honorDailyLog=$,k.honor=M,t.addToast(`Honor Restored for ${J} (+100%)`,"level-up"),Ce("level-up",r)}else if(E.type==="system"&&!E.isInfinite)if(k.inventory=[...i.inventory,S],S==="item_theme_gold"){const $={id:"gold",name:"Midas Touch",colors:{"--color-life-black":"#1a1200","--color-life-paper":"#261a00","--color-life-gold":"#ffd700","--color-life-text":"#fffae6"}};t.addTheme($),t.setTheme("gold"),t.addToast("Gold Theme Activated","success")}else if(S==="item_theme_cyberpunk"){const $={id:"cyberpunk",name:"Neon City",colors:{"--color-life-black":"#020617","--color-life-paper":"#0f172a","--color-life-gold":"#22d3ee","--color-life-text":"#e0f2fe"}};t.addTheme($),t.setTheme("cyberpunk"),t.addToast("Cyberpunk Protocol Activated","level-up")}else t.addToast(`Acquired: ${E.title}`,"success");else E.type==="artifact"?(k.inventory=[...i.inventory,S],t.addToast(`Artifact Acquired: ${E.title}`,"success"),setTimeout(()=>t.addToast("Equip it in Profile to activate.","info"),1500)):E.id==="item_potion_xp"?(k.inventory=[...i.inventory,S],t.addToast("Potion stored in Inventory","success")):E.id==="item_battery"?(k.shields=3,t.addToast("Shields Fully Recharged!","level-up")):(k.inventory=[...i.inventory,S],t.addToast(`Voucher Acquired: ${E.title}`,"success"));const F={id:`log_${Date.now()}`,itemId:E.id,title:E.title,cost:E.cost,timestamp:new Date().toISOString()};return k.purchaseHistory=[F,...i.purchaseHistory||[]].slice(0,50),t.updateUser(k),Ce("coin",r),E.isInfinite||c($=>({...$,storeItems:$.storeItems.filter(M=>M.id!==S)})),!0},h=S=>{c(E=>{const D=E.storeItems.findIndex(k=>k.id===S.id);if(D>=0){const k=[...E.storeItems];return k[D]=S,{...E,storeItems:k}}return E.storeItems.some(k=>k.title===S.title)?E:{...E,storeItems:[...E.storeItems,S]}}),Ce("click",r)},x=S=>{c(E=>{let D=[...E.storeItems];return S.forEach(k=>{const F=D.findIndex($=>$.id===k.id);F>=0?D[F]=k:D.some($=>$.title===k.title)||D.push(k)}),{...E,storeItems:D}}),Ce("level-up",r)},b=S=>{confirm("Remove this item from the market?")&&(c(E=>({...E,storeItems:E.storeItems.filter(D=>D.id!==S)})),Ce("delete",r))},T=S=>{c({storeItems:S}),t.addToast("Market Restored","success")};return o.jsx(UN.Provider,{value:{shopState:{storeItems:d},shopDispatch:{buyItem:p,addStoreItem:h,addStoreItems:x,deleteStoreItem:b,restoreData:T}},children:n})},Qh=()=>{const n=K.useContext(UN);if(n===void 0)throw new Error("useShop must be used within a ShopProvider");return n},AL=({icon:n,size:e=24})=>{switch(n){case"Shield":return o.jsx(Zi,{size:e});case"Flask":return o.jsx(xN,{size:e});case"Coffee":return o.jsx(gN,{size:e});case"Palette":return o.jsx(kn,{size:e});case"Burger":return o.jsx(O3,{size:e});case"Game":return o.jsx(iP,{size:e});default:return o.jsx(vx,{size:e})}},Tf=({item:n,canAfford:e,onBuy:t,onInfo:i})=>o.jsxs("div",{onClick:()=>i(n),className:`
        relative flex flex-col p-4 rounded-xl border bg-life-paper transition-all duration-300 group cursor-pointer
        ${e?"border-zinc-800 hover:border-life-gold/50 shadow-lg hover:shadow-life-gold/5":"border-zinc-800 opacity-60"}
    `,children:[o.jsxs("div",{className:"flex justify-between items-start mb-3",children:[o.jsx("div",{className:`p-3 rounded-lg border bg-life-black transition-colors ${e?"border-life-gold/20 text-life-gold":"border-zinc-800 text-life-muted"}`,children:o.jsx(AL,{icon:n.icon,size:24})}),o.jsxs("div",{className:`px-2 py-1 rounded text-xs font-mono font-bold border ${e?"bg-life-gold/10 text-life-gold border-life-gold/20":"bg-life-muted/10 text-life-muted border-zinc-800"}`,children:[n.cost," G"]})]}),o.jsx("h3",{className:"font-bold text-life-text mb-1 truncate",children:n.title}),o.jsx("p",{className:"text-xs text-life-muted leading-relaxed mb-4 flex-1 line-clamp-2",children:n.description}),o.jsx("button",{onClick:r=>{r.stopPropagation(),e&&t(n.id)},disabled:!e,className:`
            w-full py-2 rounded-lg text-xs font-bold uppercase tracking-wider transition-all active:scale-95
            ${e?"bg-life-gold text-life-black hover:bg-yellow-400 shadow-[0_0_10px_rgba(251,191,36,0.2)]":"bg-life-muted/10 text-life-muted cursor-not-allowed"}
        `,children:e?"Buy":"Locked"}),o.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 overflow-hidden pointer-events-none",children:o.jsx("div",{className:`absolute top-0 right-0 w-4 h-4 -mr-2 -mt-2 rotate-45 transform ${e?"bg-life-gold":"bg-life-muted"}`})})]}),_x=({icon:n,size:e=16})=>{switch(n){case"Shield":return o.jsx(Zi,{size:e});case"Flask":return o.jsx(xN,{size:e});case"Coffee":return o.jsx(gN,{size:e});case"Palette":return o.jsx(kn,{size:e});case"Burger":return o.jsx(Lt,{size:e});case"Gift":return o.jsx(_N,{size:e});case"Zap":return o.jsx(Lt,{size:e});case"Scroll":return o.jsx(n3,{size:e});default:return o.jsx(vx,{size:e})}},IL=()=>{const{state:n}=Ve(),{shopState:e,shopDispatch:t}=Qh(),{storeItems:i}=e,{user:r}=n,[l,c]=K.useState(!1),[d,p]=K.useState(""),[h,x]=K.useState(100),[b,T]=K.useState(null),[S,E]=K.useState([]),D=i.filter(H=>H.type==="system"),k=i.filter(H=>H.type==="artifact"),F=i.filter(H=>H.type==="redemption"),$=i.filter(H=>H.type==="custom"),M=(H,z)=>{if(t.buyItem(H)){const C=Array.from({length:12}).map((A,P)=>({id:Date.now()+P,x:z.clientX,y:z.clientY}));E(A=>[...A,...C])}};K.useEffect(()=>{if(S.length>0){const H=setTimeout(()=>E([]),1e3);return()=>clearTimeout(H)}},[S]);const J=H=>{if(H.preventDefault(),!d.trim()||h<0)return;const z={id:`cust_${Date.now()}`,title:d,description:"Custom User Reward",cost:Math.max(0,h),type:"custom",icon:"Gift",isInfinite:!0};t.addStoreItem(z),p(""),c(!1)};return o.jsxs("div",{className:"pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500 relative",children:[S.map(H=>o.jsx("div",{className:"fixed w-2 h-2 rounded-full animate-[particle_0.8s_ease-out_forwards] pointer-events-none z-[100]",style:{left:H.x,top:H.y,backgroundColor:["#fbbf24","#ffffff","#10b981"][Math.floor(Math.random()*3)],boxShadow:"0 0 10px currentColor","--tx":`${(Math.random()-.5)*200}px`,"--ty":`${(Math.random()-1)*200}px`}},H.id)),o.jsxs("div",{className:"flex items-end justify-between mb-6 px-1",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-black text-life-text tracking-tight flex items-center gap-2",children:"THE BAZAAR"}),o.jsx("p",{className:"text-xs text-life-muted uppercase tracking-widest mt-1",children:"Exchange Gold for Power & Pleasure"})]}),o.jsxs("div",{className:"flex items-center gap-2 text-life-gold bg-life-gold/5 px-3 py-1.5 rounded-lg border border-life-gold/20 shadow-[0_0_15px_rgba(251,191,36,0.1)]",children:[o.jsx(pi,{size:16,className:"text-life-gold"}),o.jsx("span",{className:"font-mono font-bold text-lg",children:r.gold})]})]}),o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4 text-life-muted px-1",children:[o.jsx(y4,{size:14}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"System Upgrades"})]}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:D.map(H=>o.jsx("div",{onClick:z=>{},children:o.jsx(Tf,{item:H,canAfford:r.gold>=H.cost,onBuy:z=>{const R={clientX:window.innerWidth/2,clientY:window.innerHeight/2};M(z,R)},onInfo:z=>T(z)})},H.id))})]}),k.length>0&&o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4 text-life-muted px-1",children:[o.jsx(Zi,{size:14}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Rare Artifacts"})]}),o.jsx("div",{className:"grid grid-cols-2 gap-3",children:k.map(H=>o.jsx("div",{children:o.jsx(Tf,{item:H,canAfford:r.gold>=H.cost,onBuy:z=>{const R={clientX:window.innerWidth/2,clientY:window.innerHeight/2};M(z,R)},onInfo:z=>T(z)})},H.id))})]}),o.jsxs("div",{className:"mb-8",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted",children:[o.jsx(_N,{size:14}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Real World Rewards"})]}),o.jsxs("button",{onClick:()=>c(!l),className:"text-[10px] flex items-center gap-1 text-life-gold hover:text-white uppercase font-bold",children:[o.jsx(nn,{size:12})," Add Custom"]})]}),l&&o.jsxs("form",{onSubmit:J,className:"mb-4 bg-life-black border border-zinc-800 p-3 rounded-lg flex gap-2 animate-in fade-in",children:[o.jsx("input",{type:"text",placeholder:"Reward Name...",value:d,onChange:H=>p(H.target.value),className:"flex-1 bg-transparent border-b border-zinc-800 text-xs text-white focus:outline-none focus:border-life-gold px-2",autoFocus:!0}),o.jsx("input",{type:"number",placeholder:"Cost",value:h,min:0,onChange:H=>x(Number(H.target.value)),className:"w-16 bg-transparent border-b border-zinc-800 text-xs text-white focus:outline-none focus:border-life-gold text-center"}),o.jsx("button",{type:"submit",className:"text-life-gold",children:o.jsx(nn,{size:16})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[F.map(H=>o.jsxs("div",{className:"relative group",children:[o.jsx(Tf,{item:H,canAfford:r.gold>=H.cost,onBuy:z=>{const R={clientX:window.innerWidth/2,clientY:window.innerHeight/2};M(z,R)},onInfo:z=>T(z)}),o.jsx("button",{onClick:()=>t.deleteStoreItem(H.id),className:"absolute -top-2 -right-2 bg-life-black border border-life-hard/30 text-life-hard p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx(et,{size:12})})]},H.id)),$.map(H=>o.jsxs("div",{className:"relative group",children:[o.jsx(Tf,{item:H,canAfford:r.gold>=H.cost,onBuy:z=>{const R={clientX:window.innerWidth/2,clientY:window.innerHeight/2};M(z,R)},onInfo:z=>T(z)}),o.jsx("button",{onClick:()=>t.deleteStoreItem(H.id),className:"absolute -top-2 -right-2 bg-life-black border border-life-hard/30 text-life-hard p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:o.jsx(et,{size:12})})]},H.id)),$.length===0&&F.length===0&&o.jsx("div",{className:"col-span-2 py-8 text-center border-2 border-dashed border-zinc-800 rounded-xl",children:o.jsx("p",{className:"text-[10px] text-life-muted",children:"No custom rewards defined."})})]})]}),o.jsxs("div",{className:"mt-8 pt-8 border-t border-zinc-800",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-4 text-life-muted px-1 opacity-60",children:[o.jsx(pP,{size:14}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Transaction Log (Last 100)"})]}),o.jsxs("div",{className:"space-y-1 opacity-70",children:[r.purchaseHistory.map(H=>{const z=H.title.includes("[XP]"),R=H.cost<0,C=Math.abs(H.cost),A=R?"+":"-";let P="text-life-gold";z?P="text-life-easy":R?P="text-green-400":P="text-red-400";const L=z?"XP":"G";return o.jsxs("div",{className:"flex justify-between items-center p-2 rounded bg-life-black border border-life-muted/10 text-[10px]",children:[o.jsx("span",{className:"text-life-text font-medium truncate flex-1 pr-2",children:H.title.replace("[XP] ","")}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:`${P} font-mono font-bold`,children:[A,C," ",L]}),o.jsx("span",{className:"text-life-muted opacity-50 text-[9px]",children:new Date(H.timestamp).toLocaleDateString()})]})]},H.id)}),r.purchaseHistory.length===0&&o.jsx("p",{className:"text-[10px] text-life-muted italic text-center",children:"No transaction data."})]})]}),b&&o.jsx("div",{onClick:()=>T(null),className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in",children:o.jsxs("div",{onClick:H=>H.stopPropagation(),className:"bg-life-paper w-full max-w-xs rounded-xl border border-zinc-800 p-5 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>T(null),className:"absolute top-3 right-3 text-life-muted hover:text-life-text",children:o.jsx(et,{size:20})}),o.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[o.jsx("div",{className:"w-20 h-20 rounded-full bg-life-black border border-zinc-800 flex items-center justify-center mb-3 text-life-gold shadow-inner",children:o.jsx(_x,{icon:b.icon,size:40})}),o.jsx("h3",{className:"font-black uppercase tracking-widest text-life-text",children:b.title}),o.jsxs("div",{className:"mt-2 flex items-center gap-2 justify-center",children:[o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded bg-life-muted/10 text-life-muted border border-zinc-800",children:b.type}),o.jsxs("span",{className:"text-[10px] font-bold uppercase tracking-wider px-2 py-0.5 rounded bg-life-gold/10 text-life-gold border border-life-gold/20",children:[b.cost," G"]})]}),o.jsx("p",{className:"text-xs text-life-muted mt-4 leading-relaxed",children:b.description}),b.effect&&o.jsxs("div",{className:"mt-4 w-full bg-life-black/50 p-3 rounded border border-zinc-800 text-left",children:[o.jsxs("h4",{className:"text-[9px] font-bold uppercase text-life-muted mb-1 flex items-center gap-1",children:[o.jsx(dt,{size:10})," Effect"]}),o.jsxs("p",{className:"text-[10px] text-life-text font-mono",children:[b.effect.type==="xp_boost"&&`+${b.effect.value*100}% XP Gain`,b.effect.type==="gold_boost"&&`+${b.effect.value*100}% Gold Gain`,b.effect.stat&&` (${b.effect.stat})`]})]})]}),o.jsx("button",{onClick:()=>{if(r.gold>=b.cost){const H={clientX:window.innerWidth/2,clientY:window.innerHeight/2};M(b.id,H),T(null)}},disabled:r.gold<b.cost,className:`
                        w-full py-3 font-black uppercase text-xs rounded-xl shadow-lg transition-all active:scale-95
                        ${r.gold>=b.cost?"bg-life-gold text-life-black hover:bg-yellow-400 shadow-life-gold/20":"bg-life-muted/10 text-life-muted cursor-not-allowed"}
                    `,children:r.gold>=b.cost?"Purchase Item":"Insufficient Funds"})]})}),o.jsx("style",{children:`
        @keyframes particle {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; }
        }
      `})]})},RL=[{id:"bdg_ascendant",name:"The Ascendant",icon:"",description:"Rise through the ranks of existence.",category:"progression",triggerType:"metric",metricKey:"level",levels:[{tier:"silver",target:5,quote:"You have awakened.",rewards:{xp:100,gold:50}},{tier:"gold",target:10,quote:"Power is not given, it is taken.",rewards:{xp:500,gold:200}},{tier:"diamond",target:25,quote:"You are no longer a spectator.",rewards:{xp:2e3,gold:1e3}},{tier:"crimson",target:50,quote:"Godhood is a lonely path.",rewards:{xp:1e4,gold:5e3}}]},{id:"bdg_grunt",name:"The Grunt",icon:"",description:"Complete missions of Easy difficulty.",category:"combat",triggerType:"metric",metricKey:`tasksByDifficulty.${Ge.EASY}`,levels:[{tier:"silver",target:10,quote:"Do the work. Don't complain.",rewards:{xp:50,gold:20}},{tier:"gold",target:50,quote:"Discipline is the bridge between goals and accomplishment.",rewards:{xp:200,gold:100}},{tier:"diamond",target:200,quote:"Routine is the weapon of the disciplined.",rewards:{xp:1e3,gold:500}},{tier:"crimson",target:500,quote:"The mundane has become your masterpiece.",rewards:{xp:5e3,gold:2e3}}]},{id:"bdg_warlord",name:"The Warlord",icon:"",description:"Complete missions of Hard difficulty.",category:"combat",triggerType:"metric",metricKey:`tasksByDifficulty.${Ge.HARD}`,levels:[{tier:"silver",target:5,quote:"Pain is weakness leaving the body.",rewards:{xp:200,gold:100}},{tier:"gold",target:25,quote:"Hardship is the forge of character.",rewards:{xp:1e3,gold:500}},{tier:"diamond",target:100,quote:"You do not survive the storm. You are the storm.",rewards:{xp:5e3,gold:2e3}},{tier:"crimson",target:250,quote:"Impossible is just an opinion.",rewards:{xp:2e4,gold:1e4}}]},{id:"bdg_conqueror",name:"The Conqueror",icon:"",description:"Total Operations (Raids) Conquered.",category:"warfare",triggerType:"metric",metricKey:"totalRaidsWon",levels:[{tier:"silver",target:1,quote:"First blood.",rewards:{xp:150,gold:100}},{tier:"gold",target:5,quote:"Strategy requires sacrifice.",rewards:{xp:750,gold:500}},{tier:"diamond",target:20,quote:"Kings play chess on a map of the world.",rewards:{xp:3e3,gold:2e3}},{tier:"crimson",target:50,quote:"History is written by the victors.",rewards:{xp:15e3,gold:1e4}}]},{id:"bdg_immortal",name:"The Immortal",icon:"",description:"Maintain a daily login streak.",category:"consistency",triggerType:"metric",metricKey:"highestStreak",levels:[{tier:"silver",target:7,quote:"Momentum is building.",rewards:{xp:100,gold:50}},{tier:"gold",target:30,quote:"Consistency is the only currency that matters.",rewards:{xp:500,gold:250}},{tier:"diamond",target:90,quote:"You have transcended motivation.",rewards:{xp:2e3,gold:1e3}},{tier:"crimson",target:365,quote:"Time bows to your will.",rewards:{xp:1e4,gold:5e3}}]},{id:"bdg_phoenix",name:"The Phoenix",icon:"",description:"Reset the system and start over.",category:"consistency",triggerType:"metric",metricKey:"resetsCount",levels:[{tier:"silver",target:1,quote:"From the ashes, we rise.",rewards:{xp:0,gold:500}},{tier:"gold",target:3,quote:"Failure is not the end.",rewards:{xp:0,gold:1e3}},{tier:"diamond",target:5,quote:"Destruction is a form of creation.",rewards:{xp:0,gold:3e3}},{tier:"crimson",target:10,quote:"You are eternal.",rewards:{xp:0,gold:1e4}}]},{id:"bdg_deep_focus",name:"Deep Worker",icon:"",description:'Maintain a streak on any "Deep Work" habit.',category:"special",triggerType:"habit",metricKey:"Deep Work",levels:[{tier:"silver",target:7,quote:"Focus is the new oil.",rewards:{xp:300,gold:150}},{tier:"gold",target:21,quote:"Distraction is the enemy of greatness.",rewards:{xp:1e3,gold:500}},{tier:"diamond",target:66,quote:"The mind is a laser.",rewards:{xp:5e3,gold:2500}},{tier:"crimson",target:100,quote:"Flow state is your home.",rewards:{xp:2e4,gold:1e4}}]},{id:"bdg_gold_hoarder",name:"Gold Hoarder",icon:"",description:"Total lifetime gold earned.",category:"economy",triggerType:"metric",metricKey:"totalGoldEarned",levels:[{tier:"silver",target:1e3,quote:"The first coin is the heaviest.",rewards:{xp:100,gold:100}},{tier:"gold",target:1e4,quote:"Wealth is a tool, not a master.",rewards:{xp:500,gold:500}},{tier:"diamond",target:1e5,quote:"You can buy armies.",rewards:{xp:2e3,gold:2e3}},{tier:"crimson",target:1e6,quote:"Midas touches you.",rewards:{xp:1e4,gold:1e4}}]},{id:"bdg_stoic",name:"The Stoic",icon:"",description:"Reach high Discipline (DIS).",category:"mastery",triggerType:"stat",metricKey:te.DIS,levels:[{tier:"silver",target:10,quote:"Control your mind.",rewards:{xp:200,gold:100}},{tier:"gold",target:25,quote:"Emotion is a choice.",rewards:{xp:1e3,gold:500}},{tier:"diamond",target:50,quote:"Stone does not bleed.",rewards:{xp:5e3,gold:2e3}},{tier:"crimson",target:100,quote:"You are the mountain.",rewards:{xp:2e4,gold:1e4}}]},{id:"bdg_titan",name:"The Titan",icon:"",description:"Reach high Strength (STR).",category:"mastery",triggerType:"stat",metricKey:te.STR,levels:[{tier:"silver",target:10,quote:"Lift the weight.",rewards:{xp:200,gold:100}},{tier:"gold",target:25,quote:"The body obeys the will.",rewards:{xp:1e3,gold:500}},{tier:"diamond",target:50,quote:"Force of nature.",rewards:{xp:5e3,gold:2e3}},{tier:"crimson",target:100,quote:"Atlas shrugs.",rewards:{xp:2e4,gold:1e4}}]}],VN=K.createContext(void 0),jL=()=>{const n=new Date,e=t=>t.toString().padStart(2,"0");return`${n.getFullYear().toString().slice(-2)}${e(n.getMonth()+1)}${e(n.getDate())}${e(n.getHours())}${e(n.getMinutes())}`},DL=({children:n})=>{var x,b,T;const{state:e,dispatch:t}=Ve(),{skillState:i}=sn(),{habitState:r}=ei(),{raidState:l}=ss(),{user:c}=e,d=()=>[...RL,...e.badgesRegistry],p=()=>{let S=!1,E={...c};E.badgeTiers||(E.badgeTiers={}),E.badgeHistory||(E.badgeHistory={}),d().forEach(k=>{var $;let F=0;if(k.triggerType==="metric"&&k.metricKey){const M=k.metricKey.split(".");M.length===1?F=c.metrics[M[0]]||0:M.length===2&&(F=(($=c.metrics[M[0]])==null?void 0:$[M[1]])||0),k.metricKey==="level"&&(F=c.level),k.metricKey==="highestStreak"&&(F=Math.max(c.streak,c.metrics.highestStreak))}else if(k.triggerType==="stat"&&k.metricKey)F=c.stats[k.metricKey]||0;else if(k.triggerType==="skill"&&k.metricKey){const M=i.skills.find(J=>J.id===k.metricKey);M&&(F=M.level)}else if(k.triggerType==="habit"&&k.metricKey){const M=r.habits.find(J=>J.title.toLowerCase().includes(k.metricKey.toLowerCase()));M&&(F=M.streak)}else if(k.triggerType==="raid"&&k.metricKey){const M=l.raids.find(J=>J.title.toLowerCase().includes(k.metricKey.toLowerCase()));M&&(F=M.progress)}k.levels.forEach(M=>{var z;const J=M.tier;E.badgeTiers[k.id];const H=(z=E.badgeHistory[k.id])==null?void 0:z[J];F>=M.target&&!H&&(S=!0,E.badgeTiers[k.id]=J,E.badges.includes(k.id)||E.badges.push(k.id),E.badgeHistory[k.id]||(E.badgeHistory[k.id]={}),E.badgeHistory[k.id][J]=jL(),E.currentXP+=M.rewards.xp,E.gold+=M.rewards.gold,setTimeout(()=>{t.setModal("badgeUnlock",{badge:k,tier:J,rewards:M.rewards}),Ce("level-up",!0)},500))})}),S&&t.updateUser(E)};K.useEffect(()=>{const S=setTimeout(()=>{p()},1e3);return()=>clearTimeout(S)},[c.level,c.streak,(x=c.metrics)==null?void 0:x.totalTasksCompleted,(b=c.metrics)==null?void 0:b.totalGoldEarned,(T=c.metrics)==null?void 0:T.totalRaidsWon,JSON.stringify(c.stats),JSON.stringify(i.skills.map(S=>S.level)),JSON.stringify(r.habits.map(S=>S.streak)),JSON.stringify(l.raids.map(S=>S.progress))]);const h=()=>d().map(E=>{var $,M,J,H;let D=0;if(E.triggerType==="metric"&&E.metricKey){const z=E.metricKey.split(".");z.length===1?D=c.metrics[z[0]]||0:D=(($=c.metrics[z[0]])==null?void 0:$[z[1]])||0,E.metricKey==="level"&&(D=c.level),E.metricKey==="highestStreak"&&(D=Math.max(c.streak,((M=c.metrics)==null?void 0:M.highestStreak)||0))}else if(E.triggerType==="stat"&&E.metricKey)D=c.stats[E.metricKey]||0;else if(E.triggerType==="skill"&&E.metricKey){const z=i.skills.find(R=>R.id===E.metricKey);z&&(D=z.level)}else if(E.triggerType==="habit"&&E.metricKey){const z=r.habits.find(R=>R.title.toLowerCase().includes(E.metricKey.toLowerCase()));z&&(D=z.streak)}else if(E.triggerType==="raid"&&E.metricKey){const z=l.raids.find(R=>R.title.toLowerCase().includes(E.metricKey.toLowerCase()));z&&(D=z.progress)}const k=((J=c.badgeTiers)==null?void 0:J[E.id])||null;let F=E.levels[0];return k==="silver"&&(F=E.levels[1]),k==="gold"&&(F=E.levels[2]),k==="diamond"&&(F=E.levels[3]),k==="crimson"&&(F=null),{badge:E,currentValue:D,isUnlocked:!!k,currentTier:k,nextTier:F,history:((H=c.badgeHistory)==null?void 0:H[E.id])||{}}});return o.jsx(VN.Provider,{value:{getAllBadges:h,checkBadges:p},children:n})},zN=()=>{const n=K.useContext(VN);if(!n)throw new Error("useBadges must be used within BadgeProvider");return n},ML=({user:n,dynamicTitle:e,featuredBadgesData:t})=>o.jsxs("div",{className:"bg-life-paper border border-zinc-800 rounded-xl p-6 text-center mb-6 relative overflow-hidden group",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-life-gold/5 to-transparent pointer-events-none"}),o.jsxs("div",{className:"w-24 h-24 mx-auto bg-life-black rounded-full border-4 border-zinc-800 flex items-center justify-center mb-4 relative shadow-2xl z-10 transition-transform select-none",children:[o.jsx(bx,{size:48,className:"text-life-silver"}),o.jsxs("div",{className:"absolute -bottom-2 bg-life-gold text-life-black text-xs font-black px-2 py-0.5 rounded shadow-sm border border-life-black",children:["Lvl ",n.level]})]}),o.jsx("h2",{className:"text-2xl font-black text-life-text tracking-tight uppercase relative z-10",children:n.name}),o.jsx("p",{className:"text-sm text-life-gold font-mono tracking-widest opacity-80 mb-5 relative z-10",children:e}),t.length>0&&o.jsx("div",{className:"flex justify-center gap-2 mb-5 relative z-10",children:t.map(i=>{const r=i.currentTier;let l="text-gray-400";return r==="gold"&&(l="text-yellow-400 drop-shadow-[0_0_5px_rgba(250,204,21,0.5)]"),r==="diamond"&&(l="text-cyan-400 drop-shadow-[0_0_5px_rgba(34,211,238,0.5)]"),r==="crimson"&&(l="text-red-500 drop-shadow-[0_0_8px_rgba(220,38,38,0.6)]"),o.jsxs("div",{className:"relative group/badge cursor-help",title:i.badge.name,children:[o.jsx("div",{className:`w-8 h-8 rounded-full bg-life-black border border-zinc-800 flex items-center justify-center ${l}`,children:o.jsx("span",{className:"text-sm",children:i.badge.icon})}),o.jsx("div",{className:`absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-life-paper bg-current ${l}`})]},i.badge.id)})}),o.jsxs("div",{className:"bg-black/40 rounded-lg p-3 backdrop-blur-sm border border-zinc-800 relative z-10",children:[o.jsxs("div",{className:"flex justify-between text-[10px] text-life-muted mb-1 uppercase font-bold",children:[o.jsx("span",{children:"XP Progress"}),o.jsxs("span",{className:"text-life-gold",children:[n.currentXP," ",o.jsxs("span",{className:"text-life-muted",children:["/ ",n.targetXP]})]})]}),o.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-life-gold shadow-[0_0_10px_rgba(251,191,36,0.5)] transition-all duration-700",style:{width:`${Math.min(100,n.currentXP/n.targetXP*100)}%`}})})]})]}),PL=({items:n,onSelectItem:e})=>{const t=n.reduce((r,l)=>(r[l.id]||(r[l.id]={...l,count:0}),r[l.id].count+=1,r),{}),i=Object.values(t);return o.jsxs("div",{className:"mb-8",children:[o.jsxs("h3",{className:"text-xs font-bold text-life-muted uppercase tracking-wider mb-3 flex items-center gap-2",children:[o.jsx(OP,{size:14})," Inventory (",n.length,")"]}),i.length>0?o.jsx("div",{className:"grid grid-cols-4 gap-2",children:i.map(r=>o.jsxs("button",{onClick:()=>e(r),className:"aspect-square bg-life-paper rounded-xl border border-zinc-800 flex flex-col items-center justify-center gap-1 hover:border-life-gold/50 hover:bg-life-muted/5 transition-all relative",children:[r.count>1&&o.jsxs("span",{className:"absolute top-1 right-1 bg-life-gold text-life-black text-[9px] font-black px-1.5 rounded-full shadow-sm",children:["x",r.count]}),o.jsx("div",{className:"text-life-gold",children:o.jsx(_x,{icon:r.icon,size:20})})]},r.id))}):o.jsx("div",{className:"text-center py-6 border border-dashed border-zinc-800 rounded-xl",children:o.jsx("p",{className:"text-[10px] text-life-muted",children:"Inventory Empty"})})]})},LL=()=>{const[n,e]=K.useState(null),[t,i]=K.useState(!1);return K.useEffect(()=>{const l=c=>{c.preventDefault(),e(c),i(!0)};return window.addEventListener("beforeinstallprompt",l),()=>window.removeEventListener("beforeinstallprompt",l)},[]),{isInstallable:t,promptInstall:async()=>{if(!n)return;n.prompt();const{outcome:l}=await n.userChoice;l==="accepted"&&(console.log("User accepted the install prompt"),e(null),i(!1))}}},OL=({user:n,dispatch:e,onExport:t,onImport:i,onForceSleep:r})=>{LL();const{skillState:l}=sn(),c=()=>{e.togglePreference("useSkillAsTitle")},d=p=>{const h=p.target.value;e.updateUser({preferences:{...n.preferences,linkedSkillId:h}})};return o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"bg-life-black border border-zinc-800 rounded-xl p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(xh,{size:14,className:"text-life-muted"}),o.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-life-muted",children:"Title Override"})]}),o.jsxs("div",{className:"flex items-center justify-between p-3 bg-life-paper rounded-lg border border-zinc-800",children:[o.jsx("label",{htmlFor:"title-override-toggle",className:"text-xs font-bold text-life-text",children:"Use Skill as Title"}),o.jsx("button",{id:"title-override-toggle",onClick:c,className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${n.preferences.useSkillAsTitle?"bg-life-gold":"bg-life-muted/20"}`,children:o.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${n.preferences.useSkillAsTitle?"translate-x-6":"translate-x-1"}`})})]}),n.preferences.useSkillAsTitle&&o.jsx("div",{className:"animate-in fade-in duration-300",children:o.jsxs("select",{value:n.preferences.linkedSkillId||"",onChange:d,className:"w-full p-3 bg-life-paper border border-zinc-800 rounded-lg text-xs font-bold text-life-text focus:outline-none focus:ring-2 focus:ring-life-gold/50",children:[o.jsx("option",{value:"",disabled:!0,children:"Select a Skill..."}),l.skills.map(p=>o.jsx("option",{value:p.id,children:p.title},p.id))]})})]}),o.jsxs("div",{className:"bg-life-black border border-zinc-800 rounded-xl p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx(qh,{size:14,className:"text-life-muted"}),o.jsx("h3",{className:"text-[10px] font-black uppercase tracking-[0.2em] text-life-muted",children:"Data Persistence"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("button",{onClick:t,className:"flex flex-col items-center justify-center gap-2 p-4 rounded-lg bg-life-paper border border-zinc-800 hover:border-life-gold/50 transition-all group",children:[o.jsx(dh,{size:20,className:"text-life-gold group-hover:scale-110 transition-transform"}),o.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-life-text",children:"Backup System"})]}),o.jsxs("button",{onClick:i,className:"flex flex-col items-center justify-center gap-2 p-4 rounded-lg bg-life-paper border border-zinc-800 hover:border-life-easy/50 transition-all group",children:[o.jsx(yh,{size:20,className:"text-life-easy group-hover:scale-110 transition-transform"}),o.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-life-text",children:"Restore Data"})]})]}),o.jsxs("div",{className:"flex items-center justify-center gap-2 pt-2 opacity-50",children:[o.jsx(mh,{size:10,className:"text-life-easy"}),o.jsx("span",{className:"text-[8px] text-life-muted uppercase font-bold",children:"Local Storage Protocol Active"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("button",{onClick:()=>e.setModal("questForge"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-indigo-950/30 border border-indigo-500/30 hover:bg-indigo-900/40 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-indigo-500/20 rounded-lg text-indigo-400 group-hover:text-indigo-300",children:o.jsx(tn,{size:16})}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-200 group-hover:text-white",children:"Quest Forge (Tasks)"})]}),o.jsx("span",{className:"text-[8px] font-mono text-indigo-400/60 bg-indigo-950/50 px-2 py-1 rounded border border-indigo-500/10",children:"AI_TASK_GEN"})]}),o.jsxs("button",{onClick:()=>e.setModal("habitProtocol"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-emerald-950/30 border border-emerald-500/30 hover:bg-emerald-900/40 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-emerald-500/20 rounded-lg text-emerald-400 group-hover:text-emerald-300",children:o.jsx(Lt,{size:16})}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-emerald-200 group-hover:text-white",children:"Protocol Foundry (Habits)"})]}),o.jsx("span",{className:"text-[8px] font-mono text-emerald-400/60 bg-emerald-950/50 px-2 py-1 rounded border border-emerald-500/10",children:"AI_HABIT_GEN"})]}),o.jsxs("button",{onClick:()=>e.setModal("shopProtocol"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-pink-950/30 border border-pink-500/30 hover:bg-pink-900/40 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-pink-500/20 rounded-lg text-pink-400 group-hover:text-pink-300",children:o.jsx(EN,{size:16})}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-pink-200 group-hover:text-white",children:"Shop Archives"})]}),o.jsx("span",{className:"text-[8px] font-mono text-pink-400/60 bg-pink-950/50 px-2 py-1 rounded border border-pink-500/10",children:"AI_SHOP_DOCS"})]}),o.jsxs("button",{onClick:()=>e.setModal("economyProtocol"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-amber-950/30 border border-amber-500/30 hover:bg-amber-900/40 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-amber-500/20 rounded-lg text-amber-400 group-hover:text-amber-300",children:o.jsx(pi,{size:16})}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-amber-200 group-hover:text-white",children:"Treasury Archive (Economy)"})]}),o.jsx("span",{className:"text-[8px] font-mono text-amber-400/60 bg-amber-950/50 px-2 py-1 rounded border border-amber-500/10",children:"AI_ECON_DOCS"})]}),o.jsxs("button",{onClick:()=>e.setModal("raidProtocol"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-red-950/30 border border-red-500/30 hover:bg-red-900/40 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-red-500/20 rounded-lg text-red-400 group-hover:text-red-300",children:o.jsx(mh,{size:16})}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-red-200 group-hover:text-white",children:"The War Room (Raids)"})]}),o.jsx("span",{className:"text-[8px] font-mono text-red-400/60 bg-red-950/50 px-2 py-1 rounded border border-red-500/10",children:"AI_RAID_OPS"})]}),o.jsxs("button",{onClick:()=>e.setModal("codexArbiter"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-indigo-950/30 border border-indigo-500/30 hover:bg-indigo-900/40 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-indigo-500/20 rounded-lg text-indigo-400 group-hover:text-indigo-300",children:o.jsx(Yh,{size:16})}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-200 group-hover:text-white",children:"Codex Arbiter (Laws)"})]}),o.jsx("span",{className:"text-[8px] font-mono text-indigo-400/60 bg-indigo-950/50 px-2 py-1 rounded border border-indigo-500/10",children:"AI_CODEX_GEN"})]}),o.jsxs("button",{onClick:()=>e.setModal("badgeProtocol"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-yellow-950/30 border border-yellow-500/30 hover:bg-yellow-900/40 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-yellow-500/20 rounded-lg text-yellow-400 group-hover:text-yellow-300",children:o.jsx(xh,{size:16})}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-yellow-200 group-hover:text-white",children:"Badge Architect"})]}),o.jsx("span",{className:"text-[8px] font-mono text-yellow-400/60 bg-yellow-950/50 px-2 py-1 rounded border border-yellow-500/10",children:"AI_BADGE_GEN"})]}),o.jsxs("button",{onClick:()=>e.setModal("skillProtocol"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-blue-950/30 border border-blue-500/30 hover:bg-blue-900/40 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-1.5 bg-blue-500/20 rounded-lg text-blue-400 group-hover:text-blue-300",children:o.jsx(tn,{size:16})}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-blue-200 group-hover:text-white",children:"Skill Tree Architect"})]}),o.jsx("span",{className:"text-[8px] font-mono text-blue-400/60 bg-blue-950/50 px-2 py-1 rounded border border-blue-500/10",children:"AI_SKILL_GEN"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("button",{onClick:async()=>{const p=await GS();alert(p?"Notifications Enabled! ":"Notifications Denied or Not Supported ")},className:"flex flex-col items-center justify-center gap-2 p-4 rounded-lg bg-life-paper border border-life-muted/20 hover:border-life-gold/50 transition-all group",children:[o.jsx(ur,{size:20,className:"text-life-gold group-hover:scale-110 transition-transform"}),o.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-life-text",children:"Enable Alerts"})]}),o.jsxs("button",{onClick:()=>Gf(Date.now(),"Life OS","System Test: Notifications Operational "),className:"flex flex-col items-center justify-center gap-2 p-4 rounded-lg bg-life-paper border border-life-muted/20 hover:border-life-easy/50 transition-all group",children:[o.jsx(Lt,{size:20,className:"text-life-easy group-hover:scale-110 transition-transform"}),o.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-life-text",children:"Test Alert"})]})]}),o.jsxs("button",{onClick:r,className:"w-full flex items-center justify-between p-4 rounded-xl bg-life-black border border-life-muted/10 hover:bg-life-muted/5 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(SN,{size:16,className:"text-life-gold group-hover:rotate-180 transition-transform duration-700"}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-life-text",children:"Trigger Daily Reset"})]}),o.jsx("span",{className:"text-[8px] font-mono text-life-muted opacity-50",children:"MANUAL_OVERRIDE"})]}),o.jsxs("button",{onClick:()=>e.setModal("resetConfirm"),className:"w-full flex items-center justify-between p-4 rounded-xl bg-red-950/10 border border-red-900/30 hover:bg-red-900/20 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(NN,{size:16,className:"text-red-500"}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-red-400",children:"Rebirth Protocol"})]}),o.jsx("span",{className:"text-[8px] font-mono text-red-900 font-bold",children:"DANGER_ZONE"})]})]}),o.jsx("div",{className:"text-center pt-4",children:o.jsx("p",{className:"text-[8px] text-life-muted font-mono opacity-40 uppercase tracking-[0.3em]",children:"LifeOS Neural Kernel v2.4.0 // Secured"})})]})},UL=({stat:n,size:e=14})=>{switch(n){case te.STR:return o.jsx(Qn,{size:e});case te.INT:return o.jsx(tn,{size:e});case te.DIS:return o.jsx(dt,{size:e});case te.HEA:return o.jsx(gi,{size:e});case te.CRT:return o.jsx(kn,{size:e});case te.SPR:return o.jsx(Mi,{size:e});case te.REL:return o.jsx(mo,{size:e});case te.FIN:return o.jsx(pi,{size:e});default:return o.jsx(Bh,{size:e})}},VL=({stats:n,maxVal:e=20})=>{const l=e,c=[te.STR,te.INT,te.DIS,te.HEA,te.CRT,te.SPR,te.REL,te.FIN],d=(x,b,T=85)=>{const E=Math.PI*2/c.length*b-Math.PI/2,D=x/l*T,k=150+D*Math.cos(E),F=150+D*Math.sin(E);return{x:k,y:F}},p=c.map((x,b)=>{const T=Math.min(n[x],l),{x:S,y:E}=d(T,b);return`${S},${E}`}).join(" "),h=[.25,.5,.75,1].map(x=>c.map((b,T)=>{const{x:S,y:E}=d(l*x,T);return`${S},${E}`}).join(" "));return o.jsx("div",{className:"relative flex justify-center animate-in fade-in zoom-in-95 duration-500",children:o.jsxs("svg",{width:300,height:300,viewBox:"0 0 300 300",className:"overflow-visible",children:[h.map((x,b)=>o.jsx("polygon",{points:x,fill:"none",stroke:"var(--color-life-text)",strokeWidth:"1",opacity:"0.1"},b)),c.map((x,b)=>{const{x:T,y:S}=d(l,b);return o.jsx("line",{x1:150,y1:150,x2:T,y2:S,stroke:"var(--color-life-text)",strokeWidth:"1",opacity:"0.1"},b)}),o.jsx("polygon",{points:p,fill:"rgba(251, 191, 36, 0.15)",stroke:"#fbbf24",strokeWidth:"2",className:"drop-shadow-[0_0_15px_rgba(251,191,36,0.3)]"}),c.map((x,b)=>{const T=d(l,b,125),S=n[x],E=ut[x];return o.jsx("foreignObject",{x:T.x-30,y:T.y-25,width:"60",height:"50",className:"overflow-visible",children:o.jsxs("div",{className:"flex flex-col items-center justify-center text-center group cursor-pointer hover:scale-110 transition-transform",children:[o.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center bg-life-black border shadow-sm mb-1 z-10 relative",style:{borderColor:`${E}50`,color:E,boxShadow:`0 0 10px ${E}20`},children:o.jsx(UL,{stat:x,size:12})}),o.jsxs("div",{className:"flex flex-col leading-none relative z-10 bg-life-black/80 px-1 rounded backdrop-blur-sm",children:[o.jsx("span",{className:"text-[8px] font-black uppercase tracking-wider text-life-muted group-hover:text-life-text transition-colors",children:x}),o.jsx("span",{className:"text-[10px] font-mono font-bold text-life-text group-hover:text-life-gold transition-colors",children:S})]})]})},x)}),c.map((x,b)=>{const T=Math.min(n[x],l),S=d(T,b);return o.jsx("circle",{cx:S.x,cy:S.y,r:"3",fill:"#fbbf24",stroke:"#000",strokeWidth:"1"},`dot-${b}`)})]})})},zL=n=>{switch(n){case te.STR:return Qn;case te.INT:return tn;case te.DIS:return dt;case te.HEA:return gi;case te.CRT:return kn;case te.SPR:return Mi;case te.REL:return mo;case te.FIN:return pi;default:return Bh}},HL=n=>{switch(n){case te.STR:return"#ef4444";case te.INT:return"#8b5cf6";case te.DIS:return"#3b82f6";case te.HEA:return"#10b981";case te.CRT:return"#ec4899";case te.SPR:return"#f43f5e";case te.REL:return"#fbbf24";case te.FIN:return"#14b8a6";default:return"#6b7280"}},FL=n=>{const e={[te.STR]:n.STR||0,[te.INT]:n.INT||0,[te.DIS]:n.DIS||0,[te.HEA]:n.HEA||0,[te.CRT]:n.CRT||0,[te.SPR]:n.SPR||0,[te.REL]:n.REL||0,[te.FIN]:n.FIN||0},t=Math.max(...Object.values(e));let i=20;return t>=1280?i=2560:t>=640?i=1280:t>=320?i=640:t>=160?i=320:t>=80?i=160:t>=40?i=80:t>=20&&(i=40),{xpValues:e,globalTarget:i}},GL={[te.STR]:"Strength",[te.INT]:"Intelligence",[te.DIS]:"Discipline",[te.HEA]:"Health",[te.CRT]:"Creativity",[te.SPR]:"Spirit",[te.REL]:"Relation",[te.FIN]:"Finance"},BL=({stat:n,xp:e,target:t})=>{const i=t>0?Math.min(e/t*100,100):0,r=zL(n),l=HL(n),c=GL[n]||n;return o.jsxs("div",{className:"flex flex-col w-full mb-2 group",children:[o.jsxs("div",{className:"flex justify-between items-end px-0 mb-1",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-1.5 rounded-md bg-life-black border border-zinc-800 flex items-center justify-center shadow-sm group-hover:border-life-muted/40 transition-colors",children:o.jsx(r,{size:14,style:{color:l}})}),o.jsxs("div",{className:"flex flex-col leading-none gap-0.5",children:[o.jsx("span",{className:"font-black text-[10px] text-life-text uppercase tracking-widest",children:c}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("span",{className:"text-[8px] font-mono text-life-muted font-bold opacity-50",children:n}),o.jsxs("span",{className:"text-[8px] font-mono text-life-gold font-bold bg-life-gold/10 px-1 rounded-[2px]",children:["LVL ",Math.floor(e/20)+1]})]})]})]}),o.jsxs("p",{className:"text-[10px] font-mono text-life-text text-right leading-none",children:[o.jsx("span",{style:{color:l},className:"font-black text-xs",children:e.toFixed(0)}),o.jsxs("span",{className:"text-life-muted/40 text-[9px] ml-1",children:["/ ",t]})]})]}),o.jsxs("div",{className:"w-full bg-black h-2 rounded-full overflow-hidden border border-zinc-800 relative shadow-inner",children:[o.jsx("div",{className:"h-full rounded-full transition-all duration-700 ease-out relative z-10",style:{width:`${i}%`,backgroundColor:l}}),o.jsx("div",{className:"absolute inset-0 opacity-30 blur-[3px]",style:{width:`${i}%`,backgroundColor:l}})]})]})},qL=({user:n})=>{const[e,t]=K.useState("data"),{xpValues:i,globalTarget:r}=FL(n.stats),l=[te.STR,te.INT,te.DIS,te.HEA,te.CRT,te.SPR,te.REL,te.FIN];return o.jsxs("div",{className:"bg-life-black border border-zinc-800 rounded-xl p-4 mb-4 shadow-lg shadow-black/50 relative overflow-hidden group",children:[o.jsx("div",{className:"absolute top-0 left-0 w-2 h-2 border-t border-l border-life-muted/30 rounded-tl-lg"}),o.jsx("div",{className:"absolute top-0 right-0 w-2 h-2 border-t border-r border-life-muted/30 rounded-tr-lg"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-2 h-2 border-b border-l border-life-muted/30 rounded-bl-lg"}),o.jsx("div",{className:"absolute bottom-0 right-0 w-2 h-2 border-b border-r border-life-muted/30 rounded-br-lg"}),o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{children:[o.jsxs("h3",{className:"text-xs font-black uppercase tracking-[0.2em] text-life-text flex items-center gap-2",children:[o.jsx("span",{className:"text-life-gold",children:""})," Attribute Analysis"]}),o.jsx("p",{className:"text-[9px] text-life-muted uppercase font-mono tracking-[0.1em] mt-1 opacity-60",children:"Neural_Net_v1.4 // Connected"})]}),o.jsxs("div",{className:"flex items-center bg-black border border-zinc-800 p-1 rounded-lg gap-1",children:[o.jsxs("button",{onClick:()=>t("graph"),className:`flex items-center gap-2 px-3 py-1.5 text-[10px] font-black uppercase tracking-wider rounded-md transition-all ${e==="graph"?"bg-life-gold text-black shadow-sm":"text-life-muted hover:text-white hover:bg-white/5"}`,children:[o.jsx(fP,{size:12,className:e==="graph"?"fill-black stroke-black":""}),"Graph"]}),o.jsxs("button",{onClick:()=>t("data"),className:`flex items-center gap-2 px-3 py-1.5 text-[10px] font-black uppercase tracking-wider rounded-md transition-all ${e==="data"?"bg-life-gold text-black shadow-sm":"text-life-muted hover:text-white hover:bg-white/5"}`,children:[o.jsx(EP,{size:14}),"Data"]})]})]}),o.jsx("div",{className:"animate-in fade-in zoom-in-95 duration-300",children:e==="graph"?o.jsx("div",{className:"relative h-64 flex items-center justify-center",children:o.jsx(VL,{stats:n.stats,maxVal:r})}):o.jsx("div",{className:"space-y-3 py-1",children:l.map(c=>o.jsx(BL,{stat:c,xp:i[c],target:r},c))})})]})},$L=()=>{var L;const{state:n,dispatch:e}=Ve(),{shopState:t}=Qh(),{skillState:i}=sn(),{taskState:r}=Zn(),{habitState:l}=ei(),{raidState:c}=ss(),{campaignState:d}=Ul(),{getAllBadges:p}=zN(),{user:h}=n,{storeItems:x}=t,[b,T]=K.useState(null),[S,E]=K.useState(oo.currentUser);K.useEffect(()=>{const O=oo.onAuthStateChanged(j=>E(j));return()=>O()},[]);const D=(i==null?void 0:i.skills)||[],k=D.length>0?D.reduce((O,j)=>O.level>j.level?O:j,D[0]):null,F=k?`${k.rank} ${k.title}`:h.title,$=h.inventory.map(O=>x.find(j=>j.id===O)).filter(Boolean),M=((L=h.badges)==null?void 0:L.length)||0,J=p(),H=(h.featuredBadges||[]).map(O=>J.find(j=>j.badge.id===O)).filter(Boolean),z=()=>{b&&(e.useItem(b),T(null))},R=()=>{const O={user:n.user,badgesRegistry:n.badgesRegistry,ui:{...n.ui,activeModal:"none",modalData:null},tasks:r.tasks,taskCategories:r.categories,laws:r.laws,habits:l.habits,habitCategories:l.categories,raids:c.raids,skills:i.skills,storeItems:t.storeItems,campaign:d.campaign,meta:{timestamp:new Date().toISOString(),version:"2.0",type:"full_backup"}},j=JSON.stringify(O,null,2);e.setModal("dataExchange",{mode:"export",title:"System Backup",data:j})},C=()=>{e.setModal("dataExchange",{mode:"import",title:"System Uplink"})},A=()=>{e.triggerDailyReset(),e.addToast("System Cycle Reset Initiated","success")},P=async()=>{const O=new ks;try{S?S.isAnonymous?(await LR(S,O),e.addToast("Account Linked Successfully","success")):e.addToast("Already Connected","info"):(await Pw(oo,O),e.addToast("Neural Link Established","success"))}catch(j){console.error("Link Error:",j),e.addToast(j.message||"Link Failed","error")}};return o.jsxs("div",{className:"pb-24 animate-in fade-in zoom-in-95 duration-500 relative",children:[o.jsx(ML,{user:h,dynamicTitle:F,featuredBadgesData:H}),o.jsxs("button",{onClick:P,className:`w-full mb-6 border rounded-xl p-4 flex items-center justify-between transition-all group shadow-lg ${S?"bg-life-easy/10 border-life-easy/30 hover:bg-life-easy/20":"bg-life-black border-zinc-800 hover:border-life-gold/50 hover:bg-life-gold/5"}`,children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center border group-hover:scale-110 transition-transform ${S?"bg-life-easy/20 text-life-easy border-life-easy/30":"bg-life-gold/10 text-life-gold border-life-gold/20"}`,children:o.jsx(dt,{size:20,className:S?"":"animate-pulse"})}),o.jsxs("div",{className:"text-left",children:[o.jsx("h3",{className:`text-xs font-black uppercase tracking-widest transition-colors ${S?"text-life-easy":"text-life-text group-hover:text-life-gold"}`,children:S?"Neural Link Active":"Connect Neural Link"}),o.jsx("p",{className:"text-[9px] text-life-muted uppercase tracking-[0.2em]",children:S?S.email||"Linked":"Sync with Google Cloud"})]})]}),S?o.jsx(Zi,{size:20,className:"text-life-easy"}):o.jsx(Bt,{size:20,className:"text-life-muted group-hover:text-life-gold"})]}),o.jsxs("button",{onClick:()=>e.setView("hall_of_fame"),className:"w-full mb-6 bg-life-black border border-zinc-800 rounded-xl p-4 flex items-center justify-between hover:border-life-gold/50 hover:bg-life-gold/5 transition-all group shadow-lg",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-life-crimson/10 flex items-center justify-center text-life-crimson border border-life-crimson/20 group-hover:scale-110 transition-transform",children:o.jsx(po,{size:20})}),o.jsxs("div",{className:"text-left",children:[o.jsx("h3",{className:"text-xs font-black text-life-text uppercase tracking-widest group-hover:text-life-gold transition-colors",children:"Hall of Glory"}),o.jsxs("p",{className:"text-[9px] text-life-muted uppercase tracking-[0.2em]",children:[M," Medals Secured"]})]})]}),o.jsx(Bt,{size:20,className:"text-life-muted group-hover:text-life-gold"})]}),o.jsx(qL,{user:h}),o.jsx(PL,{items:$,onSelectItem:T}),o.jsx(OL,{user:h,dispatch:e,onForceSleep:A,onExport:R,onImport:C}),b&&o.jsx("div",{onClick:()=>T(null),className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in",children:o.jsxs("div",{onClick:O=>O.stopPropagation(),className:"bg-life-paper w-full max-w-xs rounded-xl border border-zinc-800 p-5 shadow-2xl relative",children:[o.jsx("button",{onClick:()=>T(null),className:"absolute top-3 right-3 text-life-muted hover:text-life-text",children:o.jsx(et,{size:20})}),o.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[o.jsx("div",{className:"w-20 h-20 rounded-full bg-life-black border border-zinc-800 flex items-center justify-center mb-3 text-life-gold shadow-inner",children:o.jsx(_x,{icon:b.icon,size:40})}),o.jsx("h3",{className:"font-black uppercase tracking-widest text-life-text",children:b.title}),o.jsx("p",{className:"text-[10px] text-life-muted mt-2 leading-relaxed uppercase",children:b.description})]}),o.jsx("div",{className:"flex flex-col gap-2",children:b.type==="artifact"?o.jsx("button",{onClick:()=>{e.toggleEquip(b.id),T(null)},className:`w-full py-4 font-black uppercase text-xs rounded-xl shadow-lg transition-all active:scale-95 ${h.equippedItems.includes(b.id)?"bg-life-muted/20 text-life-muted hover:bg-life-muted/30":"bg-life-gold text-life-black hover:bg-yellow-400 shadow-life-gold/20"}`,children:h.equippedItems.includes(b.id)?"Unequip Artifact":"Equip Artifact"}):o.jsx("button",{onClick:z,className:"w-full py-4 bg-life-gold text-life-black font-black uppercase text-xs rounded-xl hover:bg-yellow-400 shadow-lg shadow-life-gold/20 transition-all active:scale-95",children:"Consume Item"})})]})})]})},YL=({onStart:n})=>{const[e,t]=K.useState(""),[i,r]=K.useState(new Date().toISOString().split("T")[0]),l=c=>{c.preventDefault(),e&&n(e,i)};return o.jsxs("div",{className:"pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500 h-full flex flex-col justify-center",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-20 h-20 bg-life-black border border-life-gold rounded-full flex items-center justify-center mx-auto mb-4 shadow-[0_0_30px_rgba(251,191,36,0.2)]",children:o.jsx(is,{size:40,className:"text-life-gold"})}),o.jsx("h2",{className:"text-3xl font-black text-life-text tracking-tighter uppercase mb-2",children:"Operation Tempo"}),o.jsx("p",{className:"text-sm text-life-muted max-w-xs mx-auto",children:'"The year is not 12 months. It is 12 weeks. No time for hesitation."'})]}),o.jsxs("form",{onSubmit:l,className:"bg-life-paper border border-life-muted/20 p-6 rounded-2xl shadow-xl space-y-6",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Campaign Objective (Title)"}),o.jsx("input",{type:"text",value:e,onChange:c=>t(c.target.value),placeholder:"e.g. Project Spartan, Winter Arc...",className:"w-full bg-life-black border border-life-muted/30 rounded-lg p-3 text-life-text focus:border-life-gold outline-none font-bold",autoFocus:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Start Date (Zero Point)"}),o.jsx("input",{type:"date",value:i,onChange:c=>r(c.target.value),className:"w-full bg-life-black border border-life-muted/30 rounded-lg p-3 text-life-text focus:border-life-gold outline-none"})]}),o.jsxs("button",{type:"submit",disabled:!e,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest flex items-center justify-center gap-2 transition-all
                        ${e?"bg-life-gold text-life-black hover:bg-yellow-400 shadow-lg shadow-life-gold/20":"bg-life-muted/20 text-life-muted cursor-not-allowed"}
                    `,children:[o.jsx($h,{size:18,fill:"currentColor"})," Initiate Campaign"]})]})]})},JL=({stats:n,onComplete:e})=>{const t=n.grade==="S"?"text-life-diamond":n.grade==="A"?"text-life-gold":n.grade==="F"?"text-life-hard":"text-life-text";return o.jsxs("div",{className:"relative overflow-hidden rounded-2xl border-2 border-life-gold bg-life-black p-6 shadow-[0_0_30px_rgba(251,191,36,0.15)] animate-in zoom-in-95 duration-700",children:[o.jsx("div",{className:"absolute inset-0 bg-life-gold/5 animate-pulse-slow pointer-events-none"}),o.jsx("div",{className:"absolute -right-10 -top-10 opacity-10 rotate-12",children:o.jsx(G3,{size:150,className:"text-life-gold"})}),o.jsxs("div",{className:"relative z-10 text-center",children:[o.jsx("h3",{className:"text-xs font-black text-life-gold uppercase tracking-[0.3em] mb-4",children:"The Harvest is Here"}),o.jsxs("div",{className:"flex flex-col items-center mb-6",children:[o.jsx("div",{className:`text-6xl font-black ${t} drop-shadow-2xl`,children:n.grade}),o.jsx("div",{className:"text-xs text-life-muted font-bold uppercase tracking-widest mt-2 border-t border-b border-life-muted/20 py-1 px-4",children:"Campaign Rank"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[o.jsxs("div",{className:"bg-life-paper/50 p-3 rounded-xl border border-life-muted/20",children:[o.jsxs("div",{className:"text-2xl font-black text-life-text",children:[n.completionRate,"%"]}),o.jsx("div",{className:"text-[9px] text-life-muted uppercase tracking-widest",children:"Efficiency"})]}),o.jsxs("div",{className:"bg-life-paper/50 p-3 rounded-xl border border-life-muted/20",children:[o.jsx("div",{className:"text-2xl font-black text-life-gold",children:n.raidCount}),o.jsx("div",{className:"text-[9px] text-life-muted uppercase tracking-widest",children:"Ops Won"})]}),o.jsxs("div",{className:"bg-life-paper/50 p-3 rounded-xl border border-life-muted/20 col-span-2 flex items-center justify-between px-6",children:[o.jsxs("div",{className:"text-left",children:[o.jsxs("div",{className:"text-xl font-black text-life-text",children:[n.completedTasks," ",o.jsxs("span",{className:"text-life-muted text-sm",children:["/ ",n.totalTasks]})]}),o.jsx("div",{className:"text-[9px] text-life-muted uppercase tracking-widest",children:"Missions Cleared"})]}),o.jsx(Xh,{size:24,className:"text-life-gold opacity-50"})]})]}),o.jsxs("button",{onClick:e,className:"w-full py-4 bg-life-gold hover:bg-yellow-400 text-life-black font-black uppercase tracking-widest rounded-xl shadow-[0_0_20px_rgba(251,191,36,0.3)] transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-2",children:[o.jsx(Bh,{size:20,strokeWidth:3})," Reap & Reset Cycle"]}),o.jsx("p",{className:"text-[9px] text-life-muted mt-3 opacity-60",children:"Archiving this campaign will reset the timeline for the next 12-week cycle."})]})]})},Q_=({title:n,isCompleted:e,type:t,onToggle:i,onOpenDetails:r,colorClass:l})=>o.jsxs("div",{onClick:c=>{c.stopPropagation(),r()},className:`group flex items-center gap-3 p-2 rounded-lg border mb-1 cursor-pointer transition-all ${e?"bg-life-black border-life-muted/10 opacity-50":"bg-life-paper border-life-muted/20 hover:border-life-gold/30 hover:bg-life-muted/5"}`,children:[o.jsx("div",{onClick:c=>{c.stopPropagation(),i()},className:`w-6 h-6 rounded flex items-center justify-center transition-all cursor-pointer z-10 hover:scale-110 ${e?"bg-life-muted border border-life-muted text-life-black":"border-2 border-life-muted/30 text-transparent hover:border-life-gold"}`,children:o.jsx(Os,{size:14,strokeWidth:4,className:e?"scale-100":"scale-0"})}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsx("div",{className:`text-xs font-medium truncate ${e?"line-through text-life-muted":"text-life-text"}`,children:n})}),t==="raid"&&o.jsx("div",{className:`px-1.5 py-0.5 rounded text-[8px] font-black uppercase tracking-wider ${l} bg-opacity-10`,children:"OP"})]}),KL=()=>{const{campaignState:n,campaignDispatch:e}=Ul(),{taskState:t,taskDispatch:i}=Zn(),{raidState:r,raidDispatch:l}=ss(),{state:c,dispatch:d}=Ve(),{campaign:p}=n,{unlockAllWeeks:h}=c.user.preferences,[x,b]=K.useState(null),T=()=>{d.setModal("confirmation",{title:"Abort Campaign?",message:"Terminate timeline? All schedule data will be lost.",confirmText:"Abort Protocol",isDangerous:!0,onConfirm:()=>e.resetCampaign()})},S=(H,z)=>{const R=new Date(H),C=new Date(R.getTime()+(z-1)*7*864e5),A=new Date(C.getTime()+6*864e5),P={month:"short",day:"numeric"};return`${C.toLocaleDateString(void 0,P)} - ${A.toLocaleDateString(void 0,P)}`},E=(H,z,R)=>new Date(new Date(H).getTime()+((z-1)*7+(R-1))*864e5).toLocaleDateString(void 0,{weekday:"short",day:"numeric"}),D=(H,z,R)=>{const C=new Date(new Date(H).getTime()+((z-1)*7+(R-1))*864e5),A=P=>P.toString().padStart(2,"0");return`${C.getFullYear()}-${A(C.getMonth()+1)}-${A(C.getDate())}T12:00`},k=H=>{if(!p.startDate)return{tasks:[],raidSteps:[]};const z=new Date(p.startDate),R=new Date(z.getTime()+(H-1)*7*864e5);R.setHours(0,0,0,0);const C=new Date(R.getTime()+6*864e5);C.setHours(23,59,59,999);const A=t.tasks.filter(L=>{if(!L.deadline||L.isArchived)return!1;const O=new Date(L.deadline);return O>=R&&O<=C}),P=[];return r.raids.forEach(L=>{L.status!=="archived"&&L.steps.forEach(O=>{if(O.scheduledDate&&!O.isArchived){const j=new Date(O.scheduledDate);j>=R&&j<=C&&P.push({raidId:L.id,raidTitle:L.title,step:O})}})}),{weekTasks:A,weekRaidSteps:P}},F=()=>{if(!p.startDate)return{grade:"F",completionRate:0,totalTasks:0,completedTasks:0,raidCount:0};const H=new Date(p.startDate);let z=0,R=0,C=0;t.tasks.forEach(L=>{L.isArchived||L.deadline&&new Date(L.deadline)>=H&&(z++,L.isCompleted&&R++)}),r.raids.forEach(L=>{L.status==="completed"&&C++});const A=z>0?Math.round(R/z*100):0;let P="F";return A>=95?P="S":A>=85?P="A":A>=70?P="B":A>=50?P="C":A>=30&&(P="D"),{grade:P,completionRate:A,totalTasks:z,completedTasks:R,raidCount:C}};if(!p.isActive||!p.startDate)return o.jsx(YL,{onStart:e.initCampaign});const $=p.currentWeek>=13,M=Math.min(100,(p.currentWeek-1)/12*100),J=Array.from({length:13},(H,z)=>z+1);return o.jsxs("div",{className:"pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[o.jsxs("div",{className:"flex items-end justify-between mb-6 px-1",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-black text-life-text tracking-tight uppercase truncate max-w-[200px] sm:max-w-none",children:p.title}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("span",{className:`text-xs px-2 py-0.5 rounded font-bold uppercase tracking-wider ${p.isFrozen?"bg-blue-500/20 text-blue-400":"bg-life-gold/20 text-life-gold"}`,children:p.isFrozen?" Frozen":$?" Harvest":`Week ${p.currentWeek} / 12`}),!$&&o.jsxs("span",{className:"text-[10px] text-life-muted uppercase tracking-widest",children:[" Day ",p.currentDay]})]})]}),o.jsxs("div",{className:"text-life-gold opacity-50 flex items-center gap-2",children:[h&&o.jsx("span",{title:"Horus Eye Active",children:o.jsx(zf,{size:16,className:"animate-pulse text-life-crimson"})}),o.jsx(is,{size:24})]})]}),o.jsxs("div",{className:"mb-8",children:[o.jsx("div",{className:"h-2 w-full bg-life-black rounded-full overflow-hidden border border-life-muted/20 relative",children:o.jsx("div",{className:`h-full transition-all duration-1000 ${p.isFrozen?"bg-blue-500":"bg-life-gold"}`,style:{width:`${M}%`}})}),o.jsxs("div",{className:"flex justify-between mt-1 text-[9px] text-life-muted uppercase font-mono",children:[o.jsx("span",{children:"Start"}),o.jsx("span",{children:"Week 6"}),o.jsx("span",{children:"Harvest"})]})]}),o.jsx("div",{className:"space-y-3",children:J.map(H=>{const z=H<p.currentWeek,R=H===p.currentWeek,C=R||h&&!z,A=H===13,P=S(p.startDate,H),{weekTasks:L,weekRaidSteps:O}=k(H),j=L.length>0||O.length>0,q=L.filter(Y=>Y.isCompleted).length+O.filter(Y=>Y.step.isCompleted).length,le=L.length+O.length,U=le>0?Math.round(q/le*100):0;if(A)return o.jsx(JL,{stats:F(),onComplete:e.completeCampaign},H);if(z){const Y=x===H;return o.jsxs("div",{onClick:()=>b(Y?null:H),className:`border-l-4 rounded-r-lg bg-life-black transition-all cursor-pointer group ${Y?"border-life-muted/50 bg-life-paper pb-2":"border-life-muted/20 opacity-60 hover:opacity-100"}`,children:[o.jsxs("div",{className:"p-3 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("div",{className:"w-6 h-6 rounded bg-life-muted/20 flex items-center justify-center text-[10px] font-bold text-life-muted",children:["W",H]}),o.jsxs("div",{children:[o.jsxs("h4",{className:"text-xs font-bold text-life-muted group-hover:text-life-text transition-colors flex items-center gap-2",children:[o.jsxs("span",{className:"line-through",children:["Week ",H]}),o.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-life-muted/10 text-life-muted no-underline",children:"COMPLETE"})]}),o.jsxs("p",{className:"text-[9px] text-life-muted/50 font-mono mt-0.5",children:[P,"  ",U,"% Executed"]})]})]}),o.jsx("div",{className:"text-life-muted",children:Y?o.jsx(Xn,{size:14}):o.jsx(Os,{size:14})})]}),Y&&o.jsxs("div",{className:"px-3 pt-0 animate-in slide-in-from-top-2",children:[o.jsx("div",{className:"h-px w-full bg-life-muted/10 mb-2"}),j?o.jsxs("div",{className:"space-y-1 opacity-70",children:[L.map(X=>o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-life-muted line-through",children:[o.jsx(ns,{size:10})," ",X.title]},X.id)),O.map(({raidTitle:X,step:ie})=>o.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-life-muted line-through",children:[o.jsx(ua,{size:10})," ",X,": ",ie.title]},ie.id))]}):o.jsx("p",{className:"text-[10px] text-life-muted italic",children:"No logs recorded."})]})]},H)}return C?o.jsxs("div",{className:`relative rounded-xl border ${R?"border-life-gold bg-life-paper":"border-life-muted/30 bg-life-black/50 border-dashed"} shadow-[0_0_15px_rgba(251,191,36,0.05)] overflow-hidden`,children:[p.isFrozen&&R&&o.jsx("div",{className:"absolute inset-0 bg-blue-500/10 backdrop-blur-[1px] z-10 flex items-center justify-center border border-blue-500/30 rounded-xl",children:o.jsxs("div",{className:"bg-life-black px-4 py-2 rounded-full border border-blue-500 text-blue-400 flex items-center gap-2 text-xs font-bold uppercase tracking-widest shadow-xl",children:[o.jsx($_,{size:14})," Timeline Frozen"]})}),o.jsxs("div",{className:`p-4 border-b border-life-muted/10 flex justify-between items-start ${R?"bg-life-gold/5":"bg-transparent"}`,children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.jsxs("span",{className:`text-xs font-black uppercase tracking-wider ${R?"text-life-gold":"text-life-muted"}`,children:["Week ",H]}),R&&o.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-red-500 animate-pulse"}),!R&&h&&o.jsx("div",{className:"text-[8px] border border-life-crimson text-life-crimson px-1 rounded uppercase",children:"God Mode"})]}),o.jsxs("div",{className:"text-[10px] font-mono text-life-muted flex items-center gap-1",children:[o.jsx(ln,{size:10})," ",P]})]}),R&&o.jsx("div",{className:"text-[10px] px-2 py-1 rounded bg-life-gold text-life-black font-bold uppercase tracking-widest shadow-sm",children:"Current Front"})]}),o.jsx("div",{className:"p-2 space-y-2",children:[1,2,3,4,5,6,7].map(Y=>{const X=Y===p.currentDay&&R,ie=L.filter(ee=>new Date(ee.deadline).getDate()===new Date(new Date(p.startDate).getTime()+((H-1)*7+(Y-1))*864e5).getDate()),pe=O.filter(({step:ee})=>new Date(ee.scheduledDate).getDate()===new Date(new Date(p.startDate).getTime()+((H-1)*7+(Y-1))*864e5).getDate()),B=ie.length>0||pe.length>0;return!X&&!B?null:o.jsxs("div",{className:`rounded-lg border ${X?"border-life-gold/30 bg-life-gold/5":"border-life-muted/10 bg-life-black/50"} p-2`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsxs("span",{className:`text-[10px] font-black uppercase ${X?"text-life-gold":"text-life-muted"}`,children:["Day ",Y]}),o.jsx("span",{className:"text-[9px] text-life-muted font-mono opacity-70",children:E(p.startDate,H,Y)})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[X&&o.jsx("span",{className:"text-[8px] px-1 rounded bg-life-gold text-life-black font-bold uppercase",children:"Today"}),o.jsx("button",{onClick:()=>d.setModal("addTask",{date:D(p.startDate,H,Y),origin:"campaign"}),className:"w-5 h-5 rounded flex items-center justify-center bg-life-muted/10 hover:bg-life-gold text-life-muted hover:text-life-black transition-all",title:"Tactical Insert",children:o.jsx(nn,{size:12})})]})]}),B?o.jsxs("div",{className:"space-y-1",children:[ie.map(ee=>o.jsx(Q_,{title:ee.title,isCompleted:ee.isCompleted,type:"mission",onToggle:()=>i.toggleTask(ee.id),onOpenDetails:()=>d.setModal("itemDetails",{itemId:ee.id,type:"task"}),colorClass:"text-life-text"},ee.id)),pe.map(({raidId:ee,raidTitle:he,step:Q})=>o.jsx(Q_,{title:`${he}: ${Q.title}`,isCompleted:Q.isCompleted,type:"raid",onToggle:()=>l.toggleRaidStep(ee,Q.id),onOpenDetails:()=>d.setModal("itemDetails",{itemId:Q.id,parentId:ee,type:"raid_step"}),colorClass:"text-life-hard"},Q.id))]}):o.jsx("div",{className:"text-[9px] text-life-muted/30 italic text-center py-2 border border-dashed border-life-muted/10 rounded",children:"No tactical objectives."})]},Y)})})]},H):o.jsxs("div",{className:"border border-life-muted/10 rounded-xl bg-life-black opacity-60 hover:opacity-100 transition-opacity",children:[o.jsxs("div",{className:"p-3 flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-8 h-8 rounded bg-life-muted/10 flex items-center justify-center text-xs font-bold text-life-muted",children:H}),o.jsxs("div",{children:[o.jsxs("h4",{className:"text-xs font-bold text-life-text uppercase tracking-wider",children:["Week ",H]}),o.jsxs("p",{className:"text-[9px] text-life-muted font-mono",children:[P,"  ",le," Objectives"]})]})]}),o.jsx(da,{size:14,className:"text-life-muted/30"})]}),j&&o.jsxs("div",{className:"px-3 pb-3 pt-0",children:[o.jsx("div",{className:"h-px w-full bg-life-muted/10 mb-2"}),o.jsxs("div",{className:"flex flex-wrap gap-1",children:[L.map(Y=>o.jsx("div",{className:"w-2 h-2 rounded-full bg-life-muted",title:Y.title},Y.id)),O.map(({raidTitle:Y,step:X})=>o.jsx("div",{className:"w-2 h-2 rounded-full bg-life-hard",title:`${Y}: ${X.title}`},X.id))]})]})]},H)})}),o.jsxs("div",{className:"mt-8 pt-8 border-t border-life-muted/10 flex justify-between",children:[o.jsxs("button",{onClick:e.toggleFreeze,className:`flex items-center gap-2 text-[10px] font-bold uppercase tracking-wider transition-colors ${p.isFrozen?"text-blue-400 hover:text-blue-300":"text-life-muted hover:text-blue-400"}`,children:[o.jsx($_,{size:14,className:p.isFrozen?"animate-pulse":""})," ",p.isFrozen?"Resume Timeline":"Freeze Time"]}),o.jsxs("button",{onClick:T,className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-wider text-life-muted hover:text-life-hard transition-colors",children:[o.jsx(yx,{size:14})," Abort Campaign"]})]})]})},XL=({stat:n,size:e=14})=>{switch(n){case te.STR:return o.jsx(Qn,{size:e});case te.INT:return o.jsx(tn,{size:e});case te.DIS:return o.jsx(dt,{size:e});case te.HEA:return o.jsx(gi,{size:e});case te.CRT:return o.jsx(kn,{size:e});case te.SPR:return o.jsx(Mi,{size:e});case te.REL:return o.jsx(mo,{size:e});case te.FIN:return o.jsx(pi,{size:e});default:return o.jsx(Lt,{size:e})}},Z_={Novice:"text-life-muted border-life-muted",Adept:"text-life-normal border-life-normal",Expert:"text-purple-400 border-purple-400",Master:"text-life-gold border-life-gold",Grandmaster:"text-life-diamond border-life-diamond"},WL=({skill:n})=>{const{skillDispatch:e}=sn(),t=Math.min(100,n.currentXP/n.targetXP*100),i=Z_[n.rank]||Z_.Novice,r=i.split(" ")[0];return o.jsxs("div",{onClick:()=>e.setActiveSkill(n.id),className:`
                relative bg-life-paper border rounded-xl overflow-hidden mb-3 transition-all duration-200 
                hover:bg-life-muted/5 hover:scale-[1.01] active:scale-[0.99] cursor-pointer group 
                ${n.isRusty?"border-orange-900/50":"border-zinc-800"}
            `,children:[n.isRusty&&o.jsx("div",{className:"absolute top-2 right-2 text-orange-500 animate-pulse",title:"Skill is Rusty! Perform tasks to restore.",children:o.jsx(hr,{size:16})}),o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex justify-between items-start mb-2",children:[o.jsxs("div",{children:[o.jsx("h3",{className:`text-base font-bold text-life-text flex items-center gap-2 ${n.isRusty?"text-life-muted line-through opacity-70":""}`,children:n.title}),o.jsx("div",{className:"flex gap-1 mt-1",children:n.relatedStats.map(l=>o.jsxs("div",{className:"flex items-center gap-1 px-1.5 py-0.5 rounded bg-life-black border border-zinc-800 text-[9px] font-bold",style:{color:ut[l],borderColor:`${ut[l]}30`},children:[o.jsx(XL,{stat:l,size:10}),o.jsx("span",{children:l})]},l))})]}),o.jsx("div",{className:`px-2 py-1 rounded border bg-life-black text-[10px] uppercase font-black tracking-wider ${i} bg-opacity-20`,children:n.rank})]}),n.description&&o.jsx("p",{className:"text-xs text-life-muted/60 mb-3 line-clamp-1",children:n.description}),o.jsxs("div",{className:"relative pt-1",children:[o.jsxs("div",{className:"flex justify-between text-[10px] font-mono font-bold mb-1",children:[o.jsxs("span",{className:r,children:["LVL ",n.level]}),o.jsxs("span",{className:"text-life-muted",children:[n.currentXP," / ",n.targetXP," XP"]})]}),o.jsx("div",{className:"h-1.5 w-full bg-life-black rounded-full overflow-hidden border border-zinc-800",children:o.jsx("div",{className:`h-full transition-all duration-700 ${n.isRusty?"bg-life-muted":"bg-current"}`,style:{width:`${t}%`,color:n.rank==="Novice"?"#9ca3af":void 0},children:o.jsx("div",{className:`w-full h-full ${r.replace("text-","bg-")} opacity-80 shadow-[0_0_10px_currentColor]`})})})]})]})]})},QL=({onClose:n})=>{const{skillDispatch:e}=sn(),[t,i]=K.useState(""),[r,l]=K.useState(""),[c,d]=K.useState([]),p=b=>{b.preventDefault(),t.trim()&&c.length!==0&&(e.addSkill(t,c,r),n())},h=b=>{c.includes(b)?d(c.filter(T=>T!==b)):c.length<3&&d([...c,b])},x=({type:b})=>{switch(b){case te.STR:return o.jsx(Qn,{size:18});case te.INT:return o.jsx(tn,{size:18});case te.DIS:return o.jsx(dt,{size:18});case te.HEA:return o.jsx(gi,{size:18});case te.CRT:return o.jsx(kn,{size:18});case te.SPR:return o.jsx(Flame,{size:18});case te.REL:return o.jsx(Users,{size:18});case te.FIN:return o.jsx(Coins,{size:18});default:return o.jsx(Lt,{size:18})}};return o.jsxs("form",{onSubmit:p,className:"space-y-6 animate-in slide-in-from-right fade-in duration-300",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Skill Name"}),o.jsx("input",{type:"text",value:t,onChange:b=>i(b.target.value),placeholder:"e.g. Graphic Design, MMA...",autoFocus:!0,className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 text-life-text placeholder:text-life-muted/50 focus:outline-none focus:border-life-gold/50 transition-all font-medium"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Description"}),o.jsx("textarea",{rows:2,value:r,onChange:b=>l(b.target.value),placeholder:"Define the scope of this ability...",className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 text-sm text-life-text placeholder:text-life-muted/50 focus:outline-none focus:border-life-gold/50 transition-all resize-none"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Parent Attributes (Select 1-3)"}),o.jsx("div",{className:"grid grid-cols-7 gap-2",children:Object.values(te).map(b=>{const T=c.includes(b);return o.jsxs("button",{type:"button",onClick:()=>h(b),className:`
                                    flex flex-col items-center justify-center p-2 rounded-lg border transition-all aspect-square relative
                                    ${T?"bg-life-muted/10 border-current shadow-lg scale-105":"border-zinc-800 text-life-muted hover:bg-life-muted/5 opacity-70 hover:opacity-100"}
                                `,style:{color:T?ut[b]:void 0},children:[o.jsx(x,{type:b}),o.jsx("span",{className:"text-[9px] font-bold mt-1",children:b}),T&&o.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 rounded-full bg-current shadow-[0_0_5px_currentColor]"})]},b)})}),c.length===0&&o.jsx("p",{className:"text-[10px] text-life-hard mt-2 opacity-80",children:"* Required: Link at least one attribute."})]}),o.jsxs("button",{type:"submit",className:`
                    w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all mt-4
                    ${t&&c.length>0?"bg-life-gold text-life-black hover:bg-yellow-400 shadow-[0_0_20px_rgba(251,191,36,0.3)]":"border-zinc-800 text-life-muted cursor-not-allowed"}
                `,disabled:!t||c.length===0,children:["Acquire Skill ",o.jsx(Bt,{size:16})]})]})},ZL=()=>{const{skillState:n}=sn(),{dispatch:e}=Ve(),{skills:t}=n,[i,r]=K.useState(!1),l=[...t].sort((d,p)=>d.isRusty&&!p.isRusty?-1:!d.isRusty&&p.isRusty?1:p.level-d.level),c=()=>{const d={meta:{type:"SKILL_ARSENAL_EXPORT",generatedAt:new Date().toISOString(),count:t.length},skills:t.map(h=>({id:h.id,title:h.title,level:h.level,rank:h.rank,relatedStats:h.relatedStats,description:h.description,currentXP:h.currentXP,targetXP:h.targetXP,isRusty:h.isRusty}))},p=JSON.stringify(d,null,2);e.setModal("dataExchange",{mode:"export",title:"The Arsenal Codex",data:p})};return o.jsxs("div",{className:"pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[o.jsxs("div",{className:"flex items-end justify-between mb-6 px-1",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-black text-life-text tracking-tight flex items-center gap-2",children:"THE ARSENAL"}),o.jsxs("p",{className:"text-xs text-life-muted uppercase tracking-widest mt-1",children:["Skill Tree  ",t.length," Abilities Acquired"]})]}),o.jsx("button",{onClick:c,className:"p-3 rounded-xl bg-life-paper/50 border border-zinc-800 text-life-gold hover:bg-life-gold/10 hover:border-life-gold/50 transition-all group active:scale-95",title:"Export Skill Codex",children:o.jsx(hi,{size:20,className:"group-hover:scale-110 transition-transform"})})]}),o.jsx("div",{className:"mb-6",children:o.jsxs("button",{onClick:()=>r(!0),className:"w-full py-3 rounded-xl border border-dashed border-zinc-800 bg-life-paper/50 text-life-muted hover:text-life-gold hover:border-life-gold/50 hover:bg-life-gold/5 transition-all flex items-center justify-center gap-2 text-xs font-bold uppercase tracking-widest group",children:[o.jsx(nn,{size:16,className:"group-hover:scale-110 transition-transform"}),"Acquire New Skill"]})}),o.jsx("div",{children:l.length>0?l.map(d=>o.jsx(WL,{skill:d},d.id)):o.jsxs("div",{className:"py-12 text-center border-2 border-dashed border-zinc-800 rounded-xl bg-life-paper/30",children:[o.jsx(dt,{size:32,className:"mx-auto text-life-muted mb-3 opacity-50"}),o.jsx("p",{className:"text-life-muted text-sm font-bold",children:"No Skills Learned"}),o.jsx("p",{className:"text-[10px] text-life-muted/60 mt-1 uppercase tracking-wider",children:"Acquire new skills to track your progress."})]})}),i&&o.jsx("div",{onClick:()=>r(!1),className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in",children:o.jsxs("div",{onClick:d=>d.stopPropagation(),className:"bg-life-paper w-full max-w-lg rounded-2xl border border-zinc-800 shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 slide-in-from-bottom-4",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-zinc-800 bg-life-black/50",children:[o.jsxs("h3",{className:"text-sm font-black tracking-tight text-life-text flex items-center gap-2 uppercase",children:[o.jsx(hi,{size:16,className:"text-life-gold"})," Acquire Skill"]}),o.jsx("button",{onClick:()=>r(!1),className:"w-8 h-8 rounded-full flex items-center justify-center text-life-muted hover:text-life-text hover:bg-life-muted/20 transition-all",children:o.jsx(et,{size:20})})]}),o.jsx("div",{className:"p-6 overflow-y-auto",children:o.jsx(QL,{onClose:()=>r(!1)})})]})})]})},eT={Novice:"text-life-muted border-life-muted",Adept:"text-life-normal border-life-normal",Expert:"text-purple-400 border-purple-400",Master:"text-life-gold border-life-gold",Grandmaster:"text-life-diamond border-life-diamond"},e6=({stat:n,size:e=14})=>{switch(n){case te.STR:return o.jsx(Qn,{size:e});case te.INT:return o.jsx(tn,{size:e});case te.DIS:return o.jsx(dt,{size:e});case te.HEA:return o.jsx(gi,{size:e});case te.CRT:return o.jsx(kn,{size:e});case te.SPR:return o.jsx(Mi,{size:e});case te.REL:return o.jsx(mo,{size:e});case te.FIN:return o.jsx(pi,{size:e});default:return o.jsx(Lt,{size:e})}},t6=()=>{const{skillState:n,skillDispatch:e}=sn(),{dispatch:t}=Ve(),{skills:i,activeSkillId:r}=n,l=i.find(F=>F.id===r);if(!l)return null;const c=()=>{e.setActiveSkill(null)},d=()=>{e.addSkillXP(l.id,1)},p=()=>{t.setModal("confirmation",{title:"Forget Skill?",message:"Are you sure you want to remove this skill? All accrued XP and progress will be lost permanently.",confirmText:"Forget",isDangerous:!0,onConfirm:()=>{e.deleteSkill(l.id)}})},h=eT[l.rank]||eT.Novice,x=h.split(" ")[0],b=Math.min(100,l.currentXP/l.targetXP*100),T=new Date(l.createdAt),S=new Date,E=Math.max(1,Math.floor((S.getTime()-T.getTime())/(1e3*60*60*24))),D=new Date(l.lastPracticed),k=Math.floor((S.getTime()-D.getTime())/(1e3*60*60*24));return o.jsx("div",{onClick:c,className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{onClick:F=>F.stopPropagation(),className:`
                    relative bg-life-paper w-full max-w-md rounded-2xl border shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 slide-in-from-bottom-8 duration-500
                    ${l.isRusty?"border-orange-500/30":"border-life-muted/20"}
                `,children:[l.isRusty&&o.jsx("div",{className:"absolute inset-0 pointer-events-none z-0 opacity-10",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='1' fill='#f97316'/%3E%3C/svg%3E")`}}),o.jsxs("div",{className:"relative p-6 pb-8 border-b border-life-muted/20 overflow-hidden z-10",children:[o.jsx("div",{className:`absolute top-0 right-0 w-64 h-64 bg-current opacity-5 blur-[80px] rounded-full translate-x-1/2 -translate-y-1/2 pointer-events-none ${x}`}),o.jsx("button",{onClick:c,className:"absolute top-4 right-4 w-8 h-8 flex items-center justify-center rounded-full bg-life-black/50 text-life-muted hover:text-white hover:bg-life-muted/20 transition-all z-10",children:o.jsx(et,{size:20})}),o.jsxs("div",{children:[o.jsxs("div",{className:`inline-flex items-center gap-1 px-2 py-1 rounded border bg-life-black/50 text-[10px] font-black uppercase tracking-widest mb-3 ${h}`,children:[o.jsx(Xh,{size:12}),l.rank]}),o.jsx("h2",{className:`text-3xl font-black text-life-text tracking-tighter mb-1 ${l.isRusty?"opacity-80":""}`,children:l.title}),o.jsx("p",{className:"text-sm text-life-muted leading-relaxed",children:l.description||"No description provided."})]})]}),o.jsxs("div",{className:"overflow-y-auto p-6 space-y-8 relative z-10",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-end",children:[o.jsxs("span",{className:"text-4xl font-black font-mono leading-none",style:{color:b>=100?"#10b981":void 0},children:["LVL ",l.level]}),o.jsxs("span",{className:"text-xs font-mono text-life-muted mb-1",children:[o.jsx("span",{className:"text-life-text",children:l.currentXP})," / ",l.targetXP," XP"]})]}),o.jsxs("div",{className:"h-4 w-full bg-life-black rounded-full overflow-hidden border border-life-muted/20 relative",children:[o.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"linear-gradient(90deg, transparent 95%, #000 95%)",backgroundSize:"10% 100%"}}),o.jsxs("div",{className:`h-full transition-all duration-1000 ease-out relative overflow-hidden ${l.isRusty?"grayscale":""}`,style:{width:`${b}%`},children:[o.jsx("div",{className:`absolute inset-0 opacity-80 ${x.replace("text-","bg-")} shadow-[0_0_15px_currentColor]`}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent w-full -translate-x-full animate-[shimmer_2s_infinite]"})]})]})]}),l.isRusty?o.jsxs("div",{className:"p-4 rounded-xl bg-orange-900/10 border border-orange-500/30 flex items-center gap-4 animate-pulse",children:[o.jsx("div",{className:"p-2 bg-orange-500/10 rounded-full text-orange-500",children:o.jsx(hr,{size:24})}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-sm font-bold text-orange-400",children:"Skill Rusting"}),o.jsxs("p",{className:"text-[10px] text-orange-300/70",children:["Inactive for ",k," days. XP gain is paused."]})]}),o.jsx("button",{onClick:d,className:"ml-auto px-3 py-1.5 rounded bg-orange-500 text-black text-xs font-bold uppercase tracking-wider hover:bg-orange-400 transition-colors shadow-lg shadow-orange-500/20",children:"Polish"})]}):o.jsxs("div",{className:"flex items-center gap-2 text-life-easy opacity-80 p-3 rounded-lg bg-life-easy/5 border border-life-easy/10",children:[o.jsx(dt,{size:16}),o.jsxs("span",{className:"text-xs font-bold uppercase",children:["Active  ",k,"d since practice"]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-[10px] text-life-muted uppercase font-bold tracking-widest mb-3",children:"DNA Source (Parent Stats)"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:l.relatedStats.map(F=>o.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-life-black border border-life-muted/20",children:[o.jsx("div",{style:{color:ut[F]},children:o.jsx(e6,{stat:F,size:18})}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:"text-[10px] font-bold text-life-text leading-none",children:F}),o.jsx("span",{className:"text-[8px] text-life-muted leading-none mt-0.5",children:"Linked"})]})]},F))})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"p-3 rounded-lg bg-life-black border border-life-muted/20",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted mb-1",children:[o.jsx(ln,{size:12}),o.jsx("span",{className:"text-[9px] uppercase font-bold",children:"Time Invested"})]}),o.jsxs("span",{className:"text-xs font-mono text-life-text",children:[E," Days"]})]}),o.jsxs("div",{className:"p-3 rounded-lg bg-life-black border border-life-muted/20",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted mb-1",children:[o.jsx(Wn,{size:12}),o.jsx("span",{className:"text-[9px] uppercase font-bold",children:"Last Session"})]}),o.jsx("span",{className:"text-xs font-mono text-life-text",children:new Date(l.lastPracticed).toLocaleDateString()})]})]}),o.jsx("div",{className:"pt-4 border-t border-life-muted/10",children:o.jsxs("button",{onClick:p,className:"w-full py-3 flex items-center justify-center gap-2 text-life-muted hover:text-life-hard hover:bg-life-hard/5 rounded-lg transition-colors text-xs font-bold uppercase tracking-widest",children:[o.jsx(Nn,{size:14}),"Forget Skill"]})})]})]})})},n6=["S","M","T","W","T","F","S"],i6=()=>{const{habitState:n,habitDispatch:e}=ei(),{habits:t,activeHabitId:i}=n,r=t.find(k=>k.id===i);if(!r)return null;const l=S0(r.streak),c=ut[r.stat],d=Bf(r.streak),p=r.streak-d,x=(()=>{const k=[],F=new Date;for(let $=29;$>=0;$--){const M=new Date;M.setDate(F.getDate()-$);const J=M.toISOString().split("T")[0],H=r.history.some(C=>C.startsWith(J)),z=$===0;let R="neutral";H?R="done":z&&(r.status==="completed"?R="done":r.status==="failed"?R="failed":R="pending"),k.push({date:M,status:R,isToday:z})}return k})(),b=r.history.length+(r.status==="completed"?1:0),T=new Date(r.createdAt),S=Math.max(1,Math.floor((new Date().getTime()-T.getTime())/(1e3*60*60*24))),E=Math.round(b/S*100),D=()=>{var k,F;switch(r.type){case"daily":return o.jsxs("div",{className:"flex items-center gap-2 text-life-text font-medium",children:[o.jsx(wN,{size:14,className:"text-life-gold"}),o.jsx("span",{children:"Daily Protocol"})]});case"interval":return o.jsxs("div",{className:"flex items-center gap-2 text-life-text font-medium",children:[o.jsx(Lt,{size:14,className:"text-life-gold"}),o.jsxs("span",{children:["Every ",o.jsx("span",{className:"text-life-gold font-bold",children:r.intervalValue})," Days"]})]});case"specific_days":return o.jsxs("div",{className:"w-full",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 text-life-text font-medium",children:[o.jsx(Wn,{size:14,className:"text-life-gold"}),o.jsx("span",{children:"Weekly Schedule"})]}),o.jsx("div",{className:"flex justify-between gap-1 bg-life-black p-1.5 rounded-lg border border-zinc-800",children:n6.map(($,M)=>{var H;const J=(H=r.specificDays)==null?void 0:H.includes(M);return o.jsx("div",{className:`w-6 h-6 rounded flex items-center justify-center text-[10px] font-bold ${J?"bg-life-gold text-life-black":"text-life-muted/30"}`,children:$},M)})})]});case"custom":return o.jsxs("div",{className:"w-full",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2 text-life-text font-medium",children:[o.jsx(bP,{size:14,className:"text-life-gold"}),o.jsxs("span",{children:["The Matrix (",(k=r.pattern)==null?void 0:k.length," Day Loop)"]})]}),o.jsx("div",{className:"flex flex-wrap gap-0.5",children:(F=r.pattern)==null?void 0:F.split("").map(($,M)=>o.jsx("div",{className:`w-2 h-4 rounded-sm ${$==="1"?"bg-life-gold":"bg-life-muted/20"}`,title:$==="1"?"Active":"Rest"},M))})]});default:return null}};return o.jsx("div",{onClick:()=>e.setActiveHabit(null),className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{onClick:k=>k.stopPropagation(),className:"bg-life-paper w-full max-w-md rounded-2xl border border-zinc-800 shadow-2xl overflow-hidden flex flex-col max-h-[90vh] animate-in slide-in-from-bottom-8 duration-500",children:[o.jsxs("div",{className:"relative p-6 border-b border-zinc-800 overflow-hidden bg-life-black",children:[o.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-current opacity-5 blur-[80px] rounded-full translate-x-1/2 -translate-y-1/2 pointer-events-none",style:{color:c}}),o.jsx("button",{onClick:()=>e.setActiveHabit(null),className:"absolute top-4 right-4 text-life-muted hover:text-white transition-colors z-10",children:o.jsx(et,{size:20})}),o.jsxs("div",{className:"flex items-start gap-4 relative z-10",children:[o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("div",{className:"text-4xl font-black text-life-gold leading-none mb-1 drop-shadow-lg font-mono",children:r.streak}),o.jsxs("div",{className:"text-[9px] uppercase font-bold text-life-muted tracking-widest flex items-center gap-1",children:[o.jsx(Mi,{size:10,className:"text-life-gold",fill:"currentColor"})," Streak"]})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h2",{className:"text-xl font-bold text-life-text leading-tight mb-1 truncate",children:r.title}),o.jsxs("div",{className:`inline-flex items-center px-2 py-0.5 rounded border text-[9px] font-black uppercase tracking-widest ${l.phaseColor} bg-black/50`,children:["Phase: ",l.phase]})]})]})]}),o.jsxs("div",{className:"overflow-y-auto p-6 space-y-6",children:[o.jsxs("div",{className:"bg-life-black/40 border border-zinc-800 rounded-xl p-4",children:[o.jsxs("h4",{className:"text-[10px] text-life-muted uppercase font-bold tracking-widest mb-3 flex items-center gap-2",children:[o.jsx(ln,{size:12})," Execution Parameters"]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"text-xs",children:D()}),o.jsxs("div",{className:"flex items-center gap-4 pt-3 border-t border-zinc-800",children:[r.scheduledTime?o.jsxs("div",{className:"flex items-center gap-2 bg-life-gold/10 px-3 py-1.5 rounded border border-life-gold/20 text-xs font-mono font-bold text-life-gold",children:[o.jsx(ur,{size:12}),r.scheduledTime]}):o.jsx("div",{className:"text-xs text-life-muted italic",children:"No set time"}),r.isTimed&&o.jsxs("div",{className:"flex items-center gap-2 text-xs text-life-muted",children:[o.jsx(C3,{size:12}),o.jsxs("span",{children:["Duration: ",r.durationMinutes,"m"]})]})]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted/50",children:[o.jsx(Kh,{size:14}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Fibonacci Sequence"})]}),o.jsxs("span",{className:"text-[9px] font-mono text-life-gold",children:[l.progress,"% to Next Checkpoint"]})]}),o.jsxs("div",{className:"relative py-4",children:[o.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-0.5 bg-life-muted/10 -translate-y-1/2 z-0"}),o.jsx("div",{className:"flex items-center gap-4 relative z-10 overflow-x-auto no-scrollbar pb-4 px-2 snap-x",children:Dn.map(k=>{const F=r.streak>=k,$=!F&&r.streak<k&&r.streak>=(Dn[Dn.indexOf(k)-1]||0),M=k===l.prevCheckpoint;return o.jsxs("div",{className:"flex flex-col items-center gap-2 min-w-[50px] snap-center shrink-0",children:[o.jsxs("div",{className:`
                                                    w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold border-2 transition-all relative
                                                    ${F?"bg-life-gold border-life-gold text-life-black shadow-[0_0_10px_rgba(251,191,36,0.3)]":$?"bg-life-black border-life-gold text-life-gold animate-pulse scale-110 shadow-[0_0_15px_rgba(251,191,36,0.2)]":"bg-life-black border-zinc-800 text-life-muted/30"}
                                                `,children:[F?o.jsx(Os,{size:14}):$?o.jsx(ua,{size:14}):o.jsx(da,{size:12}),M&&o.jsx("div",{className:"absolute -bottom-2 -right-2 bg-life-black border border-zinc-800 rounded-full p-0.5",title:"Safety Net",children:o.jsx(Zi,{size:10,className:"text-life-text"})})]}),o.jsx("span",{className:`text-[10px] font-mono font-bold ${F||$?"text-life-text":"text-life-muted/30"}`,children:k})]},k)})})]}),o.jsxs("div",{className:"bg-life-black rounded-lg p-3 border border-zinc-800 flex items-start gap-3 relative overflow-hidden group",children:[o.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-life-hard/50"}),o.jsx(hr,{size:16,className:"text-life-hard shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex justify-between items-center mb-1",children:[o.jsx("span",{className:"text-[10px] font-bold uppercase text-life-muted",children:"Failure Consequence"}),o.jsxs("span",{className:"text-[10px] font-black text-life-hard uppercase",children:["Streak -",p]})]}),o.jsxs("div",{className:"text-xs text-life-text",children:["If you miss today, your streak will fall to ",o.jsx("span",{className:"font-mono font-bold text-life-gold",children:d}),"."]}),o.jsxs("div",{className:"text-[9px] text-life-muted/50 mt-1",children:["Reaching ",o.jsx("span",{className:"text-life-text",children:l.nextCheckpoint})," will secure your next safety net."]})]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-4 px-1",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted/50",children:[o.jsx(Lt,{size:14}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"30-Day Consistency"})]}),o.jsxs("span",{className:"text-[10px] font-mono text-life-text",children:[E,"%"]})]}),o.jsx("div",{className:"grid grid-cols-7 gap-1",children:x.map((k,F)=>o.jsx("div",{className:`
                                        aspect-square rounded flex items-center justify-center text-[9px] font-mono
                                        ${k.status==="done"?"bg-life-easy text-life-black":k.status==="failed"?"bg-life-hard/20 text-life-hard border border-life-hard/30":k.isToday?"bg-life-gold/20 text-life-gold border border-life-gold/30 animate-pulse":"bg-life-black border border-zinc-800 text-life-muted/20"}
                                    `,title:k.date.toLocaleDateString(),children:k.date.getDate()},F))})]})]})]})})},s6=({onClose:n})=>{const{state:e}=Ve(),{taskDispatch:t,taskState:i}=Zn(),{skillState:r}=sn(),{categories:l}=i,c=e.user.preferences.showCalendarSync??!0,[d,p]=K.useState(""),[h,x]=K.useState(""),[b,T]=K.useState(Ge.EASY),[S]=K.useState("medium"),[E,D]=K.useState(te.DIS),[k,F]=K.useState(""),[$,M]=K.useState(""),[J,H]=K.useState("stat"),[z,R]=K.useState([]),C=K.useRef([]),[A,P]=K.useState(!1);K.useEffect(()=>{var _e;if(A&&z.length>0){const Pe=z.length-1;(_e=C.current[Pe])==null||_e.focus(),P(!1)}},[z,A]);const L=e.ui.modalData||{},O=L.date||"",j=O?`${O}T09:00`:"",[q,le]=K.useState(O),[U,Y]=K.useState(j),[X,ie]=K.useState(!1),[pe,B]=K.useState(()=>O?[{id:`auto_rem_${Date.now()}`,minutesBefore:0,isSent:!1}]:[]),ee=L.origin,he=ee==="campaign",Q=ee==="calendar",[ae,ye]=K.useState(!1),[ue,Te]=K.useState(25);K.useEffect(()=>{U&&c?ie(!0):c||ie(!1)},[U,c]);const Ae=()=>{R([...z,""]),P(!0)},Be=(_e,Pe)=>{const He=[...z];He[_e]=Pe,R(He)},jt=(_e,Pe)=>{var He;_e.key==="Enter"||_e.key==="Shift"?(_e.preventDefault(),Pe<z.length-1?(He=C.current[Pe+1])==null||He.focus():Ae()):_e.key==="Backspace"&&z[Pe]===""&&z.length>0&&(_e.preventDefault(),Dt(Pe),Pe>0&&setTimeout(()=>{var At;return(At=C.current[Pe-1])==null?void 0:At.focus()},0))},Dt=_e=>{R(z.filter((Pe,He)=>He!==_e))},An=_e=>{if(_e===-1)return;pe.some(He=>He.minutesBefore===_e)||B([...pe,{id:`rem_${Date.now()}`,minutesBefore:_e,isSent:!1}].sort((He,At)=>He.minutesBefore-At.minutesBefore))},mt=_e=>{B(pe.filter(Pe=>Pe.id!==_e))},we=_e=>_e===0?"At time of event":_e===5?"5 mins before":_e===15?"15 mins before":_e===30?"30 mins before":_e===60?"1 hour before":_e===120?"2 hours before":_e===1440?"1 day before":`${_e} mins before`,Ee=_e=>{if(_e.preventDefault(),!d.trim())return;const He=z.filter(At=>At.trim()!=="").map((At,xo)=>({id:`st_${Date.now()}_${xo}`,title:At,isCompleted:!1}));if(t.addTask({title:d,description:h,difficulty:b,energyLevel:S,stat:E,isTimed:ae,durationMinutes:ae?ue:void 0,deadline:q||void 0,scheduledTime:U||void 0,reminders:pe,skillId:J==="skill"&&k||void 0,categoryId:$||void 0,subtasks:He,isCampaign:he,isCalendarEvent:Q}),X&&U&&c){let At=h;He.length>0&&(At+=`

Subtasks:
`+He.map(xo=>`- [ ] ${xo.title}`).join(`
`)),Wh(d,At,U,ae?ue:60)}n()},De=({type:_e})=>{switch(_e){case te.STR:return o.jsx(Qn,{size:18});case te.INT:return o.jsx(tn,{size:18});case te.DIS:return o.jsx(dt,{size:18});case te.HEA:return o.jsx(gi,{size:18});case te.CRT:return o.jsx(kn,{size:18});case te.SPR:return o.jsx(Flame,{size:18});case te.REL:return o.jsx(Users,{size:18});case te.FIN:return o.jsx(Coins,{size:18});default:return o.jsx(Lt,{size:18})}};return o.jsxs("form",{onSubmit:Ee,className:"space-y-6 animate-in slide-in-from-right fade-in duration-300",children:[he&&o.jsxs("div",{className:"bg-indigo-500/10 border border-indigo-500/30 p-2 rounded-lg flex items-center gap-2 mb-2",children:[o.jsx(is,{size:16,className:"text-indigo-400"}),o.jsx("span",{className:"text-xs font-bold text-indigo-200 uppercase tracking-widest",children:"Linked to Campaign (G12)"})]}),Q&&o.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 p-2 rounded-lg flex items-center gap-2 mb-2",children:[o.jsx(Wn,{size:16,className:"text-blue-400"}),o.jsx("span",{className:"text-xs font-bold text-blue-200 uppercase tracking-widest",children:"Linked to Calendar (C30)"})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Mission Objective"}),o.jsx("input",{type:"text",value:d,onChange:_e=>p(_e.target.value),placeholder:"e.g. Physics Homework...",autoFocus:!0,className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 text-life-text placeholder:text-life-muted/50 focus:outline-none focus:border-life-gold/50 font-medium"})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-1",children:[o.jsx(ln,{size:10})," Schedule Time"]}),o.jsx("input",{type:"datetime-local",value:U,onChange:_e=>Y(_e.target.value),className:"w-full bg-life-black border border-zinc-800 rounded-lg p-2 text-xs text-life-text focus:outline-none focus:border-life-gold/50"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-1",children:[o.jsx(Wn,{size:10})," Deadline"]}),o.jsx("input",{type:"date",value:q,onChange:_e=>le(_e.target.value),className:"w-full bg-life-black border border-zinc-800 rounded-lg p-2 text-xs text-life-text focus:outline-none focus:border-life-gold/50"})]})]}),U&&c&&o.jsxs("div",{onClick:()=>ie(!X),className:`flex items-center gap-2 p-2 rounded-lg border cursor-pointer transition-all ${X?"bg-blue-500/10 border-blue-500/50":"bg-life-black border-zinc-800"}`,children:[o.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${X?"bg-blue-500 border-blue-500 text-white":"border-zinc-800"}`,children:X&&o.jsx(Gh,{size:10})}),o.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${X?"text-blue-400":"text-life-muted"}`,children:"Sync to Google Calendar"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest flex items-center gap-1",children:[o.jsx(ur,{size:10})," Notifications"]})}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:pe.map(_e=>o.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-life-gold/10 border border-life-gold/30 rounded text-[10px] text-life-gold",children:[o.jsx("span",{children:we(_e.minutesBefore)}),o.jsx("button",{type:"button",onClick:()=>mt(_e.id),className:"hover:text-life-text",children:o.jsx(et,{size:10})})]},_e.id))}),o.jsxs("select",{value:-1,onChange:_e=>An(Number(_e.target.value)),className:"w-full bg-life-black border border-zinc-800 rounded-lg p-2 text-xs text-life-muted focus:outline-none focus:border-life-gold/50",children:[o.jsx("option",{value:-1,children:"+ Add Reminder..."}),o.jsx("option",{value:0,children:"At time of event"}),o.jsx("option",{value:5,children:"5 mins before"}),o.jsx("option",{value:15,children:"15 mins before"}),o.jsx("option",{value:30,children:"30 mins before"}),o.jsx("option",{value:60,children:"1 hour before"}),o.jsx("option",{value:120,children:"2 hours before"}),o.jsx("option",{value:1440,children:"1 day before"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-2",children:[o.jsx(Jh,{size:10})," Details / Intel"]}),o.jsx("textarea",{value:h,onChange:_e=>x(_e.target.value),placeholder:"e.g. Chapter 1, Exercises 1-5...",rows:2,className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 text-sm text-life-text placeholder:text-life-muted/50 focus:outline-none focus:border-life-gold/50 resize-none"})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest",children:"Tactical Steps (Sub-objectives)"}),o.jsxs("button",{type:"button",onClick:Ae,className:"text-[10px] flex items-center gap-1 text-life-gold hover:text-white uppercase font-bold",children:[o.jsx(nn,{size:12})," Add Step"]})]}),o.jsxs("div",{className:"space-y-2",children:[z.map((_e,Pe)=>o.jsxs("div",{className:"flex items-center gap-2 bg-life-black px-2 py-1 rounded-lg border border-zinc-800 focus-within:border-life-gold/50 transition-colors",children:[o.jsxs("span",{className:"text-[10px] text-life-muted font-mono w-4",children:[Pe+1,"."]}),o.jsx("input",{ref:He=>{C.current[Pe]=He},type:"text",value:_e,onChange:He=>Be(Pe,He.target.value),onKeyDown:He=>jt(He,Pe),placeholder:"Sub-objective...",enterKeyHint:"next",className:"flex-1 bg-transparent text-xs text-life-text focus:outline-none py-1"}),o.jsx("button",{type:"button",onClick:()=>Dt(Pe),className:"text-life-muted hover:text-life-hard p-1",children:o.jsx(Nn,{size:12})})]},Pe)),z.length===0&&o.jsx("div",{onClick:Ae,className:"text-[10px] text-life-muted/40 italic border border-dashed border-zinc-800 rounded p-2 text-center cursor-pointer hover:bg-life-muted/5 hover:text-life-muted/60",children:"No sub-objectives. Tap 'Add Step' or press + to start planning."})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Difficulty"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(Ge).map(_e=>o.jsx("button",{type:"button",onClick:()=>T(_e),className:`
                                py-3 rounded-lg text-xs font-bold uppercase tracking-wider border transition-all
                                ${b===_e?`${ui[_e]} ${Eu[_e]} shadow-[0_0_10px_rgba(0,0,0,0.5)] scale-105`:"border-zinc-800 text-life-muted hover:bg-life-muted/5"}
                            `,children:_e},_e))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Focus Timer"}),o.jsxs("div",{className:"flex bg-life-black rounded-lg border border-zinc-800 p-1 mb-2",children:[o.jsx("button",{type:"button",onClick:()=>ye(!1),className:`flex-1 py-1.5 rounded text-[10px] font-bold uppercase ${ae?"text-life-muted":"bg-life-muted/30 text-white"}`,children:"No Timer"}),o.jsx("button",{type:"button",onClick:()=>ye(!0),className:`flex-1 py-1.5 rounded text-[10px] font-bold uppercase ${ae?"bg-life-gold text-life-black":"text-life-muted"}`,children:"With Timer"})]}),ae&&o.jsxs("div",{className:"flex items-center gap-2 animate-in slide-in-from-top-2",children:[o.jsx(ln,{size:14,className:"text-life-gold"}),o.jsx("input",{type:"number",value:ue,onChange:_e=>Te(parseInt(_e.target.value)||0),className:"w-16 bg-life-black border border-zinc-800 rounded p-1 text-center text-sm font-bold focus:border-life-gold outline-none"}),o.jsx("span",{className:"text-xs text-life-muted",children:"minutes duration"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Category"}),o.jsxs("div",{className:"relative",children:[o.jsx(vN,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-life-muted",size:16}),o.jsxs("select",{value:$,onChange:_e=>M(_e.target.value),className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 pl-10 text-xs text-life-text appearance-none focus:outline-none focus:border-life-gold/50",children:[o.jsx("option",{value:"",children:"(Uncategorized)"}),l.map(_e=>o.jsx("option",{value:_e.id,children:_e.title},_e.id))]}),o.jsx(Bt,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-life-muted rotate-90",size:14})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Reward Source"}),o.jsxs("div",{className:"flex bg-life-black rounded-lg border border-zinc-800 p-1 mb-4",children:[o.jsx("button",{type:"button",onClick:()=>H("stat"),className:`flex-1 py-2 rounded-md text-[10px] font-bold uppercase transition-all ${J==="stat"?"bg-life-gold text-life-black shadow-sm":"text-life-muted hover:text-white hover:bg-white/5"}`,children:"Attribute Focus"}),o.jsx("button",{type:"button",onClick:()=>H("skill"),className:`flex-1 py-2 rounded-md text-[10px] font-bold uppercase transition-all ${J==="skill"?"bg-life-gold text-life-black shadow-sm":"text-life-muted hover:text-white hover:bg-white/5"}`,children:"Skill Link"})]}),J==="stat"?o.jsx("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:o.jsx("div",{className:"grid grid-cols-7 gap-2",children:Object.values(te).map(_e=>o.jsxs("button",{type:"button",onClick:()=>D(_e),className:`
                                        flex flex-col items-center justify-center p-2 rounded border transition-all aspect-square
                                        ${E===_e?"bg-life-muted/10 border-current shadow-sm scale-105":"border-zinc-800 text-life-muted opacity-50 hover:opacity-100"}
                                    `,style:{color:E===_e?ut[_e]:void 0},children:[o.jsx(De,{type:_e}),o.jsx("span",{className:"text-[8px] font-bold mt-1",children:_e})]},_e))})}):o.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300 space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-life-muted",size:16}),o.jsxs("select",{value:k,onChange:_e=>{const Pe=_e.target.value;F(Pe);const He=r.skills.find(At=>At.id===Pe);He&&He.relatedStats.length>0&&D(He.relatedStats[0])},className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 pl-10 text-xs text-life-text appearance-none focus:outline-none focus:border-life-gold/50",children:[o.jsx("option",{value:"",children:"Select a Skill..."}),r.skills.map(_e=>o.jsxs("option",{value:_e.id,children:[_e.title," (Lvl ",_e.level,")"]},_e.id))]}),o.jsx(Bt,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-life-muted rotate-90",size:14})]}),k&&o.jsxs("div",{className:"p-3 bg-life-gold/10 border border-life-gold/20 rounded-lg flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-life-gold/20 rounded-full text-life-gold",children:o.jsx(dt,{size:14})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-[10px] text-life-gold font-bold uppercase tracking-wider",children:"Auto-Linked Attribute"}),o.jsx("p",{className:"text-xs text-life-text font-mono",children:E})]})]})]})]}),o.jsxs("button",{type:"submit",className:`
                    w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all mt-4
                    ${d?"bg-life-gold text-life-black hover:bg-yellow-400 shadow-[0_0_20px_rgba(251,191,36,0.3)]":"bg-life-muted/20 text-life-muted cursor-not-allowed"}
                `,disabled:!d,children:["Confirm Mission ",o.jsx(Bt,{size:16})]})]})},r6=["S","M","T","W","T","F","S"],o6=({habitType:n,setHabitType:e,selectedDays:t,toggleDay:i,intervalVal:r,setIntervalVal:l,pattern:c,setPattern:d,reps:p,setReps:h})=>{const x=S=>{const E=c.split("");E[S]=E[S]==="1"?"0":"1",d(E.join(""))},b=()=>d(S=>S+"1"),T=()=>{c.length>1&&d(S=>S.slice(0,-1))};return o.jsxs("div",{className:"p-4 bg-life-black/40 rounded-xl border border-life-muted/10 space-y-4",children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest",children:"Habit Taxonomy"}),o.jsx("div",{className:"grid grid-cols-2 gap-2",children:[{id:"daily",label:"Daily",icon:o.jsx(ln,{size:14})},{id:"specific_days",label:"Specific Days",icon:o.jsx(Wn,{size:14})},{id:"interval",label:"Interval",icon:o.jsx(ns,{size:14})},{id:"custom",label:"The Matrix",icon:o.jsx(cP,{size:14})}].map(S=>o.jsxs("button",{type:"button",onClick:()=>e(S.id),className:`
                            flex items-center justify-center gap-2 py-3 rounded-lg border text-xs font-bold uppercase tracking-wider transition-all
                            ${n===S.id?"bg-life-gold/10 border-life-gold text-life-gold":"bg-life-black border-life-muted/20 text-life-muted hover:border-life-muted/50"}
                        `,children:[S.icon," ",S.label]},S.id))}),n==="specific_days"&&o.jsx("div",{className:"flex justify-between gap-1 pt-2",children:r6.map((S,E)=>o.jsx("button",{type:"button",onClick:()=>i(E),className:`w-10 h-10 rounded-lg border flex items-center justify-center text-sm font-bold transition-all ${t.includes(E)?"bg-life-easy border-life-easy text-life-black":"border-life-muted/30 text-life-muted hover:bg-life-muted/10"}`,children:S},E))}),n==="interval"&&o.jsxs("div",{className:"pt-2 flex items-center gap-4",children:[o.jsx("span",{className:"text-sm text-life-muted",children:"Every"}),o.jsx("input",{type:"number",min:"2",max:"365",value:r,onChange:S=>l(parseInt(S.target.value)||2),className:"w-20 bg-life-black border border-life-muted/50 rounded-lg p-2 text-center text-life-text font-mono font-bold focus:border-life-gold focus:outline-none"}),o.jsx("span",{className:"text-sm text-life-muted",children:"Days"})]}),n==="custom"&&o.jsxs("div",{className:"pt-2",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("p",{className:"text-[10px] text-life-muted",children:"The Matrix Pattern"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{type:"button",onClick:T,className:"w-6 h-6 flex items-center justify-center rounded border border-life-muted/30 text-life-muted hover:text-white hover:border-life-muted/50 transition-all",children:o.jsx(fh,{size:12})}),o.jsxs("span",{className:"text-[10px] font-mono text-life-gold min-w-[24px] text-center",children:[c.length,"d"]}),o.jsx("button",{type:"button",onClick:b,className:"w-6 h-6 flex items-center justify-center rounded border border-life-muted/30 text-life-muted hover:text-white hover:border-life-muted/50 transition-all",children:o.jsx(nn,{size:12})}),o.jsx("div",{className:"w-px h-3 bg-life-muted/20 mx-1"}),o.jsxs("button",{type:"button",onClick:()=>d(c.includes("0")?"11111111111111":"00000000000000"),className:"text-[10px] text-life-gold hover:underline flex items-center gap-1",children:[o.jsx(yx,{size:10})," Reset"]})]})]}),o.jsx("div",{className:"flex flex-wrap gap-1",children:c.split("").map((S,E)=>o.jsx("button",{type:"button",onClick:()=>x(E),className:`w-6 h-8 rounded border text-[9px] font-mono flex items-center justify-center transition-all ${S==="1"?"bg-life-gold border-life-gold text-life-black":"bg-life-black border-life-muted/20 text-life-muted/30 hover:bg-life-muted/10"}`,title:S==="1"?"Active Day":"Rest Day",children:S},E))})]})]})},a6=({onClose:n})=>{const{state:e}=Ve(),{habitDispatch:t,habitState:i}=ei(),{skillState:r}=sn(),{categories:l}=i,c=e.user.preferences.showCalendarSync??!0,[d,p]=K.useState(""),[h,x]=K.useState(Ge.EASY),[b,T]=K.useState(te.DIS),[S,E]=K.useState(""),[D,k]=K.useState(""),[F,$]=K.useState("stat"),[M,J]=K.useState("daily"),[H,z]=K.useState(""),[R,C]=K.useState([]),[A,P]=K.useState(2),[L,O]=K.useState("10101010101010"),[j,q]=K.useState(1),[le,U]=K.useState(!1),[Y,X]=K.useState(30),[ie,pe]=K.useState(""),[B,ee]=K.useState([]),[he,Q]=K.useState(!1),[ae,ye]=K.useState([]),ue=K.useRef([]),[Te,Ae]=K.useState(!1);K.useEffect(()=>{var Ee;if(Te&&ae.length>0){const De=ae.length-1;(Ee=ue.current[De])==null||Ee.focus(),Ae(!1)}},[ae,Te]),K.useEffect(()=>{ie&&c?Q(!0):c||Q(!1)},[ie,c]);const Be=Ee=>{R.includes(Ee)?C(R.filter(De=>De!==Ee)):C([...R,Ee].sort())},jt=()=>{ye([...ae,""]),Ae(!0)},Dt=(Ee,De)=>{const _e=[...ae];_e[Ee]=De,ye(_e)},An=Ee=>ye(ae.filter((De,_e)=>_e!==Ee)),mt=Ee=>{if(Ee.preventDefault(),!d.trim())return;const De=ae.filter(_e=>_e.trim()!=="").map((_e,Pe)=>({id:`st_${Date.now()}_${Pe}`,title:_e,isCompleted:!1}));if(t.addHabit({title:d,description:H,skillId:F==="skill"&&D||void 0,difficulty:h,stat:b,type:M,categoryId:S||void 0,specificDays:M==="specific_days"?R:void 0,intervalValue:M==="interval"?A:void 0,pattern:M==="custom"?L:void 0,isTimed:le,durationMinutes:le?Y:void 0,scheduledTime:ie||void 0,reminders:B,subtasks:De,dailyTarget:j}),he&&ie&&c){const _e=new Date,[Pe,He]=ie.split(":").map(Number),At=new Date(_e.getFullYear(),_e.getMonth(),_e.getDate(),Pe,He);Wh(`[Protocol] ${d}`,`${H}

Generated by LifeOS`,At.toISOString(),le?Y:30)}n()},we=({type:Ee})=>{switch(Ee){case te.STR:return o.jsx(Qn,{size:18});case te.INT:return o.jsx(tn,{size:18});case te.DIS:return o.jsx(dt,{size:18});case te.HEA:return o.jsx(gi,{size:18});case te.CRT:return o.jsx(kn,{size:18});case te.SPR:return o.jsx(Flame,{size:18});case te.REL:return o.jsx(Users,{size:18});case te.FIN:return o.jsx(Coins,{size:18});default:return o.jsx(Lt,{size:18})}};return o.jsxs("form",{onSubmit:mt,className:"space-y-6 animate-in slide-in-from-right fade-in duration-300",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Protocol Name"}),o.jsx("input",{type:"text",value:d,onChange:Ee=>p(Ee.target.value),placeholder:"e.g. Read 20 pages...",autoFocus:!0,className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 text-life-text placeholder:text-life-muted/50 focus:outline-none focus:border-life-gold/50 transition-all font-medium"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-1",children:[o.jsx(ln,{size:10})," Daily Time"]}),o.jsx("input",{type:"time",value:ie,onChange:Ee=>pe(Ee.target.value),className:"w-full bg-life-black border border-zinc-800 rounded-lg p-2 text-xs text-life-text focus:outline-none focus:border-life-gold/50"})]}),ie&&c&&o.jsxs("div",{onClick:()=>Q(!he),className:`flex items-center gap-2 p-2 rounded-lg border cursor-pointer transition-all ${he?"bg-blue-500/10 border-blue-500/50":"bg-life-black border-zinc-800"}`,children:[o.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${he?"bg-blue-500 border-blue-500 text-white":"border-zinc-800"}`,children:he&&o.jsx(Gh,{size:10})}),o.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${he?"text-blue-400":"text-life-muted"}`,children:"Sync to Google Calendar (Daily Event)"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest",children:"Side Missions (Routine Steps)"}),o.jsxs("button",{type:"button",onClick:jt,className:"text-[10px] uppercase font-bold text-life-gold flex items-center gap-1",children:[o.jsx(nn,{size:12})," Add Step"]})]}),o.jsx("div",{className:"space-y-2",children:ae.map((Ee,De)=>o.jsxs("div",{className:"flex items-center gap-2 bg-life-black/40 px-2 py-1 rounded-lg border border-zinc-800 focus-within:border-life-gold/50 transition-colors",children:[o.jsxs("span",{className:"text-[10px] text-life-muted font-mono w-4",children:[De+1,"."]}),o.jsx("input",{ref:_e=>{ue.current[De]=_e},type:"text",value:Ee,onChange:_e=>Dt(De,_e.target.value),className:"flex-1 bg-transparent text-xs text-life-text focus:outline-none py-1"}),o.jsx("button",{type:"button",onClick:()=>An(De),className:"text-life-muted hover:text-life-hard p-1",children:o.jsx(Nn,{size:12})})]},De))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Category / Section"}),o.jsxs("div",{className:"relative",children:[o.jsx(vN,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-life-muted",size:16}),o.jsxs("select",{value:S,onChange:Ee=>E(Ee.target.value),className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 pl-10 text-sm text-life-text appearance-none focus:outline-none focus:border-life-gold/50",children:[o.jsx("option",{value:"",children:"(Uncategorized)"}),l.map(Ee=>o.jsx("option",{value:Ee.id,children:Ee.title},Ee.id))]}),o.jsx(Bt,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-life-muted rotate-90",size:16})]})]})]}),o.jsx(o6,{habitType:M,setHabitType:J,selectedDays:R,toggleDay:Be,intervalVal:A,setIntervalVal:P,pattern:L,setPattern:O,reps:j,setReps:q}),o.jsx("div",{className:"p-4 bg-life-black/40 rounded-xl border border-zinc-800 space-y-2",children:o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest flex items-center gap-2",children:[o.jsx(wN,{size:12})," Daily Iterations"]}),o.jsxs("div",{className:"flex items-center gap-3 bg-life-black rounded-lg border border-zinc-800 p-1",children:[o.jsx("button",{type:"button",onClick:()=>q(Math.max(1,j-1)),className:"w-8 h-8 rounded border border-zinc-800 flex items-center justify-center hover:bg-life-muted/10 text-life-muted hover:text-white transition-colors",children:o.jsx(fh,{size:14})}),o.jsx("span",{className:"text-sm font-mono font-bold text-life-gold w-6 text-center",children:j}),o.jsx("button",{type:"button",onClick:()=>q(Math.min(99,j+1)),className:"w-8 h-8 rounded border border-zinc-800 flex items-center justify-center hover:bg-life-muted/10 text-life-muted hover:text-white transition-colors",children:o.jsx(nn,{size:14})})]})]})}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Threat Level"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(Ge).map(Ee=>o.jsx("button",{type:"button",onClick:()=>x(Ee),className:`py-2 rounded-lg text-xs font-bold uppercase tracking-wider border transition-all ${h===Ee?`${ui[Ee]} ${Eu[Ee]} shadow-[0_0_10px_rgba(0,0,0,0.5)] scale-105`:"border-zinc-800 text-life-muted hover:bg-life-muted/5"}`,children:Ee},Ee))})]}),o.jsxs("div",{className:"flex bg-life-black rounded-lg border border-zinc-800 p-1 mb-2",children:[o.jsx("button",{type:"button",onClick:()=>U(!1),className:`flex-1 py-1.5 rounded text-[10px] font-bold uppercase ${le?"text-life-muted":"bg-life-muted/30 text-white"}`,children:"No Timer"}),o.jsx("button",{type:"button",onClick:()=>U(!0),className:`flex-1 py-1.5 rounded text-[10px] font-bold uppercase ${le?"bg-life-gold text-life-black":"text-life-muted"}`,children:"With Timer"})]}),le&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ln,{size:14,className:"text-life-gold"}),o.jsx("input",{type:"number",value:Y,onChange:Ee=>X(parseInt(Ee.target.value)||0),className:"w-16 bg-life-black border border-zinc-800 rounded p-1 text-center text-sm font-bold focus:border-life-gold outline-none"}),o.jsx("span",{className:"text-xs text-life-muted",children:"mins"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Reward Source"}),o.jsxs("div",{className:"flex bg-life-black rounded-lg border border-zinc-800 p-1 mb-4",children:[o.jsx("button",{type:"button",onClick:()=>$("stat"),className:`flex-1 py-2 rounded-md text-[10px] font-bold uppercase transition-all ${F==="stat"?"bg-life-gold text-life-black shadow-sm":"text-life-muted hover:text-white hover:bg-white/5"}`,children:"Attribute Focus"}),o.jsx("button",{type:"button",onClick:()=>$("skill"),className:`flex-1 py-2 rounded-md text-[10px] font-bold uppercase transition-all ${F==="skill"?"bg-life-gold text-life-black shadow-sm":"text-life-muted hover:text-white hover:bg-white/5"}`,children:"Skill Link"})]}),F==="stat"?o.jsx("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:o.jsx("div",{className:"grid grid-cols-7 gap-2",children:Object.values(te).map(Ee=>o.jsxs("button",{type:"button",onClick:()=>T(Ee),className:`
                                        flex flex-col items-center justify-center p-2 rounded-lg border transition-all aspect-square
                                        ${b===Ee?"bg-life-muted/10 border-current shadow-lg scale-110":"border-zinc-800 text-life-muted opacity-70 hover:opacity-100 hover:bg-life-muted/5"}
                                    `,style:{color:b===Ee?ut[Ee]:void 0},children:[o.jsx(we,{type:Ee}),o.jsx("span",{className:"text-[9px] font-bold mt-1",children:Ee})]},Ee))})}):o.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300 space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-life-muted",size:16}),o.jsxs("select",{value:D,onChange:Ee=>{const De=Ee.target.value;k(De);const _e=r.skills.find(Pe=>Pe.id===De);_e&&_e.relatedStats.length>0&&T(_e.relatedStats[0])},className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 pl-10 text-xs text-life-text appearance-none focus:outline-none focus:border-life-gold/50",children:[o.jsx("option",{value:"",children:"Select a Skill..."}),r.skills.map(Ee=>o.jsxs("option",{value:Ee.id,children:[Ee.title," (Lvl ",Ee.level,")"]},Ee.id))]}),o.jsx(Bt,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-life-muted rotate-90",size:14})]}),D&&o.jsxs("div",{className:"p-3 bg-life-gold/10 border border-life-gold/20 rounded-lg flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-life-gold/20 rounded-full text-life-gold",children:o.jsx(dt,{size:14})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-[10px] text-life-gold font-bold uppercase tracking-wider",children:"Auto-Linked Attribute"}),o.jsx("p",{className:"text-xs text-life-text font-mono",children:b})]})]})]})]}),o.jsxs("button",{type:"submit",className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all mt-4 ${d?"bg-life-gold text-life-black hover:bg-yellow-400 shadow-[0_0_20px_rgba(251,191,36,0.3)]":"bg-life-muted/20 text-life-muted cursor-not-allowed"}`,disabled:!d,children:["Install Protocol ",o.jsx(Bt,{size:16})]})]})},l6=({stepIndex:n,step:e,parentDifficulty:t,parentStat:i,parentSkillId:r,onUpdate:l,onClose:c,onAddSubtask:d,onRemoveSubtask:p,onChangeSubtask:h,onAddReminder:x,onRemoveReminder:b})=>{const{skillState:T}=sn(),S=K.useRef([]);K.useEffect(()=>{var M;if(e.subtasks.length>0){const J=e.subtasks.length-1;e.subtasks[J].title===""&&((M=S.current[J])==null||M.focus())}},[e.subtasks.length]);const E=e.difficulty||t,D=e.stat||i,k=T.skills.find(M=>M.id===r),F=M=>M===0?"At time":M===60?"1h before":M===1440?"1d before":`${M}m before`,$=({type:M})=>{switch(M){case te.STR:return o.jsx(Qn,{size:18});case te.INT:return o.jsx(tn,{size:18});case te.DIS:return o.jsx(dt,{size:18});case te.HEA:return o.jsx(gi,{size:18});case te.CRT:return o.jsx(kn,{size:18});case te.SPR:return o.jsx(Flame,{size:18});case te.REL:return o.jsx(Users,{size:18});case te.FIN:return o.jsx(Coins,{size:18});default:return o.jsx(Lt,{size:18})}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-300",children:o.jsxs("div",{className:"bg-life-paper w-full max-w-md rounded-2xl border border-life-muted/20 shadow-2xl flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-300",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-life-muted/20 bg-life-black/50 shrink-0",children:[o.jsxs("h3",{className:"text-sm font-black tracking-tight text-life-text flex items-center gap-2 uppercase",children:[o.jsx("span",{className:"text-life-gold",children:"///"})," Edit Step ",n+1]}),o.jsx("button",{onClick:c,className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"p-4 flex-1 overflow-y-auto space-y-6 custom-scrollbar",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Tactical Objective"}),o.jsx("input",{type:"text",value:e.title,onChange:M=>l(n,"title",M.target.value),placeholder:"e.g. Secure the perimeter...",autoFocus:!0,className:"w-full bg-life-black border border-life-muted/30 rounded-lg p-3 text-sm text-life-text font-medium placeholder:text-life-muted/50 focus:outline-none focus:border-life-gold/50 transition-all"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-1",children:[o.jsx(da,{size:10})," Inherited Skill"]}),o.jsxs("div",{className:"flex items-center gap-3 bg-life-black/30 p-3 rounded-lg border border-life-muted/20 opacity-70",children:[o.jsx(hi,{size:16,className:"text-life-gold"}),o.jsx("span",{className:"text-xs font-bold text-life-text",children:k?`${k.title} (Lvl ${k.level})`:"No Skill Linked"}),o.jsx("span",{className:"ml-auto text-[8px] uppercase font-black text-life-muted tracking-widest",children:"Locked"})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest",children:"Threat Level"}),!e.difficulty&&o.jsx("span",{className:"text-[8px] uppercase font-black text-life-gold/50 tracking-widest",children:"Inherited"})]}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(Ge).map(M=>o.jsx("button",{type:"button",onClick:()=>{e.difficulty===M?l(n,"difficulty",void 0):l(n,"difficulty",M)},className:`py-3 rounded-lg text-xs font-bold uppercase tracking-wider border transition-all ${E===M?`${ui[M]} ${Eu[M]} shadow-lg scale-[1.02]`:"border-life-muted/20 text-life-muted hover:bg-life-muted/5"}`,children:M},M))})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest",children:"Attribute Focus"}),!e.stat&&o.jsx("span",{className:"text-[8px] uppercase font-black text-life-gold/50 tracking-widest",children:"Inherited"})]}),o.jsx("div",{className:"grid grid-cols-7 gap-2",children:Object.values(te).map(M=>{const J=D===M;return o.jsxs("button",{type:"button",onClick:()=>{e.stat===M?l(n,"stat",void 0):l(n,"stat",M)},className:`flex flex-col items-center justify-center p-2 rounded-lg border transition-all aspect-square relative ${J?"bg-life-muted/10 border-current shadow-lg scale-110":"border-life-muted/20 text-life-muted hover:bg-life-muted/5 opacity-70 hover:opacity-100"}`,style:{color:J?ut[M]:void 0},children:[o.jsx($,{type:M}),o.jsx("span",{className:"text-[8px] font-bold mt-1",children:M}),J&&o.jsx("div",{className:"absolute top-1 right-1 w-1.5 h-1.5 rounded-full bg-current shadow-[0_0_5px_currentColor]"})]},M)})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Focus Timer"}),o.jsxs("div",{className:"flex bg-life-black border border-life-muted/20 rounded-lg p-1",children:[o.jsx("button",{type:"button",onClick:()=>l(n,"isTimed",!1),className:`flex-1 py-2 rounded-md text-[10px] font-bold uppercase tracking-wider transition-all ${e.isTimed?"text-life-muted hover:text-life-silver":"bg-life-muted/20 text-white shadow-sm"}`,children:"No Timer"}),o.jsx("button",{type:"button",onClick:()=>l(n,"isTimed",!0),className:`flex-1 py-2 rounded-md text-[10px] font-bold uppercase tracking-wider transition-all ${e.isTimed?"bg-life-gold/20 text-life-gold shadow-sm":"text-life-muted hover:text-life-silver"}`,children:"With Timer"})]}),e.isTimed&&o.jsx("div",{className:"mt-3 animate-in slide-in-from-top-2 fade-in",children:o.jsxs("div",{className:"flex items-center gap-3 bg-life-black/50 p-3 rounded-lg border border-life-gold/20",children:[o.jsx(ln,{className:"text-life-gold",size:18}),o.jsx("input",{type:"number",value:e.durationMinutes||0,onChange:M=>l(n,"durationMinutes",Number(M.target.value)),className:"flex-1 bg-transparent text-lg font-mono text-white focus:outline-none",placeholder:"0"}),o.jsx("span",{className:"text-xs font-bold text-life-muted uppercase",children:"Minutes"})]})})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-1",children:[o.jsx(ln,{size:12})," Scheduled Start (Optional)"]}),o.jsx("input",{type:"datetime-local",value:e.scheduledTime||"",onChange:M=>l(n,"scheduledTime",M.target.value),className:"w-full bg-life-black border border-life-muted/30 rounded-lg p-3 text-xs text-life-text focus:outline-none focus:border-life-gold/50 transition-all"})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest",children:"Tactical Steps (Sub-objectives)"}),o.jsxs("button",{type:"button",onClick:()=>d(n),className:"text-[10px] flex items-center gap-1 text-life-gold hover:text-white transition-colors uppercase font-bold",children:[o.jsx(nn,{size:12})," Add Step"]})]}),e.subtasks.length===0?o.jsx("div",{onClick:()=>d(n),className:"border border-dashed border-life-muted/20 rounded-lg p-4 text-center cursor-pointer hover:bg-life-muted/5 transition-colors group",children:o.jsx("p",{className:"text-[10px] text-life-muted group-hover:text-life-silver",children:"No sub-objectives. Tap 'Add Step' to start planning."})}):o.jsx("div",{className:"space-y-2",children:e.subtasks.map((M,J)=>o.jsxs("div",{className:"flex items-center gap-2 bg-life-black p-2 rounded-lg border border-life-muted/20 focus-within:border-life-gold/50 transition-all",children:[o.jsx("div",{className:"w-4 h-4 rounded border border-life-muted/30 flex items-center justify-center shrink-0",children:o.jsx("div",{className:"w-2 h-2 rounded-sm bg-life-muted/20"})}),o.jsx("input",{ref:H=>{S.current[J]=H},type:"text",value:M.title,onChange:H=>h(n,J,H.target.value),onKeyDown:H=>{var z;H.key==="Enter"&&(H.preventDefault(),J<e.subtasks.length-1?(z=S.current[J+1])==null||z.focus():d(n))},placeholder:"Sub-objective...",className:"flex-1 bg-transparent text-xs text-life-text focus:outline-none"}),o.jsx("button",{type:"button",onClick:()=>p(n,M.id),className:"text-life-muted hover:text-life-hard p-1 opacity-50 hover:opacity-100",children:o.jsx(Nn,{size:12})})]},M.id))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-1",children:[o.jsx(Ol,{size:12})," Intel / Notes"]}),o.jsx("textarea",{value:e.notes,onChange:M=>l(n,"notes",M.target.value),placeholder:"Add detailed instructions, links, or coordinates...",className:"w-full h-24 bg-life-black border border-life-muted/30 rounded-lg p-3 text-xs text-life-text focus:border-life-gold outline-none resize-none font-mono leading-relaxed"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-1",children:[o.jsx(ur,{size:12})," Alerts"]}),o.jsxs("div",{className:"bg-life-black border border-life-muted/20 rounded-lg p-2",children:[o.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.reminders.map(M=>o.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-life-gold/10 border border-life-gold/30 rounded text-[9px] text-life-gold font-bold",children:[o.jsx("span",{children:F(M.minutesBefore)}),o.jsx("button",{type:"button",onClick:()=>b(n,M.id),className:"hover:text-white",children:o.jsx(et,{size:10})})]},M.id)),e.reminders.length===0&&o.jsx("span",{className:"text-[10px] text-life-muted italic p-1",children:"No active alerts"})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:-1,onChange:M=>x(n,Number(M.target.value)),className:"w-full bg-life-black/50 border border-life-muted/30 rounded p-2 text-xs text-life-muted focus:outline-none focus:border-life-gold/50 appearance-none",children:[o.jsx("option",{value:-1,children:"+ Add Reminder"}),o.jsx("option",{value:0,children:"At scheduled time"}),o.jsx("option",{value:5,children:"5 mins before"}),o.jsx("option",{value:15,children:"15 mins before"}),o.jsx("option",{value:30,children:"30 mins before"}),o.jsx("option",{value:60,children:"1 hour before"})]}),o.jsx(Bt,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-life-muted rotate-90 pointer-events-none",size:14})]})]})]}),o.jsx("div",{className:"h-4"})]}),o.jsx("div",{className:"p-4 bg-life-black/80 border-t border-life-muted/20 shrink-0",children:o.jsx("button",{onClick:c,className:"w-full py-3 rounded-xl bg-life-gold text-life-black font-black uppercase tracking-widest text-xs hover:bg-yellow-400 transition-all shadow-lg shadow-life-gold/10",children:"Apply Tactical Intel"})})]})})},c6=({onClose:n})=>{var Y;const{state:e}=Ve(),{raidDispatch:t}=ss(),{skillState:i}=sn(),[r,l]=K.useState(""),c=(Y=e.ui.modalData)!=null&&Y.date?e.ui.modalData.date.split("T")[0]:"",[d,p]=K.useState(c),[h,x]=K.useState(Ge.EASY),[b,T]=K.useState([te.DIS]),[S,E]=K.useState(""),[D,k]=K.useState("stat"),[F,$]=K.useState([{id:`temp_${Date.now()}_1`,title:"",notes:"",subtasks:[],reminders:[]},{id:`temp_${Date.now()}_2`,title:"",notes:"",subtasks:[],reminders:[]}]),M=K.useRef([]),[J,H]=K.useState(null);K.useEffect(()=>{var X;if(F.length>0){const ie=F.length-1;F[ie].title===""&&((X=M.current[ie])==null||X.focus())}},[F.length]);const z=()=>{$([...F,{id:`temp_${Date.now()}_${F.length+1}`,title:"",notes:"",subtasks:[],reminders:[],difficulty:void 0,stat:void 0}])},R=X=>{$(F.filter((ie,pe)=>pe!==X))},C=(X,ie,pe)=>{const B=[...F];B[X]={...B[X],[ie]:pe},$(B)},A=X=>{const ie={id:`st_new_${Date.now()}`,title:"",isCompleted:!1},pe=[...F];pe[X].subtasks.push(ie),$(pe)},P=(X,ie,pe)=>{const B=[...F];B[X].subtasks[ie].title=pe,$(B)},L=(X,ie)=>{const pe=[...F];pe[X].subtasks=pe[X].subtasks.filter(B=>B.id!==ie),$(pe)},O=(X,ie)=>{if(ie===-1||F[X].reminders.some(he=>he.minutesBefore===ie))return;const B={id:`rem_new_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,minutesBefore:ie,isSent:!1},ee=[...F];ee[X].reminders.push(B),ee[X].reminders.sort((he,Q)=>he.minutesBefore-Q.minutesBefore),$(ee)},j=(X,ie)=>{const pe=[...F];pe[X].reminders=pe[X].reminders.filter(B=>B.id!==ie),$(pe)},q=X=>{b.includes(X)?T(b.filter(ie=>ie!==X)):b.length<3&&T([...b,X])},le=X=>{if(X.preventDefault(),!r.trim()||b.length===0)return;const ie=F.filter(pe=>pe.title.trim()!=="").map((pe,B)=>({id:`rs_${Date.now()}_${B}`,title:pe.title,notes:pe.notes,subtasks:pe.subtasks.filter(ee=>ee.title.trim()!==""),reminders:pe.reminders,isCompleted:!1,isLocked:B>0,difficulty:pe.difficulty,stat:pe.stat,scheduledTime:pe.scheduledTime,deadline:pe.deadline,isTimed:pe.isTimed,durationMinutes:pe.durationMinutes}));if(ie.length===0){alert("Operation must have at least one step.");return}t.addRaid({title:r,deadline:d||void 0,difficulty:h,stats:b,skillId:D==="skill"&&S||void 0,steps:ie}),n()},U=({type:X})=>{switch(X){case te.STR:return o.jsx(Qn,{size:18});case te.INT:return o.jsx(tn,{size:18});case te.DIS:return o.jsx(dt,{size:18});case te.HEA:return o.jsx(gi,{size:18});case te.CRT:return o.jsx(kn,{size:18});case te.SPR:return o.jsx(Flame,{size:18});case te.REL:return o.jsx(Users,{size:18});case te.FIN:return o.jsx(Coins,{size:18});default:return o.jsx(Lt,{size:18})}};return o.jsxs(o.Fragment,{children:[o.jsxs("form",{onSubmit:le,className:"space-y-6 animate-in slide-in-from-right fade-in duration-300",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Operation Title"}),o.jsx("input",{type:"text",value:r,onChange:X=>l(X.target.value),placeholder:"e.g. Master React Native...",autoFocus:!0,className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 text-life-text placeholder:text-life-muted/50 focus:outline-none focus:border-life-gold/50 transition-all font-medium"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Deadline (Target Date)"}),o.jsxs("div",{className:"relative",children:[o.jsx(Wn,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-life-muted",size:16}),o.jsx("input",{type:"date",value:d,onChange:X=>p(X.target.value),className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 pl-10 text-life-text focus:outline-none focus:border-life-gold/50 text-sm"})]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest",children:"Tactical Steps & Intel"}),o.jsxs("button",{type:"button",onClick:z,className:"text-[10px] flex items-center gap-1 text-life-gold hover:text-white transition-colors uppercase font-bold",children:[o.jsx(nn,{size:12})," Add Step"]})]}),o.jsx("div",{className:"space-y-3",children:F.map((X,ie)=>o.jsxs("div",{className:"bg-life-black/40 p-3 rounded-lg border border-zinc-800",children:[o.jsxs("div",{className:"flex gap-2 items-center mb-2",children:[o.jsxs("span",{className:"text-[10px] font-mono text-life-muted w-4",children:[ie+1,"."]}),o.jsx("input",{ref:pe=>{M.current[ie]=pe},type:"text",value:X.title,onChange:pe=>C(ie,"title",pe.target.value),onKeyDown:pe=>{var B;pe.key==="Enter"&&(pe.preventDefault(),ie<F.length-1?(B=M.current[ie+1])==null||B.focus():z())},placeholder:`Step ${ie+1} objective...`,className:"flex-1 bg-transparent border-b border-zinc-800 px-2 py-1 text-sm text-life-text focus:outline-none focus:border-life-gold/50"}),F.length>1&&o.jsx("button",{type:"button",onClick:()=>R(ie),className:"text-life-muted hover:text-life-hard p-1",children:o.jsx(Nn,{size:14})})]}),o.jsx("div",{className:"pl-6",children:o.jsxs("button",{type:"button",onClick:()=>H(ie),className:`w-full flex items-center gap-3 p-2 rounded-md border text-xs text-left transition-all ${X.notes||X.subtasks.length>0||X.reminders.length>0?"bg-life-gold/5 border-life-gold/30 text-life-text":"bg-transparent border-dashed border-zinc-800 text-life-muted hover:text-life-gold hover:border-life-gold/50"}`,children:[o.jsx(Ol,{size:14,className:X.notes?"text-life-gold":"opacity-50"}),o.jsx("div",{className:"flex-1 truncate",children:X.notes?X.notes:o.jsx("span",{className:"opacity-50",children:"+ Add Intel, Subtasks, Alerts"})}),(X.subtasks.length>0||X.reminders.length>0)&&o.jsxs("div",{className:"flex gap-2 text-[9px] font-mono font-bold",children:[X.subtasks.length>0&&o.jsxs("span",{className:"flex items-center gap-1 text-life-gold",children:[o.jsx(ns,{size:10})," ",X.subtasks.length]}),X.reminders.length>0&&o.jsxs("span",{className:"flex items-center gap-1 text-life-gold",children:[o.jsx(ur,{size:10})," ",X.reminders.length]})]})]})})]},X.id))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Threat Level"}),o.jsx("div",{className:"grid grid-cols-3 gap-2",children:Object.values(Ge).map(X=>o.jsx("button",{type:"button",onClick:()=>x(X),className:`py-2 rounded-lg text-xs font-bold uppercase tracking-wider border transition-all ${h===X?`${ui[X]} ${Eu[X]} shadow-[0_0_10px_rgba(0,0,0,0.5)] scale-105`:"border-zinc-800 text-life-muted hover:bg-life-muted/5"}`,children:X},X))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest mb-2",children:"Reward Source"}),o.jsxs("div",{className:"flex bg-life-black rounded-lg border border-zinc-800 p-1 mb-4",children:[o.jsx("button",{type:"button",onClick:()=>k("stat"),className:`flex-1 py-2 rounded-md text-[10px] font-bold uppercase transition-all ${D==="stat"?"bg-life-gold text-life-black shadow-sm":"text-life-muted hover:text-white hover:bg-white/5"}`,children:"Attribute Focus"}),o.jsx("button",{type:"button",onClick:()=>k("skill"),className:`flex-1 py-2 rounded-md text-[10px] font-bold uppercase transition-all ${D==="skill"?"bg-life-gold text-life-black shadow-sm":"text-life-muted hover:text-white hover:bg-white/5"}`,children:"Skill Link"})]}),D==="stat"?o.jsx("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300",children:o.jsx("div",{className:"grid grid-cols-7 gap-2",children:Object.values(te).map(X=>{const ie=b.includes(X);return o.jsxs("button",{type:"button",onClick:()=>q(X),className:`
                                            flex flex-col items-center justify-center p-2 rounded-lg border transition-all aspect-square relative
                                            ${ie?"bg-life-muted/10 border-current shadow-lg scale-110":"border-zinc-800 text-life-muted opacity-70 hover:opacity-100 hover:bg-life-muted/5"}
                                        `,style:{color:ie?ut[X]:void 0},children:[o.jsx(U,{type:X}),o.jsx("span",{className:"text-[9px] font-bold mt-1",children:X}),ie&&o.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 rounded-full bg-current shadow-[0_0_5px_currentColor]"})]},X)})})}):o.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 duration-300 space-y-2",children:[o.jsxs("div",{className:"relative",children:[o.jsx(hi,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-life-muted",size:16}),o.jsxs("select",{value:S,onChange:X=>{const ie=X.target.value;E(ie);const pe=i.skills.find(B=>B.id===ie);pe&&pe.relatedStats.length>0&&T(pe.relatedStats)},className:"w-full bg-life-black border border-zinc-800 rounded-lg p-3 pl-10 text-xs text-life-text appearance-none focus:outline-none focus:border-life-gold/50",children:[o.jsx("option",{value:"",children:"Select a Skill..."}),i.skills.map(X=>o.jsxs("option",{value:X.id,children:[X.title," (Lvl ",X.level,")"]},X.id))]}),o.jsx(Bt,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-life-muted rotate-90",size:14})]}),S&&o.jsxs("div",{className:"p-3 bg-life-gold/10 border border-life-gold/20 rounded-lg flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-life-gold/20 rounded-full text-life-gold",children:o.jsx(dt,{size:14})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-[10px] text-life-gold font-bold uppercase tracking-wider",children:"Auto-Linked Attributes"}),o.jsx("div",{className:"flex gap-2 mt-1",children:b.map(X=>o.jsx("span",{className:"text-xs font-mono px-1.5 py-0.5 rounded bg-life-black/50 border border-life-gold/30 text-life-gold",children:X},X))})]})]})]})]}),o.jsxs("button",{type:"submit",className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all mt-4 ${r&&b.length>0?"bg-life-gold text-life-black hover:bg-yellow-400 shadow-[0_0_20px_rgba(251,191,36,0.3)]":"border-zinc-800 text-life-muted cursor-not-allowed"}`,disabled:!r||b.length===0,children:["Launch Operation ",o.jsx(Bt,{size:16})]})]}),J!==null&&o.jsx(l6,{stepIndex:J,step:F[J],parentDifficulty:h,parentStat:b[0]||te.DIS,parentSkillId:S,onUpdate:C,onClose:()=>H(null),onAddSubtask:A,onRemoveSubtask:L,onChangeSubtask:P,onAddReminder:O,onRemoveReminder:j})]})};var Yc={exports:{}},Ng={},Cg,tT;function u6(){if(tT)return Cg;tT=1;function n(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return Cg=n,n.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},n.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var i=this._timeouts.shift();if(i===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),i=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},i),this._options.unref&&this._timer.unref(),!0},n.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var i=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){i._operationTimeoutCb()},i._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},n.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},n.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},n.prototype.start=n.prototype.try,n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,i=0,r=0;r<this._errors.length;r++){var l=this._errors[r],c=l.message,d=(e[c]||0)+1;e[c]=d,d>=i&&(t=l,i=d)}return t},Cg}var nT;function d6(){return nT||(nT=1,(function(n){var e=u6();n.operation=function(t){var i=n.timeouts(t);return new e(i,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},n.timeouts=function(t){if(t instanceof Array)return[].concat(t);var i={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var r in t)i[r]=t[r];if(i.minTimeout>i.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var l=[],c=0;c<i.retries;c++)l.push(this.createTimeout(c,i));return t&&t.forever&&!l.length&&l.push(this.createTimeout(c,i)),l.sort(function(d,p){return d-p}),l},n.createTimeout=function(t,i){var r=i.randomize?Math.random()+1:1,l=Math.round(r*Math.max(i.minTimeout,1)*Math.pow(i.factor,t));return l=Math.min(l,i.maxTimeout),l},n.wrap=function(t,i,r){if(i instanceof Array&&(r=i,i=null),!r){r=[];for(var l in t)typeof t[l]=="function"&&r.push(l)}for(var c=0;c<r.length;c++){var d=r[c],p=t[d];t[d]=(function(x){var b=n.operation(i),T=Array.prototype.slice.call(arguments,1),S=T.pop();T.push(function(E){b.retry(E)||(E&&(arguments[0]=b.mainError()),S.apply(this,arguments))}),b.attempt(function(){x.apply(t,T)})}).bind(t,p),t[d].options=i}}})(Ng)),Ng}var kg,iT;function f6(){return iT||(iT=1,kg=d6()),kg}var sT;function h6(){if(sT)return Yc.exports;sT=1;const n=f6(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class t extends Error{constructor(d){super(),d instanceof Error?(this.originalError=d,{message:d}=d):(this.originalError=new Error(d),this.originalError.stack=this.stack),this.name="AbortError",this.message=d}}const i=(c,d,p)=>{const h=p.retries-(d-1);return c.attemptNumber=d,c.retriesLeft=h,c},r=c=>e.includes(c),l=(c,d)=>new Promise((p,h)=>{d={onFailedAttempt:()=>{},retries:10,...d};const x=n.operation(d);x.attempt(async b=>{try{p(await c(b))}catch(T){if(!(T instanceof Error)){h(new TypeError(`Non-error was thrown: "${T}". You should only throw errors.`));return}if(T instanceof t)x.stop(),h(T.originalError);else if(T instanceof TypeError&&!r(T.message))x.stop(),h(T);else{i(T,b,d);try{await d.onFailedAttempt(T)}catch(S){h(S);return}x.retry(T)||h(x.mainError())}}})});return Yc.exports=l,Yc.exports.default=l,Yc.exports.AbortError=t,Yc.exports}var HN=h6();const p6=VS(HN);var m6={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let g6,x6;function y6(){return{geminiUrl:g6,vertexUrl:x6}}function v6(n,e,t,i){var r,l;if(!(n!=null&&n.baseUrl)){const c=y6();return e?(r=c.vertexUrl)!==null&&r!==void 0?r:t:(l=c.geminiUrl)!==null&&l!==void 0?l:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pr{}function ke(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const l=e[r];return l!=null?String(l):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function g(n,e,t){for(let l=0;l<e.length-1;l++){const c=e[l];if(c.endsWith("[]")){const d=c.slice(0,-2);if(!(d in n))if(Array.isArray(t))n[d]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${c}`);if(Array.isArray(n[d])){const p=n[d];if(Array.isArray(t))for(let h=0;h<p.length;h++){const x=p[h];g(x,e.slice(l+1),t[h])}else for(const h of p)g(h,e.slice(l+1),t)}return}else if(c.endsWith("[0]")){const d=c.slice(0,-3);d in n||(n[d]=[{}]);const p=n[d];g(p[0],e.slice(l+1),t);return}(!n[c]||typeof n[c]!="object")&&(n[c]={}),n=n[c]}const i=e[e.length-1],r=n[i];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function m(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const r=e[i];if(r.endsWith("[]")){const l=r.slice(0,-2);if(l in n){const c=n[l];return Array.isArray(c)?c.map(d=>m(d,e.slice(i+1),t)):t}else return t}else n=n[r]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function b6(n,e){for(const[t,i]of Object.entries(e)){const r=t.split("."),l=i.split("."),c=new Set;let d=-1;for(let p=0;p<r.length;p++)if(r[p]==="*"){d=p;break}if(d!==-1&&l.length>d)for(let p=d;p<l.length;p++){const h=l[p];h!=="*"&&!h.endsWith("[]")&&!h.endsWith("[0]")&&c.add(h)}s0(n,r,l,0,c)}}function s0(n,e,t,i,r){if(i>=e.length||typeof n!="object"||n===null)return;const l=e[i];if(l.endsWith("[]")){const c=l.slice(0,-2),d=n;if(c in d&&Array.isArray(d[c]))for(const p of d[c])s0(p,e,t,i+1,r)}else if(l==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const c=n,d=Object.keys(c).filter(h=>!h.startsWith("_")&&!r.has(h)),p={};for(const h of d)p[h]=c[h];for(const[h,x]of Object.entries(p)){const b=[];for(const T of t.slice(i))T==="*"?b.push(h):b.push(T);g(c,b,x)}for(const h of d)delete c[h]}}else{const c=n;l in c&&s0(c[l],e,t,i+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Tx(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _6(n){const e={},t=m(n,["operationName"]);t!=null&&g(e,["operationName"],t);const i=m(n,["resourceName"]);return i!=null&&g(e,["_url","resourceName"],i),e}function T6(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const i=m(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const l=m(n,["error"]);l!=null&&g(e,["error"],l);const c=m(n,["response","generateVideoResponse"]);return c!=null&&g(e,["response"],w6(c)),e}function S6(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const i=m(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const l=m(n,["error"]);l!=null&&g(e,["error"],l);const c=m(n,["response"]);return c!=null&&g(e,["response"],E6(c)),e}function w6(n){const e={},t=m(n,["generatedSamples"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>N6(c))),g(e,["generatedVideos"],l)}const i=m(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);const r=m(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function E6(n){const e={},t=m(n,["videos"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(c=>C6(c))),g(e,["generatedVideos"],l)}const i=m(n,["raiMediaFilteredCount"]);i!=null&&g(e,["raiMediaFilteredCount"],i);const r=m(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function N6(n){const e={},t=m(n,["video"]);return t!=null&&g(e,["video"],D6(t)),e}function C6(n){const e={},t=m(n,["_self"]);return t!=null&&g(e,["video"],M6(t)),e}function k6(n){const e={},t=m(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function A6(n){const e={},t=m(n,["operationName"]);return t!=null&&g(e,["_url","operationName"],t),e}function I6(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const i=m(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const l=m(n,["error"]);l!=null&&g(e,["error"],l);const c=m(n,["response"]);return c!=null&&g(e,["response"],R6(c)),e}function R6(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["parent"]);i!=null&&g(e,["parent"],i);const r=m(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function FN(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const i=m(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const l=m(n,["error"]);l!=null&&g(e,["error"],l);const c=m(n,["response"]);return c!=null&&g(e,["response"],j6(c)),e}function j6(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["parent"]);i!=null&&g(e,["parent"],i);const r=m(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function D6(n){const e={},t=m(n,["uri"]);t!=null&&g(e,["uri"],t);const i=m(n,["encodedVideo"]);i!=null&&g(e,["videoBytes"],Tx(i));const r=m(n,["encoding"]);return r!=null&&g(e,["mimeType"],r),e}function M6(n){const e={},t=m(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const i=m(n,["bytesBase64Encoded"]);i!=null&&g(e,["videoBytes"],Tx(i));const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var rT;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(rT||(rT={}));var oT;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(oT||(oT={}));var aT;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(aT||(aT={}));var eo;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(eo||(eo={}));var lT;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(lT||(lT={}));var cT;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(cT||(cT={}));var uT;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(uT||(uT={}));var dT;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(dT||(dT={}));var fT;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(fT||(fT={}));var hT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(hT||(hT={}));var pT;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(pT||(pT={}));var mT;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH",n.MINIMAL="MINIMAL"})(mT||(mT={}));var gT;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(gT||(gT={}));var xT;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(xT||(xT={}));var yT;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(yT||(yT={}));var vT;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE",n.IMAGE_RECITATION="IMAGE_RECITATION",n.IMAGE_OTHER="IMAGE_OTHER"})(vT||(vT={}));var bT;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(bT||(bT={}));var _T;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(_T||(_T={}));var TT;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(TT||(TT={}));var ST;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(ST||(ST={}));var wT;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(wT||(wT={}));var vh;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(vh||(vh={}));var ET;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ET||(ET={}));var NT;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(NT||(NT={}));var CT;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(CT||(CT={}));var r0;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(r0||(r0={}));var kT;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(kT||(kT={}));var AT;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",n.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(AT||(AT={}));var o0;(function(n){n.COLLECTION="COLLECTION"})(o0||(o0={}));var IT;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(IT||(IT={}));var RT;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(RT||(RT={}));var bh;(function(n){n.PREDICT="PREDICT",n.EMBED_CONTENT="EMBED_CONTENT"})(bh||(bh={}));var jT;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(jT||(jT={}));var DT;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(DT||(DT={}));var MT;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(MT||(MT={}));var PT;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(PT||(PT={}));var LT;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(LT||(LT={}));var OT;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(OT||(OT={}));var UT;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(UT||(UT={}));var VT;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(VT||(VT={}));var zT;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(zT||(zT={}));var HT;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(HT||(HT={}));var FT;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(FT||(FT={}));var GT;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING",n.DISTILLATION="DISTILLATION"})(GT||(GT={}));var BT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(BT||(BT={}));var qT;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(qT||(qT={}));var $T;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED",n.REGISTERED="REGISTERED"})($T||($T={}));var YT;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(YT||(YT={}));var JT;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(JT||(JT={}));var KT;(function(n){n.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",n.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",n.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(KT||(KT={}));var XT;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.ACTIVITY_START="ACTIVITY_START",n.ACTIVITY_END="ACTIVITY_END"})(XT||(XT={}));var WT;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(WT||(WT={}));var QT;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(QT||(QT={}));var ZT;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(ZT||(ZT={}));var eS;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(eS||(eS={}));var tS;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(tS||(tS={}));var nS;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(nS||(nS={}));var cl;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(cl||(cl={}));class a0{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Jc{get text(){var e,t,i,r,l,c,d,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",x=!1;const b=[];for(const T of(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&p!==void 0?p:[]){for(const[S,E]of Object.entries(T))S!=="text"&&S!=="thought"&&S!=="thoughtSignature"&&(E!==null||E!==void 0)&&b.push(S);if(typeof T.text=="string"){if(typeof T.thought=="boolean"&&T.thought)continue;x=!0,h+=T.text}}return b.length>0&&console.warn(`there are non-text parts ${b} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),x?h:void 0}get data(){var e,t,i,r,l,c,d,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const x=[];for(const b of(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)!==null&&p!==void 0?p:[]){for(const[T,S]of Object.entries(b))T!=="inlineData"&&(S!==null||S!==void 0)&&x.push(T);b.inlineData&&typeof b.inlineData.data=="string"&&(h+=atob(b.inlineData.data))}return x.length>0&&console.warn(`there are non-data parts ${x} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var e,t,i,r,l,c,d,p;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(x=>x.functionCall).map(x=>x.functionCall).filter(x=>x!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var e,t,i,r,l,c,d,p,h;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const x=(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(b=>b.executableCode).map(b=>b.executableCode).filter(b=>b!==void 0);if((x==null?void 0:x.length)!==0)return(h=x==null?void 0:x[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var e,t,i,r,l,c,d,p,h;if(((r=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const x=(p=(d=(c=(l=this.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content)===null||d===void 0?void 0:d.parts)===null||p===void 0?void 0:p.filter(b=>b.codeExecutionResult).map(b=>b.codeExecutionResult).filter(b=>b!==void 0);if((x==null?void 0:x.length)!==0)return(h=x==null?void 0:x[0])===null||h===void 0?void 0:h.output}}class iS{}class sS{}class P6{}class L6{}class O6{}class U6{}class rS{}class oS{}class aS{}class V6{}class _h{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new _h;let r;const l=e;return t?r=S6(l):r=T6(l),Object.assign(i,r),i}}class lS{}class cS{}class uS{}class dS{}class z6{}class H6{}class F6{}class Sx{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new Sx,l=I6(e);return Object.assign(i,l),i}}class G6{}class B6{}class q6{}class $6{}class fS{}class Y6{get text(){var e,t,i;let r="",l=!1;const c=[];for(const d of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[p,h]of Object.entries(d))p!=="text"&&p!=="thought"&&h!==null&&c.push(p);if(typeof d.text=="string"){if(typeof d.thought=="boolean"&&d.thought)continue;l=!0,r+=d.text}}return c.length>0&&console.warn(`there are non-text parts ${c} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),l?r:void 0}get data(){var e,t,i;let r="";const l=[];for(const c of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[d,p]of Object.entries(c))d!=="inlineData"&&p!==null&&l.push(d);c.inlineData&&typeof c.inlineData.data=="string"&&(r+=atob(c.inlineData.data))}return l.length>0&&console.warn(`there are non-data parts ${l} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class J6{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class wx{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new wx,l=FN(e);return Object.assign(i,l),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ft(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function GN(n,e){const t=ft(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function BN(n){return Array.isArray(n)?n.map(e=>Th(e)):[Th(n)]}function Th(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function qN(n){const e=Th(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function $N(n){const e=Th(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function hS(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function YN(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>hS(e)):[hS(n)]}function l0(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function pS(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function mS(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function gn(n){if(n==null)throw new Error("ContentUnion is required");return l0(n)?n:{role:"user",parts:YN(n)}}function Ex(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=gn(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=gn(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>gn(t)):[gn(e)]}function di(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(pS(n)||mS(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[gn(n)]}const e=[],t=[],i=l0(n[0]);for(const r of n){const l=l0(r);if(l!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(l)e.push(r);else{if(pS(r)||mS(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return i||e.push({role:"user",parts:YN(t)}),e}function K6(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(eo).includes(t[0].toUpperCase())?t[0].toUpperCase():eo.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(eo).includes(i.toUpperCase())?i.toUpperCase():eo.TYPE_UNSPECIFIED})}}function gl(n){const e={},t=["items"],i=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const l=n.anyOf;l!=null&&l.length==2&&(l[0].type==="null"?(e.nullable=!0,n=l[1]):l[1].type==="null"&&(e.nullable=!0,n=l[0])),n.type instanceof Array&&K6(n.type,e);for(const[c,d]of Object.entries(n))if(d!=null)if(c=="type"){if(d==="null")throw new Error("type: null can not be the only possible type for the field.");if(d instanceof Array)continue;e.type=Object.values(eo).includes(d.toUpperCase())?d.toUpperCase():eo.TYPE_UNSPECIFIED}else if(t.includes(c))e[c]=gl(d);else if(i.includes(c)){const p=[];for(const h of d){if(h.type=="null"){e.nullable=!0;continue}p.push(gl(h))}e[c]=p}else if(r.includes(c)){const p={};for(const[h,x]of Object.entries(d))p[h]=gl(x);e[c]=p}else{if(c==="additionalProperties")continue;e[c]=d}return e}function Nx(n){return gl(n)}function Cx(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function kx(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Vl(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=gl(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=gl(e.response));return n}function zl(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function X6(n,e,t,i=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function mr(n,e){if(typeof e!="string")throw new Error("name must be a string");return X6(n,e,"cachedContents")}function JN(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function go(n){return Tx(n)}function W6(n){return n!=null&&typeof n=="object"&&"name"in n}function Q6(n){return n!=null&&typeof n=="object"&&"video"in n}function Z6(n){return n!=null&&typeof n=="object"&&"uri"in n}function KN(n){var e;let t;if(W6(n)&&(t=n.name),!(Z6(n)&&(t=n.uri,t===void 0))&&!(Q6(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function XN(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function WN(n){for(const e of["models","tunedModels","publisherModels"])if(eO(n,e))return n[e];return[]}function eO(n,e){return n!==null&&typeof n=="object"&&e in n}function tO(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function nO(n,e={}){const t=[],i=new Set;for(const r of n){const l=r.name;if(i.has(l))throw new Error(`Duplicate function name ${l} found in MCP tools. Please ensure function names are unique.`);i.add(l);const c=tO(r,e);c.functionDeclarations&&t.push(...c.functionDeclarations)}return{functionDeclarations:t}}function QN(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(r>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function iO(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function ZN(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return n;let l=!1;for(const c of r){if(typeof c!="object"||c===null)continue;const p=c.response;if(typeof p!="object"||p===null)continue;if(p.embedding!==void 0){l=!0;break}}return l&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Hl(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function e2(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function sO(n){return n.includes("gemini")&&n!=="gemini-embedding-001"||n.includes("maas")}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rO(n){const e={},t=m(n,["responsesFile"]);t!=null&&g(e,["fileName"],t);const i=m(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>VO(c))),g(e,["inlinedResponses"],l)}const r=m(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["inlinedEmbedContentResponses"],l)}return e}function oO(n){const e={},t=m(n,["predictionsFormat"]);t!=null&&g(e,["format"],t);const i=m(n,["gcsDestination","outputUriPrefix"]);i!=null&&g(e,["gcsUri"],i);const r=m(n,["bigqueryDestination","outputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function aO(n){const e={},t=m(n,["format"]);t!=null&&g(e,["predictionsFormat"],t);const i=m(n,["gcsUri"]);i!=null&&g(e,["gcsDestination","outputUriPrefix"],i);const r=m(n,["bigqueryUri"]);if(r!=null&&g(e,["bigqueryDestination","outputUri"],r),m(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Hf(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const i=m(n,["metadata","displayName"]);i!=null&&g(e,["displayName"],i);const r=m(n,["metadata","state"]);r!=null&&g(e,["state"],e2(r));const l=m(n,["metadata","createTime"]);l!=null&&g(e,["createTime"],l);const c=m(n,["metadata","endTime"]);c!=null&&g(e,["endTime"],c);const d=m(n,["metadata","updateTime"]);d!=null&&g(e,["updateTime"],d);const p=m(n,["metadata","model"]);p!=null&&g(e,["model"],p);const h=m(n,["metadata","output"]);return h!=null&&g(e,["dest"],rO(ZN(h))),e}function c0(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const i=m(n,["displayName"]);i!=null&&g(e,["displayName"],i);const r=m(n,["state"]);r!=null&&g(e,["state"],e2(r));const l=m(n,["error"]);l!=null&&g(e,["error"],l);const c=m(n,["createTime"]);c!=null&&g(e,["createTime"],c);const d=m(n,["startTime"]);d!=null&&g(e,["startTime"],d);const p=m(n,["endTime"]);p!=null&&g(e,["endTime"],p);const h=m(n,["updateTime"]);h!=null&&g(e,["updateTime"],h);const x=m(n,["model"]);x!=null&&g(e,["model"],x);const b=m(n,["inputConfig"]);b!=null&&g(e,["src"],lO(b));const T=m(n,["outputConfig"]);T!=null&&g(e,["dest"],oO(ZN(T)));const S=m(n,["completionStats"]);return S!=null&&g(e,["completionStats"],S),e}function lO(n){const e={},t=m(n,["instancesFormat"]);t!=null&&g(e,["format"],t);const i=m(n,["gcsSource","uris"]);i!=null&&g(e,["gcsUri"],i);const r=m(n,["bigquerySource","inputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function cO(n,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=m(e,["fileName"]);i!=null&&g(t,["fileName"],i);const r=m(e,["inlinedRequests"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>UO(n,c))),g(t,["requests","requests"],l)}return t}function uO(n){const e={},t=m(n,["format"]);t!=null&&g(e,["instancesFormat"],t);const i=m(n,["gcsUri"]);i!=null&&g(e,["gcsSource","uris"],i);const r=m(n,["bigqueryUri"]);if(r!=null&&g(e,["bigquerySource","inputUri"],r),m(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function dO(n){const e={},t=m(n,["data"]);if(t!=null&&g(e,["data"],t),m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=m(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function fO(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],Hl(n,i)),t}function hO(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],Hl(n,i)),t}function pO(n){const e={},t=m(n,["content"]);t!=null&&g(e,["content"],t);const i=m(n,["citationMetadata"]);i!=null&&g(e,["citationMetadata"],mO(i));const r=m(n,["tokenCount"]);r!=null&&g(e,["tokenCount"],r);const l=m(n,["finishReason"]);l!=null&&g(e,["finishReason"],l);const c=m(n,["avgLogprobs"]);c!=null&&g(e,["avgLogprobs"],c);const d=m(n,["groundingMetadata"]);d!=null&&g(e,["groundingMetadata"],d);const p=m(n,["index"]);p!=null&&g(e,["index"],p);const h=m(n,["logprobsResult"]);h!=null&&g(e,["logprobsResult"],h);const x=m(n,["safetyRatings"]);if(x!=null){let T=x;Array.isArray(T)&&(T=T.map(S=>S)),g(e,["safetyRatings"],T)}const b=m(n,["urlContextMetadata"]);return b!=null&&g(e,["urlContextMetadata"],b),e}function mO(n){const e={},t=m(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["citations"],i)}return e}function t2(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>$O(l))),g(e,["parts"],r)}const i=m(n,["role"]);return i!=null&&g(e,["role"],i),e}function gO(n,e){const t={},i=m(n,["displayName"]);if(e!==void 0&&i!=null&&g(e,["batch","displayName"],i),m(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function xO(n,e){const t={},i=m(n,["displayName"]);e!==void 0&&i!=null&&g(e,["displayName"],i);const r=m(n,["dest"]);return e!==void 0&&r!=null&&g(e,["outputConfig"],aO(iO(r))),t}function gS(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["_url","model"],ft(n,i));const r=m(e,["src"]);r!=null&&g(t,["batch","inputConfig"],cO(n,QN(n,r)));const l=m(e,["config"]);return l!=null&&gO(l,t),t}function yO(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["model"],ft(n,i));const r=m(e,["src"]);r!=null&&g(t,["inputConfig"],uO(QN(n,r)));const l=m(e,["config"]);return l!=null&&xO(l,t),t}function vO(n,e){const t={},i=m(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["batch","displayName"],i),t}function bO(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["_url","model"],ft(n,i));const r=m(e,["src"]);r!=null&&g(t,["batch","inputConfig"],CO(n,r));const l=m(e,["config"]);return l!=null&&vO(l,t),t}function _O(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],Hl(n,i)),t}function TO(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],Hl(n,i)),t}function SO(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["name"]);i!=null&&g(e,["name"],i);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const l=m(n,["error"]);return l!=null&&g(e,["error"],l),e}function wO(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["name"]);i!=null&&g(e,["name"],i);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const l=m(n,["error"]);return l!=null&&g(e,["error"],l),e}function EO(n,e){const t={},i=m(e,["contents"]);if(i!=null){let l=Ex(n,i);Array.isArray(l)&&(l=l.map(c=>c)),g(t,["requests[]","request","content"],l)}const r=m(e,["config"]);return r!=null&&(g(t,["_self"],NO(r,t)),b6(t,{"requests[].*":"requests[].request.*"})),t}function NO(n,e){const t={},i=m(n,["taskType"]);e!==void 0&&i!=null&&g(e,["requests[]","taskType"],i);const r=m(n,["title"]);e!==void 0&&r!=null&&g(e,["requests[]","title"],r);const l=m(n,["outputDimensionality"]);if(e!==void 0&&l!=null&&g(e,["requests[]","outputDimensionality"],l),m(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function CO(n,e){const t={},i=m(e,["fileName"]);i!=null&&g(t,["file_name"],i);const r=m(e,["inlinedRequests"]);return r!=null&&g(t,["requests"],EO(n,r)),t}function kO(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function AO(n){const e={},t=m(n,["id"]);t!=null&&g(e,["id"],t);const i=m(n,["args"]);i!=null&&g(e,["args"],i);const r=m(n,["name"]);if(r!=null&&g(e,["name"],r),m(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function IO(n){const e={},t=m(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);const i=m(n,["mode"]);if(i!=null&&g(e,["mode"],i),m(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function RO(n,e,t){const i={},r=m(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],t2(gn(r)));const l=m(e,["temperature"]);l!=null&&g(i,["temperature"],l);const c=m(e,["topP"]);c!=null&&g(i,["topP"],c);const d=m(e,["topK"]);d!=null&&g(i,["topK"],d);const p=m(e,["candidateCount"]);p!=null&&g(i,["candidateCount"],p);const h=m(e,["maxOutputTokens"]);h!=null&&g(i,["maxOutputTokens"],h);const x=m(e,["stopSequences"]);x!=null&&g(i,["stopSequences"],x);const b=m(e,["responseLogprobs"]);b!=null&&g(i,["responseLogprobs"],b);const T=m(e,["logprobs"]);T!=null&&g(i,["logprobs"],T);const S=m(e,["presencePenalty"]);S!=null&&g(i,["presencePenalty"],S);const E=m(e,["frequencyPenalty"]);E!=null&&g(i,["frequencyPenalty"],E);const D=m(e,["seed"]);D!=null&&g(i,["seed"],D);const k=m(e,["responseMimeType"]);k!=null&&g(i,["responseMimeType"],k);const F=m(e,["responseSchema"]);F!=null&&g(i,["responseSchema"],Nx(F));const $=m(e,["responseJsonSchema"]);if($!=null&&g(i,["responseJsonSchema"],$),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const M=m(e,["safetySettings"]);if(t!==void 0&&M!=null){let j=M;Array.isArray(j)&&(j=j.map(q=>YO(q))),g(t,["safetySettings"],j)}const J=m(e,["tools"]);if(t!==void 0&&J!=null){let j=zl(J);Array.isArray(j)&&(j=j.map(q=>KO(Vl(q)))),g(t,["tools"],j)}const H=m(e,["toolConfig"]);if(t!==void 0&&H!=null&&g(t,["toolConfig"],JO(H)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const z=m(e,["cachedContent"]);t!==void 0&&z!=null&&g(t,["cachedContent"],mr(n,z));const R=m(e,["responseModalities"]);R!=null&&g(i,["responseModalities"],R);const C=m(e,["mediaResolution"]);C!=null&&g(i,["mediaResolution"],C);const A=m(e,["speechConfig"]);if(A!=null&&g(i,["speechConfig"],Cx(A)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=m(e,["thinkingConfig"]);P!=null&&g(i,["thinkingConfig"],P);const L=m(e,["imageConfig"]);L!=null&&g(i,["imageConfig"],OO(L));const O=m(e,["enableEnhancedCivicAnswers"]);if(O!=null&&g(i,["enableEnhancedCivicAnswers"],O),m(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return i}function jO(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["candidates"]);if(i!=null){let p=i;Array.isArray(p)&&(p=p.map(h=>pO(h))),g(e,["candidates"],p)}const r=m(n,["modelVersion"]);r!=null&&g(e,["modelVersion"],r);const l=m(n,["promptFeedback"]);l!=null&&g(e,["promptFeedback"],l);const c=m(n,["responseId"]);c!=null&&g(e,["responseId"],c);const d=m(n,["usageMetadata"]);return d!=null&&g(e,["usageMetadata"],d),e}function DO(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],Hl(n,i)),t}function MO(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],Hl(n,i)),t}function PO(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function LO(n){const e={};if(m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function OO(n){const e={},t=m(n,["aspectRatio"]);t!=null&&g(e,["aspectRatio"],t);const i=m(n,["imageSize"]);if(i!=null&&g(e,["imageSize"],i),m(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function UO(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["request","model"],ft(n,i));const r=m(e,["contents"]);if(r!=null){let d=di(r);Array.isArray(d)&&(d=d.map(p=>t2(p))),g(t,["request","contents"],d)}const l=m(e,["metadata"]);l!=null&&g(t,["metadata"],l);const c=m(e,["config"]);return c!=null&&g(t,["request","generationConfig"],RO(n,c,m(t,["request"],{}))),t}function VO(n){const e={},t=m(n,["response"]);t!=null&&g(e,["response"],jO(t));const i=m(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=m(n,["error"]);return r!=null&&g(e,["error"],r),e}function zO(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=m(n,["pageToken"]);if(e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),m(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function HO(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=m(n,["pageToken"]);e!==void 0&&r!=null&&g(e,["_query","pageToken"],r);const l=m(n,["filter"]);return e!==void 0&&l!=null&&g(e,["_query","filter"],l),t}function FO(n){const e={},t=m(n,["config"]);return t!=null&&zO(t,e),e}function GO(n){const e={},t=m(n,["config"]);return t!=null&&HO(t,e),e}function BO(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=m(n,["operations"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>Hf(c))),g(e,["batchJobs"],l)}return e}function qO(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=m(n,["batchPredictionJobs"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c0(c))),g(e,["batchJobs"],l)}return e}function $O(n){const e={},t=m(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=m(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const r=m(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);const l=m(n,["fileData"]);l!=null&&g(e,["fileData"],kO(l));const c=m(n,["functionCall"]);c!=null&&g(e,["functionCall"],AO(c));const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const p=m(n,["inlineData"]);p!=null&&g(e,["inlineData"],dO(p));const h=m(n,["text"]);h!=null&&g(e,["text"],h);const x=m(n,["thought"]);x!=null&&g(e,["thought"],x);const b=m(n,["thoughtSignature"]);b!=null&&g(e,["thoughtSignature"],b);const T=m(n,["videoMetadata"]);return T!=null&&g(e,["videoMetadata"],T),e}function YO(n){const e={},t=m(n,["category"]);if(t!=null&&g(e,["category"],t),m(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=m(n,["threshold"]);return i!=null&&g(e,["threshold"],i),e}function JO(n){const e={},t=m(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);const i=m(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],IO(i)),e}function KO(n){const e={};if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);const i=m(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const r=m(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["functionDeclarations"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(b=>b)),g(e,["functionDeclarations"],x)}const c=m(n,["googleMaps"]);c!=null&&g(e,["googleMaps"],PO(c));const d=m(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],LO(d));const p=m(n,["googleSearchRetrieval"]);p!=null&&g(e,["googleSearchRetrieval"],p);const h=m(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var dr;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(dr||(dr={}));class ha{constructor(e,t,i,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,r)}init(e,t,i){var r,l;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let c={config:{}};!i||Object.keys(i).length===0?c={config:{}}:typeof i=="object"?c=Object.assign({},i):c=i,c.config&&(c.config.pageToken=t.nextPageToken),this.paramsInternal=c,this.pageInternalSize=(l=(r=c.config)===null||r===void 0?void 0:r.pageSize)!==null&&l!==void 0?l:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XO extends pr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ha(dr.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=gS(this.apiClient,e),i=t._url,r=ke("{model}:batchGenerateContent",i),d=t.batch.inputConfig.requests,p=d.requests,h=[];for(const x of p){const b=Object.assign({},x);if(b.systemInstruction){const T=b.systemInstruction;delete b.systemInstruction;const S=b.request;S.systemInstruction=T,b.request=S}h.push(b)}return d.requests=h,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},r=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${r}`),i.dest===void 0){const l=this.getGcsUri(e),c=this.getBigqueryUri(e);if(l)l.endsWith(".jsonl")?i.dest=`${l.slice(0,-6)}/dest`:i.dest=`${l}_dest_${r}`;else if(c)i.dest=`${c}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=yO(this.apiClient,e);return d=ke("batchPredictionJobs",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>c0(x))}else{const h=gS(this.apiClient,e);return d=ke("{model}:batchGenerateContent",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>Hf(x))}}async createEmbeddingsInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=bO(this.apiClient,e);return l=ke("{model}:asyncBatchEmbedContent",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>Hf(p))}}async get(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=MO(this.apiClient,e);return d=ke("batchPredictionJobs/{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>c0(x))}else{const h=DO(this.apiClient,e);return d=ke("batches/{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>Hf(x))}}async cancel(e){var t,i,r,l;let c="",d={};if(this.apiClient.isVertexAI()){const p=hO(this.apiClient,e);c=ke("batchPredictionJobs/{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const p=fO(this.apiClient,e);c=ke("batches/{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,await this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal})}}async listInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=GO(e);return d=ke("batchPredictionJobs",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=qO(x),T=new fS;return Object.assign(T,b),T})}else{const h=FO(e);return d=ke("batches",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=BO(x),T=new fS;return Object.assign(T,b),T})}}async delete(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=TO(this.apiClient,e);return d=ke("batchPredictionJobs/{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>wO(x))}else{const h=_O(this.apiClient,e);return d=ke("batches/{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>SO(x))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WO(n){const e={},t=m(n,["data"]);if(t!=null&&g(e,["data"],t),m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=m(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function xS(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>bU(l))),g(e,["parts"],r)}const i=m(n,["role"]);return i!=null&&g(e,["role"],i),e}function QO(n,e){const t={},i=m(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const r=m(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);const l=m(n,["displayName"]);e!==void 0&&l!=null&&g(e,["displayName"],l);const c=m(n,["contents"]);if(e!==void 0&&c!=null){let x=di(c);Array.isArray(x)&&(x=x.map(b=>xS(b))),g(e,["contents"],x)}const d=m(n,["systemInstruction"]);e!==void 0&&d!=null&&g(e,["systemInstruction"],xS(gn(d)));const p=m(n,["tools"]);if(e!==void 0&&p!=null){let x=p;Array.isArray(x)&&(x=x.map(b=>TU(b))),g(e,["tools"],x)}const h=m(n,["toolConfig"]);if(e!==void 0&&h!=null&&g(e,["toolConfig"],_U(h)),m(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function ZO(n,e){const t={},i=m(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const r=m(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);const l=m(n,["displayName"]);e!==void 0&&l!=null&&g(e,["displayName"],l);const c=m(n,["contents"]);if(e!==void 0&&c!=null){let b=di(c);Array.isArray(b)&&(b=b.map(T=>T)),g(e,["contents"],b)}const d=m(n,["systemInstruction"]);e!==void 0&&d!=null&&g(e,["systemInstruction"],gn(d));const p=m(n,["tools"]);if(e!==void 0&&p!=null){let b=p;Array.isArray(b)&&(b=b.map(T=>SU(T))),g(e,["tools"],b)}const h=m(n,["toolConfig"]);e!==void 0&&h!=null&&g(e,["toolConfig"],h);const x=m(n,["kmsKeyName"]);return e!==void 0&&x!=null&&g(e,["encryption_spec","kmsKeyName"],x),t}function eU(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["model"],GN(n,i));const r=m(e,["config"]);return r!=null&&QO(r,t),t}function tU(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["model"],GN(n,i));const r=m(e,["config"]);return r!=null&&ZO(r,t),t}function nU(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],mr(n,i)),t}function iU(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],mr(n,i)),t}function sU(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function rU(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function oU(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function aU(n){const e={},t=m(n,["id"]);t!=null&&g(e,["id"],t);const i=m(n,["args"]);i!=null&&g(e,["args"],i);const r=m(n,["name"]);if(r!=null&&g(e,["name"],r),m(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function lU(n){const e={},t=m(n,["allowedFunctionNames"]);t!=null&&g(e,["allowedFunctionNames"],t);const i=m(n,["mode"]);if(i!=null&&g(e,["mode"],i),m(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function cU(n){const e={},t=m(n,["description"]);t!=null&&g(e,["description"],t);const i=m(n,["name"]);i!=null&&g(e,["name"],i);const r=m(n,["parameters"]);r!=null&&g(e,["parameters"],r);const l=m(n,["parametersJsonSchema"]);l!=null&&g(e,["parametersJsonSchema"],l);const c=m(n,["response"]);c!=null&&g(e,["response"],c);const d=m(n,["responseJsonSchema"]);if(d!=null&&g(e,["responseJsonSchema"],d),m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function uU(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],mr(n,i)),t}function dU(n,e){const t={},i=m(e,["name"]);return i!=null&&g(t,["_url","name"],mr(n,i)),t}function fU(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function hU(n){const e={};if(m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function pU(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function mU(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function gU(n){const e={},t=m(n,["config"]);return t!=null&&pU(t,e),e}function xU(n){const e={},t=m(n,["config"]);return t!=null&&mU(t,e),e}function yU(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=m(n,["cachedContents"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["cachedContents"],l)}return e}function vU(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=m(n,["cachedContents"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["cachedContents"],l)}return e}function bU(n){const e={},t=m(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=m(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const r=m(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);const l=m(n,["fileData"]);l!=null&&g(e,["fileData"],oU(l));const c=m(n,["functionCall"]);c!=null&&g(e,["functionCall"],aU(c));const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const p=m(n,["inlineData"]);p!=null&&g(e,["inlineData"],WO(p));const h=m(n,["text"]);h!=null&&g(e,["text"],h);const x=m(n,["thought"]);x!=null&&g(e,["thought"],x);const b=m(n,["thoughtSignature"]);b!=null&&g(e,["thoughtSignature"],b);const T=m(n,["videoMetadata"]);return T!=null&&g(e,["videoMetadata"],T),e}function _U(n){const e={},t=m(n,["retrievalConfig"]);t!=null&&g(e,["retrievalConfig"],t);const i=m(n,["functionCallingConfig"]);return i!=null&&g(e,["functionCallingConfig"],lU(i)),e}function TU(n){const e={};if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);const i=m(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const r=m(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["functionDeclarations"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(b=>b)),g(e,["functionDeclarations"],x)}const c=m(n,["googleMaps"]);c!=null&&g(e,["googleMaps"],fU(c));const d=m(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],hU(d));const p=m(n,["googleSearchRetrieval"]);p!=null&&g(e,["googleSearchRetrieval"],p);const h=m(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}function SU(n){const e={},t=m(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);const i=m(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),m(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=m(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);const l=m(n,["enterpriseWebSearch"]);l!=null&&g(e,["enterpriseWebSearch"],l);const c=m(n,["functionDeclarations"]);if(c!=null){let b=c;Array.isArray(b)&&(b=b.map(T=>cU(T))),g(e,["functionDeclarations"],b)}const d=m(n,["googleMaps"]);d!=null&&g(e,["googleMaps"],d);const p=m(n,["googleSearch"]);p!=null&&g(e,["googleSearch"],p);const h=m(n,["googleSearchRetrieval"]);h!=null&&g(e,["googleSearchRetrieval"],h);const x=m(n,["urlContext"]);return x!=null&&g(e,["urlContext"],x),e}function wU(n,e){const t={},i=m(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const r=m(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function EU(n,e){const t={},i=m(n,["ttl"]);e!==void 0&&i!=null&&g(e,["ttl"],i);const r=m(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function NU(n,e){const t={},i=m(e,["name"]);i!=null&&g(t,["_url","name"],mr(n,i));const r=m(e,["config"]);return r!=null&&wU(r,t),t}function CU(n,e){const t={},i=m(e,["name"]);i!=null&&g(t,["_url","name"],mr(n,i));const r=m(e,["config"]);return r!=null&&EU(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kU extends pr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ha(dr.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=tU(this.apiClient,e);return d=ke("cachedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const h=eU(this.apiClient,e);return d=ke("cachedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async get(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=dU(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const h=uU(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async delete(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=iU(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=rU(x),T=new uS;return Object.assign(T,b),T})}else{const h=nU(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=sU(x),T=new uS;return Object.assign(T,b),T})}}async update(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=CU(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>x)}else{const h=NU(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>x)}}async listInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=xU(e);return d=ke("cachedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=vU(x),T=new dS;return Object.assign(T,b),T})}else{const h=gU(e);return d=ke("cachedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=yU(x),T=new dS;return Object.assign(T,b),T})}}}function Sh(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function yS(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qe(n){return this instanceof qe?(this.v=n,this):new qe(n)}function es(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,l=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),d("next"),d("throw"),d("return",c),r[Symbol.asyncIterator]=function(){return this},r;function c(S){return function(E){return Promise.resolve(E).then(S,b)}}function d(S,E){i[S]&&(r[S]=function(D){return new Promise(function(k,F){l.push([S,D,k,F])>1||p(S,D)})},E&&(r[S]=E(r[S])))}function p(S,E){try{h(i[S](E))}catch(D){T(l[0][3],D)}}function h(S){S.value instanceof qe?Promise.resolve(S.value.v).then(x,b):T(l[0][2],S)}function x(S){p("next",S)}function b(S){p("throw",S)}function T(S,E){S(E),l.shift(),l.length&&p(l[0][0],l[0][1])}}function ts(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof yS=="function"?yS(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(l){t[l]=n[l]&&function(c){return new Promise(function(d,p){c=n[l](c),r(d,p,c.done,c.value)})}}function r(l,c,d,p){Promise.resolve(p).then(function(h){l({value:h,done:d})},c)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AU(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:n2(t)}function n2(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function IU(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function vS(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const r=[];let l=!0;for(;i<t&&n[i].role==="model";)r.push(n[i]),l&&!n2(n[i])&&(l=!1),i++;l?e.push(...r):e.pop()}return e}class RU{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new jU(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class jU{constructor(e,t,i,r={},l=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=r,this.history=l,this.sendPromise=Promise.resolve(),IU(l)}async sendMessage(e){var t;await this.sendPromise;const i=gn(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var l,c,d;const p=await r,h=(c=(l=p.candidates)===null||l===void 0?void 0:l[0])===null||c===void 0?void 0:c.content,x=p.automaticFunctionCallingHistory,b=this.getHistory(!0).length;let T=[];x!=null&&(T=(d=x.slice(b))!==null&&d!==void 0?d:[]);const S=h?[h]:[];this.recordHistory(i,S,T)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const i=gn(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const l=await r;return this.processStreamResponse(l,i)}getHistory(e=!1){const t=e?vS(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return es(this,arguments,function*(){var r,l,c,d,p,h;const x=[];try{for(var b=!0,T=ts(e),S;S=yield qe(T.next()),r=S.done,!r;b=!0){d=S.value,b=!1;const E=d;if(AU(E)){const D=(h=(p=E.candidates)===null||p===void 0?void 0:p[0])===null||h===void 0?void 0:h.content;D!==void 0&&x.push(D)}yield yield qe(E)}}catch(E){l={error:E}}finally{try{!b&&!r&&(c=T.return)&&(yield qe(c.call(T)))}finally{if(l)throw l.error}}this.recordHistory(t,x)})}recordHistory(e,t,i){let r=[];t.length>0&&t.every(l=>l.role!==void 0)?r=t:r.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...vS(i)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wu extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,wu.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DU(n){const e={},t=m(n,["file"]);return t!=null&&g(e,["file"],t),e}function MU(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function PU(n){const e={},t=m(n,["name"]);return t!=null&&g(e,["_url","file"],KN(t)),e}function LU(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function OU(n){const e={},t=m(n,["name"]);return t!=null&&g(e,["_url","file"],KN(t)),e}function UU(n){const e={},t=m(n,["uris"]);return t!=null&&g(e,["uris"],t),e}function VU(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function zU(n){const e={},t=m(n,["config"]);return t!=null&&VU(t,e),e}function HU(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=m(n,["files"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["files"],l)}return e}function FU(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["files"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>l)),g(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class GU extends pr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ha(dr.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async registerFiles(e){throw new Error("registerFiles is only supported in Node.js environments.")}async _registerFiles(e){return this.registerFilesInternal(e)}async listInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=zU(e);return l=ke("files",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const x=h;return x.sdkHttpResponse={headers:p.headers},x})),r.then(p=>{const h=HU(p),x=new G6;return Object.assign(x,h),x})}}async createInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=DU(e);return l=ke("upload/v1beta/files",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>{const h=MU(p),x=new B6;return Object.assign(x,h),x})}}async get(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=OU(e);return l=ke("files/{file}",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}async delete(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=PU(e);return l=ke("files/{file}",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const x=h;return x.sdkHttpResponse={headers:p.headers},x})),r.then(p=>{const h=LU(p),x=new q6;return Object.assign(x,h),x})}}async registerFilesInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=UU(e);return l=ke("files:register",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>{const h=FU(p),x=new $6;return Object.assign(x,h),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ff(n){const e={},t=m(n,["data"]);if(t!=null&&g(e,["data"],t),m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=m(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function BU(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>oV(l))),g(e,["parts"],r)}const i=m(n,["role"]);return i!=null&&g(e,["role"],i),e}function qU(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function $U(n){const e={},t=m(n,["id"]);t!=null&&g(e,["id"],t);const i=m(n,["args"]);i!=null&&g(e,["args"],i);const r=m(n,["name"]);if(r!=null&&g(e,["name"],r),m(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function YU(n){const e={},t=m(n,["description"]);t!=null&&g(e,["description"],t);const i=m(n,["name"]);i!=null&&g(e,["name"],i);const r=m(n,["parameters"]);r!=null&&g(e,["parameters"],r);const l=m(n,["parametersJsonSchema"]);l!=null&&g(e,["parametersJsonSchema"],l);const c=m(n,["response"]);c!=null&&g(e,["response"],c);const d=m(n,["responseJsonSchema"]);if(d!=null&&g(e,["responseJsonSchema"],d),m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function JU(n){const e={},t=m(n,["modelSelectionConfig"]);t!=null&&g(e,["modelConfig"],t);const i=m(n,["responseJsonSchema"]);i!=null&&g(e,["responseJsonSchema"],i);const r=m(n,["audioTimestamp"]);r!=null&&g(e,["audioTimestamp"],r);const l=m(n,["candidateCount"]);l!=null&&g(e,["candidateCount"],l);const c=m(n,["enableAffectiveDialog"]);c!=null&&g(e,["enableAffectiveDialog"],c);const d=m(n,["frequencyPenalty"]);d!=null&&g(e,["frequencyPenalty"],d);const p=m(n,["logprobs"]);p!=null&&g(e,["logprobs"],p);const h=m(n,["maxOutputTokens"]);h!=null&&g(e,["maxOutputTokens"],h);const x=m(n,["mediaResolution"]);x!=null&&g(e,["mediaResolution"],x);const b=m(n,["presencePenalty"]);b!=null&&g(e,["presencePenalty"],b);const T=m(n,["responseLogprobs"]);T!=null&&g(e,["responseLogprobs"],T);const S=m(n,["responseMimeType"]);S!=null&&g(e,["responseMimeType"],S);const E=m(n,["responseModalities"]);E!=null&&g(e,["responseModalities"],E);const D=m(n,["responseSchema"]);D!=null&&g(e,["responseSchema"],D);const k=m(n,["routingConfig"]);k!=null&&g(e,["routingConfig"],k);const F=m(n,["seed"]);F!=null&&g(e,["seed"],F);const $=m(n,["speechConfig"]);$!=null&&g(e,["speechConfig"],$);const M=m(n,["stopSequences"]);M!=null&&g(e,["stopSequences"],M);const J=m(n,["temperature"]);J!=null&&g(e,["temperature"],J);const H=m(n,["thinkingConfig"]);H!=null&&g(e,["thinkingConfig"],H);const z=m(n,["topK"]);z!=null&&g(e,["topK"],z);const R=m(n,["topP"]);if(R!=null&&g(e,["topP"],R),m(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function KU(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function XU(n){const e={};if(m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function WU(n,e){const t={},i=m(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const l=m(n,["temperature"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","temperature"],l);const c=m(n,["topP"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topP"],c);const d=m(n,["topK"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","topK"],d);const p=m(n,["maxOutputTokens"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","maxOutputTokens"],p);const h=m(n,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const x=m(n,["seed"]);e!==void 0&&x!=null&&g(e,["setup","generationConfig","seed"],x);const b=m(n,["speechConfig"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","speechConfig"],kx(b));const T=m(n,["thinkingConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","thinkingConfig"],T);const S=m(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],S);const E=m(n,["systemInstruction"]);e!==void 0&&E!=null&&g(e,["setup","systemInstruction"],BU(gn(E)));const D=m(n,["tools"]);if(e!==void 0&&D!=null){let z=zl(D);Array.isArray(z)&&(z=z.map(R=>lV(Vl(R)))),g(e,["setup","tools"],z)}const k=m(n,["sessionResumption"]);e!==void 0&&k!=null&&g(e,["setup","sessionResumption"],aV(k));const F=m(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);const $=m(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);const M=m(n,["realtimeInputConfig"]);e!==void 0&&M!=null&&g(e,["setup","realtimeInputConfig"],M);const J=m(n,["contextWindowCompression"]);e!==void 0&&J!=null&&g(e,["setup","contextWindowCompression"],J);const H=m(n,["proactivity"]);if(e!==void 0&&H!=null&&g(e,["setup","proactivity"],H),m(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function QU(n,e){const t={},i=m(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],JU(i));const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const l=m(n,["temperature"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","temperature"],l);const c=m(n,["topP"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topP"],c);const d=m(n,["topK"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","topK"],d);const p=m(n,["maxOutputTokens"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","maxOutputTokens"],p);const h=m(n,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const x=m(n,["seed"]);e!==void 0&&x!=null&&g(e,["setup","generationConfig","seed"],x);const b=m(n,["speechConfig"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","speechConfig"],kx(b));const T=m(n,["thinkingConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","thinkingConfig"],T);const S=m(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],S);const E=m(n,["systemInstruction"]);e!==void 0&&E!=null&&g(e,["setup","systemInstruction"],gn(E));const D=m(n,["tools"]);if(e!==void 0&&D!=null){let R=zl(D);Array.isArray(R)&&(R=R.map(C=>cV(Vl(C)))),g(e,["setup","tools"],R)}const k=m(n,["sessionResumption"]);e!==void 0&&k!=null&&g(e,["setup","sessionResumption"],k);const F=m(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);const $=m(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);const M=m(n,["realtimeInputConfig"]);e!==void 0&&M!=null&&g(e,["setup","realtimeInputConfig"],M);const J=m(n,["contextWindowCompression"]);e!==void 0&&J!=null&&g(e,["setup","contextWindowCompression"],J);const H=m(n,["proactivity"]);e!==void 0&&H!=null&&g(e,["setup","proactivity"],H);const z=m(n,["explicitVadSignal"]);return e!==void 0&&z!=null&&g(e,["setup","explicitVadSignal"],z),t}function ZU(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["setup","model"],ft(n,i));const r=m(e,["config"]);return r!=null&&g(t,["config"],WU(r,t)),t}function eV(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["setup","model"],ft(n,i));const r=m(e,["config"]);return r!=null&&g(t,["config"],QU(r,t)),t}function tV(n){const e={},t=m(n,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],t),e}function nV(n){const e={},t=m(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(r=>r)),g(e,["weightedPrompts"],i)}return e}function iV(n){const e={},t=m(n,["media"]);if(t!=null){let h=BN(t);Array.isArray(h)&&(h=h.map(x=>Ff(x))),g(e,["mediaChunks"],h)}const i=m(n,["audio"]);i!=null&&g(e,["audio"],Ff($N(i)));const r=m(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);const l=m(n,["video"]);l!=null&&g(e,["video"],Ff(qN(l)));const c=m(n,["text"]);c!=null&&g(e,["text"],c);const d=m(n,["activityStart"]);d!=null&&g(e,["activityStart"],d);const p=m(n,["activityEnd"]);return p!=null&&g(e,["activityEnd"],p),e}function sV(n){const e={},t=m(n,["media"]);if(t!=null){let h=BN(t);Array.isArray(h)&&(h=h.map(x=>x)),g(e,["mediaChunks"],h)}const i=m(n,["audio"]);i!=null&&g(e,["audio"],$N(i));const r=m(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);const l=m(n,["video"]);l!=null&&g(e,["video"],qN(l));const c=m(n,["text"]);c!=null&&g(e,["text"],c);const d=m(n,["activityStart"]);d!=null&&g(e,["activityStart"],d);const p=m(n,["activityEnd"]);return p!=null&&g(e,["activityEnd"],p),e}function rV(n){const e={},t=m(n,["setupComplete"]);t!=null&&g(e,["setupComplete"],t);const i=m(n,["serverContent"]);i!=null&&g(e,["serverContent"],i);const r=m(n,["toolCall"]);r!=null&&g(e,["toolCall"],r);const l=m(n,["toolCallCancellation"]);l!=null&&g(e,["toolCallCancellation"],l);const c=m(n,["usageMetadata"]);c!=null&&g(e,["usageMetadata"],uV(c));const d=m(n,["goAway"]);d!=null&&g(e,["goAway"],d);const p=m(n,["sessionResumptionUpdate"]);p!=null&&g(e,["sessionResumptionUpdate"],p);const h=m(n,["voiceActivityDetectionSignal"]);h!=null&&g(e,["voiceActivityDetectionSignal"],h);const x=m(n,["voiceActivity"]);return x!=null&&g(e,["voiceActivity"],dV(x)),e}function oV(n){const e={},t=m(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=m(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const r=m(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);const l=m(n,["fileData"]);l!=null&&g(e,["fileData"],qU(l));const c=m(n,["functionCall"]);c!=null&&g(e,["functionCall"],$U(c));const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const p=m(n,["inlineData"]);p!=null&&g(e,["inlineData"],Ff(p));const h=m(n,["text"]);h!=null&&g(e,["text"],h);const x=m(n,["thought"]);x!=null&&g(e,["thought"],x);const b=m(n,["thoughtSignature"]);b!=null&&g(e,["thoughtSignature"],b);const T=m(n,["videoMetadata"]);return T!=null&&g(e,["videoMetadata"],T),e}function aV(n){const e={},t=m(n,["handle"]);if(t!=null&&g(e,["handle"],t),m(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function lV(n){const e={};if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);const i=m(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const r=m(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["functionDeclarations"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(b=>b)),g(e,["functionDeclarations"],x)}const c=m(n,["googleMaps"]);c!=null&&g(e,["googleMaps"],KU(c));const d=m(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],XU(d));const p=m(n,["googleSearchRetrieval"]);p!=null&&g(e,["googleSearchRetrieval"],p);const h=m(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}function cV(n){const e={},t=m(n,["retrieval"]);t!=null&&g(e,["retrieval"],t);const i=m(n,["computerUse"]);if(i!=null&&g(e,["computerUse"],i),m(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=m(n,["codeExecution"]);r!=null&&g(e,["codeExecution"],r);const l=m(n,["enterpriseWebSearch"]);l!=null&&g(e,["enterpriseWebSearch"],l);const c=m(n,["functionDeclarations"]);if(c!=null){let b=c;Array.isArray(b)&&(b=b.map(T=>YU(T))),g(e,["functionDeclarations"],b)}const d=m(n,["googleMaps"]);d!=null&&g(e,["googleMaps"],d);const p=m(n,["googleSearch"]);p!=null&&g(e,["googleSearch"],p);const h=m(n,["googleSearchRetrieval"]);h!=null&&g(e,["googleSearchRetrieval"],h);const x=m(n,["urlContext"]);return x!=null&&g(e,["urlContext"],x),e}function uV(n){const e={},t=m(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);const i=m(n,["cachedContentTokenCount"]);i!=null&&g(e,["cachedContentTokenCount"],i);const r=m(n,["candidatesTokenCount"]);r!=null&&g(e,["responseTokenCount"],r);const l=m(n,["toolUsePromptTokenCount"]);l!=null&&g(e,["toolUsePromptTokenCount"],l);const c=m(n,["thoughtsTokenCount"]);c!=null&&g(e,["thoughtsTokenCount"],c);const d=m(n,["totalTokenCount"]);d!=null&&g(e,["totalTokenCount"],d);const p=m(n,["promptTokensDetails"]);if(p!=null){let S=p;Array.isArray(S)&&(S=S.map(E=>E)),g(e,["promptTokensDetails"],S)}const h=m(n,["cacheTokensDetails"]);if(h!=null){let S=h;Array.isArray(S)&&(S=S.map(E=>E)),g(e,["cacheTokensDetails"],S)}const x=m(n,["candidatesTokensDetails"]);if(x!=null){let S=x;Array.isArray(S)&&(S=S.map(E=>E)),g(e,["responseTokensDetails"],S)}const b=m(n,["toolUsePromptTokensDetails"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(E=>E)),g(e,["toolUsePromptTokensDetails"],S)}const T=m(n,["trafficType"]);return T!=null&&g(e,["trafficType"],T),e}function dV(n){const e={},t=m(n,["type"]);return t!=null&&g(e,["voiceActivityType"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fV(n,e){const t={},i=m(n,["data"]);if(i!=null&&g(t,["data"],i),m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=m(n,["mimeType"]);return r!=null&&g(t,["mimeType"],r),t}function hV(n,e){const t={},i=m(n,["content"]);i!=null&&g(t,["content"],i);const r=m(n,["citationMetadata"]);r!=null&&g(t,["citationMetadata"],pV(r));const l=m(n,["tokenCount"]);l!=null&&g(t,["tokenCount"],l);const c=m(n,["finishReason"]);c!=null&&g(t,["finishReason"],c);const d=m(n,["avgLogprobs"]);d!=null&&g(t,["avgLogprobs"],d);const p=m(n,["groundingMetadata"]);p!=null&&g(t,["groundingMetadata"],p);const h=m(n,["index"]);h!=null&&g(t,["index"],h);const x=m(n,["logprobsResult"]);x!=null&&g(t,["logprobsResult"],x);const b=m(n,["safetyRatings"]);if(b!=null){let S=b;Array.isArray(S)&&(S=S.map(E=>E)),g(t,["safetyRatings"],S)}const T=m(n,["urlContextMetadata"]);return T!=null&&g(t,["urlContextMetadata"],T),t}function pV(n,e){const t={},i=m(n,["citationSources"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>l)),g(t,["citations"],r)}return t}function mV(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["contents"]);if(l!=null){let c=di(l);Array.isArray(c)&&(c=c.map(d=>d)),g(i,["contents"],c)}return i}function gV(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["tokensInfo"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(t,["tokensInfo"],l)}return t}function xV(n,e){const t={},i=m(n,["values"]);i!=null&&g(t,["values"],i);const r=m(n,["statistics"]);return r!=null&&g(t,["statistics"],yV(r)),t}function yV(n,e){const t={},i=m(n,["truncated"]);i!=null&&g(t,["truncated"],i);const r=m(n,["token_count"]);return r!=null&&g(t,["tokenCount"],r),t}function Lu(n,e){const t={},i=m(n,["parts"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>Cz(c))),g(t,["parts"],l)}const r=m(n,["role"]);return r!=null&&g(t,["role"],r),t}function vV(n,e){const t={},i=m(n,["controlType"]);i!=null&&g(t,["controlType"],i);const r=m(n,["enableControlImageComputation"]);return r!=null&&g(t,["computeControl"],r),t}function bV(n,e){const t={};if(m(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function _V(n,e,t){const i={},r=m(n,["systemInstruction"]);e!==void 0&&r!=null&&g(e,["systemInstruction"],gn(r));const l=m(n,["tools"]);if(e!==void 0&&l!=null){let d=l;Array.isArray(d)&&(d=d.map(p=>o2(p))),g(e,["tools"],d)}const c=m(n,["generationConfig"]);return e!==void 0&&c!=null&&g(e,["generationConfig"],fz(c)),i}function TV(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["contents"]);if(l!=null){let d=di(l);Array.isArray(d)&&(d=d.map(p=>Lu(p))),g(i,["contents"],d)}const c=m(e,["config"]);return c!=null&&bV(c),i}function SV(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["contents"]);if(l!=null){let d=di(l);Array.isArray(d)&&(d=d.map(p=>p)),g(i,["contents"],d)}const c=m(e,["config"]);return c!=null&&_V(c,i),i}function wV(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["totalTokens"]);r!=null&&g(t,["totalTokens"],r);const l=m(n,["cachedContentTokenCount"]);return l!=null&&g(t,["cachedContentTokenCount"],l),t}function EV(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["totalTokens"]);return r!=null&&g(t,["totalTokens"],r),t}function NV(n,e,t){const i={},r=m(e,["model"]);return r!=null&&g(i,["_url","name"],ft(n,r)),i}function CV(n,e,t){const i={},r=m(e,["model"]);return r!=null&&g(i,["_url","name"],ft(n,r)),i}function kV(n,e){const t={},i=m(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function AV(n,e){const t={},i=m(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function IV(n,e,t){const i={},r=m(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const l=m(n,["negativePrompt"]);e!==void 0&&l!=null&&g(e,["parameters","negativePrompt"],l);const c=m(n,["numberOfImages"]);e!==void 0&&c!=null&&g(e,["parameters","sampleCount"],c);const d=m(n,["aspectRatio"]);e!==void 0&&d!=null&&g(e,["parameters","aspectRatio"],d);const p=m(n,["guidanceScale"]);e!==void 0&&p!=null&&g(e,["parameters","guidanceScale"],p);const h=m(n,["seed"]);e!==void 0&&h!=null&&g(e,["parameters","seed"],h);const x=m(n,["safetyFilterLevel"]);e!==void 0&&x!=null&&g(e,["parameters","safetySetting"],x);const b=m(n,["personGeneration"]);e!==void 0&&b!=null&&g(e,["parameters","personGeneration"],b);const T=m(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&g(e,["parameters","includeSafetyAttributes"],T);const S=m(n,["includeRaiReason"]);e!==void 0&&S!=null&&g(e,["parameters","includeRaiReason"],S);const E=m(n,["language"]);e!==void 0&&E!=null&&g(e,["parameters","language"],E);const D=m(n,["outputMimeType"]);e!==void 0&&D!=null&&g(e,["parameters","outputOptions","mimeType"],D);const k=m(n,["outputCompressionQuality"]);e!==void 0&&k!=null&&g(e,["parameters","outputOptions","compressionQuality"],k);const F=m(n,["addWatermark"]);e!==void 0&&F!=null&&g(e,["parameters","addWatermark"],F);const $=m(n,["labels"]);e!==void 0&&$!=null&&g(e,["labels"],$);const M=m(n,["editMode"]);e!==void 0&&M!=null&&g(e,["parameters","editMode"],M);const J=m(n,["baseSteps"]);return e!==void 0&&J!=null&&g(e,["parameters","editConfig","baseSteps"],J),i}function RV(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["prompt"]);l!=null&&g(i,["instances[0]","prompt"],l);const c=m(e,["referenceImages"]);if(c!=null){let p=c;Array.isArray(p)&&(p=p.map(h=>Dz(h))),g(i,["instances[0]","referenceImages"],p)}const d=m(e,["config"]);return d!=null&&IV(d,i),i}function jV(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>Zh(c))),g(t,["generatedImages"],l)}return t}function DV(n,e,t){const i={},r=m(n,["taskType"]);e!==void 0&&r!=null&&g(e,["requests[]","taskType"],r);const l=m(n,["title"]);e!==void 0&&l!=null&&g(e,["requests[]","title"],l);const c=m(n,["outputDimensionality"]);if(e!==void 0&&c!=null&&g(e,["requests[]","outputDimensionality"],c),m(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return i}function MV(n,e,t){const i={};let r=m(t,["embeddingApiType"]);if(r===void 0&&(r="PREDICT"),r==="PREDICT"){const h=m(n,["taskType"]);e!==void 0&&h!=null&&g(e,["instances[]","task_type"],h)}else if(r==="EMBED_CONTENT"){const h=m(n,["taskType"]);e!==void 0&&h!=null&&g(e,["taskType"],h)}let l=m(t,["embeddingApiType"]);if(l===void 0&&(l="PREDICT"),l==="PREDICT"){const h=m(n,["title"]);e!==void 0&&h!=null&&g(e,["instances[]","title"],h)}else if(l==="EMBED_CONTENT"){const h=m(n,["title"]);e!==void 0&&h!=null&&g(e,["title"],h)}let c=m(t,["embeddingApiType"]);if(c===void 0&&(c="PREDICT"),c==="PREDICT"){const h=m(n,["outputDimensionality"]);e!==void 0&&h!=null&&g(e,["parameters","outputDimensionality"],h)}else if(c==="EMBED_CONTENT"){const h=m(n,["outputDimensionality"]);e!==void 0&&h!=null&&g(e,["outputDimensionality"],h)}let d=m(t,["embeddingApiType"]);if(d===void 0&&(d="PREDICT"),d==="PREDICT"){const h=m(n,["mimeType"]);e!==void 0&&h!=null&&g(e,["instances[]","mimeType"],h)}let p=m(t,["embeddingApiType"]);if(p===void 0&&(p="PREDICT"),p==="PREDICT"){const h=m(n,["autoTruncate"]);e!==void 0&&h!=null&&g(e,["parameters","autoTruncate"],h)}else if(p==="EMBED_CONTENT"){const h=m(n,["autoTruncate"]);e!==void 0&&h!=null&&g(e,["autoTruncate"],h)}return i}function PV(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["contents"]);if(l!=null){let h=Ex(n,l);Array.isArray(h)&&(h=h.map(x=>x)),g(i,["requests[]","content"],h)}const c=m(e,["content"]);c!=null&&Lu(gn(c));const d=m(e,["config"]);d!=null&&DV(d,i);const p=m(e,["model"]);return p!==void 0&&g(i,["requests[]","model"],ft(n,p)),i}function LV(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));let l=m(t,["embeddingApiType"]);if(l===void 0&&(l="PREDICT"),l==="PREDICT"){const p=m(e,["contents"]);if(p!=null){let h=Ex(n,p);Array.isArray(h)&&(h=h.map(x=>x)),g(i,["instances[]","content"],h)}}let c=m(t,["embeddingApiType"]);if(c===void 0&&(c="PREDICT"),c==="EMBED_CONTENT"){const p=m(e,["content"]);p!=null&&g(i,["content"],gn(p))}const d=m(e,["config"]);return d!=null&&MV(d,i,t),i}function OV(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["embeddings"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>d)),g(t,["embeddings"],c)}const l=m(n,["metadata"]);return l!=null&&g(t,["metadata"],l),t}function UV(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["predictions[]","embeddings"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>xV(d))),g(t,["embeddings"],c)}const l=m(n,["metadata"]);if(l!=null&&g(t,["metadata"],l),e&&m(e,["embeddingApiType"])==="EMBED_CONTENT"){const c=m(n,["embedding"]),d=m(n,["usageMetadata"]),p=m(n,["truncated"]);if(c){const h={};d&&d.promptTokenCount&&(h.tokenCount=d.promptTokenCount),p&&(h.truncated=p),c.statistics=h,g(t,["embeddings"],[c])}}return t}function VV(n,e){const t={},i=m(n,["endpoint"]);i!=null&&g(t,["name"],i);const r=m(n,["deployedModelId"]);return r!=null&&g(t,["deployedModelId"],r),t}function zV(n,e){const t={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=m(n,["fileUri"]);i!=null&&g(t,["fileUri"],i);const r=m(n,["mimeType"]);return r!=null&&g(t,["mimeType"],r),t}function HV(n,e){const t={},i=m(n,["id"]);i!=null&&g(t,["id"],i);const r=m(n,["args"]);r!=null&&g(t,["args"],r);const l=m(n,["name"]);if(l!=null&&g(t,["name"],l),m(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return t}function FV(n,e){const t={},i=m(n,["allowedFunctionNames"]);i!=null&&g(t,["allowedFunctionNames"],i);const r=m(n,["mode"]);if(r!=null&&g(t,["mode"],r),m(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return t}function GV(n,e){const t={},i=m(n,["description"]);i!=null&&g(t,["description"],i);const r=m(n,["name"]);r!=null&&g(t,["name"],r);const l=m(n,["parameters"]);l!=null&&g(t,["parameters"],l);const c=m(n,["parametersJsonSchema"]);c!=null&&g(t,["parametersJsonSchema"],c);const d=m(n,["response"]);d!=null&&g(t,["response"],d);const p=m(n,["responseJsonSchema"]);if(p!=null&&g(t,["responseJsonSchema"],p),m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return t}function BV(n,e,t,i){const r={},l=m(e,["systemInstruction"]);t!==void 0&&l!=null&&g(t,["systemInstruction"],Lu(gn(l)));const c=m(e,["temperature"]);c!=null&&g(r,["temperature"],c);const d=m(e,["topP"]);d!=null&&g(r,["topP"],d);const p=m(e,["topK"]);p!=null&&g(r,["topK"],p);const h=m(e,["candidateCount"]);h!=null&&g(r,["candidateCount"],h);const x=m(e,["maxOutputTokens"]);x!=null&&g(r,["maxOutputTokens"],x);const b=m(e,["stopSequences"]);b!=null&&g(r,["stopSequences"],b);const T=m(e,["responseLogprobs"]);T!=null&&g(r,["responseLogprobs"],T);const S=m(e,["logprobs"]);S!=null&&g(r,["logprobs"],S);const E=m(e,["presencePenalty"]);E!=null&&g(r,["presencePenalty"],E);const D=m(e,["frequencyPenalty"]);D!=null&&g(r,["frequencyPenalty"],D);const k=m(e,["seed"]);k!=null&&g(r,["seed"],k);const F=m(e,["responseMimeType"]);F!=null&&g(r,["responseMimeType"],F);const $=m(e,["responseSchema"]);$!=null&&g(r,["responseSchema"],Nx($));const M=m(e,["responseJsonSchema"]);if(M!=null&&g(r,["responseJsonSchema"],M),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const J=m(e,["safetySettings"]);if(t!==void 0&&J!=null){let q=J;Array.isArray(q)&&(q=q.map(le=>Mz(le))),g(t,["safetySettings"],q)}const H=m(e,["tools"]);if(t!==void 0&&H!=null){let q=zl(H);Array.isArray(q)&&(q=q.map(le=>Hz(Vl(le)))),g(t,["tools"],q)}const z=m(e,["toolConfig"]);if(t!==void 0&&z!=null&&g(t,["toolConfig"],zz(z)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=m(e,["cachedContent"]);t!==void 0&&R!=null&&g(t,["cachedContent"],mr(n,R));const C=m(e,["responseModalities"]);C!=null&&g(r,["responseModalities"],C);const A=m(e,["mediaResolution"]);A!=null&&g(r,["mediaResolution"],A);const P=m(e,["speechConfig"]);if(P!=null&&g(r,["speechConfig"],Cx(P)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=m(e,["thinkingConfig"]);L!=null&&g(r,["thinkingConfig"],L);const O=m(e,["imageConfig"]);O!=null&&g(r,["imageConfig"],xz(O));const j=m(e,["enableEnhancedCivicAnswers"]);if(j!=null&&g(r,["enableEnhancedCivicAnswers"],j),m(e,["modelArmorConfig"])!==void 0)throw new Error("modelArmorConfig parameter is not supported in Gemini API.");return r}function qV(n,e,t,i){const r={},l=m(e,["systemInstruction"]);t!==void 0&&l!=null&&g(t,["systemInstruction"],gn(l));const c=m(e,["temperature"]);c!=null&&g(r,["temperature"],c);const d=m(e,["topP"]);d!=null&&g(r,["topP"],d);const p=m(e,["topK"]);p!=null&&g(r,["topK"],p);const h=m(e,["candidateCount"]);h!=null&&g(r,["candidateCount"],h);const x=m(e,["maxOutputTokens"]);x!=null&&g(r,["maxOutputTokens"],x);const b=m(e,["stopSequences"]);b!=null&&g(r,["stopSequences"],b);const T=m(e,["responseLogprobs"]);T!=null&&g(r,["responseLogprobs"],T);const S=m(e,["logprobs"]);S!=null&&g(r,["logprobs"],S);const E=m(e,["presencePenalty"]);E!=null&&g(r,["presencePenalty"],E);const D=m(e,["frequencyPenalty"]);D!=null&&g(r,["frequencyPenalty"],D);const k=m(e,["seed"]);k!=null&&g(r,["seed"],k);const F=m(e,["responseMimeType"]);F!=null&&g(r,["responseMimeType"],F);const $=m(e,["responseSchema"]);$!=null&&g(r,["responseSchema"],Nx($));const M=m(e,["responseJsonSchema"]);M!=null&&g(r,["responseJsonSchema"],M);const J=m(e,["routingConfig"]);J!=null&&g(r,["routingConfig"],J);const H=m(e,["modelSelectionConfig"]);H!=null&&g(r,["modelConfig"],H);const z=m(e,["safetySettings"]);if(t!==void 0&&z!=null){let X=z;Array.isArray(X)&&(X=X.map(ie=>ie)),g(t,["safetySettings"],X)}const R=m(e,["tools"]);if(t!==void 0&&R!=null){let X=zl(R);Array.isArray(X)&&(X=X.map(ie=>o2(Vl(ie)))),g(t,["tools"],X)}const C=m(e,["toolConfig"]);t!==void 0&&C!=null&&g(t,["toolConfig"],C);const A=m(e,["labels"]);t!==void 0&&A!=null&&g(t,["labels"],A);const P=m(e,["cachedContent"]);t!==void 0&&P!=null&&g(t,["cachedContent"],mr(n,P));const L=m(e,["responseModalities"]);L!=null&&g(r,["responseModalities"],L);const O=m(e,["mediaResolution"]);O!=null&&g(r,["mediaResolution"],O);const j=m(e,["speechConfig"]);j!=null&&g(r,["speechConfig"],Cx(j));const q=m(e,["audioTimestamp"]);q!=null&&g(r,["audioTimestamp"],q);const le=m(e,["thinkingConfig"]);le!=null&&g(r,["thinkingConfig"],le);const U=m(e,["imageConfig"]);if(U!=null&&g(r,["imageConfig"],yz(U)),m(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");const Y=m(e,["modelArmorConfig"]);return t!==void 0&&Y!=null&&g(t,["modelArmorConfig"],Y),r}function bS(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["contents"]);if(l!=null){let d=di(l);Array.isArray(d)&&(d=d.map(p=>Lu(p))),g(i,["contents"],d)}const c=m(e,["config"]);return c!=null&&g(i,["generationConfig"],BV(n,c,i)),i}function _S(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["contents"]);if(l!=null){let d=di(l);Array.isArray(d)&&(d=d.map(p=>p)),g(i,["contents"],d)}const c=m(e,["config"]);return c!=null&&g(i,["generationConfig"],qV(n,c,i)),i}function TS(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["candidates"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(x=>hV(x))),g(t,["candidates"],h)}const l=m(n,["modelVersion"]);l!=null&&g(t,["modelVersion"],l);const c=m(n,["promptFeedback"]);c!=null&&g(t,["promptFeedback"],c);const d=m(n,["responseId"]);d!=null&&g(t,["responseId"],d);const p=m(n,["usageMetadata"]);return p!=null&&g(t,["usageMetadata"],p),t}function SS(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["candidates"]);if(r!=null){let x=r;Array.isArray(x)&&(x=x.map(b=>b)),g(t,["candidates"],x)}const l=m(n,["createTime"]);l!=null&&g(t,["createTime"],l);const c=m(n,["modelVersion"]);c!=null&&g(t,["modelVersion"],c);const d=m(n,["promptFeedback"]);d!=null&&g(t,["promptFeedback"],d);const p=m(n,["responseId"]);p!=null&&g(t,["responseId"],p);const h=m(n,["usageMetadata"]);return h!=null&&g(t,["usageMetadata"],h),t}function $V(n,e,t){const i={};if(m(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=m(n,["numberOfImages"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const l=m(n,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const c=m(n,["guidanceScale"]);if(e!==void 0&&c!=null&&g(e,["parameters","guidanceScale"],c),m(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const d=m(n,["safetyFilterLevel"]);e!==void 0&&d!=null&&g(e,["parameters","safetySetting"],d);const p=m(n,["personGeneration"]);e!==void 0&&p!=null&&g(e,["parameters","personGeneration"],p);const h=m(n,["includeSafetyAttributes"]);e!==void 0&&h!=null&&g(e,["parameters","includeSafetyAttributes"],h);const x=m(n,["includeRaiReason"]);e!==void 0&&x!=null&&g(e,["parameters","includeRaiReason"],x);const b=m(n,["language"]);e!==void 0&&b!=null&&g(e,["parameters","language"],b);const T=m(n,["outputMimeType"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","mimeType"],T);const S=m(n,["outputCompressionQuality"]);if(e!==void 0&&S!=null&&g(e,["parameters","outputOptions","compressionQuality"],S),m(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const E=m(n,["imageSize"]);if(e!==void 0&&E!=null&&g(e,["parameters","sampleImageSize"],E),m(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return i}function YV(n,e,t){const i={},r=m(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const l=m(n,["negativePrompt"]);e!==void 0&&l!=null&&g(e,["parameters","negativePrompt"],l);const c=m(n,["numberOfImages"]);e!==void 0&&c!=null&&g(e,["parameters","sampleCount"],c);const d=m(n,["aspectRatio"]);e!==void 0&&d!=null&&g(e,["parameters","aspectRatio"],d);const p=m(n,["guidanceScale"]);e!==void 0&&p!=null&&g(e,["parameters","guidanceScale"],p);const h=m(n,["seed"]);e!==void 0&&h!=null&&g(e,["parameters","seed"],h);const x=m(n,["safetyFilterLevel"]);e!==void 0&&x!=null&&g(e,["parameters","safetySetting"],x);const b=m(n,["personGeneration"]);e!==void 0&&b!=null&&g(e,["parameters","personGeneration"],b);const T=m(n,["includeSafetyAttributes"]);e!==void 0&&T!=null&&g(e,["parameters","includeSafetyAttributes"],T);const S=m(n,["includeRaiReason"]);e!==void 0&&S!=null&&g(e,["parameters","includeRaiReason"],S);const E=m(n,["language"]);e!==void 0&&E!=null&&g(e,["parameters","language"],E);const D=m(n,["outputMimeType"]);e!==void 0&&D!=null&&g(e,["parameters","outputOptions","mimeType"],D);const k=m(n,["outputCompressionQuality"]);e!==void 0&&k!=null&&g(e,["parameters","outputOptions","compressionQuality"],k);const F=m(n,["addWatermark"]);e!==void 0&&F!=null&&g(e,["parameters","addWatermark"],F);const $=m(n,["labels"]);e!==void 0&&$!=null&&g(e,["labels"],$);const M=m(n,["imageSize"]);e!==void 0&&M!=null&&g(e,["parameters","sampleImageSize"],M);const J=m(n,["enhancePrompt"]);return e!==void 0&&J!=null&&g(e,["parameters","enhancePrompt"],J),i}function JV(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["prompt"]);l!=null&&g(i,["instances[0]","prompt"],l);const c=m(e,["config"]);return c!=null&&$V(c,i),i}function KV(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["prompt"]);l!=null&&g(i,["instances[0]","prompt"],l);const c=m(e,["config"]);return c!=null&&YV(c,i),i}function XV(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["predictions"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>lz(d))),g(t,["generatedImages"],c)}const l=m(n,["positivePromptSafetyAttributes"]);return l!=null&&g(t,["positivePromptSafetyAttributes"],s2(l)),t}function WV(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["predictions"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Zh(d))),g(t,["generatedImages"],c)}const l=m(n,["positivePromptSafetyAttributes"]);return l!=null&&g(t,["positivePromptSafetyAttributes"],r2(l)),t}function QV(n,e,t){const i={},r=m(n,["numberOfVideos"]);if(e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r),m(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const l=m(n,["durationSeconds"]);if(e!==void 0&&l!=null&&g(e,["parameters","durationSeconds"],l),m(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const c=m(n,["aspectRatio"]);e!==void 0&&c!=null&&g(e,["parameters","aspectRatio"],c);const d=m(n,["resolution"]);e!==void 0&&d!=null&&g(e,["parameters","resolution"],d);const p=m(n,["personGeneration"]);if(e!==void 0&&p!=null&&g(e,["parameters","personGeneration"],p),m(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=m(n,["negativePrompt"]);e!==void 0&&h!=null&&g(e,["parameters","negativePrompt"],h);const x=m(n,["enhancePrompt"]);if(e!==void 0&&x!=null&&g(e,["parameters","enhancePrompt"],x),m(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const b=m(n,["lastFrame"]);e!==void 0&&b!=null&&g(e,["instances[0]","lastFrame"],ep(b));const T=m(n,["referenceImages"]);if(e!==void 0&&T!=null){let S=T;Array.isArray(S)&&(S=S.map(E=>e9(E))),g(e,["instances[0]","referenceImages"],S)}if(m(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return i}function ZV(n,e,t){const i={},r=m(n,["numberOfVideos"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const l=m(n,["outputGcsUri"]);e!==void 0&&l!=null&&g(e,["parameters","storageUri"],l);const c=m(n,["fps"]);e!==void 0&&c!=null&&g(e,["parameters","fps"],c);const d=m(n,["durationSeconds"]);e!==void 0&&d!=null&&g(e,["parameters","durationSeconds"],d);const p=m(n,["seed"]);e!==void 0&&p!=null&&g(e,["parameters","seed"],p);const h=m(n,["aspectRatio"]);e!==void 0&&h!=null&&g(e,["parameters","aspectRatio"],h);const x=m(n,["resolution"]);e!==void 0&&x!=null&&g(e,["parameters","resolution"],x);const b=m(n,["personGeneration"]);e!==void 0&&b!=null&&g(e,["parameters","personGeneration"],b);const T=m(n,["pubsubTopic"]);e!==void 0&&T!=null&&g(e,["parameters","pubsubTopic"],T);const S=m(n,["negativePrompt"]);e!==void 0&&S!=null&&g(e,["parameters","negativePrompt"],S);const E=m(n,["enhancePrompt"]);e!==void 0&&E!=null&&g(e,["parameters","enhancePrompt"],E);const D=m(n,["generateAudio"]);e!==void 0&&D!=null&&g(e,["parameters","generateAudio"],D);const k=m(n,["lastFrame"]);e!==void 0&&k!=null&&g(e,["instances[0]","lastFrame"],rs(k));const F=m(n,["referenceImages"]);if(e!==void 0&&F!=null){let J=F;Array.isArray(J)&&(J=J.map(H=>t9(H))),g(e,["instances[0]","referenceImages"],J)}const $=m(n,["mask"]);e!==void 0&&$!=null&&g(e,["instances[0]","mask"],Zz($));const M=m(n,["compressionQuality"]);return e!==void 0&&M!=null&&g(e,["parameters","compressionQuality"],M),i}function ez(n,e){const t={},i=m(n,["name"]);i!=null&&g(t,["name"],i);const r=m(n,["metadata"]);r!=null&&g(t,["metadata"],r);const l=m(n,["done"]);l!=null&&g(t,["done"],l);const c=m(n,["error"]);c!=null&&g(t,["error"],c);const d=m(n,["response","generateVideoResponse"]);return d!=null&&g(t,["response"],sz(d)),t}function tz(n,e){const t={},i=m(n,["name"]);i!=null&&g(t,["name"],i);const r=m(n,["metadata"]);r!=null&&g(t,["metadata"],r);const l=m(n,["done"]);l!=null&&g(t,["done"],l);const c=m(n,["error"]);c!=null&&g(t,["error"],c);const d=m(n,["response"]);return d!=null&&g(t,["response"],rz(d)),t}function nz(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["prompt"]);l!=null&&g(i,["instances[0]","prompt"],l);const c=m(e,["image"]);c!=null&&g(i,["instances[0]","image"],ep(c));const d=m(e,["video"]);d!=null&&g(i,["instances[0]","video"],a2(d));const p=m(e,["source"]);p!=null&&oz(p,i);const h=m(e,["config"]);return h!=null&&QV(h,i),i}function iz(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["prompt"]);l!=null&&g(i,["instances[0]","prompt"],l);const c=m(e,["image"]);c!=null&&g(i,["instances[0]","image"],rs(c));const d=m(e,["video"]);d!=null&&g(i,["instances[0]","video"],l2(d));const p=m(e,["source"]);p!=null&&az(p,i);const h=m(e,["config"]);return h!=null&&ZV(h,i),i}function sz(n,e){const t={},i=m(n,["generatedSamples"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>uz(d))),g(t,["generatedVideos"],c)}const r=m(n,["raiMediaFilteredCount"]);r!=null&&g(t,["raiMediaFilteredCount"],r);const l=m(n,["raiMediaFilteredReasons"]);return l!=null&&g(t,["raiMediaFilteredReasons"],l),t}function rz(n,e){const t={},i=m(n,["videos"]);if(i!=null){let c=i;Array.isArray(c)&&(c=c.map(d=>dz(d))),g(t,["generatedVideos"],c)}const r=m(n,["raiMediaFilteredCount"]);r!=null&&g(t,["raiMediaFilteredCount"],r);const l=m(n,["raiMediaFilteredReasons"]);return l!=null&&g(t,["raiMediaFilteredReasons"],l),t}function oz(n,e,t){const i={},r=m(n,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const l=m(n,["image"]);e!==void 0&&l!=null&&g(e,["instances[0]","image"],ep(l));const c=m(n,["video"]);return e!==void 0&&c!=null&&g(e,["instances[0]","video"],a2(c)),i}function az(n,e,t){const i={},r=m(n,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const l=m(n,["image"]);e!==void 0&&l!=null&&g(e,["instances[0]","image"],rs(l));const c=m(n,["video"]);return e!==void 0&&c!=null&&g(e,["instances[0]","video"],l2(c)),i}function lz(n,e){const t={},i=m(n,["_self"]);i!=null&&g(t,["image"],vz(i));const r=m(n,["raiFilteredReason"]);r!=null&&g(t,["raiFilteredReason"],r);const l=m(n,["_self"]);return l!=null&&g(t,["safetyAttributes"],s2(l)),t}function Zh(n,e){const t={},i=m(n,["_self"]);i!=null&&g(t,["image"],i2(i));const r=m(n,["raiFilteredReason"]);r!=null&&g(t,["raiFilteredReason"],r);const l=m(n,["_self"]);l!=null&&g(t,["safetyAttributes"],r2(l));const c=m(n,["prompt"]);return c!=null&&g(t,["enhancedPrompt"],c),t}function cz(n,e){const t={},i=m(n,["_self"]);i!=null&&g(t,["mask"],i2(i));const r=m(n,["labels"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(t,["labels"],l)}return t}function uz(n,e){const t={},i=m(n,["video"]);return i!=null&&g(t,["video"],Wz(i)),t}function dz(n,e){const t={},i=m(n,["_self"]);return i!=null&&g(t,["video"],Qz(i)),t}function fz(n,e){const t={},i=m(n,["modelSelectionConfig"]);i!=null&&g(t,["modelConfig"],i);const r=m(n,["responseJsonSchema"]);r!=null&&g(t,["responseJsonSchema"],r);const l=m(n,["audioTimestamp"]);l!=null&&g(t,["audioTimestamp"],l);const c=m(n,["candidateCount"]);c!=null&&g(t,["candidateCount"],c);const d=m(n,["enableAffectiveDialog"]);d!=null&&g(t,["enableAffectiveDialog"],d);const p=m(n,["frequencyPenalty"]);p!=null&&g(t,["frequencyPenalty"],p);const h=m(n,["logprobs"]);h!=null&&g(t,["logprobs"],h);const x=m(n,["maxOutputTokens"]);x!=null&&g(t,["maxOutputTokens"],x);const b=m(n,["mediaResolution"]);b!=null&&g(t,["mediaResolution"],b);const T=m(n,["presencePenalty"]);T!=null&&g(t,["presencePenalty"],T);const S=m(n,["responseLogprobs"]);S!=null&&g(t,["responseLogprobs"],S);const E=m(n,["responseMimeType"]);E!=null&&g(t,["responseMimeType"],E);const D=m(n,["responseModalities"]);D!=null&&g(t,["responseModalities"],D);const k=m(n,["responseSchema"]);k!=null&&g(t,["responseSchema"],k);const F=m(n,["routingConfig"]);F!=null&&g(t,["routingConfig"],F);const $=m(n,["seed"]);$!=null&&g(t,["seed"],$);const M=m(n,["speechConfig"]);M!=null&&g(t,["speechConfig"],M);const J=m(n,["stopSequences"]);J!=null&&g(t,["stopSequences"],J);const H=m(n,["temperature"]);H!=null&&g(t,["temperature"],H);const z=m(n,["thinkingConfig"]);z!=null&&g(t,["thinkingConfig"],z);const R=m(n,["topK"]);R!=null&&g(t,["topK"],R);const C=m(n,["topP"]);if(C!=null&&g(t,["topP"],C),m(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return t}function hz(n,e,t){const i={},r=m(e,["model"]);return r!=null&&g(i,["_url","name"],ft(n,r)),i}function pz(n,e,t){const i={},r=m(e,["model"]);return r!=null&&g(i,["_url","name"],ft(n,r)),i}function mz(n,e){const t={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const i=m(n,["enableWidget"]);return i!=null&&g(t,["enableWidget"],i),t}function gz(n,e){const t={};if(m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const i=m(n,["timeRangeFilter"]);return i!=null&&g(t,["timeRangeFilter"],i),t}function xz(n,e){const t={},i=m(n,["aspectRatio"]);i!=null&&g(t,["aspectRatio"],i);const r=m(n,["imageSize"]);if(r!=null&&g(t,["imageSize"],r),m(n,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return t}function yz(n,e){const t={},i=m(n,["aspectRatio"]);i!=null&&g(t,["aspectRatio"],i);const r=m(n,["imageSize"]);r!=null&&g(t,["imageSize"],r);const l=m(n,["personGeneration"]);l!=null&&g(t,["personGeneration"],l);const c=m(n,["outputMimeType"]);c!=null&&g(t,["imageOutputOptions","mimeType"],c);const d=m(n,["outputCompressionQuality"]);return d!=null&&g(t,["imageOutputOptions","compressionQuality"],d),t}function vz(n,e){const t={},i=m(n,["bytesBase64Encoded"]);i!=null&&g(t,["imageBytes"],go(i));const r=m(n,["mimeType"]);return r!=null&&g(t,["mimeType"],r),t}function i2(n,e){const t={},i=m(n,["gcsUri"]);i!=null&&g(t,["gcsUri"],i);const r=m(n,["bytesBase64Encoded"]);r!=null&&g(t,["imageBytes"],go(r));const l=m(n,["mimeType"]);return l!=null&&g(t,["mimeType"],l),t}function ep(n,e){const t={};if(m(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const i=m(n,["imageBytes"]);i!=null&&g(t,["bytesBase64Encoded"],go(i));const r=m(n,["mimeType"]);return r!=null&&g(t,["mimeType"],r),t}function rs(n,e){const t={},i=m(n,["gcsUri"]);i!=null&&g(t,["gcsUri"],i);const r=m(n,["imageBytes"]);r!=null&&g(t,["bytesBase64Encoded"],go(r));const l=m(n,["mimeType"]);return l!=null&&g(t,["mimeType"],l),t}function bz(n,e,t,i){const r={},l=m(e,["pageSize"]);t!==void 0&&l!=null&&g(t,["_query","pageSize"],l);const c=m(e,["pageToken"]);t!==void 0&&c!=null&&g(t,["_query","pageToken"],c);const d=m(e,["filter"]);t!==void 0&&d!=null&&g(t,["_query","filter"],d);const p=m(e,["queryBase"]);return t!==void 0&&p!=null&&g(t,["_url","models_url"],XN(n,p)),r}function _z(n,e,t,i){const r={},l=m(e,["pageSize"]);t!==void 0&&l!=null&&g(t,["_query","pageSize"],l);const c=m(e,["pageToken"]);t!==void 0&&c!=null&&g(t,["_query","pageToken"],c);const d=m(e,["filter"]);t!==void 0&&d!=null&&g(t,["_query","filter"],d);const p=m(e,["queryBase"]);return t!==void 0&&p!=null&&g(t,["_url","models_url"],XN(n,p)),r}function Tz(n,e,t){const i={},r=m(e,["config"]);return r!=null&&bz(n,r,i),i}function Sz(n,e,t){const i={},r=m(e,["config"]);return r!=null&&_z(n,r,i),i}function wz(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);const l=m(n,["_self"]);if(l!=null){let c=WN(l);Array.isArray(c)&&(c=c.map(d=>u0(d))),g(t,["models"],c)}return t}function Ez(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);const l=m(n,["_self"]);if(l!=null){let c=WN(l);Array.isArray(c)&&(c=c.map(d=>d0(d))),g(t,["models"],c)}return t}function Nz(n,e){const t={},i=m(n,["maskMode"]);i!=null&&g(t,["maskMode"],i);const r=m(n,["segmentationClasses"]);r!=null&&g(t,["maskClasses"],r);const l=m(n,["maskDilation"]);return l!=null&&g(t,["dilation"],l),t}function u0(n,e){const t={},i=m(n,["name"]);i!=null&&g(t,["name"],i);const r=m(n,["displayName"]);r!=null&&g(t,["displayName"],r);const l=m(n,["description"]);l!=null&&g(t,["description"],l);const c=m(n,["version"]);c!=null&&g(t,["version"],c);const d=m(n,["_self"]);d!=null&&g(t,["tunedModelInfo"],Fz(d));const p=m(n,["inputTokenLimit"]);p!=null&&g(t,["inputTokenLimit"],p);const h=m(n,["outputTokenLimit"]);h!=null&&g(t,["outputTokenLimit"],h);const x=m(n,["supportedGenerationMethods"]);x!=null&&g(t,["supportedActions"],x);const b=m(n,["temperature"]);b!=null&&g(t,["temperature"],b);const T=m(n,["maxTemperature"]);T!=null&&g(t,["maxTemperature"],T);const S=m(n,["topP"]);S!=null&&g(t,["topP"],S);const E=m(n,["topK"]);E!=null&&g(t,["topK"],E);const D=m(n,["thinking"]);return D!=null&&g(t,["thinking"],D),t}function d0(n,e){const t={},i=m(n,["name"]);i!=null&&g(t,["name"],i);const r=m(n,["displayName"]);r!=null&&g(t,["displayName"],r);const l=m(n,["description"]);l!=null&&g(t,["description"],l);const c=m(n,["versionId"]);c!=null&&g(t,["version"],c);const d=m(n,["deployedModels"]);if(d!=null){let T=d;Array.isArray(T)&&(T=T.map(S=>VV(S))),g(t,["endpoints"],T)}const p=m(n,["labels"]);p!=null&&g(t,["labels"],p);const h=m(n,["_self"]);h!=null&&g(t,["tunedModelInfo"],Gz(h));const x=m(n,["defaultCheckpointId"]);x!=null&&g(t,["defaultCheckpointId"],x);const b=m(n,["checkpoints"]);if(b!=null){let T=b;Array.isArray(T)&&(T=T.map(S=>S)),g(t,["checkpoints"],T)}return t}function Cz(n,e){const t={},i=m(n,["mediaResolution"]);i!=null&&g(t,["mediaResolution"],i);const r=m(n,["codeExecutionResult"]);r!=null&&g(t,["codeExecutionResult"],r);const l=m(n,["executableCode"]);l!=null&&g(t,["executableCode"],l);const c=m(n,["fileData"]);c!=null&&g(t,["fileData"],zV(c));const d=m(n,["functionCall"]);d!=null&&g(t,["functionCall"],HV(d));const p=m(n,["functionResponse"]);p!=null&&g(t,["functionResponse"],p);const h=m(n,["inlineData"]);h!=null&&g(t,["inlineData"],fV(h));const x=m(n,["text"]);x!=null&&g(t,["text"],x);const b=m(n,["thought"]);b!=null&&g(t,["thought"],b);const T=m(n,["thoughtSignature"]);T!=null&&g(t,["thoughtSignature"],T);const S=m(n,["videoMetadata"]);return S!=null&&g(t,["videoMetadata"],S),t}function kz(n,e){const t={},i=m(n,["productImage"]);return i!=null&&g(t,["image"],rs(i)),t}function Az(n,e,t){const i={},r=m(n,["numberOfImages"]);e!==void 0&&r!=null&&g(e,["parameters","sampleCount"],r);const l=m(n,["baseSteps"]);e!==void 0&&l!=null&&g(e,["parameters","baseSteps"],l);const c=m(n,["outputGcsUri"]);e!==void 0&&c!=null&&g(e,["parameters","storageUri"],c);const d=m(n,["seed"]);e!==void 0&&d!=null&&g(e,["parameters","seed"],d);const p=m(n,["safetyFilterLevel"]);e!==void 0&&p!=null&&g(e,["parameters","safetySetting"],p);const h=m(n,["personGeneration"]);e!==void 0&&h!=null&&g(e,["parameters","personGeneration"],h);const x=m(n,["addWatermark"]);e!==void 0&&x!=null&&g(e,["parameters","addWatermark"],x);const b=m(n,["outputMimeType"]);e!==void 0&&b!=null&&g(e,["parameters","outputOptions","mimeType"],b);const T=m(n,["outputCompressionQuality"]);e!==void 0&&T!=null&&g(e,["parameters","outputOptions","compressionQuality"],T);const S=m(n,["enhancePrompt"]);e!==void 0&&S!=null&&g(e,["parameters","enhancePrompt"],S);const E=m(n,["labels"]);return e!==void 0&&E!=null&&g(e,["labels"],E),i}function Iz(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["source"]);l!=null&&jz(l,i);const c=m(e,["config"]);return c!=null&&Az(c,i),i}function Rz(n,e){const t={},i=m(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>Zh(l))),g(t,["generatedImages"],r)}return t}function jz(n,e,t){const i={},r=m(n,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const l=m(n,["personImage"]);e!==void 0&&l!=null&&g(e,["instances[0]","personImage","image"],rs(l));const c=m(n,["productImages"]);if(e!==void 0&&c!=null){let d=c;Array.isArray(d)&&(d=d.map(p=>kz(p))),g(e,["instances[0]","productImages"],d)}return i}function Dz(n,e){const t={},i=m(n,["referenceImage"]);i!=null&&g(t,["referenceImage"],rs(i));const r=m(n,["referenceId"]);r!=null&&g(t,["referenceId"],r);const l=m(n,["referenceType"]);l!=null&&g(t,["referenceType"],l);const c=m(n,["maskImageConfig"]);c!=null&&g(t,["maskImageConfig"],Nz(c));const d=m(n,["controlImageConfig"]);d!=null&&g(t,["controlImageConfig"],vV(d));const p=m(n,["styleImageConfig"]);p!=null&&g(t,["styleImageConfig"],p);const h=m(n,["subjectImageConfig"]);return h!=null&&g(t,["subjectImageConfig"],h),t}function s2(n,e){const t={},i=m(n,["safetyAttributes","categories"]);i!=null&&g(t,["categories"],i);const r=m(n,["safetyAttributes","scores"]);r!=null&&g(t,["scores"],r);const l=m(n,["contentType"]);return l!=null&&g(t,["contentType"],l),t}function r2(n,e){const t={},i=m(n,["safetyAttributes","categories"]);i!=null&&g(t,["categories"],i);const r=m(n,["safetyAttributes","scores"]);r!=null&&g(t,["scores"],r);const l=m(n,["contentType"]);return l!=null&&g(t,["contentType"],l),t}function Mz(n,e){const t={},i=m(n,["category"]);if(i!=null&&g(t,["category"],i),m(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=m(n,["threshold"]);return r!=null&&g(t,["threshold"],r),t}function Pz(n,e){const t={},i=m(n,["image"]);return i!=null&&g(t,["image"],rs(i)),t}function Lz(n,e,t){const i={},r=m(n,["mode"]);e!==void 0&&r!=null&&g(e,["parameters","mode"],r);const l=m(n,["maxPredictions"]);e!==void 0&&l!=null&&g(e,["parameters","maxPredictions"],l);const c=m(n,["confidenceThreshold"]);e!==void 0&&c!=null&&g(e,["parameters","confidenceThreshold"],c);const d=m(n,["maskDilation"]);e!==void 0&&d!=null&&g(e,["parameters","maskDilation"],d);const p=m(n,["binaryColorThreshold"]);e!==void 0&&p!=null&&g(e,["parameters","binaryColorThreshold"],p);const h=m(n,["labels"]);return e!==void 0&&h!=null&&g(e,["labels"],h),i}function Oz(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["source"]);l!=null&&Vz(l,i);const c=m(e,["config"]);return c!=null&&Lz(c,i),i}function Uz(n,e){const t={},i=m(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>cz(l))),g(t,["generatedMasks"],r)}return t}function Vz(n,e,t){const i={},r=m(n,["prompt"]);e!==void 0&&r!=null&&g(e,["instances[0]","prompt"],r);const l=m(n,["image"]);e!==void 0&&l!=null&&g(e,["instances[0]","image"],rs(l));const c=m(n,["scribbleImage"]);return e!==void 0&&c!=null&&g(e,["instances[0]","scribble"],Pz(c)),i}function zz(n,e){const t={},i=m(n,["retrievalConfig"]);i!=null&&g(t,["retrievalConfig"],i);const r=m(n,["functionCallingConfig"]);return r!=null&&g(t,["functionCallingConfig"],FV(r)),t}function Hz(n,e){const t={};if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=m(n,["computerUse"]);i!=null&&g(t,["computerUse"],i);const r=m(n,["fileSearch"]);r!=null&&g(t,["fileSearch"],r);const l=m(n,["codeExecution"]);if(l!=null&&g(t,["codeExecution"],l),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const c=m(n,["functionDeclarations"]);if(c!=null){let b=c;Array.isArray(b)&&(b=b.map(T=>T)),g(t,["functionDeclarations"],b)}const d=m(n,["googleMaps"]);d!=null&&g(t,["googleMaps"],mz(d));const p=m(n,["googleSearch"]);p!=null&&g(t,["googleSearch"],gz(p));const h=m(n,["googleSearchRetrieval"]);h!=null&&g(t,["googleSearchRetrieval"],h);const x=m(n,["urlContext"]);return x!=null&&g(t,["urlContext"],x),t}function o2(n,e){const t={},i=m(n,["retrieval"]);i!=null&&g(t,["retrieval"],i);const r=m(n,["computerUse"]);if(r!=null&&g(t,["computerUse"],r),m(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const l=m(n,["codeExecution"]);l!=null&&g(t,["codeExecution"],l);const c=m(n,["enterpriseWebSearch"]);c!=null&&g(t,["enterpriseWebSearch"],c);const d=m(n,["functionDeclarations"]);if(d!=null){let T=d;Array.isArray(T)&&(T=T.map(S=>GV(S))),g(t,["functionDeclarations"],T)}const p=m(n,["googleMaps"]);p!=null&&g(t,["googleMaps"],p);const h=m(n,["googleSearch"]);h!=null&&g(t,["googleSearch"],h);const x=m(n,["googleSearchRetrieval"]);x!=null&&g(t,["googleSearchRetrieval"],x);const b=m(n,["urlContext"]);return b!=null&&g(t,["urlContext"],b),t}function Fz(n,e){const t={},i=m(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);const r=m(n,["createTime"]);r!=null&&g(t,["createTime"],r);const l=m(n,["updateTime"]);return l!=null&&g(t,["updateTime"],l),t}function Gz(n,e){const t={},i=m(n,["labels","google-vertex-llm-tuning-base-model-id"]);i!=null&&g(t,["baseModel"],i);const r=m(n,["createTime"]);r!=null&&g(t,["createTime"],r);const l=m(n,["updateTime"]);return l!=null&&g(t,["updateTime"],l),t}function Bz(n,e,t){const i={},r=m(n,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const l=m(n,["description"]);e!==void 0&&l!=null&&g(e,["description"],l);const c=m(n,["defaultCheckpointId"]);return e!==void 0&&c!=null&&g(e,["defaultCheckpointId"],c),i}function qz(n,e,t){const i={},r=m(n,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const l=m(n,["description"]);e!==void 0&&l!=null&&g(e,["description"],l);const c=m(n,["defaultCheckpointId"]);return e!==void 0&&c!=null&&g(e,["defaultCheckpointId"],c),i}function $z(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","name"],ft(n,r));const l=m(e,["config"]);return l!=null&&Bz(l,i),i}function Yz(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["config"]);return l!=null&&qz(l,i),i}function Jz(n,e,t){const i={},r=m(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const l=m(n,["safetyFilterLevel"]);e!==void 0&&l!=null&&g(e,["parameters","safetySetting"],l);const c=m(n,["personGeneration"]);e!==void 0&&c!=null&&g(e,["parameters","personGeneration"],c);const d=m(n,["includeRaiReason"]);e!==void 0&&d!=null&&g(e,["parameters","includeRaiReason"],d);const p=m(n,["outputMimeType"]);e!==void 0&&p!=null&&g(e,["parameters","outputOptions","mimeType"],p);const h=m(n,["outputCompressionQuality"]);e!==void 0&&h!=null&&g(e,["parameters","outputOptions","compressionQuality"],h);const x=m(n,["enhanceInputImage"]);e!==void 0&&x!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],x);const b=m(n,["imagePreservationFactor"]);e!==void 0&&b!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],b);const T=m(n,["labels"]);e!==void 0&&T!=null&&g(e,["labels"],T);const S=m(n,["numberOfImages"]);e!==void 0&&S!=null&&g(e,["parameters","sampleCount"],S);const E=m(n,["mode"]);return e!==void 0&&E!=null&&g(e,["parameters","mode"],E),i}function Kz(n,e,t){const i={},r=m(e,["model"]);r!=null&&g(i,["_url","model"],ft(n,r));const l=m(e,["image"]);l!=null&&g(i,["instances[0]","image"],rs(l));const c=m(e,["upscaleFactor"]);c!=null&&g(i,["parameters","upscaleConfig","upscaleFactor"],c);const d=m(e,["config"]);return d!=null&&Jz(d,i),i}function Xz(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["predictions"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>Zh(c))),g(t,["generatedImages"],l)}return t}function Wz(n,e){const t={},i=m(n,["uri"]);i!=null&&g(t,["uri"],i);const r=m(n,["encodedVideo"]);r!=null&&g(t,["videoBytes"],go(r));const l=m(n,["encoding"]);return l!=null&&g(t,["mimeType"],l),t}function Qz(n,e){const t={},i=m(n,["gcsUri"]);i!=null&&g(t,["uri"],i);const r=m(n,["bytesBase64Encoded"]);r!=null&&g(t,["videoBytes"],go(r));const l=m(n,["mimeType"]);return l!=null&&g(t,["mimeType"],l),t}function Zz(n,e){const t={},i=m(n,["image"]);i!=null&&g(t,["_self"],rs(i));const r=m(n,["maskMode"]);return r!=null&&g(t,["maskMode"],r),t}function e9(n,e){const t={},i=m(n,["image"]);i!=null&&g(t,["image"],ep(i));const r=m(n,["referenceType"]);return r!=null&&g(t,["referenceType"],r),t}function t9(n,e){const t={},i=m(n,["image"]);i!=null&&g(t,["image"],rs(i));const r=m(n,["referenceType"]);return r!=null&&g(t,["referenceType"],r),t}function a2(n,e){const t={},i=m(n,["uri"]);i!=null&&g(t,["uri"],i);const r=m(n,["videoBytes"]);r!=null&&g(t,["encodedVideo"],go(r));const l=m(n,["mimeType"]);return l!=null&&g(t,["encoding"],l),t}function l2(n,e){const t={},i=m(n,["uri"]);i!=null&&g(t,["gcsUri"],i);const r=m(n,["videoBytes"]);r!=null&&g(t,["bytesBase64Encoded"],go(r));const l=m(n,["mimeType"]);return l!=null&&g(t,["mimeType"],l),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function n9(n,e){const t={},i=m(n,["displayName"]);return e!==void 0&&i!=null&&g(e,["displayName"],i),t}function i9(n){const e={},t=m(n,["config"]);return t!=null&&n9(t,e),e}function s9(n,e){const t={},i=m(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function r9(n){const e={},t=m(n,["name"]);t!=null&&g(e,["_url","name"],t);const i=m(n,["config"]);return i!=null&&s9(i,e),e}function o9(n){const e={},t=m(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function a9(n,e){const t={},i=m(n,["customMetadata"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["customMetadata"],l)}const r=m(n,["chunkingConfig"]);return e!==void 0&&r!=null&&g(e,["chunkingConfig"],r),t}function l9(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const i=m(n,["metadata"]);i!=null&&g(e,["metadata"],i);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const l=m(n,["error"]);l!=null&&g(e,["error"],l);const c=m(n,["response"]);return c!=null&&g(e,["response"],u9(c)),e}function c9(n){const e={},t=m(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);const i=m(n,["fileName"]);i!=null&&g(e,["fileName"],i);const r=m(n,["config"]);return r!=null&&a9(r,e),e}function u9(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["parent"]);i!=null&&g(e,["parent"],i);const r=m(n,["documentName"]);return r!=null&&g(e,["documentName"],r),e}function d9(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function f9(n){const e={},t=m(n,["config"]);return t!=null&&d9(t,e),e}function h9(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=m(n,["fileSearchStores"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["fileSearchStores"],l)}return e}function c2(n,e){const t={},i=m(n,["mimeType"]);e!==void 0&&i!=null&&g(e,["mimeType"],i);const r=m(n,["displayName"]);e!==void 0&&r!=null&&g(e,["displayName"],r);const l=m(n,["customMetadata"]);if(e!==void 0&&l!=null){let d=l;Array.isArray(d)&&(d=d.map(p=>p)),g(e,["customMetadata"],d)}const c=m(n,["chunkingConfig"]);return e!==void 0&&c!=null&&g(e,["chunkingConfig"],c),t}function p9(n){const e={},t=m(n,["fileSearchStoreName"]);t!=null&&g(e,["_url","file_search_store_name"],t);const i=m(n,["config"]);return i!=null&&c2(i,e),e}function m9(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const g9="Content-Type",x9="X-Server-Timeout",y9="User-Agent",f0="x-goog-api-client",v9="1.42.0",b9=`google-genai-sdk/${v9}`,_9="v1beta1",T9="v1beta",S9=5,w9=[408,429,500,502,503,504];class E9{constructor(e){var t,i,r;this.clientOptions=Object.assign({},e),this.customBaseUrl=(t=e.httpOptions)===null||t===void 0?void 0:t.baseUrl,this.clientOptions.vertexai&&(this.clientOptions.project&&this.clientOptions.location?this.clientOptions.apiKey=void 0:this.clientOptions.apiKey&&(this.clientOptions.project=void 0,this.clientOptions.location=void 0));const l={};if(this.clientOptions.vertexai){if(!this.clientOptions.location&&!this.clientOptions.apiKey&&!this.customBaseUrl&&(this.clientOptions.location="global"),!(this.clientOptions.project&&this.clientOptions.location||this.clientOptions.apiKey)&&!this.customBaseUrl)throw new Error("Authentication is not set up. Please provide either a project and location, or an API key, or a custom base URL.");const d=e.project&&e.location||!!e.apiKey;this.customBaseUrl&&!d?(l.baseUrl=this.customBaseUrl,this.clientOptions.project=void 0,this.clientOptions.location=void 0):this.clientOptions.apiKey||this.clientOptions.location==="global"?l.baseUrl="https://aiplatform.googleapis.com/":this.clientOptions.project&&this.clientOptions.location&&(l.baseUrl=`https://${this.clientOptions.location}-aiplatform.googleapis.com/`),l.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:_9}else{if(!this.clientOptions.apiKey)throw new wu({message:"API key must be set when using the Gemini API.",status:403});l.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:T9,l.baseUrl="https://generativelanguage.googleapis.com/"}l.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=l,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(l,e.httpOptions))}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getCustomBaseUrl(){return this.customBaseUrl}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const r=[this.getRequestUrlInternal(t)];return i&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e,t){return!(t.baseUrl&&t.baseUrlResourceScope===o0.COLLECTION||this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[c,d]of Object.entries(e.queryParams))r.searchParams.append(c,String(d));let l={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else l.body=e.body;return l=await this.includeExtraHttpOptionsToRequestInit(l,t,r.toString(),e.abortSignal),this.unaryApiCall(r,l,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[r,l]of Object.entries(t))typeof l=="object"?i[r]=Object.assign(Object.assign({},i[r]),l):l!==void 0&&(i[r]=l);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e,t),r=this.constructUrl(e.path,t,i);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let l={};return l.body=e.body,l=await this.includeExtraHttpOptionsToRequestInit(l,t,r.toString(),e.abortSignal),this.streamApiCall(r,l,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,r){if(t&&t.timeout||r){const l=new AbortController,c=l.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const d=setTimeout(()=>l.abort(),t.timeout);d&&typeof d.unref=="function"&&d.unref()}r&&r.addEventListener("abort",()=>{l.abort()}),e.signal=c}return t&&t.extraBody!==null&&N9(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await wS(r),new a0(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async r=>(await wS(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){return es(this,arguments,function*(){var i;const r=(i=e==null?void 0:e.body)===null||i===void 0?void 0:i.getReader(),l=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let c="";const d="data:",p=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:h,value:x}=yield qe(r.read());if(h){if(c.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const b=l.decode(x,{stream:!0});try{const E=JSON.parse(b);if("error"in E){const D=JSON.parse(JSON.stringify(E.error)),k=D.status,F=D.code,$=`got status: ${k}. ${JSON.stringify(E)}`;if(F>=400&&F<600)throw new wu({message:$,status:F})}}catch(E){if(E.name==="ApiError")throw E}c+=b;let T=-1,S=0;for(;;){T=-1,S=0;for(const k of p){const F=c.indexOf(k);F!==-1&&(T===-1||F<T)&&(T=F,S=k.length)}if(T===-1)break;const E=c.substring(0,T);c=c.substring(T+S);const D=E.trim();if(D.startsWith(d)){const k=D.substring(d.length).trim();try{const F=new Response(k,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield qe(new a0(F))}catch(F){throw new Error(`exception parsing stream chunk ${k}. ${F}`)}}}}}finally{r.releaseLock()}})}async apiCall(e,t){var i;if(!this.clientOptions.httpOptions||!this.clientOptions.httpOptions.retryOptions)return fetch(e,t);const r=this.clientOptions.httpOptions.retryOptions;return p6(async()=>{const c=await fetch(e,t);if(c.ok)return c;throw w9.includes(c.status)?new Error(`Retryable HTTP Error: ${c.statusText}`):new HN.AbortError(`Non-retryable exception ${c.statusText} sending request`)},{retries:((i=r.attempts)!==null&&i!==void 0?i:S9)-1})}getDefaultHeaders(){const e={},t=b9+" "+this.clientOptions.userAgentExtra;return e[y9]=t,e[f0]=t,e[g9]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[r,l]of Object.entries(e.headers))i.append(r,l);e.timeout&&e.timeout>0&&i.append(x9,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const l=this.clientOptions.uploader,c=await l.stat(e);r.sizeBytes=String(c.size);const d=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:c.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=d;const p={file:r},h=this.getFileName(e),x=ke("upload/v1beta/files",p._url),b=await this.fetchUploadUrl(x,r.sizeBytes,r.mimeType,h,p,t==null?void 0:t.httpOptions);return l.upload(e,b,this)}async uploadFileToFileSearchStore(e,t,i){var r;const l=this.clientOptions.uploader,c=await l.stat(t),d=String(c.size),p=(r=i==null?void 0:i.mimeType)!==null&&r!==void 0?r:c.type;if(p===void 0||p==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const h=`upload/v1beta/${e}:uploadToFileSearchStore`,x=this.getFileName(t),b={};i!=null&&c2(i,b);const T=await this.fetchUploadUrl(h,d,p,x,b,i==null?void 0:i.httpOptions);return l.uploadToFileSearchStore(t,T,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,r,l,c){var d;let p={};c?p=c:p={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},r?{"X-Goog-Upload-File-Name":r}:{})};const h=await this.request({path:e,body:JSON.stringify(l),httpMethod:"POST",httpOptions:p});if(!h||!(h!=null&&h.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const x=(d=h==null?void 0:h.headers)===null||d===void 0?void 0:d["x-goog-upload-url"];if(x===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return x}}async function wS(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(i);throw t>=400&&t<600?new wu({message:r,status:t}):new Error(r)}}function N9(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const l=JSON.parse(n.body);if(typeof l=="object"&&l!==null&&!Array.isArray(l))t=l;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(l,c){const d=Object.assign({},l);for(const p in c)if(Object.prototype.hasOwnProperty.call(c,p)){const h=c[p],x=d[p];h&&typeof h=="object"&&!Array.isArray(h)&&x&&typeof x=="object"&&!Array.isArray(x)?d[p]=i(x,h):(x&&h&&typeof x!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${p}". Original type: ${typeof x}, New type: ${typeof h}. Overwriting.`),d[p]=h)}return d}const r=i(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const C9="mcp_used/unknown";let k9=!1;function u2(n){for(const e of n)if(A9(e)||typeof e=="object"&&"inputSchema"in e)return!0;return k9}function d2(n){var e;const t=(e=n[f0])!==null&&e!==void 0?e:"";n[f0]=(t+` ${C9}`).trimStart()}function A9(n){return n!==null&&typeof n=="object"&&n instanceof Ax}function I9(n){return es(this,arguments,function*(t,i=100){let r,l=0;for(;l<i;){const c=yield qe(t.listTools({cursor:r}));for(const d of c.tools)yield yield qe(d),l++;if(!c.nextCursor)break;r=c.nextCursor}})}class Ax{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Ax(e,t)}async initialize(){var e,t,i,r;if(this.mcpTools.length>0)return;const l={},c=[];for(const x of this.mcpClients)try{for(var d=!0,p=(t=void 0,ts(I9(x))),h;h=await p.next(),e=h.done,!e;d=!0){r=h.value,d=!1;const b=r;c.push(b);const T=b.name;if(l[T])throw new Error(`Duplicate function name ${T} found in MCP tools. Please ensure function names are unique.`);l[T]=x}}catch(b){t={error:b}}finally{try{!d&&!e&&(i=p.return)&&await i.call(p)}finally{if(t)throw t.error}}this.mcpTools=c,this.functionNameToMcpClient=l}async tool(){return await this.initialize(),nO(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[i.name];let l;this.config.timeout&&(l={timeout:this.config.timeout});const c=await r.callTool({name:i.name,arguments:i.args},void 0,l);t.push({functionResponse:{name:i.name,response:c.isError?{error:c}:c}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function R9(n,e,t){const i=new J6;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(i,r),e(i)}class j9{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion(),c=P9(this.apiClient.getDefaultHeaders()),d=this.apiClient.getApiKey(),p=`${r}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateMusic?key=${d}`;let h=()=>{};const x=new Promise(M=>{h=M}),b=e.callbacks,T=function(){h({})},S=this.apiClient,E={onopen:T,onmessage:M=>{R9(S,b.onmessage,M)},onerror:(t=b==null?void 0:b.onerror)!==null&&t!==void 0?t:function(M){},onclose:(i=b==null?void 0:b.onclose)!==null&&i!==void 0?i:function(M){}},D=this.webSocketFactory.create(p,M9(c),E);D.connect(),await x;const $={setup:{model:ft(this.apiClient,e.model)}};return D.send(JSON.stringify($)),new D9(D,this.apiClient)}}class D9{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=nV(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=tV(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(cl.PLAY)}pause(){this.sendPlaybackControl(cl.PAUSE)}stop(){this.sendPlaybackControl(cl.STOP)}resetContext(){this.sendPlaybackControl(cl.RESET_CONTEXT)}close(){this.conn.close()}}function M9(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function P9(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const L9="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function O9(n,e,t){const i=new Y6;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const l=JSON.parse(r);if(n.isVertexAI()){const c=rV(l);Object.assign(i,c)}else Object.assign(i,l);e(i)}class U9{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new j9(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,r,l,c,d;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const p=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let x;const b=this.apiClient.getHeaders();e.config&&e.config.tools&&u2(e.config.tools)&&d2(b);const T=F9(b);if(this.apiClient.isVertexAI()){const A=this.apiClient.getProject(),P=this.apiClient.getLocation(),L=this.apiClient.getApiKey(),O=!!A&&!!P||!!L;this.apiClient.getCustomBaseUrl()&&!O?x=p:(x=`${p}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(T,x))}else{const A=this.apiClient.getApiKey();let P="BidiGenerateContent",L="key";A!=null&&A.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",L="access_token"),x=`${p}/ws/google.ai.generativelanguage.${h}.GenerativeService.${P}?${L}=${A}`}let S=()=>{};const E=new Promise(A=>{S=A}),D=e.callbacks,k=function(){var A;(A=D==null?void 0:D.onopen)===null||A===void 0||A.call(D),S({})},F=this.apiClient,$={onopen:k,onmessage:A=>{O9(F,D.onmessage,A)},onerror:(t=D==null?void 0:D.onerror)!==null&&t!==void 0?t:function(A){},onclose:(i=D==null?void 0:D.onclose)!==null&&i!==void 0?i:function(A){}},M=this.webSocketFactory.create(x,H9(T),$);M.connect(),await E;let J=ft(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&J.startsWith("publishers/")){const A=this.apiClient.getProject(),P=this.apiClient.getLocation();A&&P&&(J=`projects/${A}/locations/${P}/`+J)}let H={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[vh.AUDIO]}:e.config.responseModalities=[vh.AUDIO]),!((l=e.config)===null||l===void 0)&&l.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const z=(d=(c=e.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[],R=[];for(const A of z)if(this.isCallableTool(A)){const P=A;R.push(await P.tool())}else R.push(A);R.length>0&&(e.config.tools=R);const C={model:J,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?H=eV(this.apiClient,C):H=ZU(this.apiClient,C),delete H.config,M.send(JSON.stringify(H)),new z9(M,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const V9={turnComplete:!0};class z9{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=di(t.turns),e.isVertexAI()||(i=i.map(r=>Lu(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const l of i){if(typeof l!="object"||l===null||!("name"in l)||!("response"in l))throw new Error(`Could not parse function response, type '${typeof l}'.`);if(!e.isVertexAI()&&!("id"in l))throw new Error(L9)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},V9),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:sV(e)}:t={realtimeInput:iV(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function H9(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function F9(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ES=10;function NS(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const c of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(xl(c)){r=!0;break}if(!r)return!0;const l=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return l&&(l<0||!Number.isInteger(l))||l==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",l),!0):!1}function xl(n){return"callTool"in n&&typeof n.callTool=="function"}function G9(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>xl(r)))!==null&&i!==void 0?i:!1}function CS(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,r)=>{if(xl(i))return;const l=i;l.functionDeclarations&&l.functionDeclarations.length>0&&t.push(r)}),t}function kS(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class B9 extends pr{constructor(e){super(),this.apiClient=e,this.embedContent=async t=>{if(!this.apiClient.isVertexAI())return await this.embedContentInternal(t);if(t.model.includes("gemini")&&t.model!=="gemini-embedding-001"||t.model.includes("maas")){const r=di(t.contents);if(r.length>1)throw new Error("The embedContent API for this model only supports one content at a time.");const l=Object.assign(Object.assign({},t),{content:r[0],embeddingApiType:bh.EMBED_CONTENT});return await this.embedContentInternal(l)}else{const r=Object.assign(Object.assign({},t),{embeddingApiType:bh.PREDICT});return await this.embedContentInternal(r)}},this.generateContent=async t=>{var i,r,l,c,d;const p=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!G9(t)||NS(t.config))return await this.generateContentInternal(p);const h=CS(t);if(h.length>0){const D=h.map(k=>`tools[${k}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${D}.`)}let x,b;const T=di(p.contents),S=(l=(r=(i=p.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&l!==void 0?l:ES;let E=0;for(;E<S&&(x=await this.generateContentInternal(p),!(!x.functionCalls||x.functionCalls.length===0));){const D=x.candidates[0].content,k=[];for(const F of(d=(c=t.config)===null||c===void 0?void 0:c.tools)!==null&&d!==void 0?d:[])if(xl(F)){const M=await F.callTool(x.functionCalls);k.push(...M)}E++,b={role:"user",parts:k},p.contents=di(p.contents),p.contents.push(D),p.contents.push(b),kS(p.config)&&(T.push(D),T.push(b))}return kS(p.config)&&(x.automaticFunctionCallingHistory=T),x},this.generateContentStream=async t=>{var i,r,l,c,d;if(this.maybeMoveToResponseJsonSchem(t),NS(t.config)){const b=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(b)}const p=CS(t);if(p.length>0){const b=p.map(T=>`tools[${T}]`).join(", ");throw new Error(`Incompatible tools found at ${b}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const h=(l=(r=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||l===void 0?void 0:l.streamFunctionCallArguments,x=(d=(c=t==null?void 0:t.config)===null||c===void 0?void 0:c.automaticFunctionCalling)===null||d===void 0?void 0:d.disable;if(h&&!x)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var r;let l;const c=[];if(i!=null&&i.generatedImages)for(const p of i.generatedImages)p&&(p!=null&&p.safetyAttributes)&&((r=p==null?void 0:p.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?l=p==null?void 0:p.safetyAttributes:c.push(p);let d;return l?d={generatedImages:c,positivePromptSafetyAttributes:l,sdkHttpResponse:i.sdkHttpResponse}:d={generatedImages:c,sdkHttpResponse:i.sdkHttpResponse},d}),this.list=async t=>{var i;const c={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!c.config.queryBase){if(!((i=c.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");c.config.filter="labels.tune-type:*"}return new ha(dr.PAGED_ITEM_MODELS,d=>this.listInternal(d),await this.listInternal(c),c)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var i,r,l,c,d,p;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((c=(l=t.source)===null||l===void 0?void 0:l.video)===null||c===void 0)&&c.uri&&(!((p=(d=t.source)===null||d===void 0?void 0:d.video)===null||p===void 0)&&p.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,r;const l=(t=e.config)===null||t===void 0?void 0:t.tools;if(!l)return e;const c=await Promise.all(l.map(async p=>xl(p)?await p.tool():p)),d={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:c})};if(d.config.tools=c,e.config&&e.config.tools&&u2(e.config.tools)){const p=(r=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&r!==void 0?r:{};let h=Object.assign({},p);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),d2(h),d.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:h})}return d}async initAfcToolsMap(e){var t,i,r;const l=new Map;for(const c of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(xl(c)){const d=c,p=await d.tool();for(const h of(r=p.functionDeclarations)!==null&&r!==void 0?r:[]){if(!h.name)throw new Error("Function declaration name is required.");if(l.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);l.set(h.name,d)}}return l}async processAfcStream(e){var t,i,r;const l=(r=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&r!==void 0?r:ES;let c=!1,d=0;const p=await this.initAfcToolsMap(e);return(function(h,x,b){return es(this,arguments,function*(){for(var T,S,E,D,k,F;d<l;){c&&(d++,c=!1);const H=yield qe(h.processParamsMaybeAddMcpUsage(b)),z=yield qe(h.generateContentStreamInternal(H)),R=[],C=[];try{for(var $=!0,M=(S=void 0,ts(z)),J;J=yield qe(M.next()),T=J.done,!T;$=!0){D=J.value,$=!1;const A=D;if(yield yield qe(A),A.candidates&&(!((k=A.candidates[0])===null||k===void 0)&&k.content)){C.push(A.candidates[0].content);for(const P of(F=A.candidates[0].content.parts)!==null&&F!==void 0?F:[])if(d<l&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(x.has(P.functionCall.name)){const L=yield qe(x.get(P.functionCall.name).callTool([P.functionCall]));R.push(...L)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${x.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(A){S={error:A}}finally{try{!$&&!T&&(E=M.return)&&(yield qe(E.call(M)))}finally{if(S)throw S.error}}if(R.length>0){c=!0;const A=new Jc;A.candidates=[{content:{role:"user",parts:R}}],yield yield qe(A);const P=[];P.push(...C),P.push({role:"user",parts:R});const L=di(b.contents).concat(P);b.contents=L}else break}})})(this,p,e)}async generateContentInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=_S(this.apiClient,e);return d=ke("{model}:generateContent",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=SS(x),T=new Jc;return Object.assign(T,b),T})}else{const h=bS(this.apiClient,e);return d=ke("{model}:generateContent",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=TS(x),T=new Jc;return Object.assign(T,b),T})}}async generateContentStreamInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=_S(this.apiClient,e);return d=ke("{model}:streamGenerateContent?alt=sse",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.requestStream({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),c.then(function(b){return es(this,arguments,function*(){var T,S,E,D;try{for(var k=!0,F=ts(b),$;$=yield qe(F.next()),T=$.done,!T;k=!0){D=$.value,k=!1;const M=D,J=SS(yield qe(M.json()),e);J.sdkHttpResponse={headers:M.headers};const H=new Jc;Object.assign(H,J),yield yield qe(H)}}catch(M){S={error:M}}finally{try{!k&&!T&&(E=F.return)&&(yield qe(E.call(F)))}finally{if(S)throw S.error}}})})}else{const h=bS(this.apiClient,e);return d=ke("{model}:streamGenerateContent?alt=sse",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.requestStream({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}),c.then(function(b){return es(this,arguments,function*(){var T,S,E,D;try{for(var k=!0,F=ts(b),$;$=yield qe(F.next()),T=$.done,!T;k=!0){D=$.value,k=!1;const M=D,J=TS(yield qe(M.json()),e);J.sdkHttpResponse={headers:M.headers};const H=new Jc;Object.assign(H,J),yield yield qe(H)}}catch(M){S={error:M}}finally{try{!k&&!T&&(E=F.return)&&(yield qe(E.call(F)))}finally{if(S)throw S.error}}})})}}async embedContentInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=LV(this.apiClient,e,e),x=sO(e.model)?"{model}:embedContent":"{model}:predict";return d=ke(x,h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(b=>b.json().then(T=>{const S=T;return S.sdkHttpResponse={headers:b.headers},S})),c.then(b=>{const T=UV(b,e),S=new iS;return Object.assign(S,T),S})}else{const h=PV(this.apiClient,e);return d=ke("{model}:batchEmbedContents",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=OV(x),T=new iS;return Object.assign(T,b),T})}}async generateImagesInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=KV(this.apiClient,e);return d=ke("{model}:predict",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=WV(x),T=new sS;return Object.assign(T,b),T})}else{const h=JV(this.apiClient,e);return d=ke("{model}:predict",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=XV(x),T=new sS;return Object.assign(T,b),T})}}async editImageInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const d=RV(this.apiClient,e);return l=ke("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const x=h;return x.sdkHttpResponse={headers:p.headers},x})),r.then(p=>{const h=jV(p),x=new P6;return Object.assign(x,h),x})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const d=Kz(this.apiClient,e);return l=ke("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const x=h;return x.sdkHttpResponse={headers:p.headers},x})),r.then(p=>{const h=Xz(p),x=new L6;return Object.assign(x,h),x})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const d=Iz(this.apiClient,e);return l=ke("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>{const h=Rz(p),x=new O6;return Object.assign(x,h),x})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const d=Oz(this.apiClient,e);return l=ke("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>{const h=Uz(p),x=new U6;return Object.assign(x,h),x})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=pz(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>d0(x))}else{const h=hz(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>u0(x))}}async listInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=Sz(this.apiClient,e);return d=ke("{models_url}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=Ez(x),T=new rS;return Object.assign(T,b),T})}else{const h=Tz(this.apiClient,e);return d=ke("{models_url}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=wz(x),T=new rS;return Object.assign(T,b),T})}}async update(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=Yz(this.apiClient,e);return d=ke("{model}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>d0(x))}else{const h=$z(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>u0(x))}}async delete(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=CV(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=AV(x),T=new oS;return Object.assign(T,b),T})}else{const h=NV(this.apiClient,e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=kV(x),T=new oS;return Object.assign(T,b),T})}}async countTokens(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=SV(this.apiClient,e);return d=ke("{model}:countTokens",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=EV(x),T=new aS;return Object.assign(T,b),T})}else{const h=TV(this.apiClient,e);return d=ke("{model}:countTokens",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=wV(x),T=new aS;return Object.assign(T,b),T})}}async computeTokens(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const d=mV(this.apiClient,e);return l=ke("{model}:computeTokens",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const x=h;return x.sdkHttpResponse={headers:p.headers},x})),r.then(p=>{const h=gV(p),x=new V6;return Object.assign(x,h),x})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=iz(this.apiClient,e);return d=ke("{model}:predictLongRunning",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c.then(x=>{const b=tz(x),T=new _h;return Object.assign(T,b),T})}else{const h=nz(this.apiClient,e);return d=ke("{model}:predictLongRunning",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c.then(x=>{const b=ez(x),T=new _h;return Object.assign(T,b),T})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class q9 extends pr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let l;i&&"httpOptions"in i&&(l=i.httpOptions);const c=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:l}});return t._fromAPIResponse({apiResponse:c,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=A6(e);return d=ke("{operationName}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json()),c}else{const h=k6(e);return d=ke("{operationName}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json()),c}}async fetchPredictVideosOperationInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const d=_6(e);return l=ke("{resourceName}:fetchPredictOperation",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $9(n){const e={},t=m(n,["data"]);if(t!=null&&g(e,["data"],t),m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=m(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function Y9(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(l=>n8(l))),g(e,["parts"],r)}const i=m(n,["role"]);return i!=null&&g(e,["role"],i),e}function J9(n,e,t){const i={},r=m(e,["expireTime"]);t!==void 0&&r!=null&&g(t,["expireTime"],r);const l=m(e,["newSessionExpireTime"]);t!==void 0&&l!=null&&g(t,["newSessionExpireTime"],l);const c=m(e,["uses"]);t!==void 0&&c!=null&&g(t,["uses"],c);const d=m(e,["liveConnectConstraints"]);t!==void 0&&d!=null&&g(t,["bidiGenerateContentSetup"],t8(n,d));const p=m(e,["lockAdditionalFields"]);return t!==void 0&&p!=null&&g(t,["fieldMask"],p),i}function K9(n,e){const t={},i=m(e,["config"]);return i!=null&&g(t,["config"],J9(n,i,t)),t}function X9(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const i=m(n,["mimeType"]);return i!=null&&g(e,["mimeType"],i),e}function W9(n){const e={},t=m(n,["id"]);t!=null&&g(e,["id"],t);const i=m(n,["args"]);i!=null&&g(e,["args"],i);const r=m(n,["name"]);if(r!=null&&g(e,["name"],r),m(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Q9(n){const e={};if(m(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(n,["enableWidget"]);return t!=null&&g(e,["enableWidget"],t),e}function Z9(n){const e={};if(m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(n,["timeRangeFilter"]);return t!=null&&g(e,["timeRangeFilter"],t),e}function e8(n,e){const t={},i=m(n,["generationConfig"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig"],i);const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const l=m(n,["temperature"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","temperature"],l);const c=m(n,["topP"]);e!==void 0&&c!=null&&g(e,["setup","generationConfig","topP"],c);const d=m(n,["topK"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","topK"],d);const p=m(n,["maxOutputTokens"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","maxOutputTokens"],p);const h=m(n,["mediaResolution"]);e!==void 0&&h!=null&&g(e,["setup","generationConfig","mediaResolution"],h);const x=m(n,["seed"]);e!==void 0&&x!=null&&g(e,["setup","generationConfig","seed"],x);const b=m(n,["speechConfig"]);e!==void 0&&b!=null&&g(e,["setup","generationConfig","speechConfig"],kx(b));const T=m(n,["thinkingConfig"]);e!==void 0&&T!=null&&g(e,["setup","generationConfig","thinkingConfig"],T);const S=m(n,["enableAffectiveDialog"]);e!==void 0&&S!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],S);const E=m(n,["systemInstruction"]);e!==void 0&&E!=null&&g(e,["setup","systemInstruction"],Y9(gn(E)));const D=m(n,["tools"]);if(e!==void 0&&D!=null){let z=zl(D);Array.isArray(z)&&(z=z.map(R=>s8(Vl(R)))),g(e,["setup","tools"],z)}const k=m(n,["sessionResumption"]);e!==void 0&&k!=null&&g(e,["setup","sessionResumption"],i8(k));const F=m(n,["inputAudioTranscription"]);e!==void 0&&F!=null&&g(e,["setup","inputAudioTranscription"],F);const $=m(n,["outputAudioTranscription"]);e!==void 0&&$!=null&&g(e,["setup","outputAudioTranscription"],$);const M=m(n,["realtimeInputConfig"]);e!==void 0&&M!=null&&g(e,["setup","realtimeInputConfig"],M);const J=m(n,["contextWindowCompression"]);e!==void 0&&J!=null&&g(e,["setup","contextWindowCompression"],J);const H=m(n,["proactivity"]);if(e!==void 0&&H!=null&&g(e,["setup","proactivity"],H),m(n,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function t8(n,e){const t={},i=m(e,["model"]);i!=null&&g(t,["setup","model"],ft(n,i));const r=m(e,["config"]);return r!=null&&g(t,["config"],e8(r,t)),t}function n8(n){const e={},t=m(n,["mediaResolution"]);t!=null&&g(e,["mediaResolution"],t);const i=m(n,["codeExecutionResult"]);i!=null&&g(e,["codeExecutionResult"],i);const r=m(n,["executableCode"]);r!=null&&g(e,["executableCode"],r);const l=m(n,["fileData"]);l!=null&&g(e,["fileData"],X9(l));const c=m(n,["functionCall"]);c!=null&&g(e,["functionCall"],W9(c));const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const p=m(n,["inlineData"]);p!=null&&g(e,["inlineData"],$9(p));const h=m(n,["text"]);h!=null&&g(e,["text"],h);const x=m(n,["thought"]);x!=null&&g(e,["thought"],x);const b=m(n,["thoughtSignature"]);b!=null&&g(e,["thoughtSignature"],b);const T=m(n,["videoMetadata"]);return T!=null&&g(e,["videoMetadata"],T),e}function i8(n){const e={},t=m(n,["handle"]);if(t!=null&&g(e,["handle"],t),m(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function s8(n){const e={};if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(n,["computerUse"]);t!=null&&g(e,["computerUse"],t);const i=m(n,["fileSearch"]);i!=null&&g(e,["fileSearch"],i);const r=m(n,["codeExecution"]);if(r!=null&&g(e,["codeExecution"],r),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const l=m(n,["functionDeclarations"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(b=>b)),g(e,["functionDeclarations"],x)}const c=m(n,["googleMaps"]);c!=null&&g(e,["googleMaps"],Q9(c));const d=m(n,["googleSearch"]);d!=null&&g(e,["googleSearch"],Z9(d));const p=m(n,["googleSearchRetrieval"]);p!=null&&g(e,["googleSearchRetrieval"],p);const h=m(n,["urlContext"]);return h!=null&&g(e,["urlContext"],h),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function r8(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const r=Object.keys(i).map(l=>`${t}.${l}`);e.push(...r)}else e.push(t)}return e.join(",")}function o8(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const l=i.setup;typeof l=="object"&&l!==null?(n.bidiGenerateContentSetup=l,t=l):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const l=r8(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)l?n.fieldMask=l:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const c=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let d=[];r.length>0&&(d=r.map(h=>c.includes(h)?`generationConfig.${h}`:h));const p=[];l&&p.push(l),d.length>0&&p.push(...d),p.length>0?n.fieldMask=p.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class a8 extends pr{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const d=K9(this.apiClient,e);l=ke("auth_tokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const p=o8(d,e.config);return r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),r.then(h=>h)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function l8(n,e){const t={},i=m(n,["force"]);return e!==void 0&&i!=null&&g(e,["_query","force"],i),t}function c8(n){const e={},t=m(n,["name"]);t!=null&&g(e,["_url","name"],t);const i=m(n,["config"]);return i!=null&&l8(i,e),e}function u8(n){const e={},t=m(n,["name"]);return t!=null&&g(e,["_url","name"],t),e}function d8(n,e){const t={},i=m(n,["pageSize"]);e!==void 0&&i!=null&&g(e,["_query","pageSize"],i);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function f8(n){const e={},t=m(n,["parent"]);t!=null&&g(e,["_url","parent"],t);const i=m(n,["config"]);return i!=null&&d8(i,e),e}function h8(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const i=m(n,["nextPageToken"]);i!=null&&g(e,["nextPageToken"],i);const r=m(n,["documents"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>c)),g(e,["documents"],l)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class p8 extends pr{constructor(e){super(),this.apiClient=e,this.list=async t=>new ha(dr.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=u8(e);return l=ke("{name}",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}async delete(e){var t,i;let r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=c8(e);r=ke("{name}",c._url),l=c._query,delete c._url,delete c._query,await this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=f8(e);return l=ke("{parent}/documents",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>{const h=h8(p),x=new z6;return Object.assign(x,h),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class m8 extends pr{constructor(e,t=new p8(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new ha(dr.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=i9(e);return l=ke("fileSearchStores",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}async get(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=o9(e);return l=ke("{name}",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>p)}}async delete(e){var t,i;let r="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=r9(e);r=ke("{name}",c._url),l=c._query,delete c._url,delete c._query,await this.apiClient.request({path:r,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=f9(e);return l=ke("fileSearchStores",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>{const h=h9(p),x=new H6;return Object.assign(x,h),x})}}async uploadToFileSearchStoreInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=p9(e);return l=ke("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>{const h=m9(p),x=new F6;return Object.assign(x,h),x})}}async importFile(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=c9(e);return l=ke("{file_search_store_name}:importFile",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json()),r.then(p=>{const h=l9(p),x=new Sx;return Object.assign(x,h),x})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let f2=function(){const{crypto:n}=globalThis;if(n!=null&&n.randomUUID)return f2=n.randomUUID.bind(n),n.randomUUID();const e=new Uint8Array(1),t=n?()=>n.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^t()&15>>+i/4).toString(16))};const g8=()=>f2();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function h0(n){return typeof n=="object"&&n!==null&&("name"in n&&n.name==="AbortError"||"message"in n&&String(n.message).includes("FetchRequestCanceledException"))}const p0=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null){try{if(Object.prototype.toString.call(n)==="[object Error]"){const e=new Error(n.message,n.cause?{cause:n.cause}:{});return n.stack&&(e.stack=n.stack),n.cause&&!e.cause&&(e.cause=n.cause),n.name&&(e.name=n.name),e}}catch{}try{return new Error(JSON.stringify(n))}catch{}}return new Error(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Di extends Error{}class Hn extends Di{constructor(e,t,i,r){super(`${Hn.makeMessage(e,t,i)}`),this.status=e,this.headers=r,this.error=t}static makeMessage(e,t,i){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):i;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,i,r){if(!e||!r)return new tp({message:i,cause:p0(t)});const l=t;return e===400?new p2(e,l,i,r):e===401?new m2(e,l,i,r):e===403?new g2(e,l,i,r):e===404?new x2(e,l,i,r):e===409?new y2(e,l,i,r):e===422?new v2(e,l,i,r):e===429?new b2(e,l,i,r):e>=500?new _2(e,l,i,r):new Hn(e,l,i,r)}}class m0 extends Hn{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class tp extends Hn{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class h2 extends tp{constructor({message:e}={}){super({message:e??"Request timed out."})}}class p2 extends Hn{}class m2 extends Hn{}class g2 extends Hn{}class x2 extends Hn{}class y2 extends Hn{}class v2 extends Hn{}class b2 extends Hn{}class _2 extends Hn{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const x8=/^[a-z][a-z0-9+.-]*:/i,y8=n=>x8.test(n);let g0=n=>(g0=Array.isArray,g0(n));const v8=g0;let b8=v8;const AS=b8;function _8(n){if(!n)return!0;for(const e in n)return!1;return!0}function T8(n,e){return Object.prototype.hasOwnProperty.call(n,e)}const S8=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Di(`${n} must be an integer`);if(e<0)throw new Di(`${n} must be a positive integer`);return e},w8=n=>{try{return JSON.parse(n)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const E8=n=>new Promise(e=>setTimeout(e,n));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const al="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function N8(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const C8=()=>{var n,e,t,i,r;const l=N8();if(l==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":RS(Deno.build.os),"X-Stainless-Arch":IS(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(n=Deno.version)===null||n===void 0?void 0:n.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(l==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":RS((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":IS((i=globalThis.process.arch)!==null&&i!==void 0?i:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};const c=k8();return c?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${c.browser}`,"X-Stainless-Runtime-Version":c.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":al,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function k8(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const i=t.exec(navigator.userAgent);if(i){const r=i[1]||0,l=i[2]||0,c=i[3]||0;return{browser:e,version:`${r}.${l}.${c}`}}}return null}const IS=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",RS=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let Sf;const A8=()=>Sf??(Sf=C8());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I8(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function T2(...n){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...n)}function R8(n){let e=Symbol.asyncIterator in n?n[Symbol.asyncIterator]():n[Symbol.iterator]();return T2({start(){},async pull(t){const{done:i,value:r}=await e.next();i?t.close():t.enqueue(r)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function S2(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function j8(n){var e,t;if(n===null||typeof n!="object")return;if(n[Symbol.asyncIterator]){await((t=(e=n[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const i=n.getReader(),r=i.cancel();i.releaseLock(),await r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const D8=({headers:n,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const w2=()=>{var n;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((n=e==null?void 0:e.versions)===null||n===void 0?void 0:n.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Ag(n,e,t){return w2(),new File(n,e??"unknown_file",t)}function M8(n){return(typeof n=="object"&&n!==null&&("name"in n&&n.name&&String(n.name)||"url"in n&&n.url&&String(n.url)||"filename"in n&&n.filename&&String(n.filename)||"path"in n&&n.path&&String(n.path))||"").split(/[\\/]/).pop()||void 0}const P8=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const E2=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",L8=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&E2(n),O8=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function";async function U8(n,e,t){if(w2(),n=await n,L8(n))return n instanceof File?n:Ag([await n.arrayBuffer()],n.name);if(O8(n)){const r=await n.blob();return e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()),Ag(await x0(r),e,t)}const i=await x0(n);if(e||(e=M8(n)),!(t!=null&&t.type)){const r=i.find(l=>typeof l=="object"&&"type"in l&&l.type);typeof r=="string"&&(t=Object.assign(Object.assign({},t),{type:r}))}return Ag(i,e,t)}async function x0(n){var e,t,i,r,l;let c=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)c.push(n);else if(E2(n))c.push(n instanceof Blob?n:await n.arrayBuffer());else if(P8(n))try{for(var d=!0,p=ts(n),h;h=await p.next(),e=h.done,!e;d=!0){r=h.value,d=!1;const x=r;c.push(...await x0(x))}}catch(x){t={error:x}}finally{try{!d&&!e&&(i=p.return)&&await i.call(p)}finally{if(t)throw t.error}}else{const x=(l=n==null?void 0:n.constructor)===null||l===void 0?void 0:l.name;throw new Error(`Unexpected data type: ${typeof n}${x?`; constructor: ${x}`:""}${V8(n)}`)}return c}function V8(n){return typeof n!="object"||n===null?"":`; props: [${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class N2{constructor(e){this._client=e}}N2._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function C2(n){return n.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const jS=Object.freeze(Object.create(null)),z8=(n=C2)=>(function(t,...i){if(t.length===1)return t[0];let r=!1;const l=[],c=t.reduce((x,b,T)=>{var S,E,D;/[?#]/.test(b)&&(r=!0);const k=i[T];let F=(r?encodeURIComponent:n)(""+k);return T!==i.length&&(k==null||typeof k=="object"&&k.toString===((D=Object.getPrototypeOf((E=Object.getPrototypeOf((S=k.hasOwnProperty)!==null&&S!==void 0?S:jS))!==null&&E!==void 0?E:jS))===null||D===void 0?void 0:D.toString))&&(F=k+"",l.push({start:x.length+b.length,length:F.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),x+b+(T===i.length?"":F)},""),d=c.split(/[?#]/,1)[0],p=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let h;for(;(h=p.exec(d))!==null;)l.push({start:h.index,length:h[0].length,error:`Value "${h[0]}" can't be safely passed as a path parameter`});if(l.sort((x,b)=>x.start-b.start),l.length>0){let x=0;const b=l.reduce((T,S)=>{const E=" ".repeat(S.start-x),D="^".repeat(S.length);return x=S.start+S.length,T+E+D},"");throw new Di(`Path parameters result in path with invalid segments:
${l.map(T=>T.error).join(`
`)}
${c}
${b}`)}return c}),wf=z8(C2);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class k2 extends N2{create(e,t){var i;const{api_version:r=this._client.apiVersion}=e,l=Sh(e,["api_version"]);if("model"in l&&"agent_config"in l)throw new Di("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in l&&"generation_config"in l)throw new Di("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(wf`/${r}/interactions`,Object.assign(Object.assign({body:l},t),{stream:(i=e.stream)!==null&&i!==void 0?i:!1}))}delete(e,t={},i){const{api_version:r=this._client.apiVersion}=t??{};return this._client.delete(wf`/${r}/interactions/${e}`,i)}cancel(e,t={},i){const{api_version:r=this._client.apiVersion}=t??{};return this._client.post(wf`/${r}/interactions/${e}/cancel`,i)}get(e,t={},i){var r;const l=t??{},{api_version:c=this._client.apiVersion}=l,d=Sh(l,["api_version"]);return this._client.get(wf`/${c}/interactions/${e}`,Object.assign(Object.assign({query:d},i),{stream:(r=t==null?void 0:t.stream)!==null&&r!==void 0?r:!1}))}}k2._key=Object.freeze(["interactions"]);class A2 extends k2{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function H8(n){let e=0;for(const r of n)e+=r.length;const t=new Uint8Array(e);let i=0;for(const r of n)t.set(r,i),i+=r.length;return t}let Ef;function Ix(n){let e;return(Ef??(e=new globalThis.TextEncoder,Ef=e.encode.bind(e)))(n)}let Nf;function DS(n){let e;return(Nf??(e=new globalThis.TextDecoder,Nf=e.decode.bind(e)))(n)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class np{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?Ix(e):e;this.buffer=H8([this.buffer,t]);const i=[];let r;for(;(r=F8(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){i.push(DS(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const l=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,c=DS(this.buffer.subarray(0,l));i.push(c),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return i}flush(){return this.buffer.length?this.decode(`
`):[]}}np.NEWLINE_CHARS=new Set([`
`,"\r"]);np.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function F8(n,e){for(let r=e??0;r<n.length;r++){if(n[r]===10)return{preceding:r,index:r+1,carriage:!1};if(n[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function G8(n){for(let i=0;i<n.length-1;i++){if(n[i]===10&&n[i+1]===10||n[i]===13&&n[i+1]===13)return i+2;if(n[i]===13&&n[i+1]===10&&i+3<n.length&&n[i+2]===13&&n[i+3]===10)return i+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wh={off:0,error:200,warn:300,info:400,debug:500},MS=(n,e,t)=>{if(n){if(T8(wh,n))return n;Vn(t).warn(`${e} was set to ${JSON.stringify(n)}, expected one of ${JSON.stringify(Object.keys(wh))}`)}};function nu(){}function Cf(n,e,t){return!e||wh[n]>wh[t]?nu:e[n].bind(e)}const B8={error:nu,warn:nu,info:nu,debug:nu};let PS=new WeakMap;function Vn(n){var e;const t=n.logger,i=(e=n.logLevel)!==null&&e!==void 0?e:"off";if(!t)return B8;const r=PS.get(t);if(r&&r[0]===i)return r[1];const l={error:Cf("error",t,i),warn:Cf("warn",t,i),info:Cf("info",t,i),debug:Cf("debug",t,i)};return PS.set(t,[i,l]),l}const Ko=n=>(n.options&&(n.options=Object.assign({},n.options),delete n.options.headers),n.headers&&(n.headers=Object.fromEntries((n.headers instanceof Headers?[...n.headers]:Object.entries(n.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in n&&(n.retryOfRequestLogID&&(n.retryOf=n.retryOfRequestLogID),delete n.retryOfRequestLogID),n);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ul{constructor(e,t,i){this.iterator=e,this.controller=t,this.client=i}static fromSSEResponse(e,t,i){let r=!1;const l=i?Vn(i):console;function c(){return es(this,arguments,function*(){var p,h,x,b;if(r)throw new Di("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let T=!1;try{try{for(var S=!0,E=ts(q8(e,t)),D;D=yield qe(E.next()),p=D.done,!p;S=!0){b=D.value,S=!1;const k=b;if(!T)if(k.data.startsWith("[DONE]")){T=!0;continue}else try{yield yield qe(JSON.parse(k.data))}catch(F){throw l.error("Could not parse message into JSON:",k.data),l.error("From chunk:",k.raw),F}}}catch(k){h={error:k}}finally{try{!S&&!p&&(x=E.return)&&(yield qe(x.call(E)))}finally{if(h)throw h.error}}T=!0}catch(k){if(h0(k))return yield qe(void 0);throw k}finally{T||t.abort()}})}return new ul(c,t,i)}static fromReadableStream(e,t,i){let r=!1;function l(){return es(this,arguments,function*(){var p,h,x,b;const T=new np,S=S2(e);try{for(var E=!0,D=ts(S),k;k=yield qe(D.next()),p=k.done,!p;E=!0){b=k.value,E=!1;const F=b;for(const $ of T.decode(F))yield yield qe($)}}catch(F){h={error:F}}finally{try{!E&&!p&&(x=D.return)&&(yield qe(x.call(D)))}finally{if(h)throw h.error}}for(const F of T.flush())yield yield qe(F)})}function c(){return es(this,arguments,function*(){var p,h,x,b;if(r)throw new Di("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let T=!1;try{try{for(var S=!0,E=ts(l()),D;D=yield qe(E.next()),p=D.done,!p;S=!0){b=D.value,S=!1;const k=b;T||k&&(yield yield qe(JSON.parse(k)))}}catch(k){h={error:k}}finally{try{!S&&!p&&(x=E.return)&&(yield qe(x.call(E)))}finally{if(h)throw h.error}}T=!0}catch(k){if(h0(k))return yield qe(void 0);throw k}finally{T||t.abort()}})}return new ul(c,t,i)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],i=this.iterator(),r=l=>({next:()=>{if(l.length===0){const c=i.next();e.push(c),t.push(c)}return l.shift()}});return[new ul(()=>r(e),this.controller,this.client),new ul(()=>r(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return T2({async start(){t=e[Symbol.asyncIterator]()},async pull(i){try{const{value:r,done:l}=await t.next();if(l)return i.close();const c=Ix(JSON.stringify(r)+`
`);i.enqueue(c)}catch(r){i.error(r)}},async cancel(){var i;await((i=t.return)===null||i===void 0?void 0:i.call(t))}})}}function q8(n,e){return es(this,arguments,function*(){var i,r,l,c;if(!n.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Di("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Di("Attempted to iterate over a response with no body");const d=new Y8,p=new np,h=S2(n.body);try{for(var x=!0,b=ts($8(h)),T;T=yield qe(b.next()),i=T.done,!i;x=!0){c=T.value,x=!1;const S=c;for(const E of p.decode(S)){const D=d.decode(E);D&&(yield yield qe(D))}}}catch(S){r={error:S}}finally{try{!x&&!i&&(l=b.return)&&(yield qe(l.call(b)))}finally{if(r)throw r.error}}for(const S of p.flush()){const E=d.decode(S);E&&(yield yield qe(E))}})}function $8(n){return es(this,arguments,function*(){var t,i,r,l;let c=new Uint8Array;try{for(var d=!0,p=ts(n),h;h=yield qe(p.next()),t=h.done,!t;d=!0){l=h.value,d=!1;const x=l;if(x==null)continue;const b=x instanceof ArrayBuffer?new Uint8Array(x):typeof x=="string"?Ix(x):x;let T=new Uint8Array(c.length+b.length);T.set(c),T.set(b,c.length),c=T;let S;for(;(S=G8(c))!==-1;)yield yield qe(c.slice(0,S)),c=c.slice(S)}}catch(x){i={error:x}}finally{try{!d&&!t&&(r=p.return)&&(yield qe(r.call(p)))}finally{if(i)throw i.error}}c.length>0&&(yield yield qe(c))})}class Y8{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const l={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],l}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,i,r]=J8(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function J8(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function K8(n,e){const{response:t,requestLogID:i,retryOfRequestLogID:r,startTime:l}=e,c=await(async()=>{var d;if(e.options.stream)return Vn(n).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,n):ul.fromSSEResponse(t,e.controller,n);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const p=t.headers.get("content-type"),h=(d=p==null?void 0:p.split(";")[0])===null||d===void 0?void 0:d.trim();return(h==null?void 0:h.includes("application/json"))||(h==null?void 0:h.endsWith("+json"))?t.headers.get("content-length")==="0"?void 0:await t.json():await t.text()})();return Vn(n).debug(`[${i}] response parsed`,Ko({retryOfRequestLogID:r,url:t.url,status:t.status,body:c,durationMs:Date.now()-l})),c}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rx extends Promise{constructor(e,t,i=K8){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=i,this.client=e}_thenUnwrap(e){return new Rx(this.client,this.responsePromise,async(t,i)=>e(await this.parseResponse(t,i),i))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const I2=Symbol("brand.privateNullableHeaders");function*X8(n){if(!n)return;if(I2 in n){const{values:i,nulls:r}=n;yield*i.entries();for(const l of r)yield[l,null];return}let e=!1,t;n instanceof Headers?t=n.entries():AS(n)?t=n:(e=!0,t=Object.entries(n??{}));for(let i of t){const r=i[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const l=AS(i[1])?i[1]:[i[1]];let c=!1;for(const d of l)d!==void 0&&(e&&!c&&(c=!0,yield[r,null]),yield[r,d])}}const Kc=n=>{const e=new Headers,t=new Set;for(const i of n){const r=new Set;for(const[l,c]of X8(i)){const d=l.toLowerCase();r.has(d)||(e.delete(l),r.add(d)),c===null?(e.delete(l),t.add(d)):(e.append(l,c),t.delete(d))}}return{[I2]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ig=n=>{var e,t,i,r,l,c;if(typeof globalThis.process<"u")return(i=(t=(e=m6)===null||e===void 0?void 0:e[n])===null||t===void 0?void 0:t.trim())!==null&&i!==void 0?i:void 0;if(typeof globalThis.Deno<"u")return(c=(l=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||l===void 0?void 0:l.call(r,n))===null||c===void 0?void 0:c.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var R2;class ip{constructor(e){var t,i,r,l,c,d,p,{baseURL:h=Ig("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:x=(t=Ig("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:b="v1beta"}=e,T=Sh(e,["baseURL","apiKey","apiVersion"]);const S=Object.assign(Object.assign({apiKey:x,apiVersion:b},T),{baseURL:h||"https://generativelanguage.googleapis.com"});this.baseURL=S.baseURL,this.timeout=(i=S.timeout)!==null&&i!==void 0?i:ip.DEFAULT_TIMEOUT,this.logger=(r=S.logger)!==null&&r!==void 0?r:console;const E="warn";this.logLevel=E,this.logLevel=(c=(l=MS(S.logLevel,"ClientOptions.logLevel",this))!==null&&l!==void 0?l:MS(Ig("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&c!==void 0?c:E,this.fetchOptions=S.fetchOptions,this.maxRetries=(d=S.maxRetries)!==null&&d!==void 0?d:2,this.fetch=(p=S.fetch)!==null&&p!==void 0?p:I8(),this.encoder=D8,this._options=S,this.apiKey=x,this.apiVersion=b,this.clientAdapter=S.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=Kc([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return Kc([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return Kc([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,i])=>typeof i<"u").map(([t,i])=>{if(typeof i=="string"||typeof i=="number"||typeof i=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(i)}`;if(i===null)return`${encodeURIComponent(t)}=`;throw new Di(`Cannot stringify type ${typeof i}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${al}`}defaultIdempotencyKey(){return`stainless-node-retry-${g8()}`}makeStatusError(e,t,i,r){return Hn.generate(e,t,i,r)}buildURL(e,t,i){const r=!this.baseURLOverridden()&&i||this.baseURL,l=y8(e)?new URL(e):new URL(r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),c=this.defaultQuery();return _8(c)||(t=Object.assign(Object.assign({},c),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(l.search=this.stringifyQuery(t)),l.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:i}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,i){return this.request(Promise.resolve(i).then(r=>Object.assign({method:e,path:t},r)))}request(e,t=null){return new Rx(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,i){var r,l,c;const d=await e,p=(r=d.maxRetries)!==null&&r!==void 0?r:this.maxRetries;t==null&&(t=p),await this.prepareOptions(d);const{req:h,url:x,timeout:b}=await this.buildRequest(d,{retryCount:p-t});await this.prepareRequest(h,{url:x,options:d});const T="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),S=i===void 0?"":`, retryOf: ${i}`,E=Date.now();if(Vn(this).debug(`[${T}] sending request`,Ko({retryOfRequestLogID:i,method:d.method,url:x,options:d,headers:h.headers})),!((l=d.signal)===null||l===void 0)&&l.aborted)throw new m0;const D=new AbortController,k=await this.fetchWithTimeout(x,h,b,D).catch(p0),F=Date.now();if(k instanceof globalThis.Error){const M=`retrying, ${t} attempts remaining`;if(!((c=d.signal)===null||c===void 0)&&c.aborted)throw new m0;const J=h0(k)||/timed? ?out/i.test(String(k)+("cause"in k?String(k.cause):""));if(t)return Vn(this).info(`[${T}] connection ${J?"timed out":"failed"} - ${M}`),Vn(this).debug(`[${T}] connection ${J?"timed out":"failed"} (${M})`,Ko({retryOfRequestLogID:i,url:x,durationMs:F-E,message:k.message})),this.retryRequest(d,t,i??T);throw Vn(this).info(`[${T}] connection ${J?"timed out":"failed"} - error; no more retries left`),Vn(this).debug(`[${T}] connection ${J?"timed out":"failed"} (error; no more retries left)`,Ko({retryOfRequestLogID:i,url:x,durationMs:F-E,message:k.message})),J?new h2:new tp({cause:k})}const $=`[${T}${S}] ${h.method} ${x} ${k.ok?"succeeded":"failed"} with status ${k.status} in ${F-E}ms`;if(!k.ok){const M=await this.shouldRetry(k);if(t&&M){const A=`retrying, ${t} attempts remaining`;return await j8(k.body),Vn(this).info(`${$} - ${A}`),Vn(this).debug(`[${T}] response error (${A})`,Ko({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:F-E})),this.retryRequest(d,t,i??T,k.headers)}const J=M?"error; no more retries left":"error; not retryable";Vn(this).info(`${$} - ${J}`);const H=await k.text().catch(A=>p0(A).message),z=w8(H),R=z?void 0:H;throw Vn(this).debug(`[${T}] response error (${J})`,Ko({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,message:R,durationMs:Date.now()-E})),this.makeStatusError(k.status,z,R,k.headers)}return Vn(this).info($),Vn(this).debug(`[${T}] response start`,Ko({retryOfRequestLogID:i,url:k.url,status:k.status,headers:k.headers,durationMs:F-E})),{response:k,options:d,controller:D,requestLogID:T,retryOfRequestLogID:i,startTime:E}}async fetchWithTimeout(e,t,i,r){const l=t||{},{signal:c,method:d}=l,p=Sh(l,["signal","method"]),h=this._makeAbort(r);c&&c.addEventListener("abort",h,{once:!0});const x=setTimeout(h,i),b=globalThis.ReadableStream&&p.body instanceof globalThis.ReadableStream||typeof p.body=="object"&&p.body!==null&&Symbol.asyncIterator in p.body,T=Object.assign(Object.assign(Object.assign({signal:r.signal},b?{duplex:"half"}:{}),{method:"GET"}),p);d&&(T.method=d.toUpperCase());try{return await this.fetch.call(void 0,e,T)}finally{clearTimeout(x)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,i,r){var l;let c;const d=r==null?void 0:r.get("retry-after-ms");if(d){const h=parseFloat(d);Number.isNaN(h)||(c=h)}const p=r==null?void 0:r.get("retry-after");if(p&&!c){const h=parseFloat(p);Number.isNaN(h)?c=Date.parse(p)-Date.now():c=h*1e3}if(!(c&&0<=c&&c<60*1e3)){const h=(l=e.maxRetries)!==null&&l!==void 0?l:this.maxRetries;c=this.calculateDefaultRetryTimeoutMillis(t,h)}return await E8(c),this.makeRequest(e,t-1,i)}calculateDefaultRetryTimeoutMillis(e,t){const l=t-e,c=Math.min(.5*Math.pow(2,l),8),d=1-Math.random()*.25;return c*d*1e3}async buildRequest(e,{retryCount:t=0}={}){var i,r,l;const c=Object.assign({},e),{method:d,path:p,query:h,defaultBaseURL:x}=c,b=this.buildURL(p,h,x);"timeout"in c&&S8("timeout",c.timeout),c.timeout=(i=c.timeout)!==null&&i!==void 0?i:this.timeout;const{bodyHeaders:T,body:S}=this.buildBody({options:c}),E=await this.buildHeaders({options:e,method:d,bodyHeaders:T,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:d,headers:E},c.signal&&{signal:c.signal}),globalThis.ReadableStream&&S instanceof globalThis.ReadableStream&&{duplex:"half"}),S&&{body:S}),(r=this.fetchOptions)!==null&&r!==void 0?r:{}),(l=c.fetchOptions)!==null&&l!==void 0?l:{}),url:b,timeout:c.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:i,retryCount:r}){let l={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const c=await this.authHeaders(e);let d=Kc([l,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),A8()),this._options.defaultHeaders,i,e.headers,c]);return this.validateHeaders(d),d.values}_makeAbort(e){return()=>e.abort()}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const i=Kc([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&i.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:R8(e)}:typeof e=="object"&&i.values.get("content-type")==="application/x-www-form-urlencoded"?{bodyHeaders:{"content-type":"application/x-www-form-urlencoded"},body:this.stringifyQuery(e)}:this.encoder({body:e,headers:i})}}ip.DEFAULT_TIMEOUT=6e4;class xn extends ip{constructor(){super(...arguments),this.interactions=new A2(this)}}R2=xn;xn.GeminiNextGenAPIClient=R2;xn.GeminiNextGenAPIClientError=Di;xn.APIError=Hn;xn.APIConnectionError=tp;xn.APIConnectionTimeoutError=h2;xn.APIUserAbortError=m0;xn.NotFoundError=x2;xn.ConflictError=y2;xn.RateLimitError=b2;xn.BadRequestError=p2;xn.AuthenticationError=m2;xn.InternalServerError=_2;xn.PermissionDeniedError=g2;xn.UnprocessableEntityError=v2;xn.toFile=U8;xn.Interactions=A2;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function W8(n,e){const t={},i=m(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function Q8(n,e){const t={},i=m(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function Z8(n,e){const t={},i=m(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function eH(n,e){const t={},i=m(n,["sdkHttpResponse"]);return i!=null&&g(t,["sdkHttpResponse"],i),t}function tH(n,e,t){const i={};if(m(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=m(n,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&g(e,["displayName"],r),m(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const l=m(n,["epochCount"]);e!==void 0&&l!=null&&g(e,["tuningTask","hyperparameters","epochCount"],l);const c=m(n,["learningRateMultiplier"]);if(c!=null&&g(i,["tuningTask","hyperparameters","learningRateMultiplier"],c),m(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");if(m(n,["tuningMode"])!==void 0)throw new Error("tuningMode parameter is not supported in Gemini API.");if(m(n,["customBaseModel"])!==void 0)throw new Error("customBaseModel parameter is not supported in Gemini API.");const d=m(n,["batchSize"]);e!==void 0&&d!=null&&g(e,["tuningTask","hyperparameters","batchSize"],d);const p=m(n,["learningRate"]);if(e!==void 0&&p!=null&&g(e,["tuningTask","hyperparameters","learningRate"],p),m(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(m(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");if(m(n,["baseTeacherModel"])!==void 0)throw new Error("baseTeacherModel parameter is not supported in Gemini API.");if(m(n,["tunedTeacherModelSource"])!==void 0)throw new Error("tunedTeacherModelSource parameter is not supported in Gemini API.");if(m(n,["sftLossWeightMultiplier"])!==void 0)throw new Error("sftLossWeightMultiplier parameter is not supported in Gemini API.");if(m(n,["outputUri"])!==void 0)throw new Error("outputUri parameter is not supported in Gemini API.");if(m(n,["encryptionSpec"])!==void 0)throw new Error("encryptionSpec parameter is not supported in Gemini API.");return i}function nH(n,e,t){const i={};let r=m(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const z=m(n,["validationDataset"]);e!==void 0&&z!=null&&g(e,["supervisedTuningSpec"],Rg(z))}else if(r==="PREFERENCE_TUNING"){const z=m(n,["validationDataset"]);e!==void 0&&z!=null&&g(e,["preferenceOptimizationSpec"],Rg(z))}else if(r==="DISTILLATION"){const z=m(n,["validationDataset"]);e!==void 0&&z!=null&&g(e,["distillationSpec"],Rg(z))}const l=m(n,["tunedModelDisplayName"]);e!==void 0&&l!=null&&g(e,["tunedModelDisplayName"],l);const c=m(n,["description"]);e!==void 0&&c!=null&&g(e,["description"],c);let d=m(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const z=m(n,["epochCount"]);e!==void 0&&z!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],z)}else if(d==="PREFERENCE_TUNING"){const z=m(n,["epochCount"]);e!==void 0&&z!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],z)}else if(d==="DISTILLATION"){const z=m(n,["epochCount"]);e!==void 0&&z!=null&&g(e,["distillationSpec","hyperParameters","epochCount"],z)}let p=m(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const z=m(n,["learningRateMultiplier"]);e!==void 0&&z!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],z)}else if(p==="PREFERENCE_TUNING"){const z=m(n,["learningRateMultiplier"]);e!==void 0&&z!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],z)}else if(p==="DISTILLATION"){const z=m(n,["learningRateMultiplier"]);e!==void 0&&z!=null&&g(e,["distillationSpec","hyperParameters","learningRateMultiplier"],z)}let h=m(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const z=m(n,["exportLastCheckpointOnly"]);e!==void 0&&z!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],z)}else if(h==="PREFERENCE_TUNING"){const z=m(n,["exportLastCheckpointOnly"]);e!==void 0&&z!=null&&g(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],z)}else if(h==="DISTILLATION"){const z=m(n,["exportLastCheckpointOnly"]);e!==void 0&&z!=null&&g(e,["distillationSpec","exportLastCheckpointOnly"],z)}let x=m(t,["config","method"]);if(x===void 0&&(x="SUPERVISED_FINE_TUNING"),x==="SUPERVISED_FINE_TUNING"){const z=m(n,["adapterSize"]);e!==void 0&&z!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],z)}else if(x==="PREFERENCE_TUNING"){const z=m(n,["adapterSize"]);e!==void 0&&z!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],z)}else if(x==="DISTILLATION"){const z=m(n,["adapterSize"]);e!==void 0&&z!=null&&g(e,["distillationSpec","hyperParameters","adapterSize"],z)}let b=m(t,["config","method"]);if(b===void 0&&(b="SUPERVISED_FINE_TUNING"),b==="SUPERVISED_FINE_TUNING"){const z=m(n,["tuningMode"]);e!==void 0&&z!=null&&g(e,["supervisedTuningSpec","tuningMode"],z)}const T=m(n,["customBaseModel"]);e!==void 0&&T!=null&&g(e,["customBaseModel"],T);let S=m(t,["config","method"]);if(S===void 0&&(S="SUPERVISED_FINE_TUNING"),S==="SUPERVISED_FINE_TUNING"){const z=m(n,["batchSize"]);e!==void 0&&z!=null&&g(e,["supervisedTuningSpec","hyperParameters","batchSize"],z)}let E=m(t,["config","method"]);if(E===void 0&&(E="SUPERVISED_FINE_TUNING"),E==="SUPERVISED_FINE_TUNING"){const z=m(n,["learningRate"]);e!==void 0&&z!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRate"],z)}const D=m(n,["labels"]);e!==void 0&&D!=null&&g(e,["labels"],D);const k=m(n,["beta"]);e!==void 0&&k!=null&&g(e,["preferenceOptimizationSpec","hyperParameters","beta"],k);const F=m(n,["baseTeacherModel"]);e!==void 0&&F!=null&&g(e,["distillationSpec","baseTeacherModel"],F);const $=m(n,["tunedTeacherModelSource"]);e!==void 0&&$!=null&&g(e,["distillationSpec","tunedTeacherModelSource"],$);const M=m(n,["sftLossWeightMultiplier"]);e!==void 0&&M!=null&&g(e,["distillationSpec","hyperParameters","sftLossWeightMultiplier"],M);const J=m(n,["outputUri"]);e!==void 0&&J!=null&&g(e,["outputUri"],J);const H=m(n,["encryptionSpec"]);return e!==void 0&&H!=null&&g(e,["encryptionSpec"],H),i}function iH(n,e){const t={},i=m(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);const r=m(n,["preTunedModel"]);r!=null&&g(t,["preTunedModel"],r);const l=m(n,["trainingDataset"]);l!=null&&pH(l);const c=m(n,["config"]);return c!=null&&tH(c,t),t}function sH(n,e){const t={},i=m(n,["baseModel"]);i!=null&&g(t,["baseModel"],i);const r=m(n,["preTunedModel"]);r!=null&&g(t,["preTunedModel"],r);const l=m(n,["trainingDataset"]);l!=null&&mH(l,t,e);const c=m(n,["config"]);return c!=null&&nH(c,t,e),t}function rH(n,e){const t={},i=m(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function oH(n,e){const t={},i=m(n,["name"]);return i!=null&&g(t,["_url","name"],i),t}function aH(n,e,t){const i={},r=m(n,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const l=m(n,["pageToken"]);e!==void 0&&l!=null&&g(e,["_query","pageToken"],l);const c=m(n,["filter"]);return e!==void 0&&c!=null&&g(e,["_query","filter"],c),i}function lH(n,e,t){const i={},r=m(n,["pageSize"]);e!==void 0&&r!=null&&g(e,["_query","pageSize"],r);const l=m(n,["pageToken"]);e!==void 0&&l!=null&&g(e,["_query","pageToken"],l);const c=m(n,["filter"]);return e!==void 0&&c!=null&&g(e,["_query","filter"],c),i}function cH(n,e){const t={},i=m(n,["config"]);return i!=null&&aH(i,t),t}function uH(n,e){const t={},i=m(n,["config"]);return i!=null&&lH(i,t),t}function dH(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);const l=m(n,["tunedModels"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>j2(d))),g(t,["tuningJobs"],c)}return t}function fH(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["nextPageToken"]);r!=null&&g(t,["nextPageToken"],r);const l=m(n,["tuningJobs"]);if(l!=null){let c=l;Array.isArray(c)&&(c=c.map(d=>y0(d))),g(t,["tuningJobs"],c)}return t}function hH(n,e){const t={},i=m(n,["name"]);i!=null&&g(t,["model"],i);const r=m(n,["name"]);return r!=null&&g(t,["endpoint"],r),t}function pH(n,e){const t={};if(m(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=m(n,["examples"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(l=>l)),g(t,["examples","examples"],r)}return t}function mH(n,e,t){const i={};let r=m(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const c=m(n,["gcsUri"]);e!==void 0&&c!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(r==="PREFERENCE_TUNING"){const c=m(n,["gcsUri"]);e!==void 0&&c!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}else if(r==="DISTILLATION"){const c=m(n,["gcsUri"]);e!==void 0&&c!=null&&g(e,["distillationSpec","promptDatasetUri"],c)}let l=m(t,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const c=m(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],c)}else if(l==="PREFERENCE_TUNING"){const c=m(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&g(e,["preferenceOptimizationSpec","trainingDatasetUri"],c)}else if(l==="DISTILLATION"){const c=m(n,["vertexDatasetResource"]);e!==void 0&&c!=null&&g(e,["distillationSpec","promptDatasetUri"],c)}if(m(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function j2(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["name"]);r!=null&&g(t,["name"],r);const l=m(n,["state"]);l!=null&&g(t,["state"],JN(l));const c=m(n,["createTime"]);c!=null&&g(t,["createTime"],c);const d=m(n,["tuningTask","startTime"]);d!=null&&g(t,["startTime"],d);const p=m(n,["tuningTask","completeTime"]);p!=null&&g(t,["endTime"],p);const h=m(n,["updateTime"]);h!=null&&g(t,["updateTime"],h);const x=m(n,["description"]);x!=null&&g(t,["description"],x);const b=m(n,["baseModel"]);b!=null&&g(t,["baseModel"],b);const T=m(n,["_self"]);return T!=null&&g(t,["tunedModel"],hH(T)),t}function y0(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["name"]);r!=null&&g(t,["name"],r);const l=m(n,["state"]);l!=null&&g(t,["state"],JN(l));const c=m(n,["createTime"]);c!=null&&g(t,["createTime"],c);const d=m(n,["startTime"]);d!=null&&g(t,["startTime"],d);const p=m(n,["endTime"]);p!=null&&g(t,["endTime"],p);const h=m(n,["updateTime"]);h!=null&&g(t,["updateTime"],h);const x=m(n,["error"]);x!=null&&g(t,["error"],x);const b=m(n,["description"]);b!=null&&g(t,["description"],b);const T=m(n,["baseModel"]);T!=null&&g(t,["baseModel"],T);const S=m(n,["tunedModel"]);S!=null&&g(t,["tunedModel"],S);const E=m(n,["preTunedModel"]);E!=null&&g(t,["preTunedModel"],E);const D=m(n,["supervisedTuningSpec"]);D!=null&&g(t,["supervisedTuningSpec"],D);const k=m(n,["preferenceOptimizationSpec"]);k!=null&&g(t,["preferenceOptimizationSpec"],k);const F=m(n,["distillationSpec"]);F!=null&&g(t,["distillationSpec"],F);const $=m(n,["tuningDataStats"]);$!=null&&g(t,["tuningDataStats"],$);const M=m(n,["encryptionSpec"]);M!=null&&g(t,["encryptionSpec"],M);const J=m(n,["partnerModelTuningSpec"]);J!=null&&g(t,["partnerModelTuningSpec"],J);const H=m(n,["customBaseModel"]);H!=null&&g(t,["customBaseModel"],H);const z=m(n,["experiment"]);z!=null&&g(t,["experiment"],z);const R=m(n,["labels"]);R!=null&&g(t,["labels"],R);const C=m(n,["outputUri"]);C!=null&&g(t,["outputUri"],C);const A=m(n,["pipelineJob"]);A!=null&&g(t,["pipelineJob"],A);const P=m(n,["serviceAccount"]);P!=null&&g(t,["serviceAccount"],P);const L=m(n,["tunedModelDisplayName"]);L!=null&&g(t,["tunedModelDisplayName"],L);const O=m(n,["veoTuningSpec"]);return O!=null&&g(t,["veoTuningSpec"],O),t}function gH(n,e){const t={},i=m(n,["sdkHttpResponse"]);i!=null&&g(t,["sdkHttpResponse"],i);const r=m(n,["name"]);r!=null&&g(t,["name"],r);const l=m(n,["metadata"]);l!=null&&g(t,["metadata"],l);const c=m(n,["done"]);c!=null&&g(t,["done"],c);const d=m(n,["error"]);return d!=null&&g(t,["error"],d),t}function Rg(n,e){const t={},i=m(n,["gcsUri"]);i!=null&&g(t,["validationDatasetUri"],i);const r=m(n,["vertexDatasetResource"]);return r!=null&&g(t,["validationDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xH extends pr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new ha(dr.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const l=Object.assign(Object.assign({},t),{preTunedModel:r});return l.baseModel=void 0,await this.tuneInternal(l)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),l=await this.tuneMldevInternal(r);let c="";return l.metadata!==void 0&&l.metadata.tunedModel!==void 0?c=l.metadata.tunedModel:l.name!==void 0&&l.name.includes("/operations/")&&(c=l.name.split("/operations/")[0]),{name:c,state:r0.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=oH(e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>y0(x))}else{const h=rH(e);return d=ke("{name}",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>j2(x))}}async listInternal(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=uH(e);return d=ke("tuningJobs",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=fH(x),T=new lS;return Object.assign(T,b),T})}else{const h=cH(e);return d=ke("tunedModels",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=dH(x),T=new lS;return Object.assign(T,b),T})}}async cancel(e){var t,i,r,l;let c,d="",p={};if(this.apiClient.isVertexAI()){const h=Q8(e);return d=ke("{name}:cancel",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=eH(x),T=new cS;return Object.assign(T,b),T})}else{const h=W8(e);return d=ke("{name}:cancel",h._url),p=h._query,delete h._url,delete h._query,c=this.apiClient.request({path:d,queryParams:p,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(l=e.config)===null||l===void 0?void 0:l.abortSignal}).then(x=>x.json().then(b=>{const T=b;return T.sdkHttpResponse={headers:x.headers},T})),c.then(x=>{const b=Z8(x),T=new cS;return Object.assign(T,b),T})}}async tuneInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI()){const d=sH(e,e);return l=ke("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const x=h;return x.sdkHttpResponse={headers:p.headers},x})),r.then(p=>y0(p))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let r,l="",c={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const d=iH(e);return l=ke("tunedModels",d._url),c=d._query,delete d._url,delete d._query,r=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(p=>p.json().then(h=>{const x=h;return x.sdkHttpResponse={headers:p.headers},x})),r.then(p=>gH(p))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yH{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const vH=1024*1024*8,bH=3,_H=1e3,TH=2,Eh="x-goog-upload-status";async function SH(n,e,t){var i;const r=await D2(n,e,t),l=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Eh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return l.file}async function wH(n,e,t){var i;const r=await D2(n,e,t),l=await(r==null?void 0:r.json());if(((i=r==null?void 0:r.headers)===null||i===void 0?void 0:i[Eh])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const c=FN(l),d=new wx;return Object.assign(d,c),d}async function D2(n,e,t){var i,r;let l=0,c=0,d=new a0(new Response),p="upload";for(l=n.size;c<l;){const h=Math.min(vH,l-c),x=n.slice(c,c+h);c+h>=l&&(p+=", finalize");let b=0,T=_H;for(;b<bH&&(d=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":p,"X-Goog-Upload-Offset":String(c),"Content-Length":String(h)}}}),!(!((i=d==null?void 0:d.headers)===null||i===void 0)&&i[Eh]));)b++,await NH(T),T=T*TH;if(c+=h,((r=d==null?void 0:d.headers)===null||r===void 0?void 0:r[Eh])!=="active")break;if(l<=c)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return d}async function EH(n){return{size:n.size,type:n.type}}function NH(n){return new Promise(e=>setTimeout(e,n))}class CH{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await SH(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await wH(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await EH(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kH{create(e,t,i){return new AH(e,t,i)}}class AH{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const LS="x-goog-api-key";class IH{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(LS)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(LS,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RH="gl-node/";class jH{get interactions(){var e;if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const t=this.httpOptions;t!=null&&t.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const i=new xn({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:t==null?void 0:t.timeout,maxRetries:(e=t==null?void 0:t.retryOptions)===null||e===void 0?void 0:e.attempts});return this._interactions=i.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=v6(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const r=new IH(this.apiKey);this.apiClient=new E9({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:RH+"web",uploader:new CH,downloader:new yH}),this.models=new B9(this.apiClient),this.live=new U9(this.apiClient,r,new kH),this.batches=new XO(this.apiClient),this.chats=new RU(this.models,this.apiClient),this.caches=new kU(this.apiClient),this.files=new GU(this.apiClient),this.operations=new q9(this.apiClient),this.authTokens=new a8(this.apiClient),this.tunings=new xH(this.apiClient),this.fileSearchStores=new m8(this.apiClient)}}const DH=n=>{const{payload:e,dispatchers:t,summary:i}=n;e.themes&&Array.isArray(e.themes)&&(e.themes.forEach(r=>t.lifeDispatch.addTheme(r)),i.push(`${e.themes.length} Themes`),e.themes.length>0&&setTimeout(()=>t.lifeDispatch.setTheme(e.themes[0].id),500))},MH=n=>{const{payload:e,dispatchers:t,summary:i}=n;e.skills&&Array.isArray(e.skills)&&(e.skills.forEach(r=>{t.skillDispatch.addSkill(r.title,r.relatedStats,r.description)}),i.push(`${e.skills.length} Skills`))},jx=n=>!n||!Array.isArray(n)?[]:n.map((e,t)=>{const i=typeof e=="string"?e:e.title,r=typeof e=="object"&&e.isCompleted?e.isCompleted:!1;return{id:`st_ai_${Date.now()}_${t}`,title:i||"Unknown Step",isCompleted:r}}),Dx=n=>!n||!Array.isArray(n)?[]:n.map((e,t)=>({id:`rem_ai_${Date.now()}_${t}`,minutesBefore:e,isSent:!1})),PH=n=>{const{payload:e,dispatchers:t,summary:i}=n;e.habits&&Array.isArray(e.habits)&&(e.habits.forEach(r=>{let l=r.type||"daily",c=r.specificDays,d=r.intervalValue,p=r.pattern;r.frequency&&(l=r.frequency.type||l,c=r.frequency.specificDays||c,d=r.frequency.intervalValue||d,p=r.frequency.matrixPattern||p);const h=jx(r.subtasks),x=Dx(r.reminders);r.id&&r.id.startsWith("h_")?t.habitDispatch.updateHabit(r.id,{title:r.title,description:r.description,difficulty:r.difficulty,stat:r.stat,skillId:r.skillId,type:l,specificDays:c,intervalValue:d,pattern:p,subtasks:h,isTimed:!!r.durationMinutes,durationMinutes:r.durationMinutes,scheduledTime:r.scheduledTime,reminders:x,dailyTarget:r.dailyTarget,history:r.history,streak:r.streak}):t.habitDispatch.addHabit({title:r.title,description:r.description,difficulty:r.difficulty||"normal",stat:r.stat||"DIS",skillId:r.skillId,type:l,specificDays:c,intervalValue:d,pattern:p,subtasks:h,isTimed:!!r.durationMinutes,durationMinutes:r.durationMinutes,scheduledTime:r.scheduledTime,reminders:x,dailyTarget:r.dailyTarget||1})}),i.push(`${e.habits.length} Habits processed`))},LH=n=>{const{payload:e,dispatchers:t,summary:i}=n;e.raids&&Array.isArray(e.raids)&&(e.raids.forEach(r=>{const l=(r.steps||[]).map((c,d)=>({id:c.id||`rs_ai_${Date.now()}_${d}`,title:typeof c=="string"?c:c.title,notes:c.notes||"",isCompleted:c.isCompleted||!1,isLocked:c.isLocked!==void 0?c.isLocked:d>0,scheduledTime:c.scheduledTime,deadline:c.deadline,reminders:Dx(c.reminders),isTimed:!!c.durationMinutes,durationMinutes:c.durationMinutes,difficulty:c.difficulty,stat:c.stat,subtasks:jx(c.subtasks)}));r.id&&r.id.startsWith("rd_")?(t.raidDispatch.updateRaid(r.id,{title:r.title,description:r.description,difficulty:r.difficulty,stats:r.stats,skillId:r.skillId,deadline:r.deadline,isCampaign:r.isCampaign}),l.length>0&&t.raidDispatch.mergeRaidSteps(r.id,l)):t.raidDispatch.addRaid({title:r.title,description:r.description,difficulty:r.difficulty||"hard",stats:r.stats||["STR"],skillId:r.skillId,deadline:r.deadline,steps:l,isCampaign:r.isCampaign||void 0})}),i.push(`${e.raids.length} Ops`))},OH=n=>{const{payload:e,dispatchers:t,summary:i}=n;e.tasks&&Array.isArray(e.tasks)&&(e.tasks.forEach(r=>{const l=jx(r.subtasks),c=Dx(r.reminders);r.id&&r.id.startsWith("t_")?t.taskDispatch.updateTask(r.id,{title:r.title,description:r.description,difficulty:r.difficulty,stat:r.stat,skillId:r.skillId,energyLevel:r.energyLevel,isTimed:!!r.durationMinutes,durationMinutes:r.durationMinutes,deadline:r.deadline,scheduledTime:r.scheduledTime,subtasks:l,reminders:c,isCampaign:r.isCampaign}):t.taskDispatch.addTask({title:r.title,description:r.description,difficulty:r.difficulty||"normal",stat:r.stat||"STR",skillId:r.skillId,energyLevel:r.energyLevel||"medium",isTimed:!!r.durationMinutes,durationMinutes:r.durationMinutes,deadline:r.deadline,scheduledTime:r.scheduledTime,subtasks:l,reminders:c,isCampaign:r.isCampaign||!1})}),i.push(`${e.tasks.length} Missions`))},UH=n=>{const{payload:e,dispatchers:t,summary:i}=n;e.storeItems&&e.storeItems.length>0&&(t.shopDispatch.addStoreItems(e.storeItems),i.push(`${e.storeItems.length} Rewards`))},VH=n=>{const{payload:e,dispatchers:t,summary:i}=n;e.badges&&Array.isArray(e.badges)&&(e.badges.forEach(r=>{r.id||(r.id=`bdg_ai_${Date.now()}_${Math.random().toString(36).substr(2,5)}`),t.lifeDispatch.addBadge(r)}),i.push(`${e.badges.length} Badges`))},zH=n=>{const{payload:e,dispatchers:t,summary:i}=n;e.laws&&Array.isArray(e.laws)&&(e.laws.forEach(r=>{t.taskDispatch.addLaw(r.title||"Unknown Law",r.penaltyType||"gold",r.penaltyValue||50,r.statTarget||void 0)}),i.push(`${e.laws.length} Laws`))},Mx={MAX_ITEMS_PER_TYPE:50,MAX_TEXT_LENGTH:500,MAX_NUMBER_VALUE:1e6},OS=n=>n?n.replace(/[<>]/g,"").trim().slice(0,Mx.MAX_TEXT_LENGTH):"",HH=n=>typeof n!="number"||isNaN(n)?0:Math.min(Math.max(0,n),Mx.MAX_NUMBER_VALUE),FH=n=>{const e={meta:n.meta||{}},t=(i,r)=>!i||!Array.isArray(i)?void 0:i.slice(0,Mx.MAX_ITEMS_PER_TYPE).map(c=>{const d={};for(const p in c)typeof c[p]=="string"?d[p]=OS(c[p]):typeof c[p]=="number"?d[p]=HH(c[p]):typeof c[p]=="boolean"?d[p]=c[p]:Array.isArray(c[p])?d[p]=c[p].slice(0,20).map(h=>typeof h=="string"?OS(h):h):typeof c[p]=="object"&&c[p]!==null&&(d[p]=c[p]);return d});return n.tasks&&(e.tasks=t(n.tasks)),n.habits&&(e.habits=t(n.habits)),n.raids&&(e.raids=t(n.raids)),n.skills&&(e.skills=t(n.skills)),n.storeItems&&(e.storeItems=t(n.storeItems)),n.badges&&(e.badges=t(n.badges)),n.themes&&(e.themes=t(n.themes)),n.laws&&(e.laws=t(n.laws)),e},GH=(n,e)=>{var i;const{lifeDispatch:t}=e;try{const r=n.replace(/```json/g,"").replace(/```/g,"").trim(),l=JSON.parse(r),c=FH(l),d={payload:c,dispatchers:e,summary:[]};DH(d),MH(d),PH(d),LH(d),OH(d),UH(d),VH(d),zH(d);const p=((i=c.meta)==null?void 0:i.packName)||"Unknown Protocol";return d.summary.length===0?{success:!1,message:"Warning: Valid JSON but no recognizable data found."}:(t.addToast(`Injecting: ${p}...`,"level-up"),{success:!0,message:`SECURE INJECTION SUCCESS: ${p}.
Verified & Added: ${d.summary.join(", ")}.`})}catch(r){return console.error("Injection Failed:",r),{success:!1,message:`SECURITY BLOCK: Invalid Data Structure.
${r.message}`}}},M2=({onClose:n})=>{var A;const{state:e,dispatch:t}=Ve(),{taskState:i,taskDispatch:r}=Zn(),{habitState:l,habitDispatch:c}=ei(),{raidState:d,raidDispatch:p}=ss(),{skillDispatch:h}=sn(),{shopDispatch:x}=Qh(),{campaignDispatch:b}=Ul(),[T,S]=K.useState(""),[E,D]=K.useState("idle"),[k,F]=K.useState("System Ready. Paste JSON Code or Upload Backup File."),$=K.useRef(null),M=P=>{var j;const L=(j=P.target.files)==null?void 0:j[0];if(!L)return;const O=new FileReader;O.onload=q=>{var U;const le=(U=q.target)==null?void 0:U.result;S(le),F(`File Loaded: ${L.name}
Ready to Execute.`),D("idle")},O.readAsText(L)},J=()=>{try{if(!T.trim())return;const P=JSON.parse(T);S(JSON.stringify(P,null,2)),F("JSON Formatted. Structure Valid."),D("idle")}catch{F("Format Error: Invalid JSON Syntax."),D("error")}},H=()=>{S(""),F("Buffer Cleared."),D("idle")},z=P=>{var le;const L=l.habits.map(U=>U.title).join(", "),O=d.raids.map(U=>U.title).join(", "),j=e.badgesRegistry.map(U=>U.name).join(", "),q=((le=i.laws)==null?void 0:le.map(U=>U.title).join(", "))||"";return`
        ROLE: You are the "Refiner Node" (QA & Compiler).
        TASK: Validate and Fix the INCOMING JSON Payload for the LifeOS System.
        
        CURRENT DATABASE SNAPSHOT:
        - Existing Habits: [${L}]
        - Existing Raids: [${O}]
        - Existing Badges: [${j}]
        - Existing Laws: [${q}]

        INCOMING JSON:
        ${P}

        RULES:
        1. BADGE LINKAGE: If the JSON adds a Badge with 'triggerType': 'habit' or 'raid', verify the 'metricKey' matches an EXACT title in 'Existing Habits/Raids' OR a new habit/raid being added in this same JSON.
           - If there's a mismatch (e.g. Badge says "Drink Water" but Habit is "Drinking Water"), UPDATE the Badge's 'metricKey' to match the Habit exactly.
           - If the metricKey refers to a generic term, try to match it to the closest existing item.
        
        2. LAWS & CONSEQUENCES:
           - If the input describes a rule, punishment, or consequence (e.g., "If I upset my girlfriend, deduct Emotion points"), convert it into a "laws" array.
           - Structure: { "title": "Short Title", "penaltyType": "gold" | "xp" | "stat" | "honor", "penaltyValue": number, "statTarget": "STR" | "INT" | "DIS" | "HEA" | "CRT" | "SPR" | "REL" | "FIN" (only if type is stat) }
           - Example: "If I miss prayer, lose 50 Honor" -> { "laws": [{ "title": "Missed Prayer", "penaltyType": "honor", "penaltyValue": 50 }] }

        3. STRUCTURE: Ensure strict valid JSON. No trailing commas.
        4. OUTPUT:
           - Return ONLY the clean, fixed JSON string. No markdown code blocks. No explanations.
           - If the JSON is fundamentally broken and unfixable, return: "ERROR: [Reason]"
        `},R=async()=>{var P;if(!T.trim()){F("Error: Empty Payload.");return}try{const L=JSON.parse(T);if(L.user&&L.badgesRegistry){D("restoring"),F(` FULL SYSTEM BACKUP DETECTED.
Initiating Total Recall Protocol...`),setTimeout(()=>{t.importData(T),L.tasks&&r.restoreData(L.tasks,L.taskCategories||[],L.laws||[]),L.habits&&c.restoreData(L.habits,L.habitCategories||[]),L.raids&&p.restoreData(L.raids),L.skills&&h.restoreData(L.skills),L.storeItems&&x.restoreData(L.storeItems),L.campaign&&b.restoreData(L.campaign),D("success"),F(` SYSTEM RESTORED SUCCESSFULLY.
Rebooting UI...`),setTimeout(n,2e3)},1e3);return}let O=T;const j=e.user.preferences.apiKeys,q=e.user.preferences.enableRefiner;if(j!=null&&j.refiner&&q)try{D("refining"),F(" Refiner Node Active: Validating Logic...");const U=new jH({apiKey:j.refiner}),Y=z(T),ie=(P=(await U.models.generateContent({model:"gemini-3-flash-preview",contents:[{role:"user",parts:[{text:"Fix this payload."}]}],config:{systemInstruction:Y}})).text)==null?void 0:P.trim();if(ie&&ie.startsWith("ERROR:")){D("error"),F(`Refiner Blocked Injection:
${ie}`);return}else if(ie){const pe=ie.match(/```json\n([\s\S]*?)\n```/)||ie.match(/{[\s\S]*}/);O=pe?pe[1]||pe[0]:ie,S(O),F(" Payload Refined & Optimized.")}}catch(U){console.error("Refiner failed",U),F(" Refiner Offline. Attempting Raw Injection...")}const le=GH(O,{lifeDispatch:t,taskDispatch:r,habitDispatch:c,raidDispatch:p,skillDispatch:h,shopDispatch:x});le.success?(D("success"),F(le.message),setTimeout(n,2500)):(D("error"),F(le.message))}catch(L){D("error"),F("JSON Parse Error: "+L.message)}},C=((A=e.user.preferences.apiKeys)==null?void 0:A.refiner)&&e.user.preferences.enableRefiner;return o.jsxs("div",{className:"space-y-4 animate-in slide-in-from-right fade-in duration-300 h-full flex flex-col",children:[o.jsxs("div",{className:"bg-life-black border border-life-gold/20 p-3 rounded-lg flex items-start gap-3 shadow-[0_0_10px_rgba(251,191,36,0.1)]",children:[o.jsx("div",{className:"p-2 bg-life-gold/10 rounded-md text-life-gold animate-pulse-slow",children:o.jsx(qh,{size:18})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h4",{className:"text-xs font-black uppercase text-life-gold tracking-widest mb-1",children:"Data Uplink"}),o.jsxs("span",{className:"flex items-center gap-1 text-[8px] font-bold uppercase bg-life-easy/10 text-life-easy px-1.5 py-0.5 rounded border border-life-easy/20",children:[o.jsx(mh,{size:8})," Protected"]})]}),o.jsxs("div",{className:"text-[10px] text-life-muted leading-relaxed",children:["Paste ",o.jsx("b",{children:"Backup JSON"})," to restore, or ",o.jsx("b",{children:"AI Code"})," to inject items. The system will auto-detect the type.",C&&o.jsxs("span",{className:"block text-life-easy/80 mt-1 flex items-center gap-1",children:[o.jsx(gh,{size:8})," Refiner Node Active"]})]})]})]}),o.jsxs("div",{className:"flex-1 relative group flex flex-col",children:[o.jsxs("div",{className:"flex justify-between items-end mb-2",children:[o.jsxs("label",{className:"block text-[10px] text-life-muted uppercase font-bold tracking-widest",children:["Input Stream (",T.length," chars)"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"file",ref:$,onChange:M,accept:".json",className:"hidden"}),o.jsxs("button",{onClick:()=>{var P;return(P=$.current)==null?void 0:P.click()},className:"text-[9px] flex items-center gap-1 text-life-black bg-life-easy hover:bg-emerald-400 px-3 py-1 rounded font-bold transition-all shadow-[0_0_10px_rgba(16,185,129,0.2)]",children:[o.jsx(yh,{size:10})," Upload File"]}),o.jsxs("button",{onClick:J,className:"text-[9px] flex items-center gap-1 text-life-muted hover:text-life-gold bg-life-black px-2 py-1 rounded border border-zinc-800 hover:border-life-gold/30 transition-all",children:[o.jsx(Jh,{size:10})," Format"]}),o.jsxs("button",{onClick:H,className:"text-[9px] flex items-center gap-1 text-life-muted hover:text-life-hard bg-life-black px-2 py-1 rounded border border-zinc-800 hover:border-life-hard/30 transition-all",children:[o.jsx(yx,{size:10})," Clear"]})]})]}),o.jsx("div",{className:"relative flex-1",children:o.jsx("textarea",{value:T,onChange:P=>S(P.target.value),placeholder:`// PASTE HERE:
// 1. Full Backup JSON (to Restore)
// 2. AI Code (to Inject)`,className:"w-full h-full min-h-[180px] bg-[#050505] text-life-easy font-mono text-[10px] p-4 rounded-lg border border-zinc-800 focus:border-life-gold focus:outline-none resize-none shadow-inner leading-relaxed",spellCheck:!1,maxLength:2e5})})]}),o.jsxs("div",{className:`p-2 rounded border font-mono text-[9px] whitespace-pre-wrap transition-colors duration-300 ${E==="error"?"bg-life-hard/10 border-life-hard text-life-hard":E==="success"?"bg-life-easy/10 border-life-easy text-life-easy":E==="refining"||E==="restoring"?"bg-life-gold/10 border-life-gold text-life-gold":"bg-life-black border-zinc-800 text-life-muted"}`,children:[o.jsxs("div",{className:"flex items-center gap-2 mb-1 opacity-50 border-b border-zinc-800 pb-1",children:[o.jsx(zn,{size:10}),o.jsx("span",{children:"SYSTEM LOG"})]}),o.jsxs("div",{children:[o.jsxs("span",{className:"opacity-50 mr-2",children:[new Date().toLocaleTimeString(),":"]}),k]})]}),o.jsxs("button",{onClick:R,disabled:E==="refining"||E==="restoring",className:`
                    w-full py-4 rounded-xl font-black uppercase tracking-widest text-sm flex items-center justify-center gap-2 transition-all
                    ${E==="success"?"bg-life-easy text-black":"bg-life-gold text-life-black hover:bg-yellow-400 shadow-[0_0_20px_rgba(251,191,36,0.3)]"}
                    ${E==="refining"||E==="restoring"?"opacity-70 cursor-wait":""}
                `,children:[E==="success"?o.jsx(Os,{size:16}):E==="refining"||E==="restoring"?o.jsx(CP,{size:16,className:"animate-spin"}):o.jsx(yh,{size:16}),E==="success"?"Operation Complete":E==="refining"?"Refining Logic...":E==="restoring"?"Restoring System...":"Execute Data"]}),E==="error"&&o.jsxs("div",{className:"flex items-center justify-center gap-1 text-[9px] text-life-hard opacity-70",children:[o.jsx(ph,{size:10})," Operation Halted. Check Logs."]})]})},BH=()=>{const{state:n,dispatch:e}=Ve(),{modalData:t}=n.ui,[i,r]=K.useState(()=>t&&t.defaultType?t.defaultType:"mission"),[l,c]=K.useState(!1),d=()=>{c(!0),setTimeout(()=>{e.setModal("none")},200)},p=()=>{e.setModal("none")};return o.jsx("div",{onClick:d,className:`fixed inset-0 z-50 flex items-end sm:items-center justify-center p-0 sm:p-4 transition-all duration-200 ${l?"opacity-0 pointer-events-none":"animate-in fade-in bg-black/80 backdrop-blur-sm"}`,children:o.jsxs("div",{onClick:h=>h.stopPropagation(),className:`
            bg-life-paper w-full max-w-lg rounded-t-2xl sm:rounded-2xl border border-life-muted/20 shadow-2xl overflow-hidden flex flex-col max-h-[95vh]
            transition-transform duration-300 pb-[env(safe-area-inset-bottom)]
            ${l?"translate-y-full sm:scale-95":"animate-in slide-in-from-bottom-full sm:zoom-in-95"}
        `,children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-life-muted/20 bg-life-black/50 shrink-0",children:[o.jsxs("h3",{className:"text-lg font-black tracking-tight text-life-text flex items-center gap-2",children:[o.jsx("span",{className:"text-life-gold",children:"///"})," COMMAND LINE"]}),o.jsx("button",{onClick:d,className:"w-8 h-8 rounded-full flex items-center justify-center text-life-muted hover:text-life-text hover:bg-life-muted/20 transition-all",children:o.jsx(et,{size:20})})]}),o.jsx("div",{className:"px-4 py-3 bg-life-black/40 border-b border-life-muted/10 shrink-0",children:o.jsxs("div",{className:"flex p-1 bg-life-black rounded-xl border border-life-muted/20 overflow-x-auto no-scrollbar gap-1",children:[o.jsxs("button",{onClick:()=>r("mission"),className:`flex-1 min-w-[70px] py-2 rounded-lg text-[10px] font-bold uppercase tracking-wider flex items-center justify-center gap-1 transition-all ${i==="mission"?"bg-life-muted/30 text-white shadow-sm":"text-life-muted hover:text-life-silver"}`,children:[o.jsx(ns,{size:14})," Mission"]}),o.jsxs("button",{onClick:()=>r("protocol"),className:`flex-1 min-w-[70px] py-2 rounded-lg text-[10px] font-bold uppercase tracking-wider flex items-center justify-center gap-1 transition-all ${i==="protocol"?"bg-life-muted/30 text-white shadow-sm":"text-life-muted hover:text-life-silver"}`,children:[o.jsx(is,{size:14})," Protocol"]}),o.jsxs("button",{onClick:()=>r("operation"),className:`flex-1 min-w-[70px] py-2 rounded-lg text-[10px] font-bold uppercase tracking-wider flex items-center justify-center gap-1 transition-all ${i==="operation"?"bg-life-muted/30 text-white shadow-sm":"text-life-muted hover:text-life-silver"}`,children:[o.jsx(ua,{size:14})," Raid"]}),o.jsxs("button",{onClick:()=>r("injection"),className:`flex-1 min-w-[70px] py-2 rounded-lg text-[10px] font-bold uppercase tracking-wider flex items-center justify-center gap-1 transition-all ${i==="injection"?"bg-life-easy/20 text-life-easy border border-life-easy/30 shadow-sm":"text-life-muted hover:text-life-easy"}`,children:[o.jsx(zn,{size:14})," Inject"]})]})}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-6 min-h-[300px]",children:[i==="mission"&&o.jsx(s6,{onClose:p}),i==="protocol"&&o.jsx(a6,{onClose:p}),i==="operation"&&o.jsx(c6,{onClose:p}),i==="injection"&&o.jsx(M2,{onClose:p})]})]})})},qH=()=>{const{state:n,dispatch:e}=Ve(),{user:t}=n,i=()=>{e.setModal("none")};return o.jsx("div",{onClick:i,className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm animate-in fade-in duration-500",children:o.jsxs("div",{onClick:r=>r.stopPropagation(),className:"relative w-full max-w-sm flex flex-col items-center animate-in zoom-in-50 slide-in-from-bottom-10 duration-700",children:[o.jsx("div",{className:"absolute inset-0 bg-life-gold/20 blur-[100px] rounded-full animate-pulse-slow pointer-events-none"}),o.jsxs("div",{className:"relative mb-6",children:[o.jsx("div",{className:"w-24 h-24 rounded-full bg-life-gold border-4 border-life-black shadow-[0_0_50px_rgba(251,191,36,0.6)] flex items-center justify-center animate-bounce",children:o.jsx(Bh,{size:48,className:"text-life-black",strokeWidth:2.5})}),o.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-white rounded-full flex items-center justify-center animate-spin",children:o.jsx(gh,{size:16,className:"text-life-gold"})}),o.jsx("div",{className:"absolute -bottom-2 -left-2 w-8 h-8 bg-life-crimson rounded-full flex items-center justify-center animate-pulse",children:o.jsx(Kh,{size:16,className:"text-white"})})]}),o.jsx("h2",{className:"text-5xl font-black text-white tracking-tighter italic mb-2 drop-shadow-lg",children:"LEVEL UP!"}),o.jsxs("div",{className:"text-2xl font-mono font-bold text-life-gold mb-8 tracking-widest border px-4 py-1 rounded border-life-gold/50 bg-life-gold/10",children:["LEVEL ",t.level]}),o.jsxs("div",{className:"w-full bg-life-paper/80 border border-life-gold/30 rounded-xl p-6 mb-8 shadow-2xl backdrop-blur-md",children:[o.jsx("h3",{className:"text-xs text-life-muted uppercase font-bold tracking-widest mb-4 text-center",children:"Rewards Acquired"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-black/40 border border-life-muted/20",children:[o.jsx("span",{className:"text-sm font-bold text-life-gold",children:"Gold Currency"}),o.jsx("span",{className:"text-sm font-mono text-white",children:"+100 G"})]}),o.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-black/40 border border-life-muted/20",children:[o.jsx("span",{className:"text-sm font-bold text-life-diamond",children:"Shield Max Capacity"}),o.jsx("span",{className:"text-sm font-mono text-white",children:"REFILLED"})]}),o.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-black/40 border border-life-muted/20",children:[o.jsx("span",{className:"text-sm font-bold text-life-easy",children:"XP Threshold"}),o.jsx("span",{className:"text-sm font-mono text-white",children:"INCREASED"})]})]})]}),o.jsxs("button",{onClick:i,className:"w-full py-4 bg-life-gold hover:bg-yellow-400 text-life-black font-black uppercase tracking-widest rounded-xl shadow-[0_0_20px_rgba(251,191,36,0.4)] transition-all hover:scale-105 active:scale-95 flex items-center justify-center gap-2",children:[o.jsx(gt,{size:20,strokeWidth:3}),"Evolve & Continue"]})]})})},$H=()=>{const{state:n,dispatch:e}=Ve(),{user:t}=n,i=S0(t.streak),r=Bf(t.streak),l=t.streak-r,c=100,d=10,p=c-d*2,h=p*2*Math.PI,x=Math.min(100,t.dailyXP/t.dailyTarget*100),b=h-x/100*h,T=x>=100,S=T?"#10b981":"#fbbf24",E={filter:T?"drop-shadow(0 0 10px rgba(16,185,129,0.6))":"drop-shadow(0 0 10px rgba(251,191,36,0.6))",transition:"stroke-dashoffset 1s ease-in-out, filter 0.5s ease"},D=new Date,k=D.getDay(),F=k===0?6:k-1,$=new Date(D);$.setDate(D.getDate()-F);const M=Array.from({length:7},(z,R)=>{var L;const C=new Date($);C.setDate($.getDate()+R);const A=C.toISOString().split("T")[0];let P="future";if(R>F)P="future";else if(R===F)t.dailyXP>=t.dailyTarget?P="success":P="pending";else{const O=(L=t.streakHistory)==null?void 0:L[A];O?P=O:P="fail"}return{label:C.toLocaleDateString("en-US",{weekday:"narrow"}),date:C.getDate(),outcome:P}}),J=z=>{e.updateUser({pendingMode:z}),e.addToast(`Protocol Updated: ${z.toUpperCase()}`,"info")},H=()=>{e.setModal("none")};return o.jsx("div",{onClick:H,className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{onClick:z=>z.stopPropagation(),className:"bg-life-black border border-life-gold/20 w-full max-w-sm rounded-[2rem] relative overflow-hidden shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-8 duration-500 flex flex-col max-h-[90vh]",children:[o.jsx("div",{className:`absolute top-0 left-1/2 -translate-x-1/2 w-full h-64 blur-[90px] rounded-full pointer-events-none transition-colors duration-1000 ${T?"bg-life-easy/5":"bg-life-gold/5"}`}),o.jsx("button",{onClick:H,className:"absolute top-5 right-5 text-life-muted hover:text-white transition-colors z-20 bg-black/40 rounded-full p-1.5 backdrop-blur-sm",children:o.jsx(et,{size:20})}),o.jsxs("div",{className:"p-6 flex flex-col items-center relative z-10 overflow-y-auto no-scrollbar",children:[o.jsx("h2",{className:"text-[10px] font-black uppercase tracking-[0.25em] text-life-muted mb-4 opacity-60",children:"System Integrity"}),o.jsxs("div",{className:"relative flex items-center justify-center mb-6",style:{width:c*2.2,height:c*2.2},children:[o.jsxs("svg",{height:c*2.2,width:c*2.2,className:"overflow-visible transform rotate-90",children:[o.jsx("circle",{stroke:"#1a1a1a",strokeWidth:d,fill:"transparent",r:p,cx:c*1.1,cy:c*1.1}),o.jsx("circle",{stroke:S,strokeWidth:d,strokeDasharray:h+" "+h,style:{strokeDashoffset:b,...E},strokeLinecap:"round",fill:"transparent",r:p,cx:c*1.1,cy:c*1.1})]}),o.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pt-2",children:[o.jsx("div",{className:`text-6xl font-black drop-shadow-md flex items-center gap-1 leading-[0.8] tracking-tighter ${T?"text-life-easy":"text-life-gold"}`,children:t.streak}),o.jsxs("div",{className:"flex items-center gap-1.5 text-life-muted mt-2 mb-2",children:[o.jsx(Mi,{size:14,className:T?"fill-life-easy text-life-easy":"fill-life-gold text-life-gold"}),o.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.2em]",children:"Days Active"})]}),o.jsxs("div",{className:`inline-flex items-center px-2 py-0.5 rounded border text-[9px] font-black uppercase tracking-widest ${i.phaseColor} bg-black/50 backdrop-blur-sm`,children:[t.dailyXP," / ",t.dailyTarget," XP"]})]})]}),o.jsxs("div",{className:"w-full mb-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2 px-1",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted/50",children:[o.jsx(Kh,{size:14}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Evolution Gate"})]}),o.jsxs("span",{className:"text-[9px] font-mono text-life-gold",children:[i.progress,"% to Next"]})]}),o.jsxs("div",{className:"relative py-4 bg-life-black/30 rounded-xl border border-life-muted/10",children:[o.jsx("div",{className:"absolute top-1/2 left-0 right-0 h-0.5 bg-life-muted/10 -translate-y-1/2 z-0"}),o.jsx("div",{className:"flex items-center gap-4 relative z-10 overflow-x-auto no-scrollbar pb-2 px-4 snap-x",children:Dn.map(z=>{const R=t.streak>=z,C=!R&&t.streak<z&&t.streak>=(Dn[Dn.indexOf(z)-1]||0),A=z===i.prevCheckpoint;return o.jsxs("div",{className:"flex flex-col items-center gap-2 min-w-[40px] snap-center shrink-0",children:[o.jsxs("div",{className:`
                                                    w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold border-2 transition-all relative
                                                    ${R?"bg-life-gold border-life-gold text-life-black shadow-[0_0_10px_rgba(251,191,36,0.3)]":C?"bg-life-black border-life-gold text-life-gold animate-pulse scale-110 shadow-[0_0_15px_rgba(251,191,36,0.2)]":"bg-life-black border-life-muted/20 text-life-muted/30"}
                                                `,children:[R?o.jsx(Os,{size:14}):C?o.jsx(ua,{size:14}):o.jsx(da,{size:12}),A&&o.jsx("div",{className:"absolute -bottom-2 -right-2 bg-life-black border border-life-muted/50 rounded-full p-0.5",title:"Safety Net",children:o.jsx(Zi,{size:8,className:"text-life-text"})})]}),o.jsx("span",{className:`text-[9px] font-mono font-bold ${R||C?"text-life-text":"text-life-muted/30"}`,children:z})]},z)})})]})]}),o.jsxs("div",{className:"w-full bg-life-black rounded-lg p-3 border border-life-muted/20 flex items-start gap-3 relative overflow-hidden group mb-6",children:[o.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-life-hard/50"}),o.jsx(hr,{size:16,className:"text-life-hard shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex justify-between items-center mb-1",children:[o.jsx("span",{className:"text-[10px] font-bold uppercase text-life-muted",children:"Failure Consequence"}),o.jsxs("span",{className:"text-[10px] font-black text-life-hard uppercase",children:["Streak -",l]})]}),o.jsxs("div",{className:"text-xs text-life-text",children:["If daily target is missed, streak falls to ",o.jsx("span",{className:"font-mono font-bold text-life-gold",children:r})," (Safety Net)."]})]})]}),o.jsxs("div",{className:"w-full mb-6",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3 px-2",children:[o.jsx("span",{className:"text-[9px] text-life-muted uppercase font-bold tracking-widest",children:"Weekly Survival Log"}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-0.5 rounded bg-life-diamond/10 border border-life-diamond/20",children:[o.jsx(Zi,{size:12,className:"text-life-diamond fill-life-diamond/20"}),o.jsxs("span",{className:"text-[10px] text-life-diamond font-bold font-mono",children:[t.shields," ",o.jsx("span",{className:"text-life-diamond/50 text-[8px] uppercase",children:"Stock"})]})]})})]}),o.jsx("div",{className:"flex justify-between bg-life-black/50 p-2.5 rounded-2xl border border-life-muted/10 backdrop-blur-sm",children:M.map((z,R)=>o.jsxs("div",{className:"flex flex-col items-center gap-2 flex-1",children:[o.jsxs("div",{className:`
                                        w-7 h-7 rounded-full flex items-center justify-center border transition-all shadow-sm
                                        ${z.outcome==="success"?"bg-life-easy/10 border-life-easy text-life-easy shadow-[0_0_8px_rgba(16,185,129,0.15)]":z.outcome==="shield"?"bg-life-diamond/10 border-life-diamond text-life-diamond":z.outcome==="fail"?"bg-life-hard/10 border-life-hard text-life-hard":z.outcome==="pending"?"bg-life-gold/5 border-life-gold text-life-gold animate-pulse":"bg-transparent border-transparent text-life-muted/10"}
                                    `,children:[z.outcome==="success"&&o.jsx(Os,{size:12}),z.outcome==="shield"&&o.jsx(Zi,{size:12}),z.outcome==="fail"&&o.jsx(M4,{size:12}),z.outcome==="pending"&&o.jsx("div",{className:"w-1.5 h-1.5 bg-life-gold rounded-full shadow-[0_0_5px_currentColor]"}),z.outcome==="future"&&o.jsx("div",{className:"w-1 h-1 bg-life-muted/10 rounded-full"})]}),o.jsx("span",{className:`text-[7px] font-black uppercase tracking-wider ${z.outcome==="future"?"text-life-muted/20":"text-life-muted"}`,children:z.label[0]})]},R))})]}),o.jsxs("div",{className:"w-full pt-6 border-t border-life-muted/10",children:[o.jsxs("div",{className:"flex items-center justify-center gap-2 mb-5 text-life-muted/60",children:[o.jsx(dt,{size:12}),o.jsx("span",{className:"text-[9px] font-bold uppercase tracking-[0.2em]",children:"Next Cycle Protocol"})]}),o.jsx("div",{className:"grid grid-cols-3 gap-3",children:Object.values(pn).map(z=>{const R=t.pendingMode===z,A={[pn.EASY]:{color:"text-life-easy",border:"border-life-easy",shadow:"shadow-life-easy/20"},[pn.NORMAL]:{color:"text-life-normal",border:"border-life-normal",shadow:"shadow-life-normal/20"},[pn.HARD]:{color:"text-life-hard",border:"border-life-hard",shadow:"shadow-life-hard/20"}}[z];let P="",L=T0[z],O=50;return z===pn.EASY&&(P="Recover",O=50),z===pn.NORMAL&&(P="Maintain",O=100),z===pn.HARD&&(P="War",O=200),o.jsxs("button",{onClick:()=>J(z),className:`
                                            relative flex flex-col items-center justify-center py-3 px-2 rounded-xl transition-all duration-300
                                            ${R?`bg-transparent border-2 ${A.border} ${A.color} shadow-[0_0_20px_-5px] ${A.shadow} scale-105`:"bg-life-black border border-life-muted/10 text-life-muted/50 hover:border-life-muted/30 hover:text-life-muted"}
                                        `,children:[o.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest mb-1.5",children:P}),o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsxs("span",{className:"text-sm font-black font-mono tracking-tight",children:[L," XP"]}),o.jsxs("span",{className:"text-[9px] opacity-60 font-mono mt-0.5",children:["+",O," G"]})]}),R&&o.jsx("div",{className:`absolute top-2 right-2 w-1.5 h-1.5 rounded-full ${A.color.replace("text-","bg-")} shadow-[0_0_5px_currentColor] animate-pulse`})]},z)})})]})]})]})})},YH=({dateOverride:n,setDateOverride:e,handleDateChange:t})=>{const{state:i,dispatch:r}=Ve(),[l,c]=K.useState(""),[d,p]=K.useState(""),h=(x,b)=>{const T=parseInt(l);if(!T||T<=0){r.addToast("Invalid Amount","error");return}if(!d.trim()){r.addToast("Reason Required","error");return}const E=T*(b==="add"?1:-1),D={},k=new Date().toISOString();x==="gold"?D.gold=i.user.gold+E:D.currentXP=i.user.currentXP+E;const F={id:`man_${Date.now()}`,itemId:"manual_override",title:`[${x.toUpperCase()}] ${d}`,cost:-E,timestamp:k};D.purchaseHistory=[F,...i.user.purchaseHistory||[]].slice(0,100),r.updateUser(D),r.addToast("Transaction Logged","success"),c(""),p("")};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("h3",{className:"text-life-gold font-bold flex items-center gap-2",children:[o.jsx(yP,{size:14})," Manual Override"]}),o.jsxs("div",{className:"bg-life-black border border-life-muted/20 p-3 rounded-lg space-y-3",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"text-[9px] text-life-muted uppercase font-bold block mb-1",children:"Reason"}),o.jsxs("div",{className:"flex items-center gap-2 bg-[#0a0a0a] border border-life-muted/30 rounded px-2",children:[o.jsx(Ol,{size:10,className:"text-life-muted"}),o.jsx("input",{type:"text",value:d,onChange:x=>p(x.target.value),placeholder:"Reason...",className:"w-full bg-transparent p-2 text-xs outline-none"})]})]}),o.jsxs("div",{className:"w-1/3",children:[o.jsx("label",{className:"text-[9px] text-life-muted uppercase font-bold block mb-1",children:"Amount"}),o.jsx("input",{type:"number",value:l,onChange:x=>c(x.target.value),placeholder:"0",className:"w-full bg-[#0a0a0a] border border-life-muted/30 rounded p-2 text-xs outline-none text-center font-mono font-bold"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-[9px] text-center text-life-gold font-bold uppercase",children:"Gold"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsxs("button",{onClick:()=>h("gold","add"),className:"flex-1 bg-life-gold/20 text-life-gold border border-life-gold/30 hover:bg-life-gold/30 py-2 rounded flex items-center justify-center gap-1 font-bold",children:[o.jsx(nn,{size:12})," Add"]}),o.jsxs("button",{onClick:()=>h("gold","sub"),className:"flex-1 bg-life-black text-life-muted border border-life-muted/30 hover:text-red-400 hover:border-red-400 py-2 rounded flex items-center justify-center gap-1 font-bold",children:[o.jsx(fh,{size:12})," Sub"]})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("div",{className:"text-[9px] text-center text-life-easy font-bold uppercase",children:"XP"}),o.jsxs("div",{className:"flex gap-1",children:[o.jsxs("button",{onClick:()=>h("xp","add"),className:"flex-1 bg-life-easy/20 text-life-easy border border-life-easy/30 hover:bg-life-easy/30 py-2 rounded flex items-center justify-center gap-1 font-bold",children:[o.jsx(nn,{size:12})," Add"]}),o.jsxs("button",{onClick:()=>h("xp","sub"),className:"flex-1 bg-life-black text-life-muted border border-life-muted/30 hover:text-red-400 hover:border-red-400 py-2 rounded flex items-center justify-center gap-1 font-bold",children:[o.jsx(fh,{size:12})," Sub"]})]})]})]})]})]}),o.jsxs("div",{className:"space-y-2 pt-4 border-t border-life-muted/10",children:[o.jsxs("h3",{className:"text-life-muted font-bold flex items-center gap-2",children:[o.jsx(ln,{size:14})," Chronos"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"date",value:n,onChange:x=>e(x.target.value),className:"bg-life-black border border-life-muted/30 rounded p-2 text-white focus:border-life-gold outline-none flex-1"}),o.jsx("button",{onClick:t,className:"bg-life-muted/10 border border-life-muted/30 px-4 py-2 rounded hover:bg-life-muted/20 uppercase font-bold text-[10px]",children:"Shift Time"})]})]}),o.jsxs("div",{className:"space-y-2 pt-4 border-t border-life-muted/10",children:[o.jsxs("h3",{className:"text-red-500 font-bold flex items-center gap-2",children:[o.jsx(ph,{size:14})," Danger Zone"]}),o.jsxs("button",{onClick:()=>r.triggerDailyReset(),className:"w-full bg-red-900/20 border border-red-500/30 text-red-400 p-2 rounded hover:bg-red-900/30 flex items-center justify-center gap-2 uppercase font-bold",children:[o.jsx(gx,{size:14})," Force Midnight Protocol"]}),o.jsxs("button",{onClick:()=>r.setModal("resetConfirm"),className:"w-full bg-red-900/20 border border-red-500/30 text-red-400 p-2 rounded hover:bg-red-900/30 flex items-center justify-center gap-2 uppercase font-bold",children:[o.jsx(ph,{size:14})," Wipe Save Data"]})]})]})},Xc={commander:{title:"The Commander",role:"Strategic General & NLP Core",content:`/// CLASSIFIED: COMMANDER NODE MANUAL ///

1. OVERVIEW
The Commander is the central interface for the user. It is the only node that maintains conversational context (Memory). It acts as a router, deciding whether to handle a query itself or delegate it to a Specialist Node (Executor, Designer, etc.).

2. PERSONALITY PROFILE
- Tone: "The Godfather" / "Strategic General".
- Traits: Ruthless, Efficient, Protective, Authoritative.
- Language: Professional Arabic (Gulf/Saudi Dialect) or English (Based on toggle).

3. TRIGGERS & BEHAVIOR
- "Hello/Hi": Responds with status report.
- "Help/Guide": Explains the system.
- General Chat: Discusses productivity strategies.
- Complex Commands: If a user asks for multiple things ("Add a task AND change theme"), the Commander breaks this down or asks for clarification.

4. MEMORY PROTOCOL
- Storage: 'LIFE_OS_ORACLE_HISTORY' (Local Storage).
- Context Window: Sends last 20 messages to Gemini to maintain conversation flow.
- Reset: Can be purged via "Purge Context Memory" button.

5. DIRECTIVE
"If the user asks to create something, do NOT ask follow-up questions. Deploy defaults immediately."
`},executor:{title:"The Executor",role:"Tactical Injection Engine",content:`/// CLASSIFIED: EXECUTOR NODE MANUAL ///

1. OVERVIEW
The Executor is a "Silent Agent". It does not speak. It outputs raw JSON payloads to modify the application state directly. It handles Tasks, Habits, and Raids.

2. TRIGGER KEYWORDS
- Tasks: "Add task", "Mission", "Remind me to..."
- Habits: "New habit", "Protocol", "Routine..."
- Raids: "Start project", "Operation", "Plan a raid..."

3. JSON SCHEMA (TASKS)
{
  "tasks": [
    {
      "title": "String (Required)",
      "difficulty": "easy | normal | hard",
      "stat": "STR | INT | DIS | HEA | CRT | SPR | REL | FIN",
      "energyLevel": "low | medium | high",
      "deadline": "YYYY-MM-DD",
      "subtasks": ["Step 1", "Step 2"]
    }
  ]
}

4. JSON SCHEMA (HABITS)
{
  "habits": [
    {
      "title": "String",
      "type": "daily | specific_days | interval",
      "stat": "DIS",
      "dailyTarget": 1
    }
  ]
}

5. ERROR HANDLING
If the Executor outputs invalid JSON, the "Refiner Node" (if active) attempts to repair syntax errors before injection.
`},designer:{title:"The Designer",role:"Visual Cortex & Theme Engine",content:`/// CLASSIFIED: DESIGNER NODE MANUAL ///

1. OVERVIEW
The Designer has full control over the CSS Variables and DOM styling of LifeOS. It can generate themes on the fly based on abstract descriptions (e.g., "Make it look like Cyberpunk 2077").

2. TRIGGER KEYWORDS
- "Change theme", "Colors", "Design", "Look like..."

3. INJECTION CAPABILITIES
- Colors: Modifies --color-life-black, --color-life-gold, etc.
- CSS: Can inject raw CSS blocks to change border-radius, fonts, or layout shapes.

4. JSON SCHEMA (THEMES)
{
  "themes": [
    {
      "id": "unique_id",
      "name": "Display Name",
      "colors": {
        "--color-life-black": "#000000",
        "--color-life-paper": "#111111",
        "--color-life-gold": "#FFD700",
        "--color-life-text": "#FFFFFF"
      },
      "customCss": "body { font-family: 'Courier New'; }"
    }
  ]
}

5. PERSISTENCE
Themes created by the Designer are saved to 'user.unlockedThemes' and persist across reloads.
`},observer:{title:"The Observer",role:"Data Analyst & Critic",content:`/// CLASSIFIED: OBSERVER NODE MANUAL ///

1. OVERVIEW
The Observer has read-only access to the entire User Profile (JSON). It analyzes Stats, Metrics, Streaks, and Badge History to provide tough love or strategic insights.

2. TRIGGER KEYWORDS
- "Analyze my stats", "How am I doing?", "Report", "Status"

3. DATA ACCESS LEVEL
- user.stats (STR, INT, DIS...)
- user.metrics (Total Tasks, Completion Rates)
- user.streakHistory (Calendar Heatmap)
- user.inventory (Items owned)

4. ANALYSIS MODES
- Roast Mode: Cruelly points out weaknesses (Low DIS stat).
- Coach Mode: Suggests which Skill Tree to focus on based on lowest stats.
- Prediction: Estimates time to next Level Up based on current XP velocity.

5. OUTPUT
Returns text-only analysis. Does not modify state.
`}},JH=()=>{var D;const{state:n,dispatch:e}=Ve(),{campaignDispatch:t}=Ul(),[i,r]=K.useState("system"),[l,c]=K.useState(""),[d,p]=K.useState(null);K.useEffect(()=>{n.ui.debugDate&&c(n.ui.debugDate.split("T")[0])},[n.ui.debugDate]);const h=()=>{if(!l)e.setDebugDate(null),e.addToast("Debug Time: Synced","info");else{const k=new Date(l);k.setHours(12,0,0,0),e.setDebugDate(k.toISOString()),t.updateStartDate(k.toISOString()),e.addToast(`Time Shift: ${l}`,"level-up")}},x=k=>{var $;const F=($=k.target.files)==null?void 0:$[0];F&&e.setCustomAudio(F)},b=()=>{confirm(` PURGE NEURAL MEMORY?
This will erase the AI's conversation history. Context will be reset.`)&&(localStorage.removeItem("LIFE_OS_ORACLE_HISTORY"),window.dispatchEvent(new Event("oracle-memory-cleared")),e.addToast("Neural Memory Purged","success"))},T=()=>{if(!d)return;const k=Xc[d],F=new Blob([k.content],{type:"text/plain"}),$=URL.createObjectURL(F),M=document.createElement("a");M.href=$,M.download=`Manual_${k.title.replace(/\s+/g,"_")}.txt`,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL($),e.addToast("Manual Downloaded","success")},S=()=>{d&&(navigator.clipboard.writeText(Xc[d].content),e.addToast("Manual Copied to Clipboard","success"))},E=(k,F,$)=>{const M=n.user.preferences[$];return o.jsxs("button",{onClick:()=>e.togglePreference($),className:"w-full flex items-center justify-between p-3 rounded-lg bg-life-black border border-life-muted/20 hover:border-life-gold/50 transition-all group",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:M?"text-life-gold":"text-life-muted",children:F}),o.jsx("span",{className:"text-[10px] font-bold text-life-text uppercase tracking-wider",children:k})]}),o.jsx("div",{className:`w-8 h-4 rounded-full relative transition-colors ${M?"bg-life-gold":"bg-life-muted/30"}`,children:o.jsx("div",{className:`absolute top-0.5 w-3 h-3 bg-white rounded-full transition-all ${M?"left-4.5":"left-0.5"}`})})]})};return o.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/95 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{className:"bg-[#0a0a0a] border border-life-gold/30 w-full max-w-lg rounded-xl shadow-2xl flex flex-col h-[85vh] overflow-hidden font-mono text-xs",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-life-gold/20 bg-life-gold/5",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-gold",children:[o.jsx(zn,{size:18}),o.jsx("span",{className:"font-black uppercase tracking-[0.2em] text-sm",children:"God Mode Shell"})]}),o.jsx("button",{onClick:()=>e.setModal("none"),className:"text-life-gold hover:text-white p-1",children:o.jsx(et,{size:20})})]}),o.jsx("div",{className:"flex border-b border-life-muted/10 overflow-x-auto no-scrollbar bg-black/40",children:[{id:"system",icon:o.jsx(r3,{size:12})},{id:"oracle",icon:o.jsx(tn,{size:12})},{id:"actions",icon:o.jsx(dt,{size:12})},{id:"themes",icon:o.jsx(kn,{size:12})},{id:"state",icon:o.jsx(zf,{size:12})},{id:"log",icon:o.jsx(zn,{size:12})},{id:"media",icon:o.jsx(hh,{size:12})}].map(k=>o.jsxs("button",{onClick:()=>{r(k.id),p(null)},className:`flex-1 min-w-[75px] py-4 flex flex-col items-center gap-1 uppercase font-black text-[9px] transition-all border-b-2 ${i===k.id?"bg-life-gold/10 text-life-gold border-life-gold":"text-life-muted border-transparent hover:text-life-silver"}`,children:[k.icon,k.id]},k.id))}),o.jsxs("div",{className:"flex-1 overflow-auto p-4 bg-[#050505] text-life-text/80",children:[i==="system"&&o.jsxs("div",{className:"space-y-4 animate-in fade-in slide-in-from-right-2",children:[o.jsx("div",{className:"p-3 bg-life-gold/5 border border-life-gold/10 rounded text-[9px] text-life-gold/70 uppercase font-bold tracking-widest",children:"Core System Toggles & Calibration"}),o.jsxs("div",{className:"w-full flex items-center justify-between p-3 rounded-lg bg-life-black border border-life-muted/20",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(ln,{size:16,className:"text-life-gold"}),o.jsx("span",{className:"text-[10px] font-bold uppercase text-life-text",children:"Day Start (Reset Hour)"})]}),o.jsx("select",{value:n.user.preferences.dayStartHour??4,onChange:k=>e.setDayStartHour(parseInt(k.target.value)),className:"bg-black border border-life-gold/30 rounded px-2 py-1 text-xs font-mono font-bold text-life-gold outline-none",children:Array.from({length:24}).map((k,F)=>o.jsxs("option",{value:F,children:[F.toString().padStart(2,"0"),":00"]},F))})]}),o.jsxs("div",{className:"space-y-2",children:[E("Neural Feedback (Sound)",o.jsx(V3,{size:16}),"soundEnabled"),E("Google Calendar Sync",o.jsx(Wn,{size:16}),"showCalendarSync"),E("AI Context: History Logs",o.jsx(Ol,{size:16}),"copyIncludesHistory"),E("System Alerts (Push)",o.jsx(ur,{size:16}),"deviceNotificationsEnabled")]}),o.jsx("div",{className:"h-px bg-life-muted/10 my-2"}),o.jsxs("div",{className:"space-y-2",children:[E("Show Spear Tip (Highlights)",o.jsx(dt,{size:16}),"showHighlights"),E("Campaign Module UI",o.jsx(z4,{size:16}),"showCampaignUI"),E("Horus Eye (Unlock Weeks)",o.jsx(zf,{size:16}),"unlockAllWeeks")]})]}),i==="oracle"&&o.jsx("div",{className:"h-full flex flex-col animate-in fade-in slide-in-from-right-2",children:d?o.jsxs("div",{className:"flex flex-col h-full animate-in slide-in-from-right-4",children:[o.jsxs("button",{onClick:()=>p(null),className:"flex items-center gap-2 text-life-muted hover:text-life-gold mb-3 uppercase font-bold text-[10px]",children:[o.jsx(hN,{size:12})," Back to Gem List"]}),o.jsxs("div",{className:"flex-1 bg-life-black/50 border border-life-muted/20 rounded-xl overflow-hidden flex flex-col",children:[o.jsxs("div",{className:"p-3 border-b border-life-muted/20 bg-life-black flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-black text-life-text uppercase tracking-widest",children:Xc[d].title}),o.jsx("p",{className:"text-[9px] text-life-gold font-mono",children:Xc[d].role})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:S,className:"p-2 text-life-muted hover:text-life-easy hover:bg-life-easy/10 rounded transition-all",title:"Copy Text",children:o.jsx(mi,{size:16})}),o.jsx("button",{onClick:T,className:"p-2 text-life-muted hover:text-life-gold hover:bg-life-gold/10 rounded transition-all",title:"Download File",children:o.jsx(dh,{size:16})})]})]}),o.jsx("div",{className:"flex-1 overflow-auto p-4",children:o.jsx("pre",{className:"whitespace-pre-wrap font-mono text-[10px] text-life-text/80 leading-relaxed",children:Xc[d].content})})]})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-3",children:[o.jsxs("h3",{className:"text-life-gold font-bold uppercase tracking-widest text-[10px] flex items-center gap-2",children:[o.jsx(qh,{size:14})," Gem Architecture (Select for Manual)"]}),o.jsxs("button",{onClick:()=>p("commander"),className:"w-full bg-life-black border border-life-muted/20 p-3 rounded-lg flex items-center gap-3 hover:border-life-easy/50 hover:bg-life-easy/5 transition-all text-left group",children:[o.jsx("div",{className:"p-2 bg-life-easy/10 text-life-easy rounded-full",children:o.jsx(tn,{size:16})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-bold text-xs text-life-text group-hover:text-life-easy",children:"The Commander"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Strategic oversight & general conversation."})]}),o.jsx(Bt,{size:14,className:"text-life-muted group-hover:text-life-easy"})]}),o.jsxs("button",{onClick:()=>p("executor"),className:"w-full bg-life-black border border-life-muted/20 p-3 rounded-lg flex items-center gap-3 hover:border-purple-400/50 hover:bg-purple-400/5 transition-all text-left group",children:[o.jsx("div",{className:"p-2 bg-purple-500/10 text-purple-400 rounded-full",children:o.jsx(zn,{size:16})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-bold text-xs text-life-text group-hover:text-purple-400",children:"The Executor"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Tactical ops: Instantly Adds Tasks, Habits, Raids."})]}),o.jsx(Bt,{size:14,className:"text-life-muted group-hover:text-purple-400"})]}),o.jsxs("button",{onClick:()=>p("designer"),className:"w-full bg-life-black border border-life-muted/20 p-3 rounded-lg flex items-center gap-3 hover:border-pink-400/50 hover:bg-pink-400/5 transition-all text-left group",children:[o.jsx("div",{className:"p-2 bg-pink-500/10 text-pink-400 rounded-full",children:o.jsx(kn,{size:16})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-bold text-xs text-life-text group-hover:text-pink-400",children:"The Designer"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Visual cortex: Changes App Themes & Colors."})]}),o.jsx(Bt,{size:14,className:"text-life-muted group-hover:text-pink-400"})]}),o.jsxs("button",{onClick:()=>p("observer"),className:"w-full bg-life-black border border-life-muted/20 p-3 rounded-lg flex items-center gap-3 hover:border-blue-400/50 hover:bg-blue-400/5 transition-all text-left group",children:[o.jsx("div",{className:"p-2 bg-blue-500/10 text-blue-400 rounded-full",children:o.jsx(pN,{size:16})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"font-bold text-xs text-life-text group-hover:text-blue-400",children:"The Observer"}),o.jsx("div",{className:"text-[9px] text-life-muted",children:"Analyzes your Stats, Metrics & Performance."})]}),o.jsx(Bt,{size:14,className:"text-life-muted group-hover:text-blue-400"})]})]}),o.jsxs("div",{className:"border-t border-life-muted/10 pt-4",children:[o.jsxs("h3",{className:"text-life-gold font-bold uppercase tracking-widest text-[10px] flex items-center gap-2 mb-3",children:[o.jsx(dt,{size:14})," Maintenance"]}),o.jsxs("button",{onClick:b,className:"w-full flex items-center justify-center gap-2 p-3 rounded-lg bg-red-950/20 border border-red-900/30 text-red-400 hover:bg-red-900/30 transition-all uppercase font-bold text-[10px]",children:[o.jsx(Nn,{size:14})," Purge Context Memory"]})]})]})}),i==="actions"&&o.jsx("div",{className:"animate-in fade-in slide-in-from-right-2",children:o.jsx(YH,{dateOverride:l,setDateOverride:c,handleDateChange:h})}),i==="themes"&&o.jsx("div",{className:"grid grid-cols-2 gap-3 animate-in fade-in slide-in-from-right-2",children:n.user.unlockedThemes.map(k=>{const F=n.user.preferences.theme===k.id;return o.jsxs("button",{onClick:()=>e.setTheme(k.id),className:`p-3 rounded-xl border flex flex-col gap-2 transition-all text-left relative overflow-hidden ${F?"border-life-gold bg-life-gold/10":"border-life-muted/20 bg-life-black hover:border-life-gold/30"}`,children:[o.jsxs("div",{className:"flex gap-1",children:[o.jsx("div",{className:"w-3 h-3 rounded-full border border-zinc-800",style:{backgroundColor:k.colors["--color-life-black"]}}),o.jsx("div",{className:"w-3 h-3 rounded-full border border-zinc-800",style:{backgroundColor:k.colors["--color-life-paper"]}}),o.jsx("div",{className:"w-3 h-3 rounded-full border border-zinc-800",style:{backgroundColor:k.colors["--color-life-gold"]}})]}),o.jsx("span",{className:`text-[9px] font-black uppercase tracking-widest ${F?"text-life-gold":"text-life-muted"}`,children:k.name}),F&&o.jsx("div",{className:"absolute top-1 right-1",children:o.jsx(gt,{size:10,className:"text-life-gold"})})]},k.id)})}),i==="state"&&o.jsxs("div",{className:"p-3 bg-life-black border border-life-muted/20 rounded animate-in fade-in",children:[o.jsxs("h3",{className:"text-life-gold font-bold mb-2 flex items-center gap-2",children:[o.jsx(zf,{size:12})," Data Snapshot"]}),o.jsx("pre",{className:"whitespace-pre-wrap opacity-70 text-[9px]",children:JSON.stringify(n.user,null,2)})]}),i==="log"&&o.jsx("div",{className:"space-y-2 animate-in fade-in",children:(D=n.ui.systemLogs)==null?void 0:D.map(k=>o.jsxs("div",{className:"flex gap-2 border-b border-life-muted/10 pb-1",children:[o.jsx("span",{className:"text-[9px] text-life-muted min-w-[50px]",children:k.timestamp?new Date(k.timestamp).toLocaleTimeString():"---"}),o.jsxs("span",{className:`font-bold text-[9px] uppercase ${k.type==="error"?"text-red-500":"text-life-gold"}`,children:["[",k.type,"]"]}),o.jsx("span",{className:"text-[9px]",children:k.message})]},k.id))}),i==="media"&&o.jsxs("div",{className:"p-4 bg-life-black border border-life-gold/20 rounded-lg text-center space-y-4 animate-in fade-in",children:[o.jsx("div",{className:"w-16 h-16 bg-life-gold/10 rounded-full flex items-center justify-center mx-auto border border-life-gold/30",children:o.jsx(hh,{size:32,className:"text-life-gold"})}),o.jsxs("label",{className:"block w-full cursor-pointer",children:[o.jsx("input",{type:"file",accept:"audio/*",onChange:x,className:"hidden"}),o.jsxs("div",{className:"w-full py-3 border border-dashed border-life-muted/50 rounded-lg hover:border-life-gold hover:bg-life-gold/5 transition-all flex items-center justify-center gap-2 text-life-text",children:[o.jsx(yh,{size:14})," Neural Audio Sync"]})]}),n.ui.customAudio&&o.jsxs("div",{className:"bg-green-900/20 border border-green-500/30 p-2 rounded text-green-400 text-[10px]",children:["Active Uplink: ",o.jsx("span",{className:"font-bold text-white",children:n.ui.customAudio.name})]})]})]})]})})},KH=({editTime:n,setEditTime:e,editReminders:t,setEditReminders:i,editSubtasks:r,setEditSubtasks:l,newSubtaskTitle:c,setNewSubtaskTitle:d,hideSubtasks:p=!1})=>{const h=E=>{if(E===-1)return;t.some(k=>k.minutesBefore===E)||i([...t,{id:`rem_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,minutesBefore:E,isSent:!1}].sort((k,F)=>k.minutesBefore-F.minutesBefore))},x=E=>{i(t.filter(D=>D.id!==E))},b=()=>{if(!c.trim())return;const E={id:`st_${Date.now()}_${Math.random().toString(36).substr(2,5)}`,title:c.trim(),isCompleted:!1};l([...r,E]),d("")},T=E=>{l(r.filter(D=>D.id!==E))},S=E=>E===0?"At time":E===60?"1h before":E===1440?"1d before":`${E}m before`;return o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"mb-4 space-y-3 bg-life-black/30 p-3 rounded-lg border border-life-muted/10",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[9px] text-life-muted uppercase font-bold tracking-widest mb-1 flex items-center gap-1",children:[o.jsx(ln,{size:10})," Scheduled Time"]}),o.jsx("input",{type:"datetime-local",value:n,onChange:E=>e(E.target.value),className:"w-full bg-life-black border border-life-muted/30 rounded p-2 text-xs text-life-text focus:outline-none focus:border-life-gold/50"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[9px] text-life-muted uppercase font-bold tracking-widest mb-1 flex items-center gap-1",children:[o.jsx(ur,{size:10})," Reminders"]}),o.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:t.map(E=>o.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 bg-life-gold/10 border border-life-gold/30 rounded text-[9px] text-life-gold",children:[o.jsx("span",{children:S(E.minutesBefore)}),o.jsx("button",{type:"button",onClick:()=>x(E.id),className:"hover:text-white",children:o.jsx(et,{size:10})})]},E.id))}),o.jsxs("select",{value:-1,onChange:E=>h(Number(E.target.value)),className:"w-full bg-life-black border border-life-muted/30 rounded p-1.5 text-xs text-life-muted focus:outline-none focus:border-life-gold/50",children:[o.jsx("option",{value:-1,children:"+ Add Alert"}),o.jsx("option",{value:0,children:"At scheduled time"}),o.jsx("option",{value:15,children:"15 mins before"}),o.jsx("option",{value:60,children:"1 hour before"})]})]})]}),!p&&o.jsxs("div",{className:"border-t border-life-muted/10 pt-4 mt-2",children:[o.jsxs("label",{className:"block text-[9px] text-life-muted uppercase font-bold tracking-widest mb-2 flex items-center gap-1",children:[o.jsx(gt,{size:10})," Subtasks"]}),o.jsx("div",{className:"space-y-2 mb-2",children:r.map(E=>o.jsxs("div",{className:"flex items-center justify-between bg-life-black px-2 py-1.5 rounded border border-life-muted/20",children:[o.jsx("span",{className:"text-xs text-life-text truncate",children:E.title}),o.jsx("button",{onClick:()=>T(E.id),className:"text-life-muted hover:text-life-hard p-1",children:o.jsx(Nn,{size:12})})]},E.id))}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx("input",{type:"text",value:c,onChange:E=>d(E.target.value),onKeyDown:E=>E.key==="Enter"&&(E.preventDefault(),b()),placeholder:"Add subtask...",className:"flex-1 bg-life-black border border-life-muted/30 rounded px-2 py-1.5 text-xs text-life-text focus:border-life-gold outline-none"}),o.jsx("button",{onClick:b,className:"bg-life-gold/10 hover:bg-life-gold/20 text-life-gold border border-life-gold/30 rounded px-2",children:o.jsx(nn,{size:14})})]})]})]})},kf=({stat:n,size:e=14})=>{switch(n){case te.STR:return o.jsx(Qn,{size:e});case te.INT:return o.jsx(tn,{size:e});case te.DIS:return o.jsx(dt,{size:e});case te.HEA:return o.jsx(gi,{size:e});case te.CRT:return o.jsx(kn,{size:e});case te.SPR:return o.jsx(Mi,{size:e});case te.REL:return o.jsx(mo,{size:e});case te.FIN:return o.jsx(pi,{size:e});default:return o.jsx(Lt,{size:e})}},XH=()=>{const{state:n,dispatch:e}=Ve(),{taskState:t,taskDispatch:i}=Zn(),{habitState:r,habitDispatch:l}=ei(),{raidState:c,raidDispatch:d}=ss(),{skillState:p}=sn(),{modalData:h}=n.ui,x=K.useMemo(()=>{if(!h)return null;const{itemId:Q,type:ae,parentId:ye}=h;if(ae==="task"){const ue=t.tasks.find(Te=>Te.id===Q);return ue?{item:ue,title:ue.title,desc:ue.description,difficulty:ue.difficulty,stat:ue.stat,skillId:ue.skillId,scheduledTime:ue.scheduledTime||ue.deadline,reminders:ue.reminders,subtasks:ue.subtasks,isEditable:!0,canArchive:!0,isFullControl:!0}:null}if(ae==="habit"){const ue=r.habits.find(Te=>Te.id===Q);return ue?{item:ue,title:ue.title,desc:ue.description,difficulty:ue.difficulty,stat:ue.stat,skillId:ue.skillId,scheduledTime:ue.scheduledTime,reminders:ue.reminders,subtasks:ue.subtasks,isEditable:!0,canArchive:!1,isFullControl:!0}:null}if(ae==="raid"||ae==="raid_step")if(ae==="raid"){const ue=c.raids.find(Ae=>Ae.id===Q);if(!ue)return null;const Te=ue.stats&&ue.stats.length>0?ue.stats[0]:te.STR;return{item:ue,title:ue.title,desc:ue.description,difficulty:ue.difficulty,stat:Te,skillId:ue.skillId,scheduledTime:ue.deadline,reminders:[],subtasks:[],isEditable:!0,canArchive:!0,isFullControl:!0}}else{const ue=c.raids.find(Dt=>Dt.id===ye),Te=ue==null?void 0:ue.steps.find(Dt=>Dt.id===Q);if(!Te||!ue)return null;const Ae=Te.stat||(ue.stats&&ue.stats.length>0?ue.stats[0]:te.STR),Be=Te.difficulty||ue.difficulty,jt=ue.skillId;return{item:Te,parentRaid:ue,title:Te.title,desc:Te.notes,difficulty:Be,stat:Ae,skillId:jt,scheduledTime:Te.scheduledTime,reminders:Te.reminders,subtasks:Te.subtasks,isTimed:Te.isTimed,durationMinutes:Te.durationMinutes,isEditable:!0,canArchive:!0,isFullControl:!0,isSkillLocked:!0}}return null},[h,t.tasks,r.habits,c.raids]),[b,T]=K.useState(!1),[S,E]=K.useState(""),[D,k]=K.useState(""),[F,$]=K.useState(""),[M,J]=K.useState([]),[H,z]=K.useState([]),[R,C]=K.useState(""),[A,P]=K.useState(void 0),[L,O]=K.useState(void 0),[j,q]=K.useState("");if(K.useEffect(()=>{if(x){E(x.title),k(x.desc||""),P(x.item.difficulty),O(x.item.stat),q(x.skillId||"");let Q=x.scheduledTime||"";if((h==null?void 0:h.type)!=="habit"&&Q){const ae=new Date(Q);if(!isNaN(ae.getTime())){const ye=ae.getTimezoneOffset()*6e4;Q=new Date(ae.getTime()-ye).toISOString().slice(0,16)}}$(Q),J(x.reminders||[]),z(x.subtasks||[])}},[x]),!h||!x)return null;const le=()=>e.setModal("none"),U=()=>{const Q={...x.item};(n.user.preferences.copyIncludesHistory??!0)||(delete Q.history,delete Q.streak,delete Q.streakHistory,delete Q.purchaseHistory);let ye={};h.type==="habit"?ye={habits:[Q]}:h.type==="task"?ye={tasks:[Q]}:h.type==="raid"?ye={raids:[Q]}:ye=Q,navigator.clipboard.writeText(JSON.stringify(ye,null,2)),e.addToast("Item Copied to Clipboard (JSON)","success")},Y=()=>{if(!S.trim())return;const{itemId:Q,type:ae,parentId:ye}=h;let ue=F||void 0;if(ue&&ae!=="habit"){const Ae=new Date(ue);isNaN(Ae.getTime())||(ue=Ae.toISOString())}const Te={title:S,reminders:M.length>0?M:void 0,subtasks:H};ae==="raid_step"?(Te.notes=D,Te.scheduledTime=ue,Te.difficulty=A,Te.stat=L,Te.isTimed=x.item.isTimed):(Te.description=D,Te.difficulty=A,Te.stat=L,Te.skillId=j||void 0,ae==="raid"?(Te.deadline=ue,Te.stats=[L]):(Te.scheduledTime=ue,ae==="task"&&(Te.deadline=ue))),ae==="task"?i.updateTask(Q,Te):ae==="habit"?l.updateHabit(Q,Te):ae==="raid"?d.updateRaid(Q,Te):ae==="raid_step"&&ye&&d.updateRaidStep(ye,Q,Te),T(!1),e.addToast("Changes applied successfully","success")},X=()=>{h.type==="task"?i.archiveTask(h.itemId):h.type==="raid"?d.archiveRaid(h.itemId):h.type==="raid_step"&&d.archiveRaidStep(h.parentId,h.itemId),le()},ie=()=>{e.setModal("confirmation",{title:"Confirm Deletion",message:"Permanently delete this item?",confirmText:"Delete",isDangerous:!0,onConfirm:()=>{h.type==="task"?i.deleteTask(h.itemId):h.type==="habit"?l.deleteHabit(h.itemId):h.type==="raid"?d.deleteRaid(h.itemId):h.type==="raid_step"&&d.deleteRaidStep(h.parentId,h.itemId)}})},pe=()=>{x.scheduledTime&&Wh(x.title,x.desc||"",x.scheduledTime)},B=ui[x.difficulty],ee=ut[x.stat],he=x.skillId?p.skills.find(Q=>Q.id===x.skillId):null;return o.jsx("div",{onClick:le,className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{onClick:Q=>Q.stopPropagation(),className:"bg-life-paper w-full max-w-md rounded-xl border border-zinc-800 shadow-2xl overflow-hidden flex flex-col max-h-[85vh] animate-in zoom-in-95 duration-300 relative group",children:[o.jsxs("div",{className:"p-5 border-b border-zinc-800 flex justify-between items-start bg-life-black/40",children:[o.jsxs("div",{className:"flex-1 min-w-0 mr-4",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.2em] text-life-gold bg-life-gold/10 px-2 py-0.5 rounded border border-life-gold/20",children:h.type.replace("_"," ")}),h.parentId&&o.jsx("span",{className:"text-[9px] text-life-muted border border-zinc-800 px-1.5 py-0.5 rounded bg-life-black",children:"Linked"})]}),b?o.jsx("input",{type:"text",value:S,onChange:Q=>E(Q.target.value),className:"w-full bg-black border border-life-gold/50 rounded px-2 py-1 text-lg font-bold text-life-text focus:outline-none",autoFocus:!0}):o.jsx("h2",{className:"text-xl font-bold text-life-text leading-tight font-mono",children:x.title})]}),o.jsx("button",{onClick:le,className:"text-life-muted hover:text-white",children:o.jsx(et,{size:18})})]}),!b&&o.jsxs("div",{className:"px-5 py-3 bg-life-black border-b border-zinc-800 flex flex-wrap gap-2 items-center",children:[o.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded border text-[10px] font-black uppercase ${B} bg-opacity-10`,children:[o.jsx(da,{size:10}),x.difficulty]}),o.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded border text-[10px] font-black uppercase bg-life-paper",style:{borderColor:`${ee}40`,color:ee},children:[o.jsx(kf,{stat:x.stat,size:10}),x.stat]}),he&&o.jsxs("div",{className:"flex items-center gap-1 px-2 py-1 rounded border border-life-gold/30 text-life-gold bg-life-gold/5 text-[10px] font-bold",children:[o.jsx(hi,{size:10})," ",he.title]})]}),o.jsx("div",{className:"flex-1 overflow-y-auto p-5 bg-life-paper relative",children:b?o.jsxs("div",{className:"space-y-4",children:[x.isFullControl&&o.jsxs("div",{className:"bg-life-black/30 p-3 rounded-lg border border-zinc-800 space-y-3",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("label",{className:"block text-[9px] text-life-muted uppercase font-bold tracking-widest",children:"Difficulty"}),!A&&h.type==="raid_step"&&o.jsx("span",{className:"text-[8px] uppercase font-black text-life-gold/50 tracking-widest",children:"Inherited"})]}),o.jsx("div",{className:"grid grid-cols-3 gap-1",children:Object.values(Ge).map(Q=>{const ye=(A||x.difficulty)===Q;return o.jsx("button",{onClick:()=>{P(A===Q?void 0:Q)},className:`py-2 rounded text-[9px] font-black uppercase border transition-all ${ye?`${ui[Q]} ${Eu[Q]} shadow-sm`:"border-zinc-800 text-life-muted hover:bg-life-muted/5"}`,children:Q},Q)})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[9px] text-life-muted uppercase font-bold tracking-widest mb-1",children:["Skill Link ",x.isSkillLocked&&o.jsx("span",{className:"text-life-gold/50",children:"(Inherited)"})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:j,onChange:Q=>q(Q.target.value),disabled:x.isSkillLocked,className:`w-full bg-life-black border border-zinc-800 rounded p-1.5 pl-2 text-[10px] text-life-text appearance-none outline-none ${x.isSkillLocked?"opacity-50 cursor-not-allowed":"focus:border-life-gold"}`,children:[o.jsx("option",{value:"",children:"None"}),p.skills.map(Q=>o.jsx("option",{value:Q.id,children:Q.title},Q.id))]}),!x.isSkillLocked&&o.jsx(Xn,{size:10,className:"absolute right-2 top-1/2 -translate-x-1/2 text-life-muted pointer-events-none"})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center justify-between mb-1",children:[o.jsx("label",{className:"block text-[9px] text-life-muted uppercase font-bold tracking-widest",children:"Attribute"}),!L&&h.type==="raid_step"&&o.jsx("span",{className:"text-[8px] uppercase font-black text-life-gold/50 tracking-widest",children:"Inherited"})]}),o.jsx("div",{className:"flex gap-1 overflow-x-auto no-scrollbar pb-1",children:Object.values(te).map(Q=>{const ye=(L||x.stat)===Q;return o.jsx("button",{onClick:()=>{O(L===Q?void 0:Q)},className:`w-7 h-7 shrink-0 rounded flex items-center justify-center border transition-all ${ye?"bg-life-muted/20 border-life-muted text-life-text":"border-zinc-800 text-life-muted opacity-50"}`,style:{color:ye?ut[Q]:void 0},children:o.jsx(kf,{stat:Q,size:12})},Q)})})]})]})]}),o.jsx(KH,{editTime:F,setEditTime:$,editReminders:M,setEditReminders:J,editSubtasks:H,setEditSubtasks:z,newSubtaskTitle:R,setNewSubtaskTitle:C,hideSubtasks:h.type==="raid"}),h.type==="raid"&&x.item.steps&&o.jsxs("div",{className:"mt-4 border-t border-zinc-800 pt-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3",children:[o.jsxs("h4",{className:"text-[10px] text-life-muted uppercase font-bold flex items-center gap-1",children:[o.jsx(Lt,{size:12})," Operation Steps"]}),o.jsx("button",{onClick:()=>{const Q={id:`rs_new_${Date.now()}`,title:"New Tactical Step",isCompleted:!1,isLocked:!1,difficulty:x.difficulty,stat:x.stat},ae=[...x.item.steps,Q];d.updateRaid(h.itemId,{steps:ae}),e.addToast("Step Added","success")},className:"text-[9px] bg-life-gold/10 text-life-gold px-2 py-1 rounded border border-life-gold/20 hover:bg-life-gold/20 transition-colors",children:"+ Add Step"})]}),o.jsx("div",{className:"space-y-2",children:x.item.steps.map((Q,ae)=>{var ye;return o.jsxs("div",{className:"flex items-center justify-between p-3 rounded bg-life-black border border-life-muted/20 group hover:border-life-gold/30 transition-all",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-[9px] font-mono text-life-muted opacity-50",children:(ae+1).toString().padStart(2,"0")}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:`text-xs font-bold ${Q.isCompleted?"text-life-muted line-through":"text-life-text"}`,children:Q.title}),o.jsxs("div",{className:"flex gap-1 mt-0.5",children:[Q.difficulty&&Q.difficulty!==x.item.difficulty&&o.jsx("span",{className:`text-[7px] font-black uppercase px-1 rounded border ${ui[Q.difficulty]}`,children:Q.difficulty}),Q.stat&&Q.stat!==((ye=x.item.stats)==null?void 0:ye[0])&&o.jsxs("span",{className:"text-[7px] font-black uppercase px-1 rounded border border-life-muted/20 flex items-center gap-0.5",style:{color:ut[Q.stat],borderColor:`${ut[Q.stat]}40`},children:[o.jsx(kf,{stat:Q.stat,size:6})," ",Q.stat]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("button",{onClick:ue=>{ue.stopPropagation(),e.setModal("details",{itemId:Q.id,type:"raid_step",parentId:h.itemId})},className:"p-1.5 rounded bg-life-muted/10 hover:bg-life-gold/20 text-life-muted hover:text-life-gold",children:o.jsx(Tg,{size:10})}),o.jsx("button",{onClick:ue=>{ue.stopPropagation(),d.deleteRaidStep(h.itemId,Q.id)},className:"p-1.5 rounded bg-life-hard/10 hover:bg-life-hard/20 text-life-hard",children:o.jsx(Nn,{size:10})})]})]},Q.id)})})]}),o.jsxs("div",{className:"relative flex flex-col mt-4",children:[o.jsx("label",{className:"block text-[9px] text-life-muted uppercase font-bold tracking-widest mb-1",children:"Description / Intel"}),o.jsx("textarea",{value:D,onChange:Q=>k(Q.target.value),className:"w-full h-24 bg-life-black border border-zinc-800 rounded-lg p-3 text-sm text-life-text focus:border-life-gold outline-none resize-none font-mono"})]})]}):o.jsxs("div",{className:"space-y-4",children:[x.scheduledTime&&o.jsxs("div",{className:"flex gap-2 items-center text-xs text-life-gold bg-life-gold/10 px-3 py-2 rounded-lg border border-life-gold/20 inline-flex",children:[o.jsx(ln,{size:12}),o.jsx("span",{className:"font-mono font-bold",children:h.type==="habit"?`Daily at ${x.scheduledTime}`:new Date(x.scheduledTime).toLocaleString()}),o.jsx("button",{onClick:pe,className:"ml-2 border-l border-life-gold/30 pl-2 text-life-gold hover:text-white",children:o.jsx(Gh,{size:14})})]}),o.jsx("p",{className:"text-sm text-life-text/90 leading-relaxed font-mono whitespace-pre-wrap",children:x.desc||o.jsx("span",{className:"text-life-muted italic",children:"No Description"})}),x.subtasks&&x.subtasks.length>0&&o.jsxs("div",{className:"mt-4 border-t border-zinc-800 pt-4",children:[o.jsxs("h4",{className:"text-[10px] text-life-muted uppercase font-bold mb-2 flex items-center gap-1",children:[o.jsx(gt,{size:12})," Steps"]}),o.jsx("div",{className:"space-y-2",children:x.subtasks.map(Q=>o.jsxs("div",{className:"flex items-center gap-2 p-2 rounded bg-life-black border border-zinc-800",children:[o.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${Q.isCompleted?"bg-life-gold border-life-gold text-life-black":"border-zinc-800"}`,children:o.jsx(gt,{size:12,strokeWidth:3})}),o.jsx("span",{className:`text-xs ${Q.isCompleted?"text-life-muted line-through":"text-life-text"}`,children:Q.title})]},Q.id))})]}),h.type==="raid"&&x.item.steps&&o.jsxs("div",{className:"mt-6 border-t border-zinc-800 pt-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3",children:[o.jsxs("h4",{className:"text-[10px] text-life-muted uppercase font-bold flex items-center gap-1",children:[o.jsx(Lt,{size:12})," Operation Steps"]}),o.jsx("button",{onClick:()=>{const Q={id:`rs_new_${Date.now()}`,title:"New Tactical Step",isCompleted:!1,isLocked:!1,difficulty:x.difficulty,stat:x.stat},ae=[...x.item.steps,Q];d.updateRaid(h.itemId,{steps:ae}),e.addToast("Step Added","success")},className:"text-[9px] bg-life-gold/10 text-life-gold px-2 py-1 rounded border border-life-gold/20 hover:bg-life-gold/20 transition-colors",children:"+ Add Step"})]}),o.jsx("div",{className:"space-y-2",children:x.item.steps.map((Q,ae)=>{var ye;return o.jsxs("div",{className:"flex items-center justify-between p-3 rounded bg-life-black border border-life-muted/20 group hover:border-life-gold/30 transition-all",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-[9px] font-mono text-life-muted opacity-50",children:(ae+1).toString().padStart(2,"0")}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("span",{className:`text-xs font-bold ${Q.isCompleted?"text-life-muted line-through":"text-life-text"}`,children:Q.title}),o.jsxs("div",{className:"flex gap-1 mt-0.5",children:[Q.difficulty&&Q.difficulty!==x.item.difficulty&&o.jsx("span",{className:`text-[7px] font-black uppercase px-1 rounded border ${ui[Q.difficulty]}`,children:Q.difficulty}),Q.stat&&Q.stat!==((ye=x.item.stats)==null?void 0:ye[0])&&o.jsxs("span",{className:"text-[7px] font-black uppercase px-1 rounded border border-life-muted/20 flex items-center gap-0.5",style:{color:ut[Q.stat],borderColor:`${ut[Q.stat]}40`},children:[o.jsx(kf,{stat:Q.stat,size:6})," ",Q.stat]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[o.jsx("button",{onClick:ue=>{ue.stopPropagation(),e.setModal("details",{itemId:Q.id,type:"raid_step",parentId:h.itemId})},className:"p-1.5 rounded bg-life-muted/10 hover:bg-life-gold/20 text-life-muted hover:text-life-gold",children:o.jsx(Tg,{size:10})}),o.jsx("button",{onClick:ue=>{ue.stopPropagation(),d.deleteRaidStep(h.itemId,Q.id)},className:"p-1.5 rounded bg-life-hard/10 hover:bg-life-hard/20 text-life-hard",children:o.jsx(Nn,{size:10})})]})]},Q.id)})})]})]})}),o.jsxs("div",{className:"p-4 bg-life-black border-t border-zinc-800 flex items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:ie,className:"p-2 rounded-lg text-life-hard hover:bg-life-hard/10",children:o.jsx(Nn,{size:16})}),x.canArchive&&o.jsx("button",{onClick:X,className:"p-2 rounded-lg text-life-muted hover:bg-life-muted/10",children:o.jsx(Tu,{size:16})}),o.jsx("button",{onClick:U,className:"p-2 rounded-lg text-life-gold hover:bg-life-gold/10 border border-life-gold/20",title:"Copy JSON Code",children:o.jsx(mi,{size:16})})]}),b?o.jsxs("button",{onClick:Y,className:"px-6 py-2 rounded-lg bg-life-gold text-life-black text-xs font-black uppercase hover:bg-yellow-400 flex items-center gap-2",children:[o.jsx(ZP,{size:14})," Save"]}):o.jsxs("button",{onClick:()=>T(!0),className:"px-6 py-2 rounded-lg border border-zinc-800 bg-life-paper text-life-text hover:text-life-gold text-xs font-black uppercase flex items-center gap-2",children:[o.jsx(Tg,{size:14})," Edit"]})]})]})})},WH=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(""),[i,r]=K.useState(!1),l=()=>{r(!0),setTimeout(()=>{n.resetSystem()},1500)},c=()=>{n.setModal("none")};return o.jsx("div",{className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/95 backdrop-blur-xl animate-in fade-in duration-300",children:o.jsxs("div",{className:"w-full max-w-md bg-[#0f0505] border-2 border-red-600 rounded-2xl shadow-[0_0_50px_rgba(220,38,38,0.3)] overflow-hidden relative flex flex-col animate-in zoom-in-95 slide-in-from-bottom-8 duration-500",children:[o.jsx("div",{className:"h-2 w-full bg-[repeating-linear-gradient(45deg,#dc2626,#dc2626_10px,#000_10px,#000_20px)]"}),o.jsxs("div",{className:"p-6 text-center border-b border-red-900/30 relative",children:[o.jsx("div",{className:"absolute top-4 right-4",children:o.jsx("button",{onClick:c,className:"text-red-800 hover:text-red-500 transition-colors",children:o.jsx(et,{size:24})})}),o.jsx("div",{className:"w-20 h-20 bg-red-900/10 border border-red-600 rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse",children:o.jsx(NN,{size:40,className:"text-red-600"})}),o.jsx("h2",{className:"text-2xl font-black text-red-500 tracking-tighter uppercase mb-1",children:"System Rebirth"}),o.jsx("p",{className:"text-[10px] text-red-400/60 font-mono tracking-widest uppercase",children:"Protocol 99: New Game Plus"})]}),o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"text-center text-sm text-red-200/80 leading-relaxed font-medium",children:["Are you sure you want to wipe the current timeline? This action is ",o.jsx("span",{className:"text-red-500 font-bold underline decoration-red-500/50",children:"irreversible"}),"."]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"bg-red-950/20 border border-red-900/50 rounded-xl p-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-red-500 mb-2 border-b border-red-900/30 pb-2",children:[o.jsx(Nn,{size:14}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider",children:"Deleted"})]}),o.jsxs("ul",{className:"space-y-1.5",children:[o.jsxs("li",{className:"text-[10px] text-red-300 flex items-center gap-2",children:[o.jsx("span",{className:"w-1 h-1 bg-red-500 rounded-full"})," Active Missions"]}),o.jsxs("li",{className:"text-[10px] text-red-300 flex items-center gap-2",children:[o.jsx("span",{className:"w-1 h-1 bg-red-500 rounded-full"})," Habit Streaks"]}),o.jsxs("li",{className:"text-[10px] text-red-300 flex items-center gap-2",children:[o.jsx("span",{className:"w-1 h-1 bg-red-500 rounded-full"})," Raid Progress"]}),o.jsxs("li",{className:"text-[10px] text-red-300 flex items-center gap-2",children:[o.jsx("span",{className:"w-1 h-1 bg-red-500 rounded-full"})," Gold & XP"]})]})]}),o.jsxs("div",{className:"bg-green-950/20 border border-green-900/30 rounded-xl p-3",children:[o.jsxs("div",{className:"flex items-center gap-2 text-green-500 mb-2 border-b border-green-900/30 pb-2",children:[o.jsx(mh,{size:14}),o.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider",children:"Preserved"})]}),o.jsxs("ul",{className:"space-y-1.5",children:[o.jsxs("li",{className:"text-[10px] text-green-300/80 flex items-center gap-2",children:[o.jsx(gt,{size:10})," Earned Badges"]}),o.jsxs("li",{className:"text-[10px] text-green-300/80 flex items-center gap-2",children:[o.jsx(gt,{size:10})," Store Items"]}),o.jsxs("li",{className:"text-[10px] text-green-300/80 flex items-center gap-2",children:[o.jsx(gt,{size:10})," Unlocked Themes"]}),o.jsxs("li",{className:"text-[10px] text-green-300/80 flex items-center gap-2",children:[o.jsx(gt,{size:10})," Skill Trees (Lvl 1)"]})]})]})]})]}),o.jsxs("div",{className:"p-6 pt-0",children:[o.jsx("button",{onClick:l,disabled:i,className:`
                            w-full py-4 rounded-xl font-black uppercase tracking-[0.2em] flex items-center justify-center gap-3 transition-all
                            ${i?"bg-red-900 cursor-wait text-red-400":"bg-red-600 hover:bg-red-500 text-black shadow-[0_0_20px_rgba(220,38,38,0.5)] hover:scale-[1.02] active:scale-[0.98]"}
                        `,children:i?o.jsxs(o.Fragment,{children:[o.jsx(SN,{size:18,className:"animate-spin"}),"Wiping System..."]}):o.jsxs(o.Fragment,{children:[o.jsx(hr,{size:18,fill:"currentColor",className:"text-red-900"}),"EXECUTE REBIRTH"]})}),!i&&o.jsx("button",{onClick:c,className:"w-full mt-3 py-2 text-[10px] font-bold text-red-500/50 uppercase tracking-widest hover:text-red-400",children:"Cancel Operation"})]})]})})},QH=()=>{const{state:n,dispatch:e}=Ve(),{modalData:t}=n.ui;if(!t)return null;const{title:i,message:r,onConfirm:l,confirmText:c="Confirm",isDangerous:d=!1}=t,p=()=>{l&&l(),e.setModal("none")};return o.jsx("div",{onClick:()=>e.setModal("none"),className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{onClick:h=>h.stopPropagation(),className:"bg-life-paper border border-life-muted/20 w-full max-w-sm rounded-xl shadow-2xl p-6 relative overflow-hidden",children:[d&&o.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-life-hard"}),o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("h3",{className:"text-lg font-black text-life-text uppercase tracking-tight flex items-center gap-2",children:[d&&o.jsx(hr,{size:20,className:"text-life-hard"}),i||"Confirmation"]}),o.jsx("button",{onClick:()=>e.setModal("none"),className:"text-life-muted hover:text-white",children:o.jsx(et,{size:18})})]}),o.jsx("p",{className:"text-sm text-life-muted mb-6 leading-relaxed font-medium",children:r}),o.jsxs("div",{className:"flex gap-3",children:[o.jsx("button",{onClick:()=>e.setModal("none"),className:"flex-1 py-3 rounded-lg border border-life-muted/20 text-life-muted hover:text-life-text text-xs font-bold uppercase tracking-wider transition-colors",children:"Cancel"}),o.jsxs("button",{onClick:p,className:`flex-1 py-3 rounded-lg text-xs font-bold uppercase tracking-wider flex items-center justify-center gap-2 transition-all shadow-lg ${d?"bg-life-hard text-life-black hover:bg-red-500":"bg-life-gold text-life-black hover:bg-yellow-400"}`,children:[d?o.jsx(Nn,{size:14}):o.jsx(gt,{size:14}),c]})]})]})})},ZH=()=>{const{state:n,dispatch:e}=Ve(),{modalData:t}=n.ui;if(!t)return null;const{title:i,xp:r,gold:l,multiplier:c,message:d}=t,p=()=>{e.setModal("none")};return o.jsx("div",{onClick:p,className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/95 backdrop-blur-md animate-in fade-in duration-200",children:o.jsxs("div",{onClick:h=>h.stopPropagation(),className:"relative w-full max-w-sm flex flex-col items-center text-center animate-in zoom-in-50 slide-in-from-bottom-12 duration-500",children:[o.jsx("div",{className:"absolute inset-0 bg-life-gold/30 blur-[80px] rounded-full animate-pulse-slow pointer-events-none"}),o.jsx("div",{className:"absolute inset-0 bg-life-diamond/20 blur-[120px] rounded-full animate-pulse pointer-events-none"}),o.jsxs("div",{className:"relative mb-6",children:[o.jsx("div",{className:"w-28 h-28 rounded-full bg-life-gold border-4 border-life-black shadow-[0_0_50px_rgba(251,191,36,0.8)] flex items-center justify-center animate-[bounce_1s_infinite]",children:o.jsx(dt,{size:56,className:"text-life-black fill-life-black"})}),o.jsx(gh,{className:"absolute -top-4 -right-4 text-life-diamond animate-spin-slow w-10 h-10"}),o.jsx(gh,{className:"absolute bottom-0 -left-4 text-life-easy animate-pulse w-8 h-8"})]}),o.jsxs("div",{className:"space-y-2 mb-8 relative z-10",children:[o.jsx("h3",{className:"text-xs font-black uppercase tracking-[0.4em] text-life-gold animate-pulse",children:"Critical Success"}),o.jsx("h1",{className:"text-3xl font-black text-white tracking-tighter drop-shadow-2xl italic",children:i}),o.jsx("p",{className:"text-life-muted text-xs font-mono bg-black/50 px-3 py-1 rounded border border-life-muted/30 inline-block",children:d})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full mb-8 relative z-10",children:[o.jsxs("div",{className:"bg-life-paper/90 border border-life-gold/50 px-4 py-4 rounded-2xl shadow-[0_0_20px_rgba(251,191,36,0.2)] flex flex-col items-center",children:[o.jsx("span",{className:"text-[10px] text-life-muted uppercase font-bold tracking-widest mb-1",children:"XP Gain"}),o.jsxs("div",{className:"flex items-baseline gap-1",children:[o.jsx("span",{className:"text-2xl font-black text-life-text",children:r}),o.jsxs("span",{className:"text-xs font-bold text-life-gold bg-life-gold/10 px-1 rounded",children:["x",c]})]})]}),o.jsxs("div",{className:"bg-life-paper/90 border border-life-gold/50 px-4 py-4 rounded-2xl shadow-[0_0_20px_rgba(251,191,36,0.2)] flex flex-col items-center",children:[o.jsx("span",{className:"text-[10px] text-life-muted uppercase font-bold tracking-widest mb-1",children:"Gold Loot"}),o.jsxs("div",{className:"flex items-baseline gap-1",children:[o.jsx("span",{className:"text-2xl font-black text-life-gold",children:l}),o.jsxs("span",{className:"text-xs font-bold text-life-gold bg-life-gold/10 px-1 rounded",children:["x",c]})]})]})]}),o.jsx("button",{onClick:p,className:"w-full py-4 rounded-xl font-black uppercase tracking-widest text-black bg-life-gold shadow-[0_0_30px_rgba(251,191,36,0.6)] hover:scale-105 active:scale-95 transition-all relative z-10",children:"Claim Rewards"})]})})},eF=()=>{const{state:n,dispatch:e}=Ve(),{taskState:t,taskDispatch:i}=Zn(),{habitState:r,habitDispatch:l}=ei(),{modalData:c}=n.ui,[d,p]=K.useState("");if(!c||!c.itemId)return null;const{itemId:h,type:x}=c;let b="Item";if(x==="task"){const S=t.tasks.find(E=>E.id===h);S&&(b=S.title)}else if(x==="habit"){const S=r.habits.find(E=>E.id===h);S&&(b=S.title)}const T=S=>{if(S.preventDefault(),!d.trim())return;const E={id:`st_quick_${Date.now()}`,title:d.trim(),isCompleted:!1};if(x==="task"){const D=t.tasks.find(k=>k.id===h);D&&i.updateTask(h,{subtasks:[...D.subtasks,E]})}else if(x==="habit"){const D=r.habits.find(k=>k.id===h);D&&l.updateHabit(h,{subtasks:[...D.subtasks,E]})}e.addToast("Side Mission Added","success"),e.setModal("none")};return o.jsx("div",{onClick:()=>e.setModal("none"),className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/90 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{onClick:S=>S.stopPropagation(),className:"bg-life-paper border border-life-gold/30 w-full max-w-sm rounded-xl shadow-2xl p-6 relative",children:[o.jsxs("div",{className:"flex justify-between items-start mb-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-black text-life-gold uppercase tracking-widest mb-1",children:"Add Side Mission"}),o.jsx("p",{className:"text-sm font-bold text-white truncate max-w-[200px]",children:b})]}),o.jsx("button",{onClick:()=>e.setModal("none"),className:"text-life-muted hover:text-white",children:o.jsx(et,{size:20})})]}),o.jsxs("form",{onSubmit:T,children:[o.jsx("input",{type:"text",value:d,onChange:S=>p(S.target.value),placeholder:"Type additional requirement...",autoFocus:!0,className:"w-full bg-life-black border border-life-muted/30 rounded-lg p-3 text-life-text focus:border-life-gold outline-none mb-4"}),o.jsxs("button",{type:"submit",className:"w-full py-3 bg-life-gold text-life-black font-black uppercase tracking-widest rounded-lg hover:bg-yellow-400 flex items-center justify-center gap-2",children:[o.jsx(gt,{size:16})," Confirm"]})]})]})})},tF=()=>{const{state:n,dispatch:e}=Ve(),{modalData:t}=n.ui,i=(t==null?void 0:t.mode)||"export",r=(t==null?void 0:t.title)||(i==="export"?"System Backup":"Neural Injection Protocol"),l=(t==null?void 0:t.data)||"",[c,d]=K.useState(l),[p,h]=K.useState(!1),x=K.useRef(null),b=()=>{e.setModal("none")},T=()=>{x.current&&(x.current.select(),navigator.clipboard.writeText(c),h(!0),Ce("success",!0),e.addToast("Copied to Clipboard","success"),setTimeout(()=>h(!1),2e3))},S=()=>{const E=new Blob([c],{type:"application/json"}),D=URL.createObjectURL(E),k=document.createElement("a");k.href=D,k.download=`lifeos-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(D),e.addToast("Backup Downloaded","success"),Ce("success",!0)};return o.jsx("div",{onClick:b,className:"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/95 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{onClick:E=>E.stopPropagation(),className:"bg-life-black border border-life-gold/30 w-full max-w-lg rounded-xl shadow-2xl flex flex-col h-[85vh] relative overflow-hidden",children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-life-muted/20 bg-life-paper/50 shrink-0",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[i==="export"?o.jsx(dh,{size:18,className:"text-life-gold"}):o.jsx(qh,{size:18,className:"text-life-easy"}),o.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-life-text",children:r})]}),o.jsx("button",{onClick:b,className:"text-life-muted hover:text-white",children:o.jsx(et,{size:20})})]}),o.jsx("div",{className:"flex-1 p-4 relative overflow-hidden flex flex-col",children:i==="import"?o.jsx("div",{className:"h-full overflow-y-auto pr-1",children:o.jsx(M2,{onClose:b})}):o.jsxs(o.Fragment,{children:[o.jsx("textarea",{ref:x,value:c,onChange:E=>d(E.target.value),readOnly:!0,className:"w-full h-full bg-[#050505] rounded-lg border border-life-muted/20 p-4 font-mono text-[10px] leading-relaxed resize-none focus:outline-none text-life-gold focus:border-life-gold/50 cursor-text",spellCheck:!1,onClick:E=>E.target.select()}),o.jsx("div",{className:"absolute bottom-6 right-6 text-[9px] text-life-muted/50 pointer-events-none",children:"SYSTEM DUMP // READ ONLY"})]})}),i==="export"&&o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/50 shrink-0 flex gap-3",children:[o.jsxs("button",{onClick:S,className:"flex-1 py-3 rounded-lg font-bold uppercase tracking-widest flex items-center justify-center gap-2 transition-all bg-life-gold text-black hover:bg-yellow-400 shadow-[0_0_15px_rgba(251,191,36,0.3)]",children:[o.jsx(dh,{size:16}),"Download JSON"]}),o.jsx("button",{onClick:T,className:`px-6 py-3 rounded-lg font-bold uppercase tracking-widest flex items-center justify-center gap-2 transition-all border border-life-muted/30 hover:bg-white/5 ${p?"text-life-easy border-life-easy":"text-life-muted"}`,children:p?o.jsx(gt,{size:16}):o.jsx(mi,{size:16})})]})]})})},nF=()=>{const{state:n,dispatch:e}=Ve(),{user:t}=n,{taskState:i}=Zn(),{habitState:r}=ei(),{raidState:l}=ss(),[c,d]=K.useState("today"),{historyData:p,monthAverage:h,monthName:x,year:b,startOffset:T,daysInMonth:S}=K.useMemo(()=>{const H=t.honorDailyLog||{},z=n.ui.debugDate?new Date(n.ui.debugDate):new Date,R=z.getFullYear(),C=z.getMonth(),A=[],P=new Date(R,C+1,0).getDate();for(let j=1;j<=P;j++){const q=`${R}-${String(C+1).padStart(2,"0")}-${String(j).padStart(2,"0")}`,le=H[q];A.push({date:j,score:le,fullDate:q})}const L=A.filter(j=>j.score!==void 0).map(j=>j.score),O=L.length>0?Math.round(L.reduce((j,q)=>j+q,0)/L.length):0;return{historyData:A,monthAverage:O,monthName:z.toLocaleString("default",{month:"long"}),year:R,startOffset:new Date(R,C,1).getDay(),daysInMonth:P}},[t.honorDailyLog,n.ui.debugDate]),{items:E,totalWeight:D}=K.useMemo(()=>BS(i.tasks,r.habits,l.raids,n.ui.debugDate),[i.tasks,r.habits,l.raids,n.ui.debugDate]),k=()=>{e.setModal("none")},F=H=>H==="task"?o.jsx(is,{size:12}):H==="habit"?o.jsx(Qn,{size:12}):o.jsx(ua,{size:12}),$=E.filter(H=>H.isCompleted).reduce((H,z)=>H+z.weight,0),M=D>0?Math.round($/D*100):100,J=H=>H===void 0?"bg-life-muted/5 border-life-muted/10 text-life-muted/30":H>=100?"bg-life-crimson/20 border-life-crimson text-life-crimson shadow-[0_0_10px_rgba(220,38,38,0.2)]":H>=90?"bg-cyan-500/20 border-cyan-500 text-cyan-400 shadow-[0_0_8px_rgba(34,211,238,0.2)]":H>=80?"bg-life-gold/20 border-life-gold text-life-gold":H>=60?"bg-indigo-500/20 border-indigo-500 text-indigo-400":"bg-red-500/20 border-red-500 text-red-500";return o.jsx("div",{onClick:k,className:"fixed inset-0 z-[150] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{onClick:H=>H.stopPropagation(),className:"bg-life-black border border-indigo-500/30 w-full max-w-md rounded-2xl overflow-hidden shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-8 duration-500 flex flex-col max-h-[85vh]",children:[o.jsxs("div",{className:"p-5 border-b border-indigo-500/10 bg-indigo-950/20 flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsxs("h2",{className:"text-lg font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2",children:[o.jsx(po,{size:20})," Honor Protocol"]}),o.jsx("p",{className:"text-[10px] text-indigo-300/60 mt-1 uppercase tracking-wider",children:c==="today"?"Daily Integrity Breakdown":"Monthly Integrity Log"})]}),o.jsx("button",{onClick:k,className:"text-life-muted hover:text-white",children:o.jsx(et,{size:20})})]}),c==="today"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"p-6 flex flex-col items-center border-b border-life-muted/10 bg-life-black/50 animate-in slide-in-from-left-4 duration-300",children:[o.jsxs("div",{className:"text-4xl font-black text-white font-mono mb-2",children:[M,"%"]}),o.jsx("div",{className:"text-[9px] text-life-muted uppercase font-bold tracking-widest mb-4",children:"Projected Daily Score"}),o.jsx("div",{className:"w-full max-w-[200px] h-1.5 bg-life-muted/20 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-indigo-500 transition-all duration-700",style:{width:`${M}%`}})}),o.jsxs("button",{onClick:()=>d("history"),className:"mt-6 flex items-center gap-2 px-4 py-2 rounded-lg bg-life-paper border border-life-muted/20 hover:border-indigo-500/50 hover:text-indigo-400 transition-all text-[10px] font-bold uppercase tracking-wider",children:[o.jsx(Wn,{size:14}),"View Monthly History"]})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 animate-in slide-in-from-bottom-4 duration-300",children:[o.jsx("div",{className:"flex items-center justify-between mb-2",children:o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-life-muted",children:"Today's Obligations"})}),E.length===0?o.jsx("div",{className:"text-center py-8 text-life-muted/50 italic text-xs",children:"No obligations scheduled for today."}):E.map(H=>o.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border transition-all ${H.isCompleted?"bg-life-black border-life-muted/10 opacity-50":"bg-life-paper border-life-muted/20"}`,children:[o.jsx("div",{className:"flex flex-col items-center justify-center w-10 h-10 rounded bg-indigo-500/10 border border-indigo-500/20 text-indigo-400 font-bold font-mono",children:o.jsxs("span",{className:"text-xs",children:[H.percentage,"%"]})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-0.5",children:[o.jsx("div",{className:`text-[9px] uppercase font-black px-1.5 py-px rounded border ${ui[H.difficulty]}`,children:H.difficulty}),o.jsxs("div",{className:"text-life-muted/50 flex items-center gap-1 text-[9px] uppercase font-bold",children:[F(H.type)," ",H.type]})]}),o.jsx("div",{className:`text-xs font-bold truncate ${H.isCompleted?"line-through text-life-muted":"text-life-text"}`,children:H.title})]}),o.jsx("div",{children:H.isCompleted?o.jsx(Os,{size:16,className:"text-life-easy"}):o.jsx(A4,{size:16,className:"text-life-hard animate-pulse"})})]},`${H.type}-${H.id}`))]})]}):o.jsx(o.Fragment,{children:o.jsxs("div",{className:"flex-1 flex flex-col p-4 animate-in slide-in-from-right-4 duration-300",children:[o.jsxs("div",{className:"flex items-center justify-between mb-6",children:[o.jsxs("button",{onClick:()=>d("today"),className:"flex items-center gap-2 text-[10px] font-bold uppercase tracking-wider text-life-muted hover:text-white transition-colors",children:[o.jsx(hN,{size:14})," Back"]}),o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsx("span",{className:"text-[8px] font-bold uppercase tracking-widest text-life-muted",children:"Month Average"}),o.jsxs("span",{className:`text-lg font-black font-mono ${h>=90?"text-life-gold":"text-indigo-400"}`,children:[h,"%"]})]})]}),o.jsx("div",{className:"mb-4 text-center",children:o.jsxs("h3",{className:"text-sm font-black uppercase tracking-widest text-white",children:[x," ",b]})}),o.jsxs("div",{className:"grid grid-cols-7 gap-2 mb-4",children:[["S","M","T","W","T","F","S"].map((H,z)=>o.jsx("div",{className:"text-center text-[8px] font-bold text-life-muted/30",children:H},z)),Array.from({length:T}).map((H,z)=>o.jsx("div",{className:"aspect-square"},`empty-${z}`)),p.map(H=>o.jsxs("div",{className:`
                                            aspect-square rounded-lg border flex flex-col items-center justify-center relative group cursor-default
                                            ${J(H.score)}
                                        `,children:[o.jsx("span",{className:"text-[10px] font-bold",children:H.date}),H.score!==void 0&&o.jsxs("span",{className:"text-[8px] font-mono opacity-80",children:[H.score,"%"]}),H.score!==void 0&&o.jsxs("div",{className:"absolute bottom-full mb-2 hidden group-hover:flex flex-col items-center bg-life-black border border-life-muted/20 p-2 rounded-lg z-10 shadow-xl whitespace-nowrap pointer-events-none",children:[o.jsx("span",{className:"text-[10px] font-bold text-white",children:H.fullDate}),o.jsxs("span",{className:`text-xs font-black ${H.score>=100?"text-life-gold":"text-life-muted"}`,children:[H.score,"%"]})]})]},H.date))]}),o.jsx("div",{className:"mt-auto p-3 bg-indigo-950/20 border border-indigo-500/10 rounded-lg text-[10px] text-indigo-300/60 text-center",children:"Calendar reflects recorded daily integrity scores."})]})}),o.jsx("div",{className:"p-3 bg-indigo-950/20 border-t border-indigo-500/10 text-[9px] text-indigo-300/60 text-center",children:c==="today"?"Harder tasks carry more weight. Failure hurts more.":"Consistency builds the strongest alloy."})]})})},iF=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(!1),i=`ROLE: You are "The Quest Forge" ( ).
GOAL: Generate RPG-style quests (Tasks) for a high-performance individual.

WHEN I ASK FOR A MISSION, OUTPUT A VALID JSON OBJECT.
DO NOT CHAT. JUST OUTPUT THE JSON.

--- INPUT ---
I will describe a goal, or provide an existing Task JSON to modify.

--- OUTPUT RULES ---
1. **Updates:** If I provide an "id" (e.g., "t_123..."), YOU MUST include it in the output to UPDATE that task instead of creating a new one.
2. **Title:** Action-oriented (e.g., "Operation: Deep Dive").
3. **Difficulty:** "easy" (Scout), "normal" (Infantry), "hard" (SpecOps).
4. **Stat:** [STR, INT, DIS, HEA, CRT, SPR, REL, FIN].
5. **Skill Link:** If known, link to a skill ID (e.g., "s_coding").
6. **Reminders:** Array of minutes before due (e.g., [15, 60] = 15 mins & 1 hour before).
7. **Campaign:** Set "isCampaign": true if this is a strategic quarterly goal (G12).
8. **Time:**
   - "scheduledTime": ISO String (YYYY-MM-DDTHH:mm) for specific execution time.
   - "deadline": YYYY-MM-DD for due date.
   - "durationMinutes": Number (if timed session).

--- JSON TEMPLATE ---

\`\`\`json
{
  "tasks": [
    {
      "id": "OPTIONAL_ID_FOR_UPDATE",
      "title": "QUEST_TITLE",
      "difficulty": "hard",
      "stat": "INT",
      "skillId": "OPTIONAL_SKILL_ID",
      "description": " Objective: ... \\n Skill: ...",
      "subtasks": [
        "Step 1 (5m)",
        "Step 2 (10m)"
      ],
      "reminders": [15, 30],
      "isTimed": true,
      "durationMinutes": 45,
      "scheduledTime": "2024-10-25T09:00:00",
      "deadline": "2024-10-25",
      "energyLevel": "high",
      "isCampaign": false
    }
  ],
  "habits": [
    {
      "title": "HABIT_TITLE",
      "difficulty": "normal",
      "stat": "DIS",
      "skillId": "OPTIONAL_SKILL_ID",
      "type": "daily",
      "dailyTarget": 5,
      "description": "e.g. Drink 5 glasses of water"
    }
  ]
}
\`\`\`

--- EXAMPLES ---

**Input:** "Study Physics tomorrow at 10 AM, remind me 30 mins before."
**Output:**
\`\`\`json
{
  "tasks": [
    {
      "title": "Operation: Quantum Mechanics",
      "difficulty": "hard",
      "stat": "INT",
      "description": " Focus: Thermodynamics Chapter 4.",
      "subtasks": ["Review Notes", "Solve 3 Problems"],
      "scheduledTime": "2024-10-26T10:00:00",
      "reminders": [30],
      "isTimed": true,
      "durationMinutes": 60
    }
  ]
}
\`\`\`

**Input:** "Update task 't_999' to be harder and add a subtask."
**Output:**
\`\`\`json
{
  "tasks": [
    {
      "id": "t_999",
      "difficulty": "hard",
      "subtasks": ["Original Step 1", "New Step 2"]
    }
  ]
}
\`\`\``,r=()=>{navigator.clipboard.writeText(i),t(!0),setTimeout(()=>t(!1),2e3)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-life-black border border-life-gold/30 rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl shadow-life-gold/10",children:[o.jsxs("div",{className:"p-4 border-b border-life-muted/20 flex items-center justify-between bg-life-paper/50 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-life-gold/10 rounded-lg text-life-gold border border-life-gold/20",children:o.jsx(tn,{size:20})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-life-gold flex items-center gap-2",children:["The Quest Forge ",o.jsx("span",{className:"text-[9px] bg-life-gold text-black px-1.5 rounded font-mono",children:"V5"})]}),o.jsx("p",{className:"text-[10px] text-life-muted font-mono",children:"AI Protocol Configuration"})]})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[o.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 flex gap-3",children:[o.jsx("div",{className:"text-blue-400 mt-1",children:o.jsx(fa,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-bold text-blue-300 uppercase mb-1",children:"How to Initialize"}),o.jsxs("ol",{className:"text-[10px] text-life-muted space-y-1 list-decimal list-inside marker:text-blue-500",children:[o.jsx("li",{children:"Copy the System Prompt below."}),o.jsxs("li",{children:["Open ",o.jsx("strong",{children:"Google Gemini"})," (or any AI Chat)."]}),o.jsxs("li",{children:["Paste the text into the ",o.jsx("strong",{children:'"System Instructions"'})," or start a new chat with it."]}),o.jsx("li",{children:'Command the AI to generate tasks (e.g., "Study for exam").'}),o.jsxs("li",{children:["Copy the JSON output and paste it into ",o.jsx("strong",{children:"Data Injection"}),"."]})]})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all shadow-lg ${e?"bg-green-500 text-black":"bg-life-gold text-black hover:bg-yellow-400"}`,children:[e?o.jsx(gt,{size:12}):o.jsx(mi,{size:12}),e?"Copied!":"Copy Protocol"]})}),o.jsx("div",{className:"bg-black border border-life-muted/20 rounded-xl p-4 font-mono text-[10px] text-life-muted/80 whitespace-pre-wrap leading-relaxed overflow-x-auto h-96 custom-scrollbar selection:bg-life-gold/30 selection:text-white",children:i})]})]}),o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/30 rounded-b-2xl flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-life-muted opacity-50",children:[o.jsx(zn,{size:12}),o.jsx("span",{children:"Compatible with Gemini 1.5+, GPT-4, Claude 3"})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"px-4 py-2 rounded-lg bg-life-muted/10 hover:bg-life-muted/20 text-xs font-bold text-life-muted transition-colors",children:"Close"})]})]})})},sF=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(!1),i=`ROLE: You are "The Protocol Foundry" ( ).
GOAL: Design sustainable Habits (Protocols).

WHEN I ASK FOR A HABIT, OUTPUT A VALID JSON OBJECT.
DO NOT CHAT. JUST OUTPUT THE JSON.

--- INPUT ---
I will describe a routine, or provide an existing Habit JSON to modify.

--- OUTPUT RULES ---
1. **Updates:** If I provide an "id" (e.g., "h_123..."), YOU MUST include it to UPDATE the habit.
2. **Algorithm (Type):** "daily", "specific_days" (requires "specificDays": [0-6]), "interval" (requires "intervalValue": number).
3. **Repetitions:** Use "dailyTarget" (number) for habits that repeat within a day (e.g., "Drink Water" with dailyTarget: 8).
4. **Subtasks:** Habits can have steps! (e.g., Routine -> [Drink Water, Stretch]).
5. **Difficulty:** "easy", "normal", "hard".
6. **Stat:** Primary attribute [STR, INT, DIS, HEA, CRT, SPR, REL, FIN].
7. **Skill Link:** If known, link to a skill ID (e.g., "s_coding").
8. **Reminders:** Array of minutes before (e.g., [0, 10]).
9. **Time:** "scheduledTime" (24h format "HH:mm").

--- JSON TEMPLATE ---

\`\`\`json
{
  "habits": [
    {
      "id": "OPTIONAL_ID_FOR_UPDATE",
      "title": "HABIT_TITLE",
      "stat": "DIS",
      "skillId": "OPTIONAL_SKILL_ID",
      "difficulty": "normal",
      "type": "daily", 
      "dailyTarget": 1,
      "scheduledTime": "07:00",
      "reminders": [0],
      "subtasks": [
        { "title": "Step 1" },
        { "title": "Step 2" }
      ],
      "description": " Cue: ..."
    }
  ]
}
\`\`\`

--- EXAMPLES ---

**Input:** "Create a Morning Routine (Water, Meditate, Plan) at 6 AM."
**Output:**
\`\`\`json
{
  "habits": [
    {
      "title": "Protocol: Morning Prime",
      "stat": "SPR",
      "difficulty": "hard",
      "type": "daily",
      "dailyTarget": 1,
      "scheduledTime": "06:00",
      "reminders": [0],
      "subtasks": [
        { "title": "Hydrate (500ml)" },
        { "title": "Meditate (10m)" },
        { "title": "Tactical Planning" }
      ]
    }
  ]
}
\`\`\`

**Input:** "Drink 8 glasses of water daily."
**Output:**
\`\`\`json
{
  "habits": [
    {
      "title": "Protocol: Hydration",
      "stat": "HEA",
      "difficulty": "easy",
      "type": "daily",
      "dailyTarget": 8,
      "description": " Goal: 8 glasses (250ml each)."
    }
  ]
}
\`\`\`

**Input:** "Update habit 'h_555' to be every 2 days."
**Output:**
\`\`\`json
{
  "habits": [
    {
      "id": "h_555",
      "type": "interval",
      "intervalValue": 2
    }
  ]
}
\`\`\``,r=()=>{navigator.clipboard.writeText(i),t(!0),setTimeout(()=>t(!1),2e3)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-life-black border border-life-easy/30 rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl shadow-life-easy/10",children:[o.jsxs("div",{className:"p-4 border-b border-life-muted/20 flex items-center justify-between bg-life-paper/50 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-life-easy/10 rounded-lg text-life-easy border border-life-easy/20",children:o.jsx(Lt,{size:20})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-life-easy flex items-center gap-2",children:["The Protocol Foundry ",o.jsx("span",{className:"text-[9px] bg-life-easy text-black px-1.5 rounded font-mono",children:"V2"})]}),o.jsx("p",{className:"text-[10px] text-life-muted font-mono",children:"Habit Engineering Protocol"})]})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[o.jsxs("div",{className:"bg-life-easy/10 border border-life-easy/20 rounded-xl p-4 flex gap-3",children:[o.jsx("div",{className:"text-life-easy mt-1",children:o.jsx(fa,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-bold text-life-easy uppercase mb-1",children:"How to Initialize"}),o.jsxs("ol",{className:"text-[10px] text-life-muted space-y-1 list-decimal list-inside marker:text-life-easy",children:[o.jsx("li",{children:"Copy the System Prompt below."}),o.jsxs("li",{children:["Open ",o.jsx("strong",{children:"Google Gemini"})," (or any AI Chat)."]}),o.jsxs("li",{children:["Paste the text into the ",o.jsx("strong",{children:'"System Instructions"'}),"."]}),o.jsx("li",{children:'Command the AI to design habits (e.g., "Build a morning routine").'}),o.jsxs("li",{children:["Copy the JSON output and paste it into ",o.jsx("strong",{children:"Data Injection"}),"."]})]})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all shadow-lg ${e?"bg-green-500 text-black":"bg-life-easy text-black hover:bg-emerald-400"}`,children:[e?o.jsx(gt,{size:12}):o.jsx(mi,{size:12}),e?"Copied!":"Copy Protocol"]})}),o.jsx("div",{className:"bg-black border border-life-muted/20 rounded-xl p-4 font-mono text-[10px] text-life-muted/80 whitespace-pre-wrap leading-relaxed overflow-x-auto h-96 custom-scrollbar selection:bg-life-easy/30 selection:text-white",children:i})]})]}),o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/30 rounded-b-2xl flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-life-muted opacity-50",children:[o.jsx(zn,{size:12}),o.jsx("span",{children:"Compatible with Gemini 1.5+, GPT-4, Claude 3"})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"px-4 py-2 rounded-lg bg-life-muted/10 hover:bg-life-muted/20 text-xs font-bold text-life-muted transition-colors",children:"Close"})]})]})})},rF=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(!1),i=`ROLE: You are "The Treasury Archive" ( ).
GOAL: Understand the LifeOS Economy (XP, Gold, & Stats) to advise on growth strategies.

--- 1. CURRENCY & GROWTH ---
- **XP (Experience):** Levels up the User and Skills.
- **Gold (G):** Currency to buy Items, Themes, and Potions.
- **Stats (Attributes):** Core attributes (STR, INT, DIS, etc.) that level up based on actions.

--- 2. INCOME SOURCES (REVENUE STREAMS) ---

A. ACTIVE DUTY (Tasks & Habits)
   - **Easy:** 
     - XP: 20 | Gold: 10
     - Stat Points: +0.5 (to the linked Stat)
   - **Normal:** 
     - XP: 50 | Gold: 30
     - Stat Points: +1 (to the linked Stat)
   - **Hard:** 
     - XP: 100 | Gold: 100
     - Stat Points: +2 (to the linked Stat)
   
   * Note: Habits build "Streaks". High streaks increase "Daily Salary".
   * **Repetitions (Reps):** Habits can have a "Daily Target" (e.g., Drink Water 8x). 
     - Rewards and Streaks are ONLY awarded after ALL reps are completed.
     - Partial reps do not grant XP/Gold but prevent "Failure" penalties if at least 1 rep is done.

B. OPERATIONS (Raids)
   - **Raid Step (Sub-objective):** 
     - Treated as a Task based on difficulty (Easy/Normal/Hard).
     - Grants XP, Gold, and Stat Points immediately upon completion.
   - **Raid Completion (Victory):** 
     - **Bonus:** 5x the rewards of the final step.
     - **Loot:** Chance for rare items or badges.

C. DAILY SALARY (The Streak)
   - **Easy Mode:** Requires 300 XP.
   - **Normal Mode:** Requires 400 XP.
   - **Hard Mode:** Requires 500 XP.
   - Reward: 50-200 Gold (Scales with Streak length).

D. ACHIEVEMENTS (Badges)
   - **Bronze:** 500 XP | 100 G
   - **Silver:** 1000 XP | 250 G
   - **Gold:** 2000 XP | 500 G
   - **Diamond:** 5000 XP | 1000 G

--- 3. EXPENDITURES (GOLD USAGE) ---
- **Potions:** Restore Energy or Health (Cost: 50-150 G).
- **Artifacts:** Permanent buffs to XP/Gold gain (Cost: 500-5000 G).
- **Themes:** Visual skins for the OS (Cost: 1000+ G).
- **Penalties:** Failing tasks/habits deducts Gold.

--- 4. SKILL MASTERY ---
- Every Task/Habit linked to a Skill (e.g., "Coding") feeds 50% of its XP to that Skill.
- Leveling Skills unlocks specialized Badges.

--- HOW TO USE THIS DATA ---
When I ask "How do I get rich?" or "Plan my leveling", use these values to calculate the optimal path.`,r=()=>{navigator.clipboard.writeText(i),t(!0),setTimeout(()=>t(!1),2e3)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-life-black border border-life-gold/30 rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl shadow-life-gold/10",children:[o.jsxs("div",{className:"p-4 border-b border-life-muted/20 flex items-center justify-between bg-life-paper/50 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-life-gold/10 rounded-lg text-life-gold border border-life-gold/20",children:o.jsx(pi,{size:20})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-life-gold flex items-center gap-2",children:["The Treasury Archive ",o.jsx("span",{className:"text-[9px] bg-life-gold text-black px-1.5 rounded font-mono",children:"V1"})]}),o.jsx("p",{className:"text-[10px] text-life-muted font-mono",children:"Economy Logic Protocol"})]})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[o.jsxs("div",{className:"bg-life-gold/10 border border-life-gold/20 rounded-xl p-4 flex gap-3",children:[o.jsx("div",{className:"text-life-gold mt-1",children:o.jsx(fa,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-bold text-life-gold uppercase mb-1",children:"How to Initialize"}),o.jsxs("ol",{className:"text-[10px] text-life-muted space-y-1 list-decimal list-inside marker:text-life-gold",children:[o.jsx("li",{children:"Copy the System Prompt below."}),o.jsxs("li",{children:["Paste it into your AI's ",o.jsx("strong",{children:'"System Instructions"'}),"."]}),o.jsx("li",{children:"Now the AI understands how to reward you and plan your economy."})]})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all shadow-lg ${e?"bg-green-500 text-black":"bg-life-gold text-black hover:bg-yellow-400"}`,children:[e?o.jsx(gt,{size:12}):o.jsx(mi,{size:12}),e?"Copied!":"Copy Protocol"]})}),o.jsx("div",{className:"bg-black border border-life-muted/20 rounded-xl p-4 font-mono text-[10px] text-life-muted/80 whitespace-pre-wrap leading-relaxed overflow-x-auto h-96 custom-scrollbar selection:bg-life-gold/30 selection:text-white",children:i})]})]}),o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/30 rounded-b-2xl flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-life-muted opacity-50",children:[o.jsx(zn,{size:12}),o.jsx("span",{children:"Compatible with Gemini 1.5+, GPT-4, Claude 3"})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"px-4 py-2 rounded-lg bg-life-muted/10 hover:bg-life-muted/20 text-xs font-bold text-life-muted transition-colors",children:"Close"})]})]})})},oF=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(!1),i=`ROLE: You are "The War Room" ( ).
GOAL: Plan complex Operations (Raids) for a high-performance individual.

WHEN I ASK FOR A RAID, OUTPUT A VALID JSON OBJECT.
DO NOT CHAT. JUST OUTPUT THE JSON.

--- INPUT ---
I will describe a project, goal, or campaign.

--- OUTPUT RULES ---
1. **Structure:** A Raid is a container for multiple "Steps" (Missions).
2. **Title:** Military/Tactical naming (e.g., "Operation: Apollo").
3. **Difficulty:** "easy", "normal", "hard".
4. **Stats:** Array of primary attributes (e.g., ["STR", "INT"]).
5. **Skill Link:** If known, link to a skill ID (e.g., "s_coding").
6. **Steps (The Missions):**
   - Each step acts like a Task.
   - **Inheritance:** Steps inherit Difficulty/Stat from the Raid unless specified.
   - **Anomalies:** You CAN override a step's difficulty/stat (e.g., a "Hard" step in a "Normal" raid).
   - **Skill Lock:** Steps ALWAYS inherit the Raid's Skill. You cannot change this per step.

--- JSON TEMPLATE ---

\`\`\`json
{
  "raids": [
    {
      "id": "OPTIONAL_ID_FOR_UPDATE",
      "title": "Operation: PROJECT_NAME",
      "difficulty": "hard",
      "stats": ["INT"],
      "skillId": "OPTIONAL_SKILL_ID",
      "description": "Brief tactical overview.",
      "deadline": "YYYY-MM-DD",
      "steps": [
        {
          "title": "Phase 1: Recon",
          "difficulty": "easy", 
          "stat": "INT",
          "subtasks": ["Research", "Draft Plan"]
        },
        {
          "title": "Phase 2: Execution",
          "difficulty": "hard",
          "stat": "DIS", 
          "isTimed": true,
          "durationMinutes": 120
        }
      ]
    }
  ]
}
\`\`\`

--- EXAMPLES ---

**Input:** "Plan a workout month. 3 days cardio, 3 days weights."
**Output:**
\`\`\`json
{
  "raids": [
    {
      "title": "Operation: Iron Body",
      "difficulty": "hard",
      "stats": ["STR"],
      "description": "Monthly physical conditioning cycle.",
      "steps": [
        { "title": "Week 1: Endurance", "difficulty": "normal", "stat": "STR" },
        { "title": "Week 2: Hypertrophy", "difficulty": "hard", "stat": "STR" }
      ]
    }
  ]
}
\`\`\`

**Input:** "Launch a blog. Needs design and coding."
**Output:**
\`\`\`json
{
  "raids": [
    {
      "title": "Operation: Digital Voice",
      "difficulty": "normal",
      "stats": ["INT"],
      "steps": [
        { "title": "UI Design", "stat": "CRT", "difficulty": "normal" },
        { "title": "Backend Setup", "stat": "INT", "difficulty": "hard" }
      ]
    }
  ]
}
\`\`\``,r=()=>{navigator.clipboard.writeText(i),t(!0),setTimeout(()=>t(!1),2e3)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-life-black border border-red-500/30 rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl shadow-red-500/10",children:[o.jsxs("div",{className:"p-4 border-b border-life-muted/20 flex items-center justify-between bg-life-paper/50 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-red-500/10 rounded-lg text-red-500 border border-red-500/20",children:o.jsx(Zi,{size:20})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-red-500 flex items-center gap-2",children:["The War Room ",o.jsx("span",{className:"text-[9px] bg-red-500 text-black px-1.5 rounded font-mono",children:"V1"})]}),o.jsx("p",{className:"text-[10px] text-life-muted font-mono",children:"Raid Operations Protocol"})]})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[o.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-4 flex gap-3",children:[o.jsx("div",{className:"text-red-500 mt-1",children:o.jsx(fa,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-bold text-red-500 uppercase mb-1",children:"How to Initialize"}),o.jsxs("ol",{className:"text-[10px] text-life-muted space-y-1 list-decimal list-inside marker:text-red-500",children:[o.jsx("li",{children:"Copy the System Prompt below."}),o.jsxs("li",{children:["Paste it into your AI's ",o.jsx("strong",{children:'"System Instructions"'}),"."]}),o.jsx("li",{children:'Command the AI to plan complex projects (e.g., "Plan a marketing campaign").'}),o.jsxs("li",{children:["Copy the JSON output and paste it into ",o.jsx("strong",{children:"Data Injection"}),"."]})]})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all shadow-lg ${e?"bg-green-500 text-black":"bg-red-500 text-black hover:bg-red-400"}`,children:[e?o.jsx(gt,{size:12}):o.jsx(mi,{size:12}),e?"Copied!":"Copy Protocol"]})}),o.jsx("div",{className:"bg-black border border-life-muted/20 rounded-xl p-4 font-mono text-[10px] text-life-muted/80 whitespace-pre-wrap leading-relaxed overflow-x-auto h-96 custom-scrollbar selection:bg-red-500/30 selection:text-white",children:i})]})]}),o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/30 rounded-b-2xl flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-life-muted opacity-50",children:[o.jsx(zn,{size:12}),o.jsx("span",{children:"Compatible with Gemini 1.5+, GPT-4, Claude 3"})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"px-4 py-2 rounded-lg bg-life-muted/10 hover:bg-life-muted/20 text-xs font-bold text-life-muted transition-colors",children:"Close"})]})]})})},aF=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(!1),i=`ROLE: You are the Skill Tree Architect.
GOAL: Define and track long-term proficiencies.

1. **Structure:** Skills are the "containers" for XP earned from Tasks/Habits.
2. **Linking:** Every Task/Habit/Raid SHOULD be linked to a \`skillId\` if possible.
   - When a task is completed, 50% of its XP goes to the linked Skill.
3. **Leveling:**
   - Skills level up independently from the User Level.
   - **Formula:** Next Level XP = 100 * (Level ^ 1.5).
   - **Ranks:**
     - Level 1-9: Novice
     - Level 10-24: Adept
     - Level 25-49: Expert
     - Level 50-99: Master
     - Level 100+: Grandmaster
4. **Rust:** Skills decay if not practiced for 30 days (Rust State).
   - To cure rust: Complete a task linked to that skill.

--- JSON TEMPLATE (SKILLS) ---

\`\`\`json
{
  "skills": [
    {
      "title": "Python Programming",
      "relatedStats": ["INT", "CRT"],
      "description": "Backend development and data science."
    }
  ]
}
\`\`\`

--- EXAMPLES ---

**Input:** "I want to learn Guitar."
**Output:**
\`\`\`json
{
  "skills": [
    {
      "title": "Guitar Mastery",
      "relatedStats": ["CRT", "DIS"],
      "description": "Acoustic and Electric guitar techniques."
    }
  ]
}
\`\`\`

**Input:** "Add a skill for Cooking."
**Output:**
\`\`\`json
{
  "skills": [
    {
      "title": "Culinary Arts",
      "relatedStats": ["CRT", "HEA"],
      "description": "Mastering flavors and techniques."
    }
  ]
}
\`\`\``,r=()=>{navigator.clipboard.writeText(i),t(!0),setTimeout(()=>t(!1),2e3)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-life-black border border-blue-500/30 rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl shadow-blue-500/10",children:[o.jsxs("div",{className:"p-4 border-b border-life-muted/20 flex items-center justify-between bg-life-paper/50 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg text-blue-500 border border-blue-500/20",children:o.jsx(tn,{size:20})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-blue-500 flex items-center gap-2",children:["Skill Tree Architect ",o.jsx("span",{className:"text-[9px] bg-blue-500 text-black px-1.5 rounded font-mono",children:"V1"})]}),o.jsx("p",{className:"text-[10px] text-life-muted font-mono",children:"Mastery Protocol"})]})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[o.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-4 flex gap-3",children:[o.jsx("div",{className:"text-blue-500 mt-1",children:o.jsx(fa,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-bold text-blue-500 uppercase mb-1",children:"How to Initialize"}),o.jsxs("ol",{className:"text-[10px] text-life-muted space-y-1 list-decimal list-inside marker:text-blue-500",children:[o.jsx("li",{children:"Copy the System Prompt below."}),o.jsxs("li",{children:["Paste it into your AI's ",o.jsx("strong",{children:'"System Instructions"'}),"."]}),o.jsx("li",{children:'Command the AI to define new skills (e.g., "Add a skill for Guitar").'}),o.jsxs("li",{children:["Copy the JSON output and paste it into ",o.jsx("strong",{children:"Data Injection"}),"."]})]})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all shadow-lg ${e?"bg-green-500 text-black":"bg-blue-500 text-black hover:bg-blue-400"}`,children:[e?o.jsx(gt,{size:12}):o.jsx(mi,{size:12}),e?"Copied!":"Copy Protocol"]})}),o.jsx("div",{className:"bg-black border border-life-muted/20 rounded-xl p-4 font-mono text-[10px] text-life-muted/80 whitespace-pre-wrap leading-relaxed overflow-x-auto h-96 custom-scrollbar selection:bg-blue-500/30 selection:text-white",children:i})]})]}),o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/30 rounded-b-2xl flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-life-muted opacity-50",children:[o.jsx(zn,{size:12}),o.jsx("span",{children:"Compatible with Gemini 1.5+, GPT-4, Claude 3"})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"px-4 py-2 rounded-lg bg-life-muted/10 hover:bg-life-muted/20 text-xs font-bold text-life-muted transition-colors",children:"Close"})]})]})})},lF=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(!1),i=`ROLE: You are "The Bazaar Architect" ( ).
GOAL: Generate RPG-style Shop Items for a gamified productivity app.

WHEN I ASK FOR ITEMS, OUTPUT A VALID JSON OBJECT.
DO NOT CHAT. JUST OUTPUT THE JSON.

--- INPUT ---
I will describe a theme (e.g., "Cyberpunk Gear", "Magic Potions") or specific items.

--- OUTPUT RULES ---
1. **IDs:** Must be unique strings (e.g., "item_cyber_deck").
2. **Type:** 
   - "custom": Consumables (e.g., "Skip Gym", "Cheat Meal").
   - "artifact": Permanent passive bonuses (e.g., +10% INT XP).
   - "redemption": Real-world rewards (e.g., "1 Hour Gaming").
3. **Cost:** Balanced (100-500 for consumables, 1000+ for artifacts).
4. **Icons:** Use Lucide React icon names (e.g., "Zap", "Shield", "Coffee").
5. **Effects:** Only for "artifact" type.
   - "xp_boost": Multiplier for XP (0.1 = +10%).
   - "gold_boost": Multiplier for Gold.
   - "stat": Optional. If set (STR, INT, etc.), applies only to that stat.

--- JSON TEMPLATE ---

\`\`\`json
{
  "storeItems": [
    {
      "id": "item_unique_id",
      "title": "ITEM_NAME",
      "description": "Flavor text description.",
      "cost": 500,
      "icon": "Zap",
      "type": "artifact",
      "isInfinite": false,
      "effect": {
        "type": "xp_boost",
        "value": 0.1,
        "stat": "INT"
      }
    },
    {
      "id": "item_potion_01",
      "title": "Health Potion",
      "description": "Restores energy instantly.",
      "cost": 50,
      "icon": "Heart",
      "type": "custom",
      "isInfinite": true
    }
  ]
}
\`\`\`

--- EXAMPLES ---

**Input:** "Create a set of productivity potions."
**Output:**
\`\`\`json
{
  "storeItems": [
    {
      "id": "pot_focus",
      "title": "Elixir of Focus",
      "description": "Grants deep work capability for 2 hours.",
      "cost": 150,
      "icon": "FlaskConical",
      "type": "custom",
      "isInfinite": true
    },
    {
      "id": "pot_rest",
      "title": "Draught of Sleep",
      "description": "Ensures a perfect night's rest.",
      "cost": 100,
      "icon": "Moon",
      "type": "custom",
      "isInfinite": true
    }
  ]
}
\`\`\`
`,r=()=>{navigator.clipboard.writeText(i),t(!0),setTimeout(()=>t(!1),2e3)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-life-black border border-pink-500/30 rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl shadow-pink-500/10",children:[o.jsxs("div",{className:"p-4 border-b border-life-muted/20 flex items-center justify-between bg-life-paper/50 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-pink-500/10 rounded-lg text-pink-500 border border-pink-500/20",children:o.jsx(EN,{size:20})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-pink-500 flex items-center gap-2",children:["Shop Archives ",o.jsx("span",{className:"text-[9px] bg-pink-500 text-black px-1.5 rounded font-mono",children:"V1"})]}),o.jsx("p",{className:"text-[10px] text-life-muted font-mono",children:"AI Economy Protocol"})]})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[o.jsxs("div",{className:"bg-pink-500/10 border border-pink-500/20 rounded-xl p-4 flex gap-3",children:[o.jsx("div",{className:"text-pink-400 mt-1",children:o.jsx(fa,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-bold text-pink-300 uppercase mb-1",children:"How to Initialize"}),o.jsxs("ol",{className:"text-[10px] text-life-muted space-y-1 list-decimal list-inside marker:text-pink-500",children:[o.jsx("li",{children:"Copy the System Prompt below."}),o.jsxs("li",{children:["Open ",o.jsx("strong",{children:"Google Gemini"})," (or any AI Chat)."]}),o.jsxs("li",{children:["Paste the text into the ",o.jsx("strong",{children:'"System Instructions"'})," or start a new chat with it."]}),o.jsx("li",{children:'Command the AI to generate items (e.g., "Create legendary coding artifacts").'}),o.jsxs("li",{children:["Copy the JSON output and paste it into ",o.jsx("strong",{children:"Data Injection"}),"."]})]})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all shadow-lg ${e?"bg-green-500 text-black":"bg-pink-500 text-black hover:bg-pink-400"}`,children:[e?o.jsx(gt,{size:12}):o.jsx(mi,{size:12}),e?"Copied!":"Copy Protocol"]})}),o.jsx("div",{className:"bg-black border border-life-muted/20 rounded-xl p-4 font-mono text-[10px] text-life-muted/80 whitespace-pre-wrap leading-relaxed overflow-x-auto h-96 custom-scrollbar selection:bg-pink-500/30 selection:text-white",children:i})]})]}),o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/30 rounded-b-2xl flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-life-muted opacity-50",children:[o.jsx(zn,{size:12}),o.jsx("span",{children:"Compatible with Gemini 1.5+, GPT-4, Claude 3"})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"px-4 py-2 rounded-lg bg-life-muted/10 hover:bg-life-muted/20 text-xs font-bold text-life-muted transition-colors",children:"Close"})]})]})})},cF=()=>{const{state:n,dispatch:e}=Ve(),{taskState:t}=Zn(),{habitState:i}=ei(),{raidState:r}=ss(),{shopState:l}=Qh(),[c,d]=K.useState(!1),p={user:{level:n.user.level,title:n.user.title,stats:n.user.stats,gold:n.user.gold,xp:n.user.currentXP},activeTasks:t.tasks.filter(b=>!b.isCompleted).map(b=>({title:b.title,difficulty:b.difficulty,stat:b.stat})),habits:i.habits.map(b=>({title:b.title,type:b.type,frequency:b.frequency})),activeRaids:r.raids.filter(b=>b.status==="active").map(b=>({title:b.title,difficulty:b.difficulty,progress:b.progress})),shopItems:l.storeItems.map(b=>({title:b.title,cost:b.cost,type:b.type}))},h=`
ROLE: You are the Codex Arbiter (AI_CODEX_GEN).
GOAL: Analyze the user's LifeOS data and generate a strict "Codex of Laws" (Consequences) to enforce discipline.

USER DATA SNAPSHOT:
${JSON.stringify(p,null,2)}

INSTRUCTIONS:
1. Analyze their Tasks, Habits, and Raids to identify potential areas of failure or laziness.
2. Create 5-10 "Laws" (Consequences) that punish them for specific failures.
   - Example: "If I miss [Habit Name], I lose 50 Gold."
   - Example: "If I abandon a Raid Step, I lose 100 XP."
   - Example: "If I buy a useless item, I lose 5 Honor."
3. Use the existing Shop Items to suggest "Fines" (e.g., must buy a "Penalty Token").

PENALTY GUIDELINES (DO NOT EXAGGERATE PUNISHMENT):
- **Stat Points:** -1 to -5 (Use sparingly for severe neglect).
- **Gold:** 50 to 1000 G (Scale with severity).
- **XP:** 100 to 1000 XP (Scale with severity).
- **Honor:** 5% to 25% (Reserved for breaking core habits or oaths).

4. RETURN ONLY VALID JSON in the following format (compatible with the injection engine):

{
  "laws": [
    {
      "title": "Law Name (e.g. Neglect of [Habit])",
      "penaltyType": "gold" | "xp" | "stat" | "honor",
      "penaltyValue": 50,
      "statTarget": "DIS" (only if penaltyType is 'stat')
    }
  ]
}

CRITICAL: Return ONLY the JSON. No markdown.
`,x=()=>{navigator.clipboard.writeText(h),d(!0),setTimeout(()=>d(!1),2e3)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-life-black border border-indigo-500/30 rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl shadow-indigo-500/10",children:[o.jsxs("div",{className:"p-4 border-b border-life-muted/20 flex items-center justify-between bg-life-paper/50 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-indigo-500/10 rounded-lg text-indigo-400 border border-indigo-500/20",children:o.jsx(Yh,{size:20})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-indigo-400 flex items-center gap-2",children:["Codex Arbiter ",o.jsx("span",{className:"text-[9px] bg-indigo-500 text-white px-1.5 rounded font-mono",children:"V1"})]}),o.jsx("p",{className:"text-[10px] text-life-muted font-mono",children:"Law Generation Protocol"})]})]}),o.jsx("button",{onClick:()=>e.setModal("none"),className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[o.jsxs("div",{className:"bg-indigo-500/10 border border-indigo-500/20 rounded-xl p-4 flex gap-3",children:[o.jsx("div",{className:"text-indigo-400 mt-1",children:o.jsx(bN,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-bold text-indigo-400 uppercase mb-1",children:"How to Legislate"}),o.jsxs("ol",{className:"text-[10px] text-life-muted space-y-1 list-decimal list-inside marker:text-indigo-400",children:[o.jsx("li",{children:"Copy the System Prompt below (it includes your data)."}),o.jsxs("li",{children:["Open ",o.jsx("strong",{children:"Google Gemini"})," (or any AI Chat)."]}),o.jsx("li",{children:"Paste the text. The AI will analyze your habits/tasks."}),o.jsx("li",{children:'It will generate a list of "Laws" (Consequences).'}),o.jsxs("li",{children:["Copy the JSON output and paste it into ",o.jsx("strong",{children:"Data Injection"}),"."]})]})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsxs("button",{onClick:x,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all shadow-lg ${c?"bg-green-500 text-black":"bg-indigo-500 text-white hover:bg-indigo-400"}`,children:[c?o.jsx(gt,{size:12}):o.jsx(mi,{size:12}),c?"Copied!":"Copy Protocol"]})}),o.jsx("div",{className:"bg-black border border-life-muted/20 rounded-xl p-4 font-mono text-[10px] text-life-muted/80 whitespace-pre-wrap leading-relaxed overflow-x-auto h-96 custom-scrollbar selection:bg-indigo-500/30 selection:text-white",children:h})]})]}),o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/30 rounded-b-2xl flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-life-muted opacity-50",children:[o.jsx(zn,{size:12}),o.jsx("span",{children:"Compatible with Gemini 1.5+, GPT-4, Claude 3"})]}),o.jsx("button",{onClick:()=>e.setModal("none"),className:"px-4 py-2 rounded-lg bg-life-muted/10 hover:bg-life-muted/20 text-xs font-bold text-life-muted transition-colors",children:"Close"})]})]})})},uF=()=>{const{dispatch:n}=Ve(),[e,t]=K.useState(!1),i=`ROLE: You are "The Badge Architect" ( ).
GOAL: Generate achievement badges for a gamified life operating system.

WHEN I ASK FOR BADGES, OUTPUT A VALID JSON OBJECT.
DO NOT CHAT. JUST OUTPUT THE JSON.

--- INPUT ---
I will describe a category (e.g., "Fitness", "Coding") or a specific achievement.

--- OUTPUT RULES ---
1. **ID:** Unique identifier (snake_case), e.g., "early_riser".
2. **Name:** Creative title (e.g., "Dawn Breaker").
3. **Description:** Clear criteria for unlocking.
4. **Icon:** A valid Lucide React icon name (e.g., "Sun", "Dumbbell", "Code").
5. **Category:** One of: "progression", "combat", "warfare", "consistency", "resilience", "economy", "mastery", "skill", "special".
6. **Trigger Type:** One of: "stat", "metric", "manual", "skill", "habit", "raid".
7. **Metric Key:** The specific metric to track (e.g., "totalTasksCompleted", "stats.STR", or the exact Habit Title).
8. **Levels:** Array of 4 tiers ("silver", "gold", "diamond", "crimson"). Each level needs a "target" (number), "quote" (string), and "rewards" (xp and gold).

--- JSON TEMPLATE ---

\`\`\`json
{
  "badges": [
    {
      "id": "badge_unique_id",
      "name": "Badge Name",
      "description": "Unlock criteria description.",
      "icon": "Award",
      "category": "combat",
      "triggerType": "metric",
      "metricKey": "totalTasksCompleted",
      "levels": [
        {
          "tier": "silver",
          "target": 10,
          "quote": "A good start.",
          "rewards": { "xp": 100, "gold": 50 }
        },
        {
          "tier": "gold",
          "target": 50,
          "quote": "You are getting stronger.",
          "rewards": { "xp": 250, "gold": 100 }
        },
        {
          "tier": "diamond",
          "target": 100,
          "quote": "Unstoppable force.",
          "rewards": { "xp": 500, "gold": 250 }
        },
        {
          "tier": "crimson",
          "target": 500,
          "quote": "A legend is born.",
          "rewards": { "xp": 1000, "gold": 500 }
        }
      ]
    }
  ]
}
\`\`\`

--- EXAMPLES ---

**Input:** "Create a badge for reading books."
**Output:**
\`\`\`json
{
  "badges": [
    {
      "id": "badge_bookworm",
      "name": "Keeper of Knowledge",
      "description": "Awarded for consistent reading habits.",
      "icon": "BookOpen",
      "category": "special",
      "triggerType": "habit",
      "metricKey": "Read a Book",
      "levels": [
        {
          "tier": "silver",
          "target": 5,
          "quote": "The mind is a muscle.",
          "rewards": { "xp": 100, "gold": 50 }
        },
        {
          "tier": "gold",
          "target": 20,
          "quote": "Knowledge is power.",
          "rewards": { "xp": 250, "gold": 100 }
        },
        {
          "tier": "diamond",
          "target": 50,
          "quote": "A library in your head.",
          "rewards": { "xp": 500, "gold": 250 }
        },
        {
          "tier": "crimson",
          "target": 100,
          "quote": "Omniscience achieved.",
          "rewards": { "xp": 1000, "gold": 500 }
        }
      ]
    }
  ]
}
\`\`\`

**Input:** "Create a system badge for daily streaks."
**Output:**
\`\`\`json
{
  "badges": [
    {
      "id": "badge_streak_master",
      "name": "Time Walker",
      "description": "Awarded for maintaining a daily streak.",
      "icon": "Flame",
      "category": "consistency",
      "triggerType": "metric",
      "metricKey": "currentStreak",
      "levels": [
        {
          "tier": "silver",
          "target": 7,
          "quote": "A week of focus.",
          "rewards": { "xp": 100, "gold": 50 }
        },
        {
          "tier": "gold",
          "target": 30,
          "quote": "A month of discipline.",
          "rewards": { "xp": 250, "gold": 100 }
        },
        {
          "tier": "diamond",
          "target": 100,
          "quote": "A hundred days of power.",
          "rewards": { "xp": 500, "gold": 250 }
        },
        {
          "tier": "crimson",
          "target": 365,
          "quote": "A year of mastery.",
          "rewards": { "xp": 1000, "gold": 500 }
        }
      ]
    }
  ]
}
\`\`\`
`,r=()=>{navigator.clipboard.writeText(i),t(!0),setTimeout(()=>t(!1),2e3)};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:o.jsxs("div",{className:"bg-life-black border border-life-gold/30 rounded-2xl w-full max-w-2xl max-h-[85vh] flex flex-col shadow-2xl shadow-life-gold/10",children:[o.jsxs("div",{className:"p-4 border-b border-life-muted/20 flex items-center justify-between bg-life-paper/50 rounded-t-2xl",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-life-gold/10 rounded-lg text-life-gold border border-life-gold/20",children:o.jsx(po,{size:20})}),o.jsxs("div",{children:[o.jsxs("h2",{className:"text-sm font-black uppercase tracking-widest text-life-gold flex items-center gap-2",children:["Badge Architect ",o.jsx("span",{className:"text-[9px] bg-life-gold text-black px-1.5 rounded font-mono",children:"V1"})]}),o.jsx("p",{className:"text-[10px] text-life-muted font-mono",children:"AI Protocol Configuration"})]})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"text-life-muted hover:text-white transition-colors",children:o.jsx(et,{size:20})})]}),o.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 custom-scrollbar",children:[o.jsxs("div",{className:"bg-purple-500/10 border border-purple-500/20 rounded-xl p-4 flex gap-3",children:[o.jsx("div",{className:"text-purple-400 mt-1",children:o.jsx(fa,{size:18})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-xs font-bold text-purple-300 uppercase mb-1",children:"How to Initialize"}),o.jsxs("ol",{className:"text-[10px] text-life-muted space-y-1 list-decimal list-inside marker:text-purple-500",children:[o.jsx("li",{children:"Copy the System Prompt below."}),o.jsxs("li",{children:["Open ",o.jsx("strong",{children:"Google Gemini"})," (or any AI Chat)."]}),o.jsxs("li",{children:["Paste the text into the ",o.jsx("strong",{children:'"System Instructions"'})," or start a new chat with it."]}),o.jsx("li",{children:'Command the AI to generate badges (e.g., "Create badges for fitness").'}),o.jsxs("li",{children:["Copy the JSON output and paste it into ",o.jsx("strong",{children:"Data Injection"}),"."]})]})]})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute top-2 right-2 z-10",children:o.jsxs("button",{onClick:r,className:`flex items-center gap-2 px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider transition-all shadow-lg ${e?"bg-green-500 text-black":"bg-life-gold text-black hover:bg-yellow-400"}`,children:[e?o.jsx(gt,{size:12}):o.jsx(mi,{size:12}),e?"Copied!":"Copy Protocol"]})}),o.jsx("div",{className:"bg-black border border-life-muted/20 rounded-xl p-4 font-mono text-[10px] text-life-muted/80 whitespace-pre-wrap leading-relaxed overflow-x-auto h-96 custom-scrollbar selection:bg-life-gold/30 selection:text-white",children:i})]})]}),o.jsxs("div",{className:"p-4 border-t border-life-muted/20 bg-life-paper/30 rounded-b-2xl flex justify-between items-center",children:[o.jsxs("div",{className:"flex items-center gap-2 text-[9px] text-life-muted opacity-50",children:[o.jsx(zn,{size:12}),o.jsx("span",{children:"Compatible with Gemini 1.5+, GPT-4, Claude 3"})]}),o.jsx("button",{onClick:()=>n.setModal("none"),className:"px-4 py-2 rounded-lg bg-life-muted/10 hover:bg-life-muted/20 text-xs font-bold text-life-muted transition-colors",children:"Close"})]})]})})},dF={silver:"text-gray-300 border-gray-300 bg-gray-300/10",gold:"text-yellow-400 border-yellow-400 bg-yellow-400/10",diamond:"text-cyan-400 border-cyan-400 bg-cyan-400/10",crimson:"text-red-600 border-red-600 bg-red-600/10 shadow-[0_0_20px_rgba(220,38,38,0.4)]"},fF=({data:n,onClose:e})=>{var R;const{badge:t,currentTier:i,history:r,currentValue:l}=n,{state:c,dispatch:d}=Ve(),{user:p}=c,h=()=>{if(!i)return 0;const C=t.levels.findIndex(A=>A.tier===i);return C>=0?C:0},[x,b]=K.useState(h()),T=t.levels[x],S=T.tier,E=!!r[S],D=!E&&(x===0||!!r[t.levels[x-1].tier]),k=dF[S],F=k.split(" ")[0],$=(R=p.featuredBadges)==null?void 0:R.includes(t.id),M=()=>{let C=[...p.featuredBadges||[]];if($)C=C.filter(A=>A!==t.id),d.addToast("Badge unpinned","info");else{if(C.length>=3){d.addToast("Max 3 pinned badges allowed","error");return}C.push(t.id),d.addToast("Badge pinned to Profile","success")}d.updateUser({featuredBadges:C})},J=C=>{C.stopPropagation(),x>0&&b(x-1)},H=C=>{C.stopPropagation(),x<t.levels.length-1&&b(x+1)};let z=0;if(E)z=100;else if(D){const C=x>0?t.levels[x-1].target:0;T.target-C,z=Math.min(100,l/T.target*100)}else z=0;return o.jsx("div",{onClick:e,className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{onClick:C=>C.stopPropagation(),className:"w-full max-w-sm bg-life-paper border border-life-muted/20 rounded-2xl overflow-hidden shadow-2xl animate-in zoom-in-95 slide-in-from-bottom-4 flex flex-col",children:[o.jsxs("div",{className:`relative p-6 text-center border-b border-life-muted/10 overflow-hidden transition-colors duration-500 ${S==="crimson"?"bg-red-900/10":""}`,children:[o.jsx("div",{className:`absolute top-0 left-1/2 -translate-x-1/2 w-48 h-48 bg-current opacity-10 blur-[60px] rounded-full pointer-events-none transition-colors duration-500 ${F}`}),o.jsx("button",{onClick:e,className:"absolute top-4 right-4 text-life-muted hover:text-white z-20",children:o.jsx(et,{size:20})}),i&&o.jsx("button",{onClick:M,className:`absolute top-4 left-4 p-2 rounded-full border transition-all z-20 ${$?"bg-life-gold text-life-black border-life-gold":"bg-transparent text-life-muted border-life-muted/20 hover:text-white"}`,title:$?"Unpin":"Pin to Profile",children:o.jsx(BP,{size:16,className:$?"fill-current":""})}),o.jsxs("div",{className:"flex items-center justify-between mt-2 mb-4 relative z-10",children:[o.jsx("button",{onClick:J,disabled:x===0,className:`p-2 rounded-full transition-all ${x===0?"opacity-0 pointer-events-none":"text-life-gold hover:bg-life-gold/10 hover:scale-110"}`,children:o.jsx(mN,{size:32,strokeWidth:3})}),o.jsx("div",{className:`w-28 h-28 rounded-full border-4 flex items-center justify-center text-5xl shadow-2xl transition-all duration-500 bg-life-black ${k} ${E?"scale-100":"scale-90 opacity-50 grayscale"}`,children:E?t.icon:o.jsx(da,{size:40})}),o.jsx("button",{onClick:H,disabled:x===t.levels.length-1,className:`p-2 rounded-full transition-all ${x===t.levels.length-1?"opacity-0 pointer-events-none":"text-life-gold hover:bg-life-gold/10 hover:scale-110"}`,children:o.jsx(Bt,{size:32,strokeWidth:3})})]}),o.jsx("h2",{className:"text-2xl font-black uppercase tracking-tight text-white mb-1",children:t.name}),o.jsx("div",{className:`inline-block px-3 py-0.5 rounded text-[10px] font-black uppercase tracking-[0.2em] border transition-colors duration-500 ${k}`,children:S})]}),o.jsxs("div",{className:"p-6 space-y-6 flex-1 bg-life-paper relative",children:[o.jsx("div",{className:"text-center flex flex-col items-center justify-center min-h-[40px]",children:o.jsxs("p",{className:"text-sm italic font-serif text-life-muted/80 leading-relaxed animate-in fade-in duration-500",children:['"',T.quote,'"']},x)}),o.jsxs("div",{className:"bg-life-black/40 rounded-xl p-3 border border-life-muted/10 text-center relative overflow-hidden",children:[o.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-life-gold/50"}),o.jsxs("span",{className:"text-[9px] text-life-muted uppercase font-bold tracking-widest block mb-1 flex items-center justify-center gap-1",children:[o.jsx(is,{size:10})," Requirement"]}),o.jsxs("p",{className:"text-xs text-life-text font-medium leading-relaxed",children:[t.description," ",o.jsx("br",{}),o.jsxs("span",{className:"text-life-gold font-bold bg-life-gold/10 px-2 py-0.5 rounded mt-1 inline-block",children:["Target: ",T.target]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between text-[10px] font-mono font-bold uppercase tracking-wider",children:[o.jsx("span",{className:"text-life-muted",children:"Progress"}),o.jsx("span",{className:E?"text-life-easy":"text-life-gold",children:E?"COMPLETE":`${l} / ${T.target}`})]}),o.jsx("div",{className:"h-2 bg-life-black rounded-full overflow-hidden border border-life-muted/20",children:o.jsx("div",{className:`h-full transition-all duration-500 ${E?"bg-life-easy":"bg-life-gold"}`,style:{width:`${z}%`}})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[o.jsxs("div",{className:`p-3 rounded-xl border flex flex-col items-center justify-center gap-1 transition-colors duration-500 ${E?"bg-life-easy/10 border-life-easy/30":"bg-life-black border-life-muted/20"}`,children:[o.jsx("span",{className:"text-[9px] text-life-muted uppercase font-bold",children:"Status"}),o.jsx("span",{className:`text-xs font-black uppercase tracking-wider ${E?"text-life-easy":"text-life-muted"}`,children:E?"ACQUIRED":"LOCKED"})]}),E&&r[S]?o.jsxs("div",{className:"p-3 rounded-xl bg-life-black border border-life-muted/20 flex flex-col items-center justify-center gap-1",children:[o.jsx("span",{className:"text-[9px] text-life-muted uppercase font-bold",children:"Unlocked"}),o.jsx("span",{className:"text-[10px] font-mono text-life-text",children:(()=>{const C=r[S]||"";return C.length>=6?`20${C.substring(0,2)}-${C.substring(2,4)}-${C.substring(4,6)}`:"Unknown"})()})]}):o.jsxs("div",{className:"p-3 rounded-xl bg-life-black border border-life-muted/20 flex flex-col items-center justify-center gap-1 opacity-60",children:[o.jsx("span",{className:"text-[9px] text-life-muted uppercase font-bold",children:"Reward"}),o.jsxs("span",{className:"text-xs font-bold text-life-gold",children:[T.rewards.gold," G"]})]})]})]}),o.jsx("div",{className:"p-4 bg-life-black border-t border-life-muted/10 flex justify-center gap-2",children:t.levels.map((C,A)=>o.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all duration-300 ${A===x?"bg-life-gold w-3":"bg-life-muted/30"}`},A))})]})})},hF=[{id:"all",label:"All"},{id:"honor",label:"Honor"},{id:"progression",label:"Progression"},{id:"combat",label:"Combat"},{id:"warfare",label:"Warfare"},{id:"consistency",label:"Consistency"},{id:"resilience",label:"Resilience"},{id:"economy",label:"Economy"},{id:"mastery",label:"Stats"}],pF=()=>{const{getAllBadges:n}=zN(),e=n(),[t,i]=K.useState("all"),[r,l]=K.useState(null),[c,d]=K.useState(!1),p=t==="all"?e:t==="honor"?e.filter(S=>S.badge.id.startsWith("bdg_honor_")):e.filter(S=>S.badge.category===t),h=r?e.find(S=>S.badge.id===r):null,x=e.filter(S=>S.isUnlocked).length,b=Math.round(x/e.length*100),T={silver:e.filter(S=>S.currentTier==="silver").length,gold:e.filter(S=>S.currentTier==="gold").length,diamond:e.filter(S=>S.currentTier==="diamond").length,crimson:e.filter(S=>S.currentTier==="crimson").length};return o.jsxs("div",{className:"pb-24 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[o.jsxs("div",{className:"flex items-end justify-between mb-6 px-1",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-black text-life-text tracking-tight flex items-center gap-2",children:"HALL OF GLORY"}),o.jsxs("p",{className:"text-xs text-life-muted uppercase tracking-widest mt-1",children:["The Crimson Legacy  ",b,"% Complete"]})]}),o.jsx("div",{className:"text-life-crimson opacity-50 animate-pulse-slow",children:o.jsx(po,{size:28})})]}),o.jsxs("button",{onClick:()=>d(!c),className:"w-full mb-6 py-3 px-4 bg-life-black border border-life-muted/20 rounded-xl flex items-center justify-between hover:bg-life-muted/5 transition-all group shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-2 text-life-muted group-hover:text-life-text",children:[o.jsx(pN,{size:16}),o.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest",children:"Protocol Analysis"})]}),c?o.jsx(Xi,{size:16,className:"text-life-muted"}):o.jsx(Xn,{size:16,className:"text-life-muted"})]}),c&&o.jsxs("div",{className:"grid grid-cols-4 gap-2 mb-6 animate-in slide-in-from-top-2",children:[o.jsxs("div",{className:"bg-life-black border border-life-muted/20 p-2 rounded-lg text-center",children:[o.jsx("span",{className:"block text-lg font-black text-gray-400",children:T.silver}),o.jsx("span",{className:"text-[8px] text-life-muted uppercase font-bold",children:"Silver"})]}),o.jsxs("div",{className:"bg-life-black border border-yellow-500/20 p-2 rounded-lg text-center",children:[o.jsx("span",{className:"block text-lg font-black text-yellow-500",children:T.gold}),o.jsx("span",{className:"text-[8px] text-life-muted uppercase font-bold",children:"Gold"})]}),o.jsxs("div",{className:"bg-life-black border border-cyan-500/20 p-2 rounded-lg text-center",children:[o.jsx("span",{className:"block text-lg font-black text-cyan-400",children:T.diamond}),o.jsx("span",{className:"text-[8px] text-life-muted uppercase font-bold",children:"Diamond"})]}),o.jsxs("div",{className:"bg-life-black border border-red-600/20 p-2 rounded-lg text-center",children:[o.jsx("span",{className:"block text-lg font-black text-red-500",children:T.crimson}),o.jsx("span",{className:"text-[8px] text-life-muted uppercase font-bold",children:"Crimson"})]})]}),o.jsx("div",{className:"flex gap-2 overflow-x-auto no-scrollbar mb-6 pb-2",children:hF.map(S=>o.jsx("button",{onClick:()=>i(S.id),className:`
                            px-3 py-1.5 rounded-lg text-[10px] font-bold uppercase tracking-wider whitespace-nowrap border transition-all
                            ${t===S.id?"bg-life-gold text-life-black border-life-gold":"bg-life-black text-life-muted border-life-muted/20 hover:border-life-gold/50"}
                        `,children:S.label},S.id))}),o.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3",children:p.map(S=>{const{badge:E,currentTier:D,isUnlocked:k}=S;let F="border-life-muted/10",$="text-life-muted/20",M="";return D==="silver"&&(F="border-gray-400/50",$="text-gray-300"),D==="gold"&&(F="border-yellow-500/50",$="text-yellow-400",M="shadow-[0_0_15px_rgba(250,204,21,0.1)]"),D==="diamond"&&(F="border-cyan-500/50",$="text-cyan-400",M="shadow-[0_0_20px_rgba(34,211,238,0.2)]"),D==="crimson"&&(F="border-red-600",$="text-red-500",M="shadow-[0_0_25px_rgba(220,38,38,0.3)] bg-red-900/10"),o.jsxs("button",{onClick:()=>l(E.id),className:`
                                aspect-square rounded-xl border bg-life-paper relative flex flex-col items-center justify-center p-2 group transition-all
                                ${F} ${M}
                                ${k?"hover:scale-105 active:scale-95 cursor-pointer":"opacity-50 grayscale hover:opacity-70"}
                            `,children:[o.jsx("div",{className:`text-3xl mb-2 transition-transform group-hover:scale-110 ${$}`,children:k?E.icon:o.jsx(da,{size:24})}),o.jsx("div",{className:"text-[8px] font-bold text-center uppercase leading-tight text-life-text/80 line-clamp-2",children:E.name}),D&&o.jsx("div",{className:`absolute top-1 right-1 w-2 h-2 rounded-full ${$.replace("text-","bg-")}`})]},E.id)})}),p.length===0&&o.jsx("div",{className:"py-12 text-center text-life-muted italic text-xs",children:"No badges found in this category."}),h&&o.jsx(fF,{data:h,onClose:()=>l(null)})]})},mF=()=>{const{state:n,dispatch:e}=Ve(),{modalData:t}=n.ui;if(!t||!t.badge)return null;const{badge:i,tier:r,rewards:l}=t,c=()=>{e.setModal("none")};let d="text-gray-300 border-gray-300",p="bg-gray-500";return r==="gold"&&(d="text-yellow-400 border-yellow-400",p="bg-yellow-500"),r==="diamond"&&(d="text-cyan-400 border-cyan-400",p="bg-cyan-500"),r==="crimson"&&(d="text-red-600 border-red-600",p="bg-red-600"),o.jsx("div",{onClick:c,className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/95 backdrop-blur-md animate-in fade-in duration-300",children:o.jsxs("div",{onClick:h=>h.stopPropagation(),className:"relative w-full max-w-sm flex flex-col items-center text-center animate-in zoom-in-50 slide-in-from-bottom-8 duration-700",children:[o.jsx("div",{className:`absolute inset-0 ${p} blur-[120px] opacity-20 rounded-full animate-pulse-slow pointer-events-none`}),o.jsxs("div",{className:"relative mb-6 group",children:[o.jsx("div",{className:`w-32 h-32 rounded-full border-4 flex items-center justify-center text-6xl bg-life-black shadow-[0_0_50px_currentColor] animate-bounce ${d}`,children:i.icon}),o.jsxs("div",{className:"absolute inset-0 animate-[spin_4s_linear_infinite] pointer-events-none",children:[o.jsx(xh,{size:24,className:`absolute -top-4 left-1/2 -translate-x-1/2 ${d.split(" ")[0]} fill-current`}),o.jsx(xh,{size:24,className:`absolute -bottom-4 left-1/2 -translate-x-1/2 ${d.split(" ")[0]} fill-current`})]})]}),o.jsxs("div",{className:"space-y-2 mb-8 relative z-10",children:[o.jsx("h3",{className:`text-sm font-black uppercase tracking-[0.3em] ${d.split(" ")[0]}`,children:"Protocol Achievement"}),o.jsx("h1",{className:"text-4xl font-black text-white tracking-tighter drop-shadow-xl",children:i.name}),o.jsxs("div",{className:`inline-block px-3 py-1 rounded border text-xs font-black uppercase tracking-widest bg-black/50 ${d}`,children:[r," Rank"]})]}),o.jsxs("div",{className:"flex gap-4 mb-8",children:[o.jsxs("div",{className:"bg-life-paper/80 border border-life-muted/30 px-4 py-2 rounded-xl",children:[o.jsx("span",{className:"block text-[10px] text-life-muted uppercase font-bold",children:"XP Gain"}),o.jsxs("span",{className:"text-lg font-mono font-bold text-white",children:["+",l.xp]})]}),o.jsxs("div",{className:"bg-life-paper/80 border border-life-muted/30 px-4 py-2 rounded-xl",children:[o.jsx("span",{className:"block text-[10px] text-life-muted uppercase font-bold",children:"Gold"}),o.jsxs("span",{className:"text-lg font-mono font-bold text-life-gold",children:["+",l.gold]})]})]}),o.jsx("button",{onClick:c,className:`w-full py-4 rounded-xl font-black uppercase tracking-widest text-black shadow-xl hover:scale-105 active:scale-95 transition-all ${p.replace("bg-","bg-")}`,children:"Claim Glory"})]})})},gF=({toast:n,onDismiss:e})=>{const[t,i]=K.useState(null),[r,l]=K.useState(0),[c,d]=K.useState(!1),p=n.message.split("|"),h=p[0].trim(),x=p.length>1?p[1].trim():null,b=D=>{i(D.targetTouches[0].clientX)},T=D=>{if(t===null)return;const F=D.targetTouches[0].clientX-t;F>0&&l(F)},S=()=>{r>100?E():(l(0),i(null))},E=()=>{d(!0),l(500),setTimeout(()=>{e(n.id)},200)};return o.jsxs("div",{onTouchStart:b,onTouchMove:T,onTouchEnd:S,onClick:E,style:{transform:`translateX(${r}px)`,opacity:c?0:1-r/300,transition:t!==null?"none":"all 0.2s ease-out"},className:`
                pointer-events-auto cursor-pointer relative overflow-hidden touch-pan-y
                min-w-[280px] max-w-sm w-full backdrop-blur-xl border shadow-2xl rounded-xl p-3
                flex items-center gap-3 animate-in slide-in-from-top-4 fade-in duration-300
                ${n.type==="error"?"bg-red-950/90 border-red-500/50 shadow-red-900/20":n.type==="level-up"?"bg-life-gold/20 border-life-gold bg-black/90 shadow-life-gold/20":n.type==="success"?"bg-green-950/90 border-green-500/50 shadow-green-900/20":"bg-life-black/90 border-life-muted/30 shadow-black/50"}
            `,children:[o.jsxs("div",{className:`
                w-10 h-10 rounded-full flex items-center justify-center shrink-0 border
                ${n.type==="error"?"bg-red-500/20 border-red-500 text-red-500":n.type==="level-up"?"bg-life-gold text-black border-life-gold animate-bounce":n.type==="success"?"bg-green-500/20 border-green-500 text-green-500":"bg-life-muted/20 border-life-muted text-life-muted"}
            `,children:[n.type==="error"&&o.jsx(hr,{size:20}),n.type==="level-up"&&o.jsx(Xh,{size:20,strokeWidth:2.5}),n.type==="success"&&o.jsx(Os,{size:20}),n.type==="info"&&o.jsx(gP,{size:20}),n.type==="crit"&&o.jsx(dt,{size:20})]}),o.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[o.jsx("span",{className:"text-xs font-bold text-white leading-tight",children:h}),x&&o.jsx("span",{className:`text-[10px] font-mono font-bold uppercase tracking-wider mt-1 truncate ${n.type==="error"?"text-red-300":"text-life-gold"}`,children:x})]}),o.jsx("div",{className:"text-life-muted/50 hover:text-white transition-colors",children:o.jsx(et,{size:14})})]})},xF=()=>{const{state:n,dispatch:e}=Ve(),{toasts:t}=n.ui;return t.length===0?null:o.jsx("div",{className:"fixed top-20 left-0 right-0 z-[150] flex flex-col items-center gap-2 pointer-events-none px-4",children:t.map(i=>o.jsx(gF,{toast:i,onDismiss:r=>e.removeToast(r)},i.id))})},yF=({onGuestLogin:n})=>{const[e,t]=K.useState(null),[i,r]=K.useState(!1),l=async()=>{r(!0),t(null);const d=new ks;try{await Pw(oo,d)}catch(p){console.error("Login Error:",p),p.code==="auth/unauthorized-domain"?t(`Domain not authorized: ${window.location.hostname}. Please add this domain to Firebase Console > Authentication > Settings.`):t(p.message||"Access Denied. Neural Link Failed."),r(!1)}},c=()=>{navigator.clipboard.writeText(window.location.hostname),alert("Domain copied to clipboard!")};return o.jsxs("div",{className:"min-h-screen bg-life-black text-life-text flex flex-col items-center justify-center p-6 relative overflow-hidden font-mono selection:bg-life-gold selection:text-life-black",children:[o.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-life-gold/50 to-transparent opacity-50"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-life-gold/50 to-transparent opacity-50"}),o.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(rgba(18,18,18,0)_50%,rgba(0,0,0,0.25)_50%),linear-gradient(90deg,rgba(255,0,0,0.06),rgba(0,255,0,0.02),rgba(0,0,255,0.06))] z-[1] bg-[length:100%_2px,3px_100%] pointer-events-none"}),o.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-life-gold/5 rounded-full blur-[100px] animate-pulse"}),o.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-64 h-64 bg-life-crimson/5 rounded-full blur-[80px] animate-pulse delay-1000"})]}),o.jsxs("div",{className:"relative z-10 w-full max-w-md bg-life-paper/80 backdrop-blur-xl border border-zinc-800 p-8 rounded-2xl shadow-2xl animate-in fade-in zoom-in-95 duration-500 group",children:[o.jsx("div",{className:"absolute -top-1 -left-1 w-4 h-4 border-t-2 border-l-2 border-life-gold rounded-tl-lg"}),o.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 border-t-2 border-r-2 border-life-gold rounded-tr-lg"}),o.jsx("div",{className:"absolute -bottom-1 -left-1 w-4 h-4 border-b-2 border-l-2 border-life-gold rounded-bl-lg"}),o.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 border-b-2 border-r-2 border-life-gold rounded-br-lg"}),o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("div",{className:"w-20 h-20 bg-life-black border-2 border-life-gold rounded-full flex items-center justify-center mx-auto mb-6 shadow-[0_0_20px_rgba(251,191,36,0.3)] group-hover:shadow-[0_0_30px_rgba(251,191,36,0.5)] transition-all duration-500",children:o.jsx(dt,{size:40,className:"text-life-gold animate-pulse"})}),o.jsx("h1",{className:"text-4xl font-black uppercase tracking-tighter text-white mb-2 glitch-text","data-text":"LIFE OS",children:"LIFE OS"}),o.jsx("p",{className:"text-xs text-life-gold font-bold uppercase tracking-[0.3em] opacity-80",children:"Neural Interface v2.0"})]}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex items-center gap-3 text-xs text-life-muted font-mono border-b border-zinc-800 pb-2",children:[o.jsx(zn,{size:14,className:"text-life-gold"}),o.jsxs("span",{children:["System Status: ",o.jsx("span",{className:"text-life-easy",children:"ONLINE"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 text-xs text-life-muted font-mono border-b border-zinc-800 pb-2",children:[o.jsx(Zi,{size:14,className:"text-life-gold"}),o.jsxs("span",{children:["Security Protocol: ",o.jsx("span",{className:"text-life-easy",children:"ACTIVE"})]})]}),o.jsxs("div",{className:"flex items-center gap-3 text-xs text-life-muted font-mono border-b border-zinc-800 pb-2",children:[o.jsx(aP,{size:14,className:"text-life-gold"}),o.jsxs("span",{children:["Network Uplink: ",o.jsx("span",{className:"text-life-easy",children:"READY"})]})]})]}),e&&o.jsxs("div",{className:"bg-life-hard/10 border border-life-hard/30 text-life-hard text-xs p-3 rounded-lg text-center font-bold animate-shake flex flex-col gap-2",children:[o.jsxs("span",{children:[" ",e]}),e.includes("Domain not authorized")&&o.jsx("button",{onClick:c,className:"text-[10px] underline text-life-gold hover:text-white",children:"Copy Domain"}),o.jsx("button",{onClick:n,className:"mt-2 py-2 px-4 bg-life-muted/20 hover:bg-life-muted/30 text-life-muted hover:text-white rounded border border-life-muted/30 text-[10px] uppercase tracking-wider transition-colors",children:"Continue as Guest (Dev Mode)"})]}),o.jsx("button",{onClick:l,disabled:i,className:"w-full py-4 bg-life-gold hover:bg-yellow-400 text-life-black font-black uppercase tracking-widest rounded-xl shadow-[0_0_20px_rgba(251,191,36,0.2)] hover:shadow-[0_0_30px_rgba(251,191,36,0.4)] transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-3 group/btn",children:i?o.jsx("span",{className:"animate-pulse",children:"Initializing..."}):o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[o.jsx("path",{fill:"currentColor",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),o.jsx("path",{fill:"currentColor",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),o.jsx("path",{fill:"currentColor",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),o.jsx("path",{fill:"currentColor",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),"Sign in with Google"]})}),o.jsx("p",{className:"text-[10px] text-life-muted text-center uppercase tracking-wider opacity-60",children:"By connecting, you accept the Neural Link Protocol."})]})]}),o.jsxs("div",{className:"absolute bottom-6 text-[10px] text-life-muted font-mono opacity-40",children:["SYSTEM_ID: ",Math.random().toString(36).substring(7).toUpperCase()," // SECURE_CONNECTION"]})]})},vF=()=>{const{state:n,dispatch:e}=Ve(),{ui:t,user:i}=n,[r,l]=K.useState(!1);if(K.useEffect(()=>{const d=()=>{l(!0),setTimeout(()=>l(!1),500)};return window.addEventListener("trigger-shake",d),()=>window.removeEventListener("trigger-shake",d)},[]),!i.hasOnboarded)return o.jsx(fL,{});const c=()=>{switch(t.currentView){case"profile":return o.jsx($L,{});case"shop":return o.jsx(IL,{});case"tasks":return o.jsx(_L,{});case"habits":return o.jsx(wL,{});case"raids":return o.jsx(NL,{});case"campaign":return o.jsx(KL,{});case"skills":return o.jsx(ZL,{});case"hall_of_fame":return o.jsx(pF,{});default:return null}};return o.jsxs("div",{className:`flex flex-col h-[100dvh] bg-life-black text-life-text overflow-hidden select-none font-sans ${r?"animate-shake":""} pt-[env(safe-area-inset-top)] pb-[env(safe-area-inset-bottom)]`,children:[o.jsx(gL,{}),o.jsx(xF,{}),o.jsx(Q3,{}),o.jsxs("main",{className:"flex-1 overflow-y-auto relative p-4 scroll-smooth",children:[o.jsx("div",{className:"absolute inset-0 opacity-[0.03] pointer-events-none",style:{backgroundImage:"linear-gradient(#333 1px, transparent 1px), linear-gradient(90deg, #333 1px, transparent 1px)",backgroundSize:"20px 20px"}}),o.jsx("div",{className:"max-w-md mx-auto h-full",children:c()})]}),t.activeModal==="addTask"&&o.jsx(BH,{}),t.activeModal==="levelUp"&&o.jsx(qH,{}),t.activeModal==="badgeUnlock"&&o.jsx(mF,{}),t.activeModal==="streak"&&o.jsx($H,{}),t.activeModal==="devConsole"&&o.jsx(JH,{}),t.activeModal==="itemDetails"&&o.jsx(XH,{}),t.activeModal==="resetConfirm"&&o.jsx(WH,{}),t.activeModal==="confirmation"&&o.jsx(QH,{}),t.activeModal==="loot"&&o.jsx(ZH,{}),t.activeModal==="quickSubtask"&&o.jsx(eF,{}),t.activeModal==="dataExchange"&&o.jsx(tF,{}),t.activeModal==="login"&&o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm animate-in fade-in",children:o.jsxs("div",{className:"relative w-full max-w-md",children:[o.jsx("button",{onClick:()=>e.setModal("none"),className:"absolute top-4 right-4 z-50 text-life-muted hover:text-white",children:""}),o.jsx(yF,{onGuestLogin:()=>e.setModal("none")})]})}),t.activeModal==="honorBreakdown"&&o.jsx(nF,{})," ",t.activeModal==="questForge"&&o.jsx(iF,{})," ",t.activeModal==="habitProtocol"&&o.jsx(sF,{})," ",t.activeModal==="economyProtocol"&&o.jsx(rF,{})," ",t.activeModal==="raidProtocol"&&o.jsx(oF,{})," ",t.activeModal==="skillProtocol"&&o.jsx(aF,{})," ",t.activeModal==="shopProtocol"&&o.jsx(lF,{})," ",t.activeModal==="codexArbiter"&&o.jsx(cF,{})," ",t.activeModal==="badgeProtocol"&&o.jsx(uF,{})," ",o.jsx(dL,{}),o.jsx(t6,{}),o.jsx(i6,{}),o.jsx($3,{})]})},bF=()=>{const[n,e]=K.useState(null),[t,i]=K.useState(!0);return K.useEffect(()=>{const r=M0(oo,l=>{e(l),i(!1)});return()=>r()},[]),t?o.jsx("div",{className:"h-screen bg-life-black flex items-center justify-center text-life-gold font-mono animate-pulse",children:"INITIALIZING SYSTEM..."}):o.jsx(vF,{})},US=document.getElementById("root");US&&_k.createRoot(US).render(o.jsx(pk.StrictMode,{children:o.jsx(r4,{children:o.jsx(W3,{children:o.jsx(oL,{children:o.jsx(uL,{children:o.jsx(mL,{children:o.jsx(kL,{children:o.jsx(xL,{children:o.jsx(DL,{children:o.jsx(bF,{})})})})})})})})})}));export{ll as I,iu as N,b0 as W};
